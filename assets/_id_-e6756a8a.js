import{L as Je,N as Ke,b4 as nt,R as Xe,S as ct,W as ut,b5 as dt,a9 as Ee,p as e,G as $e,a8 as Vt,Z as Fe,E as Z,ac as mt,Q as pt,b6 as vt,O as ft,b7 as qt,Y as ot,a1 as Ct,$ as zt,ap as V,b8 as St,b9 as Ut,ba as Dt,k as S,I as je,o as n,b as h,y as t,aI as Q,aY as G,C as L,m as i,A as l,b1 as fe,D as d,aV as Le,bb as te,aD as Ve,aB as ge,aJ as ue,aL as Se,q as a,aK as re,c as p,aj as k,F as X,a as ne,at as Pe,bc as Te,H as qe,a$ as Re,r as ye,ah as ie,s as et,aZ as Ce,aX as we,ar as De,w as Be,bd as It,be as _t,aa as gt,b3 as ht,J as Mt,b0 as Pt,t as Bt}from"./index-53919516.js";import{V as xe}from"./VDialog-27a437ee.js";import{a as be,u as $t,_ as Ft,V as Lt}from"./ProjectCreateDialog-8257be7f.js";import{V as se,a as R}from"./VRow-d763a9a4.js";import{V as H}from"./VChip-3990c82e.js";import{V as ae}from"./VDivider-5b9e39d0.js";import{g as he,a as Qe,b as yt}from"./formatters-a6f48d06.js";import{V as le}from"./VSpacer-dc91da41.js";import{V as Ie}from"./VForm-58148bc2.js";import{b as de}from"./VTextField-5ba54c6d.js";import{V as _e}from"./VSelect-fb437ec2.js";import{b as tt,c as pe,V as Ue,a as bt}from"./VTabs-3bdc27fa.js";import{V as at,a as ve}from"./VSlideGroup-e5d494dd.js";import{V as Ne,a as He,b as Ye}from"./VList-6905e9b5.js";import{V as Rt}from"./VTooltip-f88f6c0c.js";import{b as it}from"./route-block-83d24a4e.js";import{V as Ot}from"./VMenu-4e9f0a8d.js";import"./index-eadd1e36.js";import"./VCheckboxBtn-ec9e9053.js";import"./ssrBoot-c4ce3992.js";const Ze=Je()({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...Ke(),...nt(),...Xe(),...ct()},setup(s,u){let{slots:o}=u;const{themeClasses:r}=ut(s),{densityClasses:v}=dt(s);return Ee(()=>e(s.tag,{class:["v-table",{"v-table--fixed-height":!!s.height,"v-table--fixed-header":s.fixedHeader,"v-table--fixed-footer":s.fixedFooter,"v-table--has-top":!!o.top,"v-table--has-bottom":!!o.bottom,"v-table--hover":s.hover},r.value,v.value,s.class],style:s.style},{default:()=>{var c,f,_;return[(c=o.top)==null?void 0:c.call(o),o.default?e("div",{class:"v-table__wrapper",style:{height:$e(s.height)}},[e("table",null,[o.default()])]):(f=o.wrapper)==null?void 0:f.call(o),(_=o.bottom)==null?void 0:_.call(o)]}})),{}}}),jt=Je()({name:"VTimeline",props:{align:{type:String,default:"center",validator:s=>["center","start"].includes(s)},direction:{type:String,default:"vertical",validator:s=>["vertical","horizontal"].includes(s)},justify:{type:String,default:"auto",validator:s=>["auto","center"].includes(s)},side:{type:String,validator:s=>s==null||["start","end"].includes(s)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:s=>["start","end","both"].includes(s)},...Ke(),...nt(),...Xe(),...ct()},setup(s,u){let{slots:o}=u;const{themeClasses:r}=ut(s),{densityClasses:v}=dt(s);Vt({VTimelineDivider:{lineColor:Fe(s,"lineColor")},VTimelineItem:{density:Fe(s,"density"),lineInset:Fe(s,"lineInset")}});const c=Z(()=>{const _=s.side?s.side:s.density!=="default"?"end":null;return _&&`v-timeline--side-${_}`}),f=Z(()=>{const _=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(s.truncateLine){case"both":return _;case"start":return _[0];case"end":return _[1];default:return null}});return Ee(()=>e(s.tag,{class:["v-timeline",`v-timeline--${s.direction}`,`v-timeline--align-${s.align}`,`v-timeline--justify-${s.justify}`,f.value,{"v-timeline--inset-line":!!s.lineInset},r.value,v.value,c.value,s.class],style:[{"--v-timeline-line-thickness":$e(s.lineThickness)},s.style]},o)),{}}}),At=Je()({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:mt,iconColor:String,lineColor:String,...Ke(),...pt(),...vt(),...ft()},setup(s,u){let{slots:o}=u;const{sizeClasses:r,sizeStyles:v}=qt(s,"v-timeline-divider__dot"),{backgroundColorStyles:c,backgroundColorClasses:f}=ot(Fe(s,"dotColor")),{roundedClasses:_}=Ct(s,"v-timeline-divider__dot"),{elevationClasses:j}=zt(s),{backgroundColorClasses:q,backgroundColorStyles:z}=ot(Fe(s,"lineColor"));return Ee(()=>e("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":s.fillDot},s.class],style:s.style},[e("div",{class:["v-timeline-divider__before",q.value],style:z.value},null),!s.hideDot&&e("div",{key:"dot",class:["v-timeline-divider__dot",j.value,_.value,r.value],style:v.value},[e("div",{class:["v-timeline-divider__inner-dot",f.value,_.value],style:c.value},[o.default?e(St,{key:"icon-defaults",disabled:!s.icon,defaults:{VIcon:{color:s.iconColor,icon:s.icon,size:s.size}}},o.default):e(V,{key:"icon",color:s.iconColor,icon:s.icon,size:s.size},null)])]),e("div",{class:["v-timeline-divider__after",q.value],style:z.value},null)])),{}}}),kt=Je()({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:mt,iconColor:String,lineInset:[Number,String],...Ke(),...Ut(),...ft(),...pt(),...vt(),...Xe()},setup(s,u){let{slots:o}=u;const{dimensionStyles:r}=Dt(s),v=S(0),c=S();return je(c,f=>{var _;f&&(v.value=((_=f.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:_.getBoundingClientRect().width)??0)},{flush:"post"}),Ee(()=>{var f,_;return e("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":s.fillDot},s.class],style:[{"--v-timeline-dot-size":$e(v.value),"--v-timeline-line-inset":s.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${$e(s.lineInset)})`:$e(0)},s.style]},[e("div",{class:"v-timeline-item__body",style:r.value},[(f=o.default)==null?void 0:f.call(o)]),e(At,{ref:c,hideDot:s.hideDot,icon:s.icon,iconColor:s.iconColor,size:s.size,elevation:s.elevation,dotColor:s.dotColor,fillDot:s.fillDot,rounded:s.rounded},{default:o.icon}),s.density!=="compact"&&e("div",{class:"v-timeline-item__opposite"},[!s.hideOpposite&&((_=o.opposite)==null?void 0:_.call(o))])])}),{}}}),Tt=i("span",{class:"text-5xl"},"!",-1),Nt={class:"text-lg font-weight-medium"},Oe={__name:"ConfirmDialog",props:{confirmationMsg:{type:String,required:!0},isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","confirm"],setup(s,{emit:u}){const o=s,r=f=>{u("update:isDialogVisible",f)},v=()=>{u("confirm",!0),r(!1)},c=()=>{u("confirm",!1),u("update:isDialogVisible",!1)};return(f,_)=>(n(),h(xe,{"max-width":"500","model-value":o.isDialogVisible,"onUpdate:modelValue":r},{default:t(()=>[e(Q,{class:"text-center px-10 py-6"},{default:t(()=>[e(G,null,{default:t(()=>[e(L,{icon:"",variant:"outlined",color:"warning",class:"mb-4",style:{width:"88px",height:"88px","pointer-events":"none"}},{default:t(()=>[Tt]),_:1}),i("h6",Nt,l(o.confirmationMsg),1)]),_:1}),e(fe,{class:"align-center justify-center gap-2"},{default:t(()=>[e(L,{variant:"elevated",onClick:v},{default:t(()=>[d(l(f.$t("confirmation.confirm")),1)]),_:1}),e(L,{color:"secondary",variant:"tonal",onClick:c},{default:t(()=>[d(l(f.$t("confirmation.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},lt=Le({id:"UserStoryStore",state:()=>({userStories:[],currentUserStory:null,loading:!1,error:null}),actions:{async fetchUserStories(s=null){this.loading=!0;try{let u="/service/user-stories/";s&&(u+=`?requirement=${s}`);const o=await te.get(u);return o.status===200?(this.userStories=o.data,{data:o.data,error:null}):{data:[],error:o.data}}catch(u){return this.error=u.message||"Failed to fetch user stories",{data:[],error:this.error}}finally{this.loading=!1}},async fetchUserStoryById(s){this.loading=!0;try{const u=await te.get(`/service/user-stories/${s}/`);return u.status===200?(this.currentUserStory=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch user story",{data:null,error:this.error}}finally{this.loading=!1}},async createUserStory(s){this.loading=!0;try{const u=await te.post("/service/user-stories/",s);return u.status===201?(this.userStories.length&&this.userStories.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create user story",{data:null,error:this.error}}finally{this.loading=!1}},async updateUserStory(s,u){this.loading=!0;try{const o=await te.put(`/service/user-stories/${s}/`,u);if(o.status===200){if(this.userStories.length){const r=this.userStories.findIndex(v=>v.id===s);r!==-1&&(this.userStories[r]=o.data)}return this.currentUserStory&&this.currentUserStory.id===s&&(this.currentUserStory=o.data),{data:o.data,error:null}}return{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update user story",{data:null,error:this.error}}finally{this.loading=!1}},async deleteUserStory(s){this.loading=!0;try{const u=await te.delete(`/service/user-stories/${s}/`);return u.status===204?(this.userStories.length&&(this.userStories=this.userStories.filter(o=>o.id!==s)),this.currentUserStory&&this.currentUserStory.id===s&&(this.currentUserStory=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete user story",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateUserStory(s,u=""){this.loading=!0;try{const o=await te.post(`/service/user-stories/${s}/regenerate/`,{feedback:u});return o.status===202?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to regenerate user story",{data:null,error:this.error}}finally{this.loading=!1}},async createComment(s,u){this.loading=!0;try{const o=await te.post("/service/user-story-comments/",{user_story:s,text:u.text,status:u.status||"active"});return o.status===201?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(s){this.loading=!0;try{const u=await te.delete(`/service/user-story-comments/${s}/`);return u.status===204?{success:!0,error:null}:{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),rt=Le({id:"UmlDiagramStore",state:()=>({diagrams:[],currentDiagram:null,loading:!1,error:null}),actions:{async fetchDiagrams(s=null,u=null){this.loading=!0;try{let o="/service/uml-diagrams/";const r={};s&&(r.project=s),u&&(r.diagram_type=u);const v=await te.get(o,{params:r});return v.status===200?(this.diagrams=v.data,{data:v.data,error:null}):{data:[],error:v.data}}catch(o){return this.error=o.message||"Failed to fetch UML diagrams",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDiagramById(s){this.loading=!0;try{const u=await te.get(`/service/uml-diagrams/${s}/`);return u.status===200?(this.currentDiagram=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async createDiagram(s){this.loading=!0;try{const u=await te.post("/service/uml-diagrams/",s);return u.status===201?(this.diagrams.length&&this.diagrams.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async updateDiagram(s,u){this.loading=!0;try{const o=await te.put(`/service/uml-diagrams/${s}/`,u);if(o.status===200){if(this.diagrams.length){const r=this.diagrams.findIndex(v=>v.id===s);r!==-1&&(this.diagrams[r]=o.data)}return this.currentDiagram&&this.currentDiagram.id===s&&(this.currentDiagram=o.data),{data:o.data,error:null}}return{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async deleteDiagram(s){this.loading=!0;try{const u=await te.delete(`/service/uml-diagrams/${s}/`);return u.status===204?(this.diagrams.length&&(this.diagrams=this.diagrams.filter(o=>o.id!==s)),this.currentDiagram&&this.currentDiagram.id===s&&(this.currentDiagram=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete UML diagram",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateDiagram(s){this.loading=!0;try{const u=await te.post(`/service/uml-diagrams/${s}/regenerate/`);return u.status===202?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to regenerate UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async generateDiagrams(s,u="class"){this.loading=!0;try{const o=await te.post(`/service/projects/${s}/generate_uml_diagrams/`,{diagram_type:u});return o.status===202?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to generate UML diagrams",{data:null,error:this.error}}finally{this.loading=!1}}}}),Ht={class:"d-flex flex-column gap-4"},Yt={class:"d-flex flex-column gap-2"},Zt={class:"d-flex align-center"},Jt={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},Kt={class:"d-flex align-center"},Et={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},Gt={class:"d-flex align-center"},Wt={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},Qt={class:"d-flex align-center"},Xt={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ea={key:0,class:"d-flex align-center"},ta={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},aa={key:1,class:"d-flex align-center"},la={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ra={key:2,class:"d-flex align-center"},sa={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},oa={class:"d-flex align-center"},ia=["title"],na={class:"ms-2"},ca={class:"whitespace-pre-wrap"},ua={class:"d-flex flex-column gap-4"},da={key:0},ma={class:"text-subtitle-1 font-weight-bold mb-2"},pa={class:"whitespace-pre-wrap"},va={key:1},fa={class:"text-subtitle-1 font-weight-bold mb-2"},_a={class:"d-flex flex-column gap-4"},ga={class:"whitespace-pre-wrap mb-4"},ha={key:0,class:"whitespace-pre-wrap"},ya={class:"text-subtitle-1 font-weight-bold mb-2"},ba={class:"whitespace-pre-wrap"},ja={class:"whitespace-pre-wrap"},ka={class:"whitespace-pre-wrap"},xa={class:"d-flex flex-column gap-3"},wa={class:"font-weight-medium mb-1"},Va={class:"d-flex justify-space-between mt-1"},qa={class:"font-weight-medium mb-1"},Ca={class:"d-flex justify-space-between mt-1"},za={class:"font-weight-medium mb-1"},Sa={class:"d-flex align-center gap-2"},Ua={class:"flex-grow-1"},Da={class:"font-weight-medium mb-1"},Ia={class:"d-flex justify-space-between mt-1"},Ma=Ve({__name:"ProjectDetailsInfo",props:{project:{type:Object,required:!0},loading:{type:Boolean,default:!1}},setup(s){const u=s,{t:o}=ge(),r=_=>_?new Date(parseInt(_)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):o("projects.details.not_set"),v=Z(()=>{switch(u.project.status){case"draft":return"warning";case"active":return"success";case"archived":return"secondary";case"completed":return"info";default:return"primary"}}),c=Z(()=>{switch(u.project.type_of_application){case"website":return"tabler-world-www";case"mobile":return"tabler-device-mobile";case"desktop":return"tabler-device-desktop";case"api":return"tabler-api";default:return"tabler-code"}}),f={en:o("projects.languages.english"),ru:o("projects.languages.russian"),de:o("projects.languages.german")};return(_,j)=>(n(),h(G,{class:"pa-6"},{default:t(()=>[e(se,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[i("div",Ht,[e(Q,{border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(V,{icon:a(c)},null,8,["icon"])]),_:1})]),append:t(()=>[e(H,{size:"small",color:a(v),label:""},{default:t(()=>[d(l(a(o)(`projects.status.${s.project.status}`)),1)]),_:1},8,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.project_overview")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",Yt,[i("div",Zt,[i("span",Jt,l(a(o)("projects.details.created_at"))+":",1),i("span",null,l(r(s.project.created_at)),1)]),i("div",Kt,[i("span",Et,l(a(o)("projects.details.updated_at"))+":",1),i("span",null,l(r(s.project.updated_at)),1)]),i("div",Gt,[i("span",Wt,l(a(o)("projects.details.type"))+":",1),e(H,{size:"small"},{default:t(()=>[d(l(a(o)(`projects.types.${s.project.type_of_application}`)),1)]),_:1})]),i("div",Qt,[i("span",Xt,l(a(o)("projects.details.language"))+":",1),e(H,{size:"small"},{default:t(()=>{return[d(l((q=s.project.language,f[q]||q)),1)];var q}),_:1})]),s.project.deadline?(n(),p("div",ea,[i("span",ta,l(a(o)("projects.details.deadline"))+":",1),i("span",null,l(r(s.project.deadline)),1)])):k("",!0),s.project.preliminary_budget?(n(),p("div",aa,[i("span",la,l(a(o)("projects.details.budget"))+":",1),i("span",null,"$"+l(s.project.preliminary_budget),1)])):k("",!0),s.project.color_scheme?(n(),p("div",ra,[i("span",sa,l(a(o)("projects.details.color_scheme"))+":",1),i("div",oa,[(n(!0),p(X,null,ne(s.project.color_scheme.split(","),(q,z)=>(n(),p("div",{key:z,class:"color-swatch rounded me-1",style:Pe({backgroundColor:q.trim()}),title:a(o)("projects.details.color")},null,12,ia))),128)),i("span",na,l(s.project.color_scheme),1)])])):k("",!0)])]),_:1})]),_:1}),s.project.additional_requirements?(n(),h(Q,{key:0,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-list-details"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.additional_requirements")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",ca,l(s.project.additional_requirements),1)]),_:1})]),_:1})):k("",!0),s.project.technology_stack||s.project.operating_system?(n(),h(Q,{key:1,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-device-laptop-code"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.technical_details")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",ua,[s.project.technology_stack?(n(),p("div",da,[i("h6",ma,l(a(o)("projects.details.technology_stack")),1),i("div",pa,l(s.project.technology_stack),1)])):k("",!0),s.project.operating_system?(n(),p("div",va,[i("h6",fa,l(a(o)("projects.details.operating_system")),1),i("div",null,l(s.project.operating_system),1)])):k("",!0)])]),_:1})]),_:1})):k("",!0)])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[i("div",_a,[e(Q,{border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-file-description"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.description")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",ga,l(s.project.short_description),1),s.project.application_description?(n(),p("div",ha,[i("h6",ya,l(a(o)("projects.details.application_description")),1),i("div",null,l(s.project.application_description),1)])):k("",!0)]),_:1})]),_:1}),s.project.target_users?(n(),h(Q,{key:0,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-users"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.target_users")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",ba,l(s.project.target_users),1)]),_:1})]),_:1})):k("",!0),s.project.non_functional_requirements?(n(),h(Q,{key:1,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-chart-bubble"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.non_functional_requirements")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",ja,l(s.project.non_functional_requirements),1)]),_:1})]),_:1})):k("",!0),s.project.priority_modules?(n(),h(Q,{key:2,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-star"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.priority_modules")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",ka,l(s.project.priority_modules),1)]),_:1})]),_:1})):k("",!0),s.project.generation_progress?(n(),h(Q,{key:3,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"info",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(V,{icon:"tabler-info-circle"})]),_:1})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.generation_status")),1)]),_:1})]),_:1}),e(ae),e(G,null,{default:t(()=>[i("div",xa,[i("div",null,[i("div",wa,l(a(o)("projects.details.requirements")),1),e(Te,{"model-value":s.project.generation_progress.requirements.status==="completed"?100:s.project.generation_progress.requirements.status==="in_progress"?50:s.project.generation_progress.requirements.status==="pending"?10:0,color:s.project.generation_progress.requirements.status==="completed"?"success":s.project.generation_progress.requirements.status==="in_progress"?"info":s.project.generation_progress.requirements.status==="failed"?"error":"warning",height:"8",rounded:""},null,8,["model-value","color"]),i("div",Va,[i("small",null,l(a(o)(`projects.details.${s.project.generation_progress.requirements.status}`)),1),i("small",null,l(s.project.requirements?s.project.requirements.length:0)+" "+l(a(o)("projects.details.requirements_count")),1)])]),i("div",null,[i("div",qa,l(a(o)("projects.details.user_stories")),1),e(Te,{"model-value":s.project.generation_progress.user_stories.total>0?s.project.generation_progress.user_stories.completed/s.project.generation_progress.user_stories.total*100:0,color:"info",height:"8",rounded:""},null,8,["model-value"]),i("div",Ca,[i("small",null,l(s.project.generation_progress.user_stories.completed)+" "+l(a(o)("projects.details.completed")),1),i("small",null,l(s.project.generation_progress.user_stories.total)+" "+l(a(o)("projects.details.total")),1)])]),i("div",null,[i("div",za,l(a(o)("projects.details.mockups")),1),i("div",Sa,[i("div",Ua,[e(Te,{"model-value":s.project.mockups&&s.project.mockups.length?s.project.mockups.filter(q=>q.generation_status==="completed"&&!q.needs_regeneration).length/s.project.mockups.length*100:0,color:"success",height:"8",rounded:""},null,8,["model-value"])]),i("div",null,[s.project.mockups&&s.project.mockups.some(q=>q.needs_regeneration||q.generation_status==="in_progress"||q.generation_status==="pending")?(n(),h(H,{key:0,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(s.project.mockups.filter(q=>q.needs_regeneration||q.generation_status==="in_progress"||q.generation_status==="pending").length)+" "+l(a(o)("projects.details.pending")),1)]),_:1})):k("",!0)])])]),i("div",null,[i("div",Da,l(a(o)("projects.details.uml_diagrams")),1),e(Te,{"model-value":s.project.generation_progress.uml_diagrams.total>0?s.project.generation_progress.uml_diagrams.completed/s.project.generation_progress.uml_diagrams.total*100:0,color:"primary",height:"8",rounded:""},null,8,["model-value"]),i("div",Ia,[i("small",null,l(s.project.generation_progress.uml_diagrams.completed)+" "+l(a(o)("projects.details.completed")),1),i("small",null,l(s.project.generation_progress.uml_diagrams.total)+" "+l(a(o)("projects.details.total")),1)])])])]),_:1})]),_:1})):k("",!0)])]),_:1})]),_:1})]),_:1}))}},[["__scopeId","data-v-7dff8a18"]]),xt=Le({id:"RequirementStore",state:()=>({requirements:[],currentRequirement:null,loading:!1,error:null}),actions:{async fetchRequirements(s=null){this.loading=!0;try{let u="/service/requirements/";s&&(u+=`?project=${s}`);const o=await te.get(u);return o.status===200?(this.requirements=o.data,{data:o.data,error:null}):{data:[],error:o.data}}catch(u){return this.error=u.message||"Failed to fetch requirements",{data:[],error:this.error}}finally{this.loading=!1}},async fetchRequirementById(s){this.loading=!0;try{const u=await te.get(`/service/requirements/${s}/`);return u.status===200?(this.currentRequirement=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch requirement",{data:null,error:this.error}}finally{this.loading=!1}},async createRequirement(s){this.loading=!0;try{const u=await te.post("/service/requirements/",s);return u.status===201?(this.requirements.length&&this.requirements.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create requirement",{data:null,error:this.error}}finally{this.loading=!1}},async updateRequirement(s,u){this.loading=!0;try{const o=await te.put(`/service/requirements/${s}/`,u);if(o.status===200){if(this.requirements.length){const r=this.requirements.findIndex(v=>v.id===s);r!==-1&&(this.requirements[r]=o.data)}return this.currentRequirement&&this.currentRequirement.id===s&&(this.currentRequirement=o.data),{data:o.data,error:null}}return{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update requirement",{data:null,error:this.error}}finally{this.loading=!1}},async deleteRequirement(s){this.loading=!0;try{const u=await te.delete(`/service/requirements/${s}/`);return u.status===204?(this.requirements.length&&(this.requirements=this.requirements.filter(o=>o.id!==s)),this.currentRequirement&&this.currentRequirement.id===s&&(this.currentRequirement=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete requirement",{success:!1,error:this.error}}finally{this.loading=!1}},async createComment(s,u){this.loading=!0;try{const o=await te.post("/service/requirement-comments/",{requirement:s,text:u.text,status:u.status||"active",responsible_user:u.responsibleUser||null});return o.status===201?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(s){this.loading=!0;try{const u=await te.delete(`/service/requirement-comments/${s}/`);return u.status===204?{success:!0,error:null}:{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),Ge=Le("mockup",()=>{const s=S([]),u=S(!1),o=S(null);return{mockups:s,loading:u,error:o,fetchProjectMockups:async r=>{u.value=!0,o.value=null;try{const v=await te.get(`/service/projects/${r}/mockups/`);return s.value=v.data,v.data}catch(v){throw o.value="Failed to fetch mockups",console.error(v),v}finally{u.value=!1}},fetchMockupById:async r=>{u.value=!0,o.value=null;try{const v=await te.get(`/service/mockups/${r}/`),c=s.value.findIndex(f=>f.id===r);return c!==-1&&(s.value[c]=v.data),v.data}catch(v){throw o.value="Failed to fetch mockup",console.error(v),v}finally{u.value=!1}},regenerateMockup:async(r,v)=>{u.value=!0,o.value=null;try{const c=await te.post(`/service/mockups/${r}/regenerate/`,v),f=s.value.findIndex(_=>_.id===r);return f!==-1&&(s.value[f]=c.data),c.data}catch(c){throw o.value="Failed to regenerate mockup",console.error(c),c}finally{u.value=!1}},regenerateAllMockups:async r=>{u.value=!0,o.value=null;try{const v=await te.post(`/service/projects/${r}/regenerate-mockups/`);return s.value=v.data,v.data}catch(v){throw o.value="Failed to regenerate all mockups",console.error(v),v}finally{u.value=!1}},updateMockupById:async(r,v)=>{u.value=!0,o.value=null;try{return(await te.put(`/service/mockups/${r}/`,v)).data}catch(c){throw o.value="Failed to update mockup",console.error(c),c}finally{u.value=!1}},deleteMockupById:async r=>{u.value=!0,o.value=null;try{return(await te.delete(`/service/mockups/${r}/`)).status===204}catch(v){throw o.value="Failed to delete mockup",console.error(v),v}finally{u.value=!1}}}}),Pa={key:0,class:"text-h5"},Ba={class:"text-h5"},$a={key:0,class:"ms-2 d-flex align-center"},Fa={class:"text-caption"},La={key:0},Ra={key:1},Oa={class:"mockup-metadata d-flex align-center px-6 py-3"},Aa={class:"d-flex align-center"},Ta={class:"text-caption"},Na={class:"d-flex align-center ms-4"},Ha={class:"text-caption"},Ya={key:0,class:"d-flex align-center ms-4"},Za={class:"text-caption"},Ja={key:1,class:"d-flex align-center ms-4"},Ka={class:"text-caption"},Ea={class:"mockup-content pa-0"},Ga={class:"text-h6 mb-2"},Wa={class:"text-body-1 text-medium-emphasis max-width-md text-center"},Qa=["srcdoc","title"],Xa={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},el={class:"text-h6 mb-2"},tl={class:"text-medium-emphasis text-center"},al={class:"text-body-1 mb-3"},st=Ve({__name:"MockupPreviewDialog",props:{modelValue:{type:Boolean,default:!1},mockup:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=Z({get:()=>o.modelValue,set:x=>u("update:modelValue",x)}),c=Ge(),f=S(!1),_=S(!1),j=S({...o.mockup}),q=S(!1),z=S(null),$=S(!1),F=S(""),I=S({show:!1,text:"",color:"success"}),P=Z(()=>o.mockup.generation_status==="in_progress"||o.mockup.generation_status==="pending"||o.mockup.needs_regeneration),N=x=>x?(x=parseInt(x),new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",J=()=>{f.value=!f.value},T=()=>{_.value&&(j.value={...o.mockup}),_.value=!_.value},O=async()=>{q.value=!0;try{const{data:x,error:U}=await c.updateMockupById(o.mockup.id,j.value);x&&!U?(M(r("projects.mockups.notifications.updated")),Object.assign(o.mockup,x),_.value=!1,v.value=!1):M(r("projects.mockups.notifications.update_failed"),"error")}catch(x){M(r("projects.mockups.notifications.update_error",{error:x.message}),"error")}finally{q.value=!1}},A=()=>{u("delete"),v.value=!1},E=async()=>{$.value=!0},C=async()=>{q.value=!0;try{o.mockup.user_story?await c.regenerateMockup(o.mockup.id,{user_story_id:o.mockup.user_story.id,feedback:F.value}):o.mockup.requirement?await c.regenerateMockup(o.mockup.id,{requirement_id:o.mockup.requirement.id,feedback:F.value}):await c.regenerateMockup(o.mockup.id,{feedback:F.value}),M(r("projects.mockups.notifications.regeneration_started")),$.value=!1,F.value="",v.value=!1,z.value=setInterval(ee,5e3)}catch(x){M(r("projects.mockups.notifications.regeneration_error",{error:x.message}),"error")}finally{q.value=!1}},M=(x,U="success")=>{I.value={show:!0,text:x,color:U}},ee=()=>{P.value&&v.value&&c.fetchMockupById(o.mockup.id).then(({data:x})=>{x&&Object.assign(o.mockup,x)})};return je(()=>o.mockup,x=>{j.value={...x}},{deep:!0}),qe(()=>{z.value=setInterval(ee,5e3)}),Re(()=>{z.value&&clearInterval(z.value)}),(x,U)=>{const W=ye("IconBtn");return n(),h(xe,{modelValue:a(v),"onUpdate:modelValue":U[9]||(U[9]=b=>De(v)?v.value=b:null),fullscreen:f.value,"max-width":f.value?"100%":"900",scrollable:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[_.value?(n(),p("h5",Pa,l(a(r)("projects.mockups.actions.edit")),1)):(n(),p(X,{key:1},[i("h5",Ba,l(s.mockup.name),1),e(H,{color:a(he)(s.mockup.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${s.mockup.status}`)),1)]),_:1},8,["color"]),a(P)?(n(),p("div",$a,[e(ie,{indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"}),i("span",Fa,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating"):a(r)("projects.mockups.status.pending")),1)])):k("",!0)],64)),e(le),e(L,{icon:"",variant:"text",onClick:J},{default:t(()=>[e(V,{icon:f.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(W,{onClick:U[0]||(U[0]=b=>v.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(ae),e(G,{class:et({"pa-0":!_.value&&s.mockup.html_content,"pa-6":_.value||!s.mockup.html_content}),style:Pe({height:f.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:t(()=>[_.value?(n(),p("div",La,[e(Ie,{onSubmit:Ce(O,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:j.value.name,"onUpdate:modelValue":U[1]||(U[1]=b=>j.value.name=b),label:a(r)("projects.mockups.name"),required:"",rules:[b=>!!b||a(r)("projects.mockups.validation.name_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:j.value.status,"onUpdate:modelValue":U[2]||(U[2]=b=>j.value.status=b),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:j.value.html_content,"onUpdate:modelValue":U[3]||(U[3]=b=>j.value.html_content=b),label:a(r)("projects.mockups.html_content"),rows:"15",rules:[b=>!!b||a(r)("projects.mockups.validation.html_required")],monospace:""},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",Ra,[i("div",Oa,[i("div",Aa,[e(V,{icon:"tabler-calendar",class:"me-2",size:"18"}),i("span",Ta,l(a(r)("projects.details.created_at"))+": "+l(N(s.mockup.created_at)),1)]),i("div",Na,[e(V,{icon:"tabler-calendar-event",class:"me-2",size:"18"}),i("span",Ha,l(a(r)("projects.details.updated_at"))+": "+l(N(s.mockup.updated_at)),1)]),s.mockup.requirement?(n(),p("div",Ya,[e(V,{icon:"tabler-file-check",class:"me-2",size:"18"}),i("span",Za,l(a(r)("projects.details.requirement"))+": "+l(s.mockup.requirement_name),1)])):k("",!0),s.mockup.user_story?(n(),p("div",Ja,[e(V,{icon:"tabler-user-check",class:"me-2",size:"18"}),i("span",Ka,l(a(r)("projects.details.user_story"))+": "+l(s.mockup.user_story_name),1)])):k("",!0)]),e(ae),i("div",Ea,[a(P)?(n(),p("div",{key:0,class:"d-flex flex-column justify-center align-center",style:Pe({height:f.value?"calc(100vh - 180px)":"calc(70vh - 110px)"})},[e(ie,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),i("h4",Ga,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating"):a(r)("projects.mockups.status.preparing")),1),i("p",Wa,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating_description"):a(r)("projects.mockups.status.preparing_description")),1)],4)):s.mockup.html_content?(n(),p("iframe",{key:1,srcdoc:s.mockup.html_content,class:"mockup-iframe",style:Pe([{width:"100%",border:"none"},{height:f.value?"calc(100vh - 180px)":"calc(70vh - 110px)"}]),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",title:a(r)("projects.mockups.preview")},null,12,Qa)):(n(),p("div",Xa,[e(V,{icon:"tabler-code-off",size:"64",color:"secondary",class:"mb-4"}),i("h4",el,l(a(r)("projects.mockups.no_content.title")),1),i("p",tl,l(a(r)("projects.mockups.no_content.description")),1)]))])]))]),_:1},8,["class","style"]),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[_.value?(n(),p(X,{key:0},[e(L,{color:"secondary",variant:"tonal",onClick:T,disabled:q.value},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(le),e(L,{color:"primary",onClick:O,loading:q.value},{default:t(()=>[d(l(a(r)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),p(X,{key:1},[s.isAdmin?(n(),h(L,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:A},{default:t(()=>[d(l(a(r)("projects.actions.delete")),1)]),_:1})):k("",!0),s.hasManagerPermission?(n(),h(L,{key:1,color:"warning",variant:"tonal","prepend-icon":"tabler-refresh",onClick:E,loading:a(P)||q.value,disabled:a(P),class:"ms-2"},{default:t(()=>[d(l(a(r)("projects.mockups.actions.regenerate")),1)]),_:1},8,["loading","disabled"])):k("",!0),e(le),s.hasManagerPermission?(n(),h(L,{key:2,class:"ms-2",color:"primary",variant:"tonal","prepend-icon":"tabler-code",onClick:T},{default:t(()=>[d(l(a(r)("projects.mockups.actions.edit")),1)]),_:1})):k("",!0)],64))]),_:1})]),_:1}),e(xe,{modelValue:$.value,"onUpdate:modelValue":U[6]||(U[6]=b=>$.value=b),"max-width":"600",persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"pt-3 pb-0"},{default:t(()=>[d(l(a(r)("projects.mockups.regeneration.title")),1)]),_:1}),e(G,null,{default:t(()=>[i("p",al,l(a(r)("projects.mockups.regeneration.description")),1),e(be,{autofocus:"",modelValue:F.value,"onUpdate:modelValue":U[4]||(U[4]=b=>F.value=b),label:a(r)("projects.mockups.fields.feedback"),hint:a(r)("projects.mockups.placeholders.feedback"),"aria-placeholder":"t('projects.mockups.placeholders.feedback')",rows:"4",counter:""},null,8,["modelValue","label","hint"])]),_:1}),e(fe,null,{default:t(()=>[e(L,{color:"secondary",variant:"tonal",onClick:U[5]||(U[5]=b=>$.value=!1)},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:C,loading:q.value},{default:t(()=>[d(l(a(r)("projects.mockups.actions.regenerate")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(we,{modelValue:I.value.show,"onUpdate:modelValue":U[8]||(U[8]=b=>I.value.show=b),color:I.value.color,timeout:5e3},{actions:t(()=>[e(W,{onClick:U[7]||(U[7]=b=>I.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(I.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-511eef4a"]]),ll={key:0,class:"text-h5"},rl={key:1,class:"text-h5"},sl={key:0},ol={key:1},il={class:"d-flex align-center mb-5"},nl={class:"d-flex align-center"},cl={class:"text-medium-emphasis d-flex align-center"},ul={class:"text-caption me-4"},dl={class:"text-caption"},ml={class:"text-h4 mb-4"},pl={class:"text-body-1 whitespace-pre-wrap"},vl={key:0,class:"text-center pa-6"},fl={class:"text-h6 mb-2"},_l={class:"text-medium-emphasis mb-4"},gl={key:1},hl={class:"d-flex justify-space-between align-center mb-4"},yl={class:"text-h5"},bl={class:"mb-2"},jl={key:0,class:"mt-3"},kl={class:"text-subtitle-2"},xl={class:"pl-4"},wl={key:0},Vl={key:0,class:"text-center mt-4"},ql={key:0,class:"text-center pa-6"},Cl={class:"text-h6 mb-2"},zl={class:"text-medium-emphasis"},Sl={key:1},Ul={class:"d-flex align-center"},Dl={class:"mockup-preview mb-3"},Il={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Ml={key:0,class:"d-flex justify-center align-center h-100"},Pl={class:"text-center"},Bl={class:"text-caption"},$l={key:1,class:"html-preview"},Fl=["innerHTML"],Ll={key:2,class:"d-flex justify-center align-center h-100"},Rl={class:"preview-overlay d-flex justify-center align-center"},Ol={key:0,class:"mb-2"},Al={class:"d-flex align-center justify-space-between"},Tl={class:"d-flex align-center"},Nl={class:"text-caption"},Hl={key:0,class:"text-center pa-6"},Yl={class:"text-h6 mb-2"},Zl={class:"text-medium-emphasis"},Jl={key:1},Kl={class:"text-caption"},El={class:"text-caption text-medium-emphasis"},Gl={class:"d-flex align-center mb-2"},Wl={class:"text-caption"},Ql={class:"text-body-2 whitespace-pre-wrap"},Xl={class:"d-flex justify-end mt-2"},er={key:1,class:"text-center pa-6"},tr={class:"text-h6 mb-2"},ar={class:"text-medium-emphasis"},lr={key:2},rr={class:"d-flex align-center"},sr={class:"d-flex align-center"},or={class:"text-caption text-medium-emphasis ml-2"},ir={class:"comment-text mt-2 whitespace-pre-wrap"},nr=Ve({__name:"RequirementDetailsDialog",props:{modelValue:{type:Boolean,default:!1},requirement:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","view-user-stories"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=Z({get:()=>o.modelValue,set:w=>u("update:modelValue",w)}),c=xt();Ge();const f=S(0),_=S(!1),j=S({...o.requirement}),q=S(""),z=S(!1),$=S({show:!1,text:"",color:"success"}),F=S(null),I=S(!1),P=S(null),N=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],J=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],T=[{title:r("projects.requirements.types.feature"),value:"feature"},{title:r("projects.requirements.types.constraint"),value:"constraint"},{title:r("projects.requirements.types.quality"),value:"quality"},{title:r("projects.requirements.types.interface"),value:"interface"},{title:r("projects.requirements.types.security"),value:"security"},{title:r("projects.requirements.types.performance"),value:"performance"},{title:r("projects.requirements.types.other"),value:"other"}],O=Z(()=>o.requirement.history||[]),A=Z(()=>o.requirement.comments||[]),E=Z(()=>o.requirement.user_stories||[]),C=Z(()=>o.requirement.mockups||[]),M=w=>w?(w=parseInt(w),new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",ee=()=>{_.value&&(j.value={...o.requirement}),_.value=!_.value,f.value="0"},x=()=>{v.value&&c.fetchRequirementById(o.requirement.id).then(({data:w})=>{w&&Object.assign(o.requirement,w)})};qe(()=>{P.value=setInterval(x,5e3)}),Re(()=>{P.value&&clearInterval(P.value)});const U=()=>{u("update",j.value),_.value=!1,v.value=!1},W=()=>{u("delete"),v.value=!1},b=()=>{u("view-user-stories",o.requirement),v.value=!1},B=async()=>{if(q.value.trim()){z.value=!0;try{const{data:w,error:D}=await c.createComment(o.requirement.id,{text:q.value,status:"active"});if(w&&!D){Y(r("projects.requirements.notifications.comment_added")),q.value="";const{data:g}=await c.fetchRequirementById(o.requirement.id);g&&Object.assign(o.requirement,g)}else Y(r("projects.requirements.notifications.comment_add_failed"),"error")}catch(w){Y(r("projects.requirements.notifications.comment_add_failed")+": "+w.message,"error")}finally{z.value=!1}}},Y=(w,D="success")=>{$.value={show:!0,text:w,color:D}};je(()=>o.requirement,w=>{j.value={...w}},{deep:!0});const K=(w,D=150)=>{if(!w||w.length<=D)return w;const g=w.replace(/<[^>]*>/g,"");return g.length<=D?w:g.substring(0,D)+"..."};return(w,D)=>{const g=ye("IconBtn");return n(),h(xe,{modelValue:a(v),"onUpdate:modelValue":D[12]||(D[12]=m=>De(v)?v.value=m:null),"max-width":"900",scrollable:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[_.value?(n(),p("h5",ll,l(a(r)("projects.requirements.actions.edit")),1)):(n(),p("h5",rl,l(a(r)("projects.requirements.actions.view_details")),1)),e(le),e(g,{onClick:D[0]||(D[0]=m=>v.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"pb-0"},{default:t(()=>[e(tt,{modelValue:f.value,"onUpdate:modelValue":D[1]||(D[1]=m=>f.value=m),"slider-color":"primary","align-tabs":"start"},{default:t(()=>[e(pe,{value:"0"},{default:t(()=>[e(V,{size:"18",icon:"tabler-info-circle",start:""}),d(" "+l(a(r)("projects.requirements.tabs.details")),1)]),_:1}),e(pe,{value:"1"},{default:t(()=>[e(V,{size:"18",icon:"tabler-user-check",start:""}),d(" "+l(a(r)("projects.requirements.tabs.user_stories"))+" ",1),a(E).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(E).length),1)]),_:1})):k("",!0)]),_:1}),e(pe,{value:"2"},{default:t(()=>[e(V,{size:"18",icon:"tabler-photo",start:""}),d(" "+l(a(r)("projects.requirements.tabs.mockups"))+" ",1),a(C).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(C).length),1)]),_:1})):k("",!0)]),_:1}),e(pe,{value:"3"},{default:t(()=>[e(V,{size:"18",icon:"tabler-history",start:""}),d(" "+l(a(r)("projects.requirements.tabs.history"))+" ",1),a(O).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(O).length),1)]),_:1})):k("",!0)]),_:1}),e(pe,{value:"4"},{default:t(()=>[e(V,{size:"18",icon:"tabler-messages",start:""}),d(" "+l(a(r)("projects.requirements.tabs.comments"))+" ",1),a(A).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(A).length),1)]),_:1})):k("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ae),e(G,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:t(()=>[e(at,{modelValue:f.value,"onUpdate:modelValue":D[8]||(D[8]=m=>f.value=m),class:"mt-5"},{default:t(()=>[e(ve,{value:"0"},{default:t(()=>[_.value?(n(),p("div",sl,[e(Ie,{onSubmit:Ce(U,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:j.value.title,"onUpdate:modelValue":D[2]||(D[2]=m=>j.value.title=m),label:a(r)("projects.requirements.title"),required:"",rules:[m=>!!m||a(r)("validation.required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:j.value.category,"onUpdate:modelValue":D[3]||(D[3]=m=>j.value.category=m),label:a(r)("projects.requirements.category"),items:N,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:j.value.requirement_type,"onUpdate:modelValue":D[4]||(D[4]=m=>j.value.requirement_type=m),label:a(r)("projects.requirements.type"),items:T,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:j.value.status,"onUpdate:modelValue":D[5]||(D[5]=m=>j.value.status=m),label:a(r)("projects.requirements.status"),items:J,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:j.value.description,"onUpdate:modelValue":D[6]||(D[6]=m=>j.value.description=m),label:a(r)("projects.requirements.description"),required:"",rows:"8",rules:[m=>!!m||a(r)("validation.required")]},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",ol,[i("div",il,[e(H,{color:a(Qe)(s.requirement.category),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(r)(`projects.categories.${s.requirement.category}`)),1)]),_:1},8,["color"]),e(H,{color:a(he)(s.requirement.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${s.requirement.status}`)),1)]),_:1},8,["color"]),e(H,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(" v"+l(s.requirement.version_number),1)]),_:1}),s.requirement.requirement_type?(n(),h(H,{key:0,color:"info",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)(`projects.requirements.types.${s.requirement.requirement_type}`)),1)]),_:1})):k("",!0),e(le)]),i("div",nl,[i("div",cl,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",ul,l(a(r)("projects.details.updated_at"))+": "+l(M(s.requirement.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",dl,l(a(r)("projects.details.created_at"))+": "+l(M(s.requirement.created_at)),1)])]),i("h4",ml,l(s.requirement.title),1),i("div",pl,l(s.requirement.description),1)]))]),_:1}),e(ve,{value:"1"},{default:t(()=>[a(E).length===0?(n(),p("div",vl,[e(V,{icon:"tabler-user-check",size:"64",color:"secondary",class:"mb-3"}),i("h4",fl,l(a(r)("projects.requirements.user_stories.empty.title")),1),i("p",_l,l(a(r)("projects.requirements.user_stories.empty.description")),1),e(L,{color:"primary",onClick:b},{default:t(()=>[d(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})])):(n(),p("div",gl,[i("div",hl,[i("h5",yl,l(a(r)("projects.requirements.user_stories.title")),1),e(L,{color:"primary",variant:"tonal",onClick:b},{default:t(()=>[d(l(a(r)("projects.requirements.actions.view_all_stories")),1)]),_:1})]),(n(!0),p(X,null,ne(a(E).slice(0,3),(m,ce)=>(n(),h(Q,{key:m.id,class:"mb-4",border:""},{default:t(()=>[e(ue,null,{append:t(()=>[e(H,{color:a(he)(m.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${m.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.requirements.user_stories.as_a",{role:m.role})),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>[i("p",bl,[i("strong",null,l(a(r)("projects.requirements.user_stories.i_want_to"))+":",1),d(" "+l(m.action),1)]),i("p",null,[i("strong",null,l(a(r)("projects.requirements.user_stories.so_that"))+":",1),d(" "+l(m.benefit),1)]),m.acceptance_criteria&&m.acceptance_criteria.length>0?(n(),p("div",jl,[i("div",kl,l(a(r)("projects.requirements.user_stories.acceptance_criteria"))+":",1),i("ul",xl,[(n(!0),p(X,null,ne(m.acceptance_criteria.slice(0,2),(y,oe)=>(n(),p("li",{key:oe},l(y),1))),128)),m.acceptance_criteria.length>2?(n(),p("li",wl,l(a(r)("projects.requirements.user_stories.and_more",{count:m.acceptance_criteria.length-2})),1)):k("",!0)])])):k("",!0)]),_:2},1024)]),_:2},1024))),128)),a(E).length>3?(n(),p("div",Vl,[e(L,{color:"primary",variant:"tonal",onClick:b},{default:t(()=>[d(l(a(r)("projects.requirements.actions.view_all_stories_count",{count:a(E).length})),1)]),_:1})])):k("",!0)]))]),_:1}),e(ve,{value:"2"},{default:t(()=>[a(C).length===0?(n(),p("div",ql,[e(V,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-3"}),i("h4",Cl,l(a(r)("projects.requirements.mockups.empty.title")),1),i("p",zl,l(a(r)("projects.requirements.mockups.empty.description")),1)])):(n(),p("div",Sl,[e(se,null,{default:t(()=>[(n(!0),p(X,null,ne(a(C),m=>(n(),h(R,{key:m.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(Q,{class:"mockup-card h-100",onClick:ce=>{F.value=m,I.value=!0},border:"",hover:""},{default:t(()=>[e(ue,null,{append:t(()=>[i("div",Ul,[m.generation_status==="in_progress"||m.generation_status==="pending"||m.needs_regeneration?(n(),h(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):k("",!0),e(H,{color:a(he)(m.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${m.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(m.name),1)]),_:2},1024)]),_:2},1024),e(ae),e(G,null,{default:t(()=>[i("div",Dl,[i("div",Il,[m.generation_status==="in_progress"||m.generation_status==="pending"?(n(),p("div",Ml,[i("div",Pl,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",Bl,l(a(r)("projects.mockups.status.generating")),1)])])):m.html_content?(n(),p("div",$l,[i("div",{innerHTML:K(m.html_content)},null,8,Fl)])):(n(),p("div",Ll,[e(V,{icon:"tabler-file-code",size:"48",color:"secondary"})])),i("div",Rl,[e(L,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:m.generation_status==="in_progress"||m.generation_status==="pending"},{default:t(()=>[d(l(a(r)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),m.needs_regeneration?(n(),p("div",Ol,[e(H,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(r)("projects.mockups.status.regenerating")),1)]),_:1})])):k("",!0),i("div",Al,[i("div",Tl,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Nl,l(M(m.created_at)),1)])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"3"},{default:t(()=>[a(O).length===0?(n(),p("div",Hl,[e(V,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),i("h4",Yl,l(a(r)("projects.requirements.history.empty.title")),1),i("p",Zl,l(a(r)("projects.requirements.history.empty.description")),1)])):(n(),p("div",Jl,[e(jt,{density:"compact",align:"start"},{default:t(()=>[(n(!0),p(X,null,ne(a(O),(m,ce)=>(n(),h(kt,{key:ce,"dot-color":"primary",size:"small"},{opposite:t(()=>[i("div",Kl,l(M(m.changed_at)),1),i("div",El,"v"+l(m.version_number),1)]),default:t(()=>[e(Q,{border:""},{default:t(()=>[e(ue,null,{append:t(()=>[e(H,{color:a(he)(m.status),size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)(`projects.status.${m.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(m.title),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>[i("div",Gl,[e(H,{color:a(Qe)(m.category),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(r)(`projects.categories.${m.category}`)),1)]),_:2},1032,["color"]),i("span",Wl,l(a(r)("projects.requirements.history.changed_by"))+": "+l(m.changed_by?m.changed_by.username:a(r)("projects.requirements.history.unknown")),1)]),i("div",Ql,l(m.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"4"},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:q.value,"onUpdate:modelValue":D[7]||(D[7]=m=>q.value=m),label:a(r)("projects.requirements.comments.add"),rows:"3",counter:"",disabled:z.value},null,8,["modelValue","label","disabled"]),i("div",Xl,[e(L,{color:"primary",size:"small",loading:z.value,disabled:!q.value.trim(),onClick:B},{default:t(()=>[d(l(a(r)("projects.requirements.comments.add_button")),1)]),_:1},8,["loading","disabled"])])]),_:1}),e(R,{cols:"12"},{default:t(()=>[a(A).length?(n(),h(ae,{key:0,class:"mb-4"})):k("",!0),a(A).length===0?(n(),p("div",er,[e(V,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),i("h4",tr,l(a(r)("projects.requirements.comments.empty.title")),1),i("p",ar,l(a(r)("projects.requirements.comments.empty.description")),1)])):(n(),p("div",lr,[(n(!0),p(X,null,ne(a(A),m=>(n(),p("div",{key:m.id,class:"comment-item mb-4"},[e(Q,{border:""},{default:t(()=>[e(G,{class:"py-2"},{default:t(()=>[i("div",rr,[e(Se,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:t(()=>[e(V,{icon:"tabler-user"})]),_:1}),i("div",null,[i("div",sr,[i("strong",null,l(m.user?m.user.username:a(r)("projects.requirements.comments.unknown_user")),1),i("div",or,l(M(m.created_at)),1)])]),e(le),s.isAdmin||s.hasManagerPermission?(n(),h(g,{key:0,size:"small",color:"error",variant:"text",onClick:ce=>(async y=>{z.value=!0;try{const{success:oe,error:ke}=await c.deleteComment(y);if(oe&&!ke){Y(r("projects.requirements.notifications.comment_deleted"));const{data:me}=await c.fetchRequirementById(o.requirement.id);me&&Object.assign(o.requirement,me)}else Y(r("projects.requirements.notifications.comment_delete_failed"),"error")}catch(oe){Y(r("projects.requirements.notifications.comment_delete_failed")+": "+oe.message,"error")}finally{z.value=!1}})(m.id),disabled:z.value},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):k("",!0)]),i("div",ir,l(m.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[_.value?(n(),p(X,{key:0},[e(L,{color:"secondary",variant:"tonal",onClick:ee},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:U},{default:t(()=>[d(l(a(r)("projects.actions.save")),1)]),_:1})],64)):(n(),p(X,{key:1},[s.isAdmin?(n(),h(L,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:W},{default:t(()=>[d(l(a(r)("projects.requirements.actions.delete")),1)]),_:1})):k("",!0),s.hasModeratorPermission&&a(E).length===0?(n(),h(L,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-user-check",class:"ms-2",onClick:b},{default:t(()=>[d(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})):k("",!0),e(le),s.hasModeratorPermission?(n(),h(L,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:ee},{default:t(()=>[d(l(a(r)("projects.requirements.actions.edit")),1)]),_:1})):k("",!0)],64))]),_:1})]),_:1}),e(we,{modelValue:$.value.show,"onUpdate:modelValue":D[10]||(D[10]=m=>$.value.show=m),color:$.value.color,timeout:5e3},{actions:t(()=>[e(g,{onClick:D[9]||(D[9]=m=>$.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l($.value.text)+" ",1)]),_:1},8,["modelValue","color"]),F.value?(n(),h(st,{key:0,modelValue:I.value,"onUpdate:modelValue":D[11]||(D[11]=m=>I.value=m),mockup:F.value,"is-admin":s.isAdmin,"has-manager-permission":s.hasManagerPermission},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):k("",!0)]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-1f023d99"]]),cr={class:"text-h5"},ur={__name:"RequirementCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},requirementData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=Z({get:()=>o.modelValue,set:P=>u("update:modelValue",P)}),c=S({title:o.editMode&&o.requirementData?o.requirementData.title:"",description:o.editMode&&o.requirementData?o.requirementData.description:"",category:o.editMode&&o.requirementData?o.requirementData.category:"functional",status:o.editMode&&o.requirementData?o.requirementData.status:"draft"}),f=[P=>!!P||r("validation.required"),P=>P.length<=255||r("projects.requirements.validation.title_length")],_=[P=>!!P||r("validation.required")],j=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],q=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],z=S(null),$=()=>{c.value={title:"",description:"",category:"functional",status:"draft"},z.value&&z.value.resetValidation()},F=()=>{v.value=!1,$()},I=async()=>{const{valid:P}=await z.value.validate();P&&(u("submit",c.value),v.value=!1,$())};return je(v,P=>{P||$()}),(P,N)=>{const J=ye("IconBtn");return n(),h(xe,{modelValue:a(v),"onUpdate:modelValue":N[4]||(N[4]=T=>De(v)?v.value=T:null),"max-width":"700",persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[i("h5",cr,l(o.editMode?a(r)("projects.requirements.actions.edit"):a(r)("projects.requirements.actions.add")),1),e(le),e(J,{onClick:F},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"px-5 pt-4"},{default:t(()=>[e(Ie,{ref_key:"formRef",ref:z,onSubmit:Ce(I,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.title,"onUpdate:modelValue":N[0]||(N[0]=T=>c.value.title=T),label:a(r)("projects.requirements.title"),rules:f,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.category,"onUpdate:modelValue":N[1]||(N[1]=T=>c.value.category=T),label:a(r)("projects.requirements.category"),items:j,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.status,"onUpdate:modelValue":N[2]||(N[2]=T=>c.value.status=T),label:a(r)("projects.requirements.status"),items:q,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:c.value.description,"onUpdate:modelValue":N[3]||(N[3]=T=>c.value.description=T),label:a(r)("projects.requirements.description"),rules:_,required:"",rows:"6"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[e(L,{variant:"tonal",color:"secondary",onClick:F},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:I},{default:t(()=>[d(l(o.editMode?a(r)("projects.actions.update"):a(r)("projects.actions.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};function Ae(s){return{all:s=s||new Map,on:function(u,o){var r=s.get(u);r?r.push(o):s.set(u,[o])},off:function(u,o){var r=s.get(u);r&&(o?r.splice(r.indexOf(o)>>>0,1):s.set(u,[]))},emit:function(u,o){var r=s.get(u);r&&r.slice().map(function(v){v(o)}),(r=s.get("*"))&&r.slice().map(function(v){v(u,o)})}}}const dr={key:0,class:"mb-4"},mr={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},pr={key:2,class:"text-center pa-4"},vr={class:"text-h6 mb-2"},fr={class:"text-body-1 text-medium-emphasis mb-6"},_r={class:"d-flex align-center"},gr={class:"text-body-2 mb-3"},hr={class:"d-flex align-center justify-space-between mb-2"},yr={class:"d-flex align-center"},br={class:"text-caption text-capitalize"},jr={class:"d-flex align-center"},kr={class:"text-caption"},xr={class:"d-flex align-center"},wr={class:"text-caption"},Vr={key:0,class:"mt-3"},qr={__name:"ProjectRequirementsList",props:{projectId:{type:String,required:!0},requirements:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh","view-user-stories"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=xt(),c=Be(),f=S(""),_=S([]),j=S(["draft","active","completed"]),q=S(null),z=S(!1),$=S(!1),F=S(!1),I=S(!1),P=S({show:!1,text:"",color:"success"}),N=Z(()=>c.is_admin()),J=Z(()=>c.userData.role>=2),T=Z(()=>c.userData.role>=3),O=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],A=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],E=Z(()=>o.requirements.filter(Y=>{const K=!f.value||Y.title.toLowerCase().includes(f.value.toLowerCase())||Y.description.toLowerCase().includes(f.value.toLowerCase()),w=_.value.length===0||_.value.includes(Y.category),D=j.value.includes(Y.status);return K&&w&&D})),C=Ae(),M=()=>{$.value=!0},ee=async Y=>{I.value=!0;try{const{data:K,error:w}=await v.createRequirement({...Y,project:o.projectId});K&&!w?(b("projects.requirements.notifications.created"),u("refresh")):b("projects.requirements.notifications.create_failed","error")}catch{b("projects.requirements.notifications.create_failed","error")}finally{I.value=!1}},x=async Y=>{I.value=!0;try{const{data:K,error:w}=await v.updateRequirement(q.value.id,Y);K&&!w?(b("projects.requirements.notifications.updated"),u("refresh")):b("projects.requirements.notifications.update_failed","error")}catch{b("projects.requirements.notifications.update_failed","error")}finally{I.value=!1}},U=async()=>{if(q.value){I.value=!0,F.value=!1;try{const{success:Y,error:K}=await v.deleteRequirement(q.value.id);Y&&!K?(b("projects.requirements.notifications.deleted"),u("refresh"),z.value=!1):b("projects.requirements.notifications.delete_failed","error")}catch{b("projects.requirements.notifications.delete_failed","error")}finally{I.value=!1}}},W=Y=>{u("view-user-stories",Y)},b=(Y,K="success")=>{P.value={show:!0,text:r(Y),color:K}},B=(Y,K=120)=>!Y||Y.length<=K?Y:Y.substring(0,K)+"...";return qe(()=>{C.on("project-refresh",()=>{v.fetchRequirements(o.projectId,{silent:!0}).then(({data:Y})=>{Y&&u("refresh")})})}),je(z,Y=>{Y?C.on("project-refresh",async()=>{if(q.value){const{data:K}=await v.fetchRequirement(q.value.id);K&&(q.value=K)}}):C.off("project-refresh")}),(Y,K)=>{const w=Oe,D=ye("IconBtn");return n(),h(G,{class:"pa-6"},{default:t(()=>[Y.anyRequirementInProgress?(n(),p("div",dr,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})])):k("",!0),e(se,null,{default:t(()=>[e(R,{cols:"12",md:"4"},{default:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":K[0]||(K[0]=g=>f.value=g),density:"compact",placeholder:a(r)("projects.requirements.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(R,{cols:"12",md:"3"},{default:t(()=>[e(_e,{modelValue:_.value,"onUpdate:modelValue":K[1]||(K[1]=g=>_.value=g),items:O,density:"compact","hide-details":"",label:a(r)("projects.requirements.actions.category"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"3"},{default:t(()=>[e(_e,{modelValue:j.value,"onUpdate:modelValue":K[2]||(K[2]=g=>j.value=g),items:A,density:"compact","hide-details":"",label:a(r)("projects.requirements.actions.status"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[a(T)?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:M,loading:I.value,block:""},{default:t(()=>[d(l(a(r)("projects.requirements.actions.add")),1)]),_:1},8,["loading"])):k("",!0)]),_:1})]),_:1}),e(ae,{class:"my-5"}),s.loading?(n(),p("div",mr,[e(ie,{indeterminate:"",color:"primary"})])):a(E).length===0?(n(),p("div",pr,[e(V,{icon:"tabler-file-search",size:"64",color:"secondary",class:"mb-4"}),i("h4",vr,l(a(r)("projects.requirements.empty.title")),1),i("p",fr,l(f.value||_.value.length>0||j.value.length>0?a(r)("projects.requirements.empty.filtered"):a(r)("projects.requirements.empty.no_requirements")),1),a(T)&&!f.value&&_.value.length===0&&j.value.length===0?(n(),h(L,{key:0,color:"primary",onClick:M,"prepend-icon":"tabler-plus"},{default:t(()=>[d(l(a(r)("projects.requirements.actions.add_requirement")),1)]),_:1})):k("",!0)])):(n(),h(se,{key:3},{default:t(()=>[(n(!0),p(X,null,ne(a(E),g=>(n(),h(R,{key:g.id,cols:"12"},{default:t(()=>[e(Q,{class:"requirement-card",onClick:m=>(async ce=>{const{data:y}=await v.fetchRequirement(ce.id);q.value=y||ce,z.value=!0})(g),border:"",hover:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:a(Qe)(g.category),variant:"tonal",size:"42"},{default:t(()=>[g.category==="functional"?(n(),h(V,{key:0,icon:"tabler-function"})):g.category==="nonfunctional"?(n(),h(V,{key:1,icon:"tabler-chart-bar"})):g.category==="uiux"?(n(),h(V,{key:2,icon:"tabler-palette"})):(n(),h(V,{key:3,icon:"tabler-file-description"}))]),_:2},1032,["color"])]),append:t(()=>[i("div",_r,[g.user_stories&&g.user_stories.some(m=>m.generation_status==="in_progress"||m.generation_status==="pending")||g.mockups&&g.mockups.some(m=>m.generation_status==="in_progress"||m.generation_status==="pending"||m.needs_regeneration)?(n(),h(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):k("",!0),g.user_stories&&g.user_stories.some(m=>m.generation_status==="pending")||g.mockups&&g.mockups.some(m=>m.generation_status==="pending"||m.needs_regeneration)?(n(),h(H,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})):k("",!0),e(H,{color:a(he)(g.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${g.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(g.handle)+" "+l(g.title),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>{return[i("p",gr,l(B(g.description)),1),i("div",hr,[i("div",yr,[e(V,{size:"16",icon:"tabler-tag",class:"me-1"}),i("span",br,l(a(r)(`projects.categories.${g.category}`)),1)]),i("div",jr,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",kr,l((m=g.updated_at,m?(m=parseInt(m),new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"")),1)]),i("div",xr,[e(V,{size:"16",icon:"tabler-history",class:"me-1"}),i("span",wr,"v"+l(g.version_number),1)])]),g.user_stories&&g.user_stories.length>0?(n(),p("div",Vr,[e(L,{size:"small",variant:"tonal",color:"primary","prepend-icon":"tabler-user-check",onClick:Ce(ce=>W(g),["stop"])},{default:t(()=>[d(l(g.user_stories.length)+" "+l(a(r)(g.user_stories.length===1?"projects.requirements.user_stories.single":"projects.requirements.user_stories.multiple")),1)]),_:2},1032,["onClick"])])):k("",!0)];var m}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),q.value?(n(),h(nr,{key:4,modelValue:z.value,"onUpdate:modelValue":K[3]||(K[3]=g=>z.value=g),requirement:q.value,onDelete:K[4]||(K[4]=g=>F.value=!0),onUpdate:x,onViewUserStories:W,"is-admin":a(N),"has-manager-permission":a(J),"has-moderator-permission":a(T)},null,8,["modelValue","requirement","is-admin","has-manager-permission","has-moderator-permission"])):k("",!0),e(ur,{modelValue:$.value,"onUpdate:modelValue":K[5]||(K[5]=g=>$.value=g),onSubmit:ee},null,8,["modelValue"]),e(w,{isDialogVisible:F.value,"onUpdate:isDialogVisible":K[6]||(K[6]=g=>F.value=g),confirmationMsg:a(r)("projects.requirements.delete_confirm.message"),onConfirm:U},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:P.value.show,"onUpdate:modelValue":K[8]||(K[8]=g=>P.value.show=g),color:P.value.color,timeout:5e3},{actions:t(()=>[e(D,{onClick:K[7]||(K[7]=g=>P.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(P.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Cr=Ve(qr,[["__scopeId","data-v-da84999d"]]),zr={key:0,class:"mb-4"},Sr={class:"d-flex align-center"},Ur={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},Dr={key:2,class:"text-center pa-4"},Ir={class:"text-h6 mb-2"},Mr={class:"text-body-1 text-medium-emphasis mb-6"},Pr={class:"d-flex align-center"},Br={class:"mockup-preview mb-3"},$r={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Fr={key:0,class:"d-flex justify-center align-center h-100"},Lr={class:"text-center"},Rr={class:"text-caption"},Or={key:1,class:"html-preview"},Ar=["innerHTML"],Tr={key:2,class:"d-flex justify-center align-center h-100"},Nr={class:"preview-overlay d-flex justify-center align-center"},Hr={key:0,class:"mb-2"},Yr={key:1,class:"mb-2"},Zr={class:"text-caption font-weight-medium"},Jr={key:2,class:"mb-2"},Kr={class:"text-caption font-weight-medium"},Er={class:"d-flex align-center justify-space-between"},Gr={class:"d-flex align-center"},Wr={class:"text-caption"},Qr={__name:"ProjectMockupsList",props:{projectId:{type:String,required:!0},mockups:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,r=Ge(),v=Be(),{t:c}=ge(),f=S(""),_=S(null),j=S(!1),q=S(!1),z=S(!1);S(null);const $=S({show:!1,text:"",color:"success"}),F=Z(()=>v.is_admin()),I=Z(()=>v.userData.role>=2);Z(()=>v.userData.role>=3);const P=Z(()=>o.mockups.filter(C=>C.needs_regeneration||C.generation_status==="in_progress"||C.generation_status==="pending").length),N=Z(()=>o.mockups.filter(C=>!f.value||C.name.toLowerCase().includes(f.value.toLowerCase())||C.requirement&&C.requirement.toLowerCase().includes(f.value.toLowerCase()))),J=Ae(),T=async()=>{if(_.value){z.value=!0,q.value=!1;try{const{success:C,error:M}=await r.deleteMockupById(_.value.id);C&&!M?(O(c("projects.mockups.notifications.deleted")),u("refresh"),j.value=!1):O(c("projects.mockups.notifications.delete_failed"),"error")}catch(C){O(c("projects.mockups.notifications.delete_failed")+": "+C.message,"error")}finally{z.value=!1}}},O=(C,M="success")=>{$.value={show:!0,text:C,color:M}},A=(C,M=150)=>{if(!C||C.length<=M)return C;const ee=C.replace(/<[^>]*>/g,"");return ee.length<=M?C:ee.substring(0,M)+"..."},E=Z(()=>o.mockups.some(C=>C.generation_status==="in_progress"||C.generation_status==="pending"||C.needs_regeneration));return qe(()=>{J.on("project-refresh",()=>{r.fetchProjectMockups(o.projectId).then(({data:C})=>{C&&u("refresh")})})}),je(j,C=>{C?J.on("project-refresh",async()=>{if(_.value){const{data:M}=await r.fetchMockupById(_.value.id);M&&(_.value=M)}}):J.off("project-refresh")}),(C,M)=>{const ee=Oe,x=ye("IconBtn");return n(),h(G,{class:"pa-6"},{default:t(()=>[a(E)?(n(),p("div",zr,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(c)("projects.mockups.status.generating")),1)]),_:1})])):k("",!0),e(se,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":M[0]||(M[0]=U=>f.value=U),density:"compact",placeholder:a(c)("projects.mockups.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(R,{cols:"12",md:"6",class:"d-flex align-center"},{default:t(()=>[a(P)>0?(n(),h(Ue,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-0 flex-grow-1 me-2"},{default:t(()=>[i("div",Sr,[e(ie,{indeterminate:"",color:"info",size:"16",width:"2",class:"me-2"}),i("span",null,l(a(P))+" "+l(a(c)("projects.mockups.status.pending_count")),1)])]),_:1})):k("",!0)]),_:1})]),_:1}),e(ae,{class:"my-5"}),s.loading?(n(),p("div",Ur,[e(ie,{indeterminate:"",color:"primary"})])):a(N).length===0?(n(),p("div",Dr,[e(V,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-4"}),i("h4",Ir,l(a(c)("projects.mockups.empty.title")),1),i("p",Mr,l(f.value?a(c)("projects.mockups.empty.filtered"):a(c)("projects.mockups.empty.description")),1)])):(n(),h(se,{key:3},{default:t(()=>[(n(!0),p(X,null,ne(a(N),U=>(n(),h(R,{key:U.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(Q,{class:"mockup-card h-100",onClick:W=>(async b=>{const{data:B}=await r.fetchMockupById(b.id);_.value=B||b,j.value=!0})(U),border:"",hover:""},{default:t(()=>[e(ue,null,{append:t(()=>[i("div",Pr,[U.generation_status==="in_progress"||U.generation_status==="pending"||U.needs_regeneration?(n(),h(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):k("",!0),U.generation_status==="pending"||U.needs_regeneration?(n(),h(H,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.mockups.status.generating")),1)]),_:1})):k("",!0),e(H,{color:a(he)(U.status),size:"small",label:""},{default:t(()=>[d(l(a(c)(`projects.status.${U.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(U.name),1)]),_:2},1024)]),_:2},1024),e(ae),e(G,null,{default:t(()=>{return[i("div",Br,[i("div",$r,[U.generation_status==="in_progress"||U.generation_status==="pending"?(n(),p("div",Fr,[i("div",Lr,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",Rr,l(a(c)("projects.mockups.status.generating")),1)])])):U.html_content?(n(),p("div",Or,[i("div",{innerHTML:A(U.html_content)},null,8,Ar)])):(n(),p("div",Tr,[e(V,{icon:"tabler-file-code",size:"48",color:"secondary"})])),i("div",Nr,[e(L,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:U.generation_status==="in_progress"||U.generation_status==="pending"},{default:t(()=>[d(l(a(c)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),U.needs_regeneration?(n(),p("div",Hr,[e(H,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.mockups.status.regenerating")),1)]),_:1})])):k("",!0),U.requirement?(n(),p("div",Yr,[i("span",Zr,l(a(c)("projects.details.requirement"))+": ",1),e(H,{size:"x-small",color:"primary",class:"ms-1"},{default:t(()=>[d(l(U.requirement_name),1)]),_:2},1024)])):k("",!0),U.user_story?(n(),p("div",Jr,[i("span",Kr,l(a(c)("projects.details.user_story"))+": ",1),e(H,{size:"x-small",color:"primary",class:"ms-1"},{default:t(()=>[d(l(U.user_story_name),1)]),_:2},1024)])):k("",!0),i("div",Er,[i("div",Gr,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Wr,l((W=U.created_at,W?new Date(parseInt(W)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1)])])];var W}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),_.value?(n(),h(st,{key:4,modelValue:j.value,"onUpdate:modelValue":M[1]||(M[1]=U=>j.value=U),mockup:_.value,onDelete:M[2]||(M[2]=U=>q.value=!0),"is-admin":a(F),"has-manager-permission":a(I)},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):k("",!0),e(ee,{isDialogVisible:q.value,"onUpdate:isDialogVisible":M[3]||(M[3]=U=>q.value=U),confirmationMsg:a(c)("projects.mockups.delete_confirm.message"),onConfirm:T},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:$.value.show,"onUpdate:modelValue":M[5]||(M[5]=U=>$.value.show=U),color:$.value.color,timeout:5e3},{actions:t(()=>[e(x,{onClick:M[4]||(M[4]=U=>$.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l($.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Xr=Ve(Qr,[["__scopeId","data-v-0e782771"]]),wt=Le({id:"DevelopmentPlanStore",state:()=>({plans:[],currentPlan:null,loading:!1,error:null}),actions:{async fetchDevelopmentPlans(s=null){this.loading=!0;try{let u="/service/development-plans/";s&&(u+=`?project=${s}`);const o=await te.get(u);return o.status===200?(this.plans=o.data,{data:o.data,error:null}):{data:[],error:o.data}}catch(u){return this.error=u.message||"Failed to fetch development plans",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDevelopmentPlanById(s){this.loading=!0;try{const u=await te.get(`/service/development-plans/${s}/`);return u.status===200?(this.currentPlan=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createDevelopmentPlan(s){this.loading=!0;try{const u=await te.post("/service/development-plans/",{project:s,status:"draft"});return u.status===201?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create development plan",{data:null,error:this.error}}finally{this.loading=!1}},async updateDevelopmentPlan(s,u){this.loading=!0;try{const o=await te.put(`/service/development-plans/${s}/`,u);return o.status===200?(this.currentPlan&&this.currentPlan.id===s&&(this.currentPlan=o.data),{data:o.data,error:null}):{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createPlanVersion(s,u){this.loading=!0;try{const o=await te.post(`/service/development-plans/${s}/new_version/`,u);return o.status===201?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to create plan version",{data:null,error:this.error}}finally{this.loading=!1}},async fetchPlanVersionById(s){this.loading=!0;try{const u=await te.get(`/service/development-plan-versions/${s}/`);return u.status===200?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch plan version",{data:null,error:this.error}}finally{this.loading=!1}},async updatePlanVersion(s,u){this.loading=!0;try{const o=await te.put(`/service/development-plan-versions/${s}/`,u);return o.status===200?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update plan version",{data:null,error:this.error}}finally{this.loading=!1}},async setCurrentPlanVersion(s,u){this.loading=!0;try{const o=await this.fetchDevelopmentPlanById(s);if(!o.data)return{data:null,error:"Plan not found"};const r=await this.fetchPlanVersionById(u);return r.data?await this.updateDevelopmentPlan(s,{current_version_number:r.data.version_number,status:o.data.status}):{data:null,error:"Version not found"}}catch(o){return this.error=o.message||"Failed to set current plan version",{data:null,error:this.error}}finally{this.loading=!1}}}}),es={key:0,class:"text-h5"},ts={key:1,class:"text-h5"},as={key:0},ls={class:"text-subtitle-1 font-weight-bold mb-2"},rs={key:1},ss={class:"d-flex flex-wrap justify-space-between mb-4"},os={class:"d-flex align-center"},is={class:"d-flex align-center"},ns={class:"text-caption"},cs={key:0,class:"text-caption ms-3"},us={class:"text-h4 font-weight-bold"},ds={class:"text-caption text-medium-emphasis text-right"},ms={class:"text-right"},ps={class:"text-right"},vs={class:"text-right"},fs={class:"text-right"},_s={key:0},gs={colspan:"3",class:"text-center"},hs={class:"text-body-1 whitespace-pre-wrap"},ys=Ve({__name:"PlanVersionDialog",props:{modelValue:{type:Boolean,default:!1},version:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},planId:{type:String,default:null}},emits:["update:modelValue","refresh"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=Z({get:()=>o.modelValue,set:O=>u("update:modelValue",O)}),c=wt(),f=S(!1),_=S({...o.version}),j=S(!1),q=S({show:!1,text:"",color:"success"}),z=S(null),$=O=>O||O===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(O):"-",F=()=>{f.value&&(_.value={...o.version}),f.value=!f.value},I=()=>{v.value&&c.fetchPlanVersionById(o.version.id).then(({data:O})=>{O&&Object.assign(o.version,O)})};qe(()=>{z.value=setInterval(I,5e3)}),Re(()=>{z.value&&clearInterval(z.value)});const P=async()=>{j.value=!0;try{const{data:O,error:A}=await c.updatePlanVersion(o.version.id,_.value);O&&!A?(T(r("projects.development_plan.notifications.version_updated")),Object.assign(o.version,O),f.value=!1,v.value=!1,u("refresh")):T(r("projects.development_plan.notifications.version_update_failed"),"error")}catch(O){T(r("projects.development_plan.notifications.version_update_failed")+": "+O.message,"error")}finally{j.value=!1}},N=async()=>{if(o.planId){j.value=!0;try{const{data:O,error:A}=await c.setCurrentPlanVersion(o.planId,o.version.id);O&&!A?(T(r("projects.development_plan.notifications.set_current_success")),v.value=!1,u("refresh")):T(r("projects.development_plan.notifications.set_current_failed"),"error")}catch(O){T(r("projects.development_plan.notifications.set_current_failed")+": "+O.message,"error")}finally{j.value=!1}}},J=O=>{if(!O)return[];try{return typeof O=="string"?JSON.parse(O):O}catch(A){return console.error("Error parsing roles and hours:",A),[]}},T=(O,A="success")=>{q.value={show:!0,text:O,color:A}};return je(()=>o.version,O=>{_.value={...O}},{deep:!0}),(O,A)=>{const E=ye("IconBtn");return n(),h(xe,{modelValue:a(v),"onUpdate:modelValue":A[7]||(A[7]=C=>De(v)?v.value=C:null),"max-width":"900",scrollable:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[f.value?(n(),p("h5",es,l(a(r)("projects.development_plan.actions.edit")),1)):(n(),p("h5",ts,[d(l(a(r)("projects.development_plan.version.version"))+" "+l(s.version.version_number)+" ",1),s.isCurrent?(n(),h(H,{key:0,color:"primary",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)("projects.development_plan.version.current")),1)]),_:1})):k("",!0)])),e(le),e(E,{onClick:A[0]||(A[0]=C=>v.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(ae),e(G,{class:"pa-6"},{default:t(()=>[f.value?(n(),p("div",as,[e(Ie,{onSubmit:Ce(P,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12",md:"4"},{default:t(()=>[e(de,{modelValue:_.value.estimated_cost,"onUpdate:modelValue":A[1]||(A[1]=C=>_.value.estimated_cost=C),modelModifiers:{number:!0},label:a(r)("projects.development_plan.estimated_cost"),type:"number",required:"",rules:[C=>!!C||a(r)("projects.development_plan.validation.estimated_cost_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:_.value.status,"onUpdate:modelValue":A[2]||(A[2]=C=>_.value.status=C),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:_.value.notes,"onUpdate:modelValue":A[3]||(A[3]=C=>_.value.notes=C),label:a(r)("projects.development_plan.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[i("p",ls,l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1),e(be,{modelValue:_.value.roles_and_hours,"onUpdate:modelValue":A[4]||(A[4]=C=>_.value.roles_and_hours=C),label:a(r)("projects.development_plan.roles_hours"),rows:"8",monospace:"",hint:a(r)("projects.development_plan.roles_hours_hint"),"persistent-hint":""},null,8,["modelValue","label","hint"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",rs,[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>{return[i("div",ss,[i("div",os,[e(H,{color:a(he)(s.version.status),size:"small",label:""},{default:t(()=>[d(l(It(s.version.status)),1)]),_:1},8,["color"])]),i("div",is,[i("span",ns,l(a(r)("projects.development_plan.version.created"))+": "+l((C=s.version.created_at,C?new Date(parseInt(C)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1),s.version.created_by?(n(),p("span",cs,l(a(r)("projects.development_plan.version.created_by"))+": "+l(s.version.created_by.username),1)):k("",!0)]),i("div",null,[i("h4",us,l($(s.version.estimated_cost)),1),i("div",ds,l(a(r)("projects.development_plan.version.estimated_total_cost")),1)])])];var C}),_:1}),e(R,{cols:"12"},{default:t(()=>[e(Q,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1)]),_:1}),e(G,null,{default:t(()=>[e(Ze,null,{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(r)("projects.development_plan.version.role")),1),i("th",ms,l(a(r)("projects.development_plan.version.hours")),1),i("th",ps,l(a(r)("projects.development_plan.version.cost")),1)])]),i("tbody",null,[(n(!0),p(X,null,ne(J(s.version.roles_and_hours),(C,M)=>(n(),p("tr",{key:M},[i("td",null,l(C.role),1),i("td",vs,l(C.hours),1),i("td",fs,l($(C.cost)),1)]))),128)),J(s.version.roles_and_hours).length===0?(n(),p("tr",_s,[i("td",gs,l(a(r)("projects.development_plan.version.no_roles")),1)])):k("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),s.version.notes?(n(),h(R,{key:0,cols:"12"},{default:t(()=>[e(Q,{variant:"outlined"},{default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.development_plan.notes")),1)]),_:1}),e(G,null,{default:t(()=>[i("div",hs,l(s.version.notes),1)]),_:1})]),_:1})]),_:1})):k("",!0)]),_:1})]))]),_:1}),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[f.value?(n(),p(X,{key:0},[e(L,{color:"secondary",variant:"tonal",onClick:F,disabled:j.value},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(le),e(L,{color:"primary",onClick:P,loading:j.value},{default:t(()=>[d(l(a(r)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),p(X,{key:1},[!s.isCurrent&&s.hasManagerPermission?(n(),h(L,{key:0,color:"primary",variant:"tonal",onClick:N,loading:j.value,"prepend-icon":"tabler-check"},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.set_current")),1)]),_:1},8,["loading"])):k("",!0),e(le),s.hasManagerPermission?(n(),h(L,{key:1,color:"primary","prepend-icon":"tabler-edit",onClick:F},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.edit")),1)]),_:1})):k("",!0)],64))]),_:1})]),_:1}),e(we,{modelValue:q.value.show,"onUpdate:modelValue":A[6]||(A[6]=C=>q.value.show=C),color:q.value.color,timeout:5e3},{actions:t(()=>[e(E,{onClick:A[5]||(A[5]=C=>q.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(q.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-20fb9f39"]]),bs={class:"text-h5"},js={class:"text-subtitle-1 mb-4"},ks={__name:"PlanVersionCreateDialog",props:{modelValue:{type:Boolean,default:!1},planId:{type:String,required:!0},currentVersionNumber:{type:Number,default:0}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=Z({get:()=>o.modelValue,set:F=>u("update:modelValue",F)}),c=S({roles_and_hours:'[{"role": "Project Manager", "hours": 20, "cost": 2000}, {"role": "Developer", "hours": 80, "cost": 8000}]',estimated_cost:1e4,notes:"",status:"draft"}),f=[F=>!!F||r("projects.development_plan.validation.estimated_cost_required"),F=>!isNaN(parseFloat(F))||r("projects.development_plan.validation.estimated_cost_number")],_=[F=>{try{return JSON.parse(F),!0}catch{return r("projects.development_plan.validation.roles_hours_json")}}],j=S(null),q=()=>{c.value={roles_and_hours:'[{"role": "Project Manager", "hours": 20, "cost": 2000}, {"role": "Developer", "hours": 80, "cost": 8000}]',estimated_cost:1e4,notes:"",status:"draft"},j.value&&j.value.resetValidation()},z=()=>{v.value=!1,q()},$=async()=>{const{valid:F}=await j.value.validate();if(F){const I={...c.value};I.estimated_cost=parseFloat(I.estimated_cost),u("submit",I),v.value=!1,q()}};return je(v,F=>{F||q()}),(F,I)=>{const P=ye("IconBtn");return n(),h(xe,{modelValue:a(v),"onUpdate:modelValue":I[4]||(I[4]=N=>De(v)?v.value=N:null),"max-width":"700",persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[i("h5",bs,l(a(r)("projects.development_plan.actions.new_version")),1),e(le),e(P,{onClick:z},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"px-5 pt-4"},{default:t(()=>[i("p",js,l(a(r)("projects.development_plan.creating_version",{version:s.currentVersionNumber+1})),1),e(Ie,{ref_key:"formRef",ref:j,onSubmit:Ce($,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(de,{modelValue:c.value.estimated_cost,"onUpdate:modelValue":I[0]||(I[0]=N=>c.value.estimated_cost=N),modelModifiers:{number:!0},label:a(r)("projects.development_plan.estimated_cost"),type:"number",rules:f,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.status,"onUpdate:modelValue":I[1]||(I[1]=N=>c.value.status=N),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:c.value.roles_and_hours,"onUpdate:modelValue":I[2]||(I[2]=N=>c.value.roles_and_hours=N),label:a(r)("projects.development_plan.roles_hours"),rules:_,rows:"6",monospace:"",hint:a(r)("projects.development_plan.roles_hours_hint"),"persistent-hint":""},null,8,["modelValue","label","hint"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:c.value.notes,"onUpdate:modelValue":I[3]||(I[3]=N=>c.value.notes=N),label:a(r)("projects.development_plan.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[e(L,{variant:"tonal",color:"secondary",onClick:z},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:$},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.create_version")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},xs={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},ws={key:1,class:"text-center pa-6"},Vs={class:"text-h6 mb-2"},qs={class:"text-body-1 text-medium-emphasis mb-6"},Cs={key:2},zs={class:"d-flex flex-column"},Ss={class:"text-h6 mb-2"},Us={class:"text-h4 font-weight-bold"},Ds={class:"text-caption text-medium-emphasis"},Is={class:"text-h6 mb-3"},Ms={class:"text-right"},Ps={class:"text-right"},Bs={class:"text-right"},$s={class:"text-right"},Fs={class:"d-flex align-center justify-space-between mb-4"},Ls={class:"text-h5"},Rs={class:"text-right"},Os={class:"text-right"},As=["onClick"],Ts={class:"d-flex align-center"},Ns={class:"font-weight-medium"},Hs={class:"text-right"},Ys={class:"text-right"},Zs={key:1,class:"text-center pa-4"},Js={class:"text-medium-emphasis"},Ks={key:2,class:"text-center pa-4"},Es={class:"text-medium-emphasis"},Gs={__name:"ProjectDevelopmentPlan",props:{projectId:{type:String,required:!0},developmentPlan:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=wt(),c=Be(),f=S(null),_=S(!1),j=S(!1),q=S(!1),z=S({show:!1,text:"",color:"success"}),$=Z(()=>c.is_admin()),F=Z(()=>c.userData.role>=2),I=Z(()=>o.developmentPlan&&o.developmentPlan.id),P=Z(()=>I.value&&o.developmentPlan.versions?[...o.developmentPlan.versions].sort((x,U)=>U.version_number-x.version_number):[]),N=Z(()=>I.value?P.value.find(x=>x.version_number===o.developmentPlan.current_version_number):null),J=x=>x?new Date(parseInt(x)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",T=x=>x||x===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(x):"-",O=x=>{f.value=x,_.value=!0},A=()=>{j.value=!0},E=async x=>{q.value=!0;try{const{data:U,error:W}=await v.createPlanVersion(o.developmentPlan.id,x);U&&!W?(M(r("projects.development_plan.notifications.version_created")),u("refresh")):M(r("projects.development_plan.notifications.version_create_failed"),"error")}catch(U){M(r("projects.development_plan.notifications.version_create_failed")+": "+U.message,"error")}finally{q.value=!1,j.value=!1}},C=async()=>{q.value=!0;try{const{data:x,error:U}=await v.createDevelopmentPlan(o.projectId);x&&!U?(M(r("projects.development_plan.notifications.created")),u("refresh")):M(r("projects.development_plan.notifications.create_failed"),"error")}catch(x){M(r("projects.development_plan.notifications.create_failed")+": "+x.message,"error")}finally{q.value=!1}},M=(x,U="success")=>{z.value={show:!0,text:x,color:U}},ee=x=>{if(!x)return[];try{return typeof x=="string"?JSON.parse(x):x}catch(U){return console.error("Error parsing roles and hours:",U),[]}};return(x,U)=>{const W=ye("IconBtn");return n(),h(G,{class:"pa-6"},{default:t(()=>[s.loading?(n(),p("div",xs,[e(ie,{indeterminate:"",color:"primary"})])):a(I)?(n(),p("div",Cs,[e(se,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(Q,{border:"",class:"mb-4"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(V,{icon:"tabler-calendar-stats"})]),_:1})]),append:t(()=>[e(H,{color:"primary",size:"small",label:"",class:"me-2"},{default:t(()=>[d(" v"+l(s.developmentPlan.current_version_number),1)]),_:1}),e(H,{color:s.developmentPlan.status==="active"?"success":"warning",size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${s.developmentPlan.status}`)),1)]),_:1},8,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.development_plan.current_plan")),1)]),_:1})]),_:1}),e(ae),a(N)?(n(),h(G,{key:0},{default:t(()=>[e(se,null,{default:t(()=>[e(R,{cols:"12",md:"4"},{default:t(()=>[i("div",zs,[i("div",Ss,l(a(r)("projects.development_plan.estimated_cost")),1),i("div",Us,l(T(a(N).estimated_cost)),1),i("div",Ds,l(a(r)("projects.development_plan.version.created"))+": "+l(J(a(N).created_at)),1)])]),_:1}),e(R,{cols:"12",md:"8"},{default:t(()=>[i("div",Is,l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1),e(Ze,{density:"compact"},{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(r)("projects.development_plan.version.role")),1),i("th",Ms,l(a(r)("projects.development_plan.version.hours")),1),i("th",Ps,l(a(r)("projects.development_plan.version.cost")),1)])]),i("tbody",null,[(n(!0),p(X,null,ne(ee(a(N).roles_and_hours),(b,B)=>(n(),p("tr",{key:B},[i("td",null,l(b.role),1),i("td",Bs,l(b.hours),1),i("td",$s,l(T(b.cost)),1)]))),128))])]),_:1}),e(L,{color:"primary",variant:"tonal",class:"mt-4",size:"small",onClick:U[0]||(U[0]=b=>O(a(N)))},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.view_details")),1)]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[i("div",Fs,[i("h5",Ls,l(a(r)("projects.development_plan.version_history")),1),a(F)?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:A,disabled:q.value},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.new_version")),1)]),_:1},8,["disabled"])):k("",!0)]),a(P).length>1?(n(),h(Ze,{key:0},{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(r)("projects.development_plan.version.version")),1),i("th",null,l(a(r)("projects.development_plan.version.created")),1),i("th",null,l(a(r)("projects.details.status")),1),i("th",Rs,l(a(r)("projects.development_plan.estimated_cost")),1),i("th",Os,l(a(r)("projects.actions.title")),1)])]),i("tbody",null,[(n(!0),p(X,null,ne(a(P),b=>(n(),p("tr",{key:b.id,class:et({"bg-primary-lighten-5":b.version_number===s.developmentPlan.current_version_number}),style:{cursor:"pointer"},onClick:B=>O(b)},[i("td",null,[i("div",Ts,[i("span",Ns,"v"+l(b.version_number),1),b.version_number===s.developmentPlan.current_version_number?(n(),h(H,{key:0,color:"primary",size:"x-small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)("projects.development_plan.version.current")),1)]),_:1})):k("",!0)])]),i("td",null,l(J(b.created_at)),1),i("td",null,[e(H,{color:b.status==="active"?"success":"warning",size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${b.status}`)),1)]),_:2},1032,["color"])]),i("td",Hs,l(T(b.estimated_cost)),1),i("td",Ys,[e(L,{icon:"",variant:"text",size:"small",color:"primary",onClick:Ce(B=>O(b),["stop"])},{default:t(()=>[e(V,{icon:"tabler-eye"})]),_:2},1032,["onClick"])])],10,As))),128))])]),_:1})):a(P).length===1?(n(),p("div",Zs,[i("p",Js,l(a(r)("projects.development_plan.version.only_one_version")),1)])):(n(),p("div",Ks,[i("p",Es,l(a(r)("projects.development_plan.version.no_versions")),1)]))]),_:1})]),_:1})])):(n(),p("div",ws,[e(V,{icon:"tabler-calendar-time",size:"64",color:"secondary",class:"mb-4"}),i("h4",Vs,l(a(r)("projects.development_plan.empty.title")),1),i("p",qs,l(a(r)("projects.development_plan.empty.description")),1),a(F)?(n(),h(L,{key:0,color:"primary",onClick:C,loading:q.value},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.create_plan")),1)]),_:1},8,["loading"])):k("",!0)])),f.value?(n(),h(ys,{key:3,modelValue:_.value,"onUpdate:modelValue":U[1]||(U[1]=b=>_.value=b),version:f.value,"is-current":f.value&&s.developmentPlan&&f.value.version_number===s.developmentPlan.current_version_number,"is-admin":a($),"has-manager-permission":a(F),"plan-id":s.developmentPlan?s.developmentPlan.id:null,onRefresh:U[2]||(U[2]=b=>u("refresh"))},null,8,["modelValue","version","is-current","is-admin","has-manager-permission","plan-id"])):k("",!0),e(ks,{modelValue:j.value,"onUpdate:modelValue":U[3]||(U[3]=b=>j.value=b),"plan-id":s.developmentPlan?s.developmentPlan.id:null,"current-version-number":s.developmentPlan?s.developmentPlan.current_version_number:0,onSubmit:E},null,8,["modelValue","plan-id","current-version-number"]),e(we,{modelValue:z.value.show,"onUpdate:modelValue":U[5]||(U[5]=b=>z.value.show=b),color:z.value.color,timeout:5e3},{actions:t(()=>[e(W,{onClick:U[4]||(U[4]=b=>z.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(z.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Ws={key:0,class:"text-h5"},Qs={key:1,class:"text-h5"},Xs={key:0},eo={class:"align-center justify-space-between mb-3"},to={class:"text-subtitle-1 font-weight-medium"},ao={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},lo={key:1},ro={class:"d-flex align-center mb-5"},so={class:"d-flex align-center"},oo={class:"text-medium-emphasis d-flex align-center"},io={class:"text-caption me-4"},no={class:"text-caption"},co={class:"user-story-format mb-6"},uo={class:"text-h5 mb-4"},mo={class:"text-primary"},po={class:"text-h5 mb-4"},vo={class:"text-primary"},fo={class:"text-h5 mb-4"},_o={class:"text-primary"},go={key:0},ho={class:"text-h6 mb-3"},yo={key:1,class:"text-medium-emphasis text-center pa-4"},bo={key:2,class:"mt-6"},jo={key:0,class:"text-center pa-6"},ko={class:"text-h6 mb-2"},xo={class:"text-medium-emphasis"},wo={key:1},Vo={class:"d-flex align-center"},qo={class:"mockup-preview mb-3"},Co={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},zo={key:0,class:"d-flex justify-center align-center h-100"},So={class:"text-center"},Uo={class:"text-caption"},Do={key:1,class:"html-preview"},Io=["innerHTML"],Mo={key:2,class:"d-flex justify-center align-center h-100"},Po={class:"preview-overlay d-flex justify-center align-center"},Bo={key:0,class:"mb-2"},$o={class:"d-flex align-center justify-space-between"},Fo={class:"d-flex align-center"},Lo={class:"text-caption"},Ro={key:0,class:"text-center pa-6"},Oo={class:"text-h6 mb-2"},Ao={class:"text-medium-emphasis"},To={key:1},No={class:"text-caption"},Ho={class:"text-caption text-medium-emphasis"},Yo={class:"text-primary"},Zo={class:"mb-2"},Jo={class:"text-primary"},Ko={class:"mb-4"},Eo={class:"text-primary"},Go={key:0},Wo={class:"text-subtitle-2 font-weight-medium mb-2"},Qo={class:"ms-3"},Xo={class:"text-caption mt-3"},ei={class:"d-flex justify-end mt-2"},ti={key:1,class:"text-center pa-6"},ai={class:"text-h6 mb-2"},li={class:"text-medium-emphasis"},ri={key:2},si={class:"d-flex align-center"},oi={class:"d-flex align-center"},ii={class:"text-caption text-medium-emphasis ml-2"},ni={class:"comment-text mt-2 whitespace-pre-wrap"},ci={class:"text-body-1 mb-3"},ui=Ve({__name:"UserStoryDetailsDialog",props:{modelValue:{type:Boolean,default:!1},userStory:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","regenerate"],setup(s,{emit:u}){const o=s,r=Z({get:()=>o.modelValue,set:g=>u("update:modelValue",g)}),v=lt();Ge();const{t:c}=ge(),f=S(0),_=S(!1),j=S({...o.userStory}),q=S(""),z=S(""),$=S(""),F=S(!1),I=S(!1),P=S(null),N=S(!1),J=S({show:!1,text:"",color:"success"}),T=S(null),O=[{title:c("projects.status.draft"),value:"draft"},{title:c("projects.status.active"),value:"active"},{title:c("projects.status.archived"),value:"archived"},{title:c("projects.status.completed"),value:"completed"}],A=Z(()=>o.userStory.history||[]),E=Z(()=>o.userStory.comments||[]),C=Z(()=>o.userStory.mockups||[]),M=g=>g?(g=parseInt(g),new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",ee=()=>{_.value&&(j.value={...o.userStory},q.value=""),_.value=!_.value,f.value="0"},x=()=>{q.value.trim()&&(j.value.acceptance_criteria||(j.value.acceptance_criteria=[]),j.value.acceptance_criteria.push(q.value.trim()),q.value="")},U=()=>{r.value&&v.fetchUserStoryById(o.userStory.id).then(({data:g})=>{g&&Object.assign(o.userStory,g)})};qe(()=>{T.value=setInterval(U,5e3)}),Re(()=>{T.value&&clearInterval(T.value)});const W=()=>{u("update",j.value),_.value=!1,r.value=!1},b=()=>{u("delete"),r.value=!1},B=()=>{$.value="",F.value=!0},Y=()=>{u("regenerate",$.value),F.value=!1,r.value=!1},K=async()=>{if(z.value.trim()){I.value=!0;try{const{data:g,error:m}=await v.createComment(o.userStory.id,{text:z.value,status:"active"});if(g&&!m){w("Comment added successfully"),z.value="";const{data:ce}=await v.fetchUserStoryById(o.userStory.id);ce&&Object.assign(o.userStory,ce)}else w("Failed to add comment","error")}catch(g){w("Failed to add comment: "+g.message,"error")}finally{I.value=!1}}},w=(g,m="success")=>{J.value={show:!0,text:g,color:m}},D=(g,m=150)=>{if(!g||g.length<=m)return g;const ce=g.replace(/<[^>]*>/g,"");return ce.length<=m?g:ce.substring(0,m)+"..."};return je(()=>o.userStory,g=>{j.value={...g}},{deep:!0}),(g,m)=>{const ce=ye("IconBtn");return n(),h(xe,{modelValue:a(r),"onUpdate:modelValue":m[15]||(m[15]=y=>De(r)?r.value=y:null),"max-width":"900",scrollable:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[_.value?(n(),p("h5",Ws,l(a(c)("projects.user_stories.title.edit")),1)):(n(),p("h5",Qs,l(a(c)("projects.user_stories.title.details")),1)),e(le),e(ce,{onClick:m[0]||(m[0]=y=>r.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"pb-0"},{default:t(()=>[e(tt,{modelValue:f.value,"onUpdate:modelValue":m[1]||(m[1]=y=>f.value=y),"slider-color":"primary","align-tabs":"start"},{default:t(()=>[e(pe,{value:"0"},{default:t(()=>[e(V,{size:"18",icon:"tabler-user-check",start:""}),d(" "+l(a(c)("projects.requirements.tabs.details")),1)]),_:1}),e(pe,{value:"1"},{default:t(()=>[e(V,{size:"18",icon:"tabler-photo",start:""}),d(" "+l(a(c)("projects.requirements.tabs.mockups"))+" ",1),a(C).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(C).length),1)]),_:1})):k("",!0)]),_:1}),e(pe,{value:"2"},{default:t(()=>[e(V,{size:"18",icon:"tabler-history",start:""}),d(" "+l(a(c)("projects.requirements.tabs.history"))+" ",1),a(A).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(A).length),1)]),_:1})):k("",!0)]),_:1}),e(pe,{value:"3"},{default:t(()=>[e(V,{size:"18",icon:"tabler-messages",start:""}),d(" "+l(a(c)("projects.requirements.tabs.comments"))+" ",1),a(E).length?(n(),h(H,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(E).length),1)]),_:1})):k("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ae),e(G,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:t(()=>[e(at,{modelValue:f.value,"onUpdate:modelValue":m[8]||(m[8]=y=>f.value=y),class:"mt-5"},{default:t(()=>[e(ve,{value:"0"},{default:t(()=>[_.value?(n(),p("div",Xs,[e(Ie,{onSubmit:Ce(W,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:j.value.role,"onUpdate:modelValue":m[2]||(m[2]=y=>j.value.role=y),label:a(c)("projects.user_stories.fields.role"),required:"",rules:[y=>!!y||a(c)("projects.user_stories.validation.role_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:j.value.action,"onUpdate:modelValue":m[3]||(m[3]=y=>j.value.action=y),label:a(c)("projects.user_stories.fields.action"),required:"",rules:[y=>!!y||a(c)("projects.user_stories.validation.action_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:j.value.benefit,"onUpdate:modelValue":m[4]||(m[4]=y=>j.value.benefit=y),label:a(c)("projects.user_stories.fields.benefit"),required:"",rules:[y=>!!y||a(c)("projects.user_stories.validation.benefit_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:j.value.status,"onUpdate:modelValue":m[5]||(m[5]=y=>j.value.status=y),label:a(c)("projects.user_stories.fields.status"),items:O,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[i("div",eo,[i("div",to,l(a(c)("projects.user_stories.fields.acceptance_criteria")),1),e(se,{class:"w-100"},{default:t(()=>[e(R,{cols:"10",sm:"8"},{default:t(()=>[e(de,{modelValue:q.value,"onUpdate:modelValue":m[6]||(m[6]=y=>q.value=y),placeholder:a(c)("projects.user_stories.fields.add_criterion"),density:"compact","hide-details":"",class:"me-2",onKeyup:_t(x,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1}),e(R,{cols:"2",sm:"4"},{default:t(()=>[e(L,{color:"primary",size:"small",disabled:!q.value.trim(),onClick:x},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.add")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),j.value.acceptance_criteria&&j.value.acceptance_criteria.length>0?(n(),h(Ne,{key:0},{default:t(()=>[(n(!0),p(X,null,ne(j.value.acceptance_criteria,(y,oe)=>(n(),h(He,{key:oe},{prepend:t(()=>[e(V,{icon:"tabler-check",color:"success"})]),append:t(()=>[e(ce,{color:"error",variant:"text",size:"small",onClick:ke=>(me=>{j.value.acceptance_criteria.splice(me,1)})(oe)},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(y),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),p("div",ao,l(a(c)("projects.user_stories.empty.acceptance_criteria.description")),1))]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",lo,[i("div",ro,[e(H,{color:a(he)(s.userStory.status),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(c)(`projects.status.${s.userStory.status}`)),1)]),_:1},8,["color"]),e(H,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(" v"+l(s.userStory.version_number),1)]),_:1})]),i("div",so,[i("div",oo,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",io,l(a(c)("projects.details.updated_at"))+": "+l(M(s.userStory.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",no,l(a(c)("projects.details.created_at"))+": "+l(M(s.userStory.created_at)),1)])]),i("div",co,[i("div",uo,[i("span",mo,l(a(c)("projects.user_stories.fields.role")),1),d(" "+l(s.userStory.role)+", ",1)]),i("div",po,[i("span",vo,l(a(c)("projects.user_stories.fields.action")),1),d(" "+l(s.userStory.action)+", ",1)]),i("div",fo,[i("span",_o,l(a(c)("projects.user_stories.fields.benefit")),1),d(" "+l(s.userStory.benefit)+". ",1)])]),e(ae,{class:"mb-4"}),s.userStory.acceptance_criteria&&s.userStory.acceptance_criteria.length>0?(n(),p("div",go,[i("div",ho,l(a(c)("projects.user_stories.fields.acceptance_criteria")),1),e(Ne,null,{default:t(()=>[(n(!0),p(X,null,ne(s.userStory.acceptance_criteria,(y,oe)=>(n(),h(He,{key:oe,class:"px-0"},{prepend:t(()=>[e(V,{icon:"tabler-check",color:"success",class:"me-2"})]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(y),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(n(),p("div",yo,l(a(c)("projects.user_stories.empty.acceptance_criteria.description")),1)),s.userStory.generation_status==="in_progress"?(n(),p("div",bo,[e(Ue,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:t(()=>[e(bt,null,{default:t(()=>[d(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1}),i("p",null,l(a(c)("projects.user_stories.regeneration.description")),1)]),_:1})])):k("",!0)]))]),_:1}),e(ve,{value:"1"},{default:t(()=>[a(C).length===0?(n(),p("div",jo,[e(V,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-3"}),i("h4",ko,l(a(c)("projects.user_stories.mockups.empty.title")),1),i("p",xo,l(a(c)("projects.user_stories.mockups.empty.description")),1)])):(n(),p("div",wo,[e(se,null,{default:t(()=>[(n(!0),p(X,null,ne(a(C),y=>(n(),h(R,{key:y.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(Q,{class:"mockup-card h-100",onClick:oe=>{P.value=y,N.value=!0},border:"",hover:""},{default:t(()=>[e(ue,null,{append:t(()=>[i("div",Vo,[y.generation_status==="in_progress"||y.generation_status==="pending"||y.needs_regeneration?(n(),h(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):k("",!0),e(H,{color:a(he)(y.status),size:"small",label:""},{default:t(()=>[d(l(a(c)(`projects.status.${y.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(y.name),1)]),_:2},1024)]),_:2},1024),e(ae),e(G,null,{default:t(()=>[i("div",qo,[i("div",Co,[y.generation_status==="in_progress"||y.generation_status==="pending"?(n(),p("div",zo,[i("div",So,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",Uo,l(a(c)("projects.mockups.status.generating")),1)])])):y.html_content?(n(),p("div",Do,[i("div",{innerHTML:D(y.html_content)},null,8,Io)])):(n(),p("div",Mo,[e(V,{icon:"tabler-file-code",size:"48",color:"secondary"})])),i("div",Po,[e(L,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:y.generation_status==="in_progress"||y.generation_status==="pending"},{default:t(()=>[d(l(a(c)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),y.needs_regeneration?(n(),p("div",Bo,[e(H,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.mockups.status.regenerating")),1)]),_:1})])):k("",!0),i("div",$o,[i("div",Fo,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Lo,l(M(y.created_at)),1)])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"2"},{default:t(()=>[a(A).length===0?(n(),p("div",Ro,[e(V,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),i("h4",Oo,l(a(c)("projects.user_stories.empty.history.title")),1),i("p",Ao,l(a(c)("projects.user_stories.empty.history.description")),1)])):(n(),p("div",To,[e(jt,{density:"compact",align:"start"},{default:t(()=>[(n(!0),p(X,null,ne(a(A),(y,oe)=>(n(),h(kt,{key:oe,"dot-color":"primary",size:"small"},{opposite:t(()=>[i("div",No,l(M(y.changed_at)),1),i("div",Ho,"v"+l(y.version_number),1)]),default:t(()=>[e(Q,{border:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",size:"36"},{default:t(()=>[e(V,{icon:"tabler-user-check"})]),_:1})]),append:t(()=>[e(H,{color:a(he)(y.status),size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(c)(`projects.status.${y.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[i("span",Yo,l(a(c)("projects.user_stories.fields.role")),1),d(" "+l(y.role),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>[i("p",Zo,[i("span",Jo,l(a(c)("projects.user_stories.fields.action")),1),d(" "+l(y.action),1)]),i("p",Ko,[i("span",Eo,l(a(c)("projects.user_stories.fields.benefit")),1),d(" "+l(y.benefit),1)]),y.acceptance_criteria&&y.acceptance_criteria.length>0?(n(),p("div",Go,[i("div",Wo,l(a(c)("projects.user_stories.fields.acceptance_criteria"))+": ",1),i("ul",Qo,[(n(!0),p(X,null,ne(y.acceptance_criteria,(ke,me)=>(n(),p("li",{key:me},l(ke),1))),128))])])):k("",!0),i("div",Xo,l(a(c)("projects.requirements.history.changed_by"))+": "+l(y.changed_by?y.changed_by.username:a(c)("projects.requirements.history.unknown")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"3"},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:z.value,"onUpdate:modelValue":m[7]||(m[7]=y=>z.value=y),label:a(c)("projects.requirements.comments.add"),rows:"3",counter:"",disabled:I.value},null,8,["modelValue","label","disabled"]),i("div",ei,[e(L,{color:"primary",size:"small",loading:I.value,disabled:!z.value.trim(),onClick:K},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.add_comment")),1)]),_:1},8,["loading","disabled"])])]),_:1}),e(R,{cols:"12"},{default:t(()=>[a(E).length?(n(),h(ae,{key:0,class:"mb-4"})):k("",!0),a(E).length===0?(n(),p("div",ti,[e(V,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),i("h4",ai,l(a(c)("projects.user_stories.empty.comments.title")),1),i("p",li,l(a(c)("projects.user_stories.empty.comments.description")),1)])):(n(),p("div",ri,[(n(!0),p(X,null,ne(a(E),y=>(n(),p("div",{key:y.id,class:"comment-item mb-4"},[e(Q,{border:""},{default:t(()=>[e(G,{class:"py-2"},{default:t(()=>[i("div",si,[e(Se,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:t(()=>[e(V,{icon:"tabler-user"})]),_:1}),i("div",null,[i("div",oi,[i("strong",null,l(y.user?y.user.username:a(c)("projects.requirements.comments.unknown_user")),1),i("div",ii,l(M(y.created_at)),1)])]),e(le),s.isAdmin||s.hasManagerPermission?(n(),h(ce,{key:0,size:"small",color:"error",variant:"text",onClick:oe=>(async ke=>{I.value=!0;try{const{success:me,error:ze}=await v.deleteComment(ke);if(me&&!ze){w("Comment deleted successfully");const{data:Me}=await v.fetchUserStoryById(o.userStory.id);Me&&Object.assign(o.userStory,Me)}else w("Failed to delete comment","error")}catch(me){w("Failed to delete comment: "+me.message,"error")}finally{I.value=!1}})(y.id),disabled:I.value},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):k("",!0)]),i("div",ni,l(y.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[_.value?(n(),p(X,{key:0},[e(L,{color:"secondary",variant:"tonal",onClick:ee},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:W},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.save")),1)]),_:1})],64)):(n(),p(X,{key:1},[s.isAdmin?(n(),h(L,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:b},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.delete")),1)]),_:1})):k("",!0),s.hasModeratorPermission?(n(),h(L,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:B},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.regenerate")),1)]),_:1})):k("",!0),e(le),s.hasModeratorPermission?(n(),h(L,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:ee},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.edit")),1)]),_:1})):k("",!0)],64))]),_:1})]),_:1}),e(xe,{modelValue:F.value,"onUpdate:modelValue":m[11]||(m[11]=y=>F.value=y),"max-width":"600",persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"pt-3 pb-0"},{default:t(()=>[d(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1}),e(G,null,{default:t(()=>[i("p",ci,l(a(c)("projects.user_stories.regeneration.description")),1),e(be,{autofocus:"",modelValue:$.value,"onUpdate:modelValue":m[9]||(m[9]=y=>$.value=y),label:a(c)("projects.user_stories.fields.feedback"),hint:a(c)("projects.user_stories.placeholders.feedback"),rows:"4",counter:""},null,8,["modelValue","label","hint"])]),_:1}),e(fe,null,{default:t(()=>[e(L,{color:"secondary",variant:"tonal",onClick:m[10]||(m[10]=y=>F.value=!1)},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:Y},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.regenerate")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),P.value?(n(),h(st,{key:0,modelValue:N.value,"onUpdate:modelValue":m[12]||(m[12]=y=>N.value=y),mockup:P.value,"is-admin":s.isAdmin,"has-manager-permission":s.hasManagerPermission},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):k("",!0),e(we,{modelValue:J.value.show,"onUpdate:modelValue":m[14]||(m[14]=y=>J.value.show=y),color:J.value.color,timeout:5e3},{actions:t(()=>[e(ce,{onClick:m[13]||(m[13]=y=>J.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(J.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-6ec6a9e7"]]),di={class:"text-h5"},mi={class:"text-subtitle-1 font-weight-medium"},pi={class:"d-flex align-center justify-space-between mb-3"},vi={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},fi={__name:"UserStoryCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},userStoryData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const o=s,{t:r}=ge(),v=Z({get:()=>o.modelValue,set:J=>u("update:modelValue",J)}),c=S({role:o.editMode&&o.userStoryData?o.userStoryData.role:"",action:o.editMode&&o.userStoryData?o.userStoryData.action:"",benefit:o.editMode&&o.userStoryData?o.userStoryData.benefit:"",acceptance_criteria:o.editMode&&o.userStoryData?[...o.userStoryData.acceptance_criteria]:[],status:o.editMode&&o.userStoryData?o.userStoryData.status:"draft"}),f=S(""),_=S(null),j=[J=>!!J||r("projects.user_stories.validation.role_required")],q=[J=>!!J||r("projects.user_stories.validation.action_required")],z=[J=>!!J||r("projects.user_stories.validation.benefit_required")],$=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],F=()=>{f.value.trim()&&(c.value.acceptance_criteria||(c.value.acceptance_criteria=[]),c.value.acceptance_criteria.push(f.value.trim()),f.value="")},I=()=>{c.value={role:"",action:"",benefit:"",acceptance_criteria:[],status:"draft"},f.value="",_.value&&_.value.resetValidation()},P=()=>{v.value=!1,I()},N=async()=>{const{valid:J}=await _.value.validate();J&&(u("submit",c.value),v.value=!1,I())};return je(v,J=>{J||I()}),(J,T)=>{const O=ye("IconBtn");return n(),h(xe,{modelValue:a(v),"onUpdate:modelValue":T[5]||(T[5]=A=>De(v)?v.value=A:null),"max-width":"700",persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[i("h5",di,l(o.editMode?a(r)("projects.user_stories.title.edit"):a(r)("projects.user_stories.title.create")),1),e(le),e(O,{onClick:P},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"px-5 pt-4"},{default:t(()=>[e(Ie,{ref_key:"formRef",ref:_,onSubmit:Ce(N,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.role,"onUpdate:modelValue":T[0]||(T[0]=A=>c.value.role=A),label:a(r)("projects.user_stories.fields.role"),rules:j,placeholder:a(r)("projects.user_stories.placeholders.role"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.action,"onUpdate:modelValue":T[1]||(T[1]=A=>c.value.action=A),label:a(r)("projects.user_stories.fields.action"),rules:q,placeholder:a(r)("projects.user_stories.placeholders.action"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.benefit,"onUpdate:modelValue":T[2]||(T[2]=A=>c.value.benefit=A),label:a(r)("projects.user_stories.fields.benefit"),rules:z,placeholder:a(r)("projects.user_stories.placeholders.benefit"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.status,"onUpdate:modelValue":T[3]||(T[3]=A=>c.value.status=A),label:a(r)("projects.user_stories.fields.status"),items:$,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[i("div",mi,l(a(r)("projects.user_stories.fields.acceptance_criteria")),1),i("div",pi,[e(se,{class:"w-100"},{default:t(()=>[e(R,{cols:"10",sm:"8"},{default:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":T[4]||(T[4]=A=>f.value=A),placeholder:a(r)("projects.user_stories.fields.add_criterion"),density:"compact","hide-details":"",class:"me-2",onKeyup:_t(F,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1}),e(R,{cols:"2",sm:"4"},{default:t(()=>[e(L,{color:"primary",size:"small",disabled:!f.value.trim(),onClick:F},{default:t(()=>[d(l(a(r)("projects.user_stories.actions.add")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),c.value.acceptance_criteria&&c.value.acceptance_criteria.length>0?(n(),h(Ne,{key:0},{default:t(()=>[(n(!0),p(X,null,ne(c.value.acceptance_criteria,(A,E)=>(n(),h(He,{key:E},{prepend:t(()=>[e(V,{icon:"tabler-check",color:"success"})]),append:t(()=>[e(O,{color:"error",variant:"text",size:"small",onClick:C=>(M=>{c.value.acceptance_criteria.splice(M,1)})(E)},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(A),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),p("div",vi,l(a(r)("projects.user_stories.empty.acceptance_criteria.description")),1))]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[e(L,{variant:"tonal",color:"secondary",onClick:P},{default:t(()=>[d(l(a(r)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:N},{default:t(()=>[d(l(o.editMode?a(r)("projects.user_stories.actions.save"):a(r)("projects.user_stories.actions.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},_i={key:0,class:"mb-4"},gi={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},hi={key:2,class:"text-center pa-4"},yi={class:"text-h6 mb-2"},bi={class:"text-body-1 text-medium-emphasis mb-6"},ji={class:"d-flex align-center"},ki={class:"text-body-1 mb-2"},xi={class:"font-weight-medium text-primary"},wi={class:"text-body-1 mb-4"},Vi={class:"font-weight-medium text-primary"},qi={key:0},Ci={class:"text-subtitle-2 font-weight-medium mb-2 text-primary"},zi={class:"ml-4"},Si={key:0},Ui={class:"d-flex align-center justify-space-between mt-3"},Di={class:"d-flex align-center"},Ii={class:"text-caption"},Mi={class:"d-flex align-center"},Pi={class:"text-caption"},Bi=Ve({__name:"UserStoriesList",props:{projectId:{type:String,required:!0},requirementId:{type:String,required:!1,default:null},userStories:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,r=lt(),v=Be(),{t:c}=ge(),f=S(""),_=S(["draft","active","completed"]),j=S(null),q=S(!1),z=S(!1),$=S(!1),F=S(!1),I=S({show:!1,text:"",color:"success"}),P=Ae(),N=Z(()=>v.is_admin()),J=Z(()=>v.userData.role>=2),T=Z(()=>v.userData.role>=3),O=[{title:c("projects.status.draft"),value:"draft"},{title:c("projects.status.active"),value:"active"},{title:c("projects.status.archived"),value:"archived"},{title:c("projects.status.completed"),value:"completed"}],A=Z(()=>o.userStories.filter(b=>{const B=!f.value||b.role.toLowerCase().includes(f.value.toLowerCase())||b.action.toLowerCase().includes(f.value.toLowerCase())||b.benefit.toLowerCase().includes(f.value.toLowerCase()),Y=_.value.includes(b.status);return B&&Y})),E=Z(()=>o.userStories.some(b=>b.generation_status==="in_progress"||b.generation_status==="pending")),C=()=>{z.value=!0},M=async b=>{F.value=!0;try{const{data:B,error:Y}=await r.createUserStory({...b,requirement:o.requirementId});B&&!Y?(W("User story created successfully"),u("refresh")):W("Failed to create user story","error")}catch(B){W("Failed to create user story: "+B.message,"error")}finally{F.value=!1}},ee=async b=>{F.value=!0;try{const{data:B,error:Y}=await r.updateUserStory(j.value.id,b);B&&!Y?(W("User story updated successfully"),u("refresh")):W("Failed to update user story","error")}catch(B){W("Failed to update user story: "+B.message,"error")}finally{F.value=!1}},x=async()=>{if(j.value){F.value=!0,$.value=!1;try{const{success:b,error:B}=await r.deleteUserStory(j.value.id);b&&!B?(W("User story deleted successfully"),u("refresh"),q.value=!1):W("Failed to delete user story","error")}catch(b){W("Failed to delete user story: "+b.message,"error")}finally{F.value=!1}}},U=async(b="")=>{if(j.value){F.value=!0;try{const{data:B,error:Y}=await r.regenerateUserStory(j.value.id,b);B&&!Y?(W("User story regeneration started"),setTimeout(()=>{u("refresh")},3e3)):W("Failed to regenerate user story","error")}catch(B){W("Failed to regenerate user story: "+B.message,"error")}finally{F.value=!1}}},W=(b,B="success")=>{I.value={show:!0,text:b,color:B}};return qe(()=>{!o.requirementId||o.userStories.length||o.loading||r.fetchUserStories(o.requirementId).then(({data:b})=>{b&&u("refresh")}),P.on("project-refresh",()=>{r.fetchUserStories(o.requirementId,{silent:!0}).then(({data:b})=>{b&&u("refresh")})})}),je(q,b=>{b?P.on("project-refresh",async()=>{if(j.value){const{data:B}=await r.fetchUserStoryById(j.value.id);B&&(j.value=B)}}):P.off("project-refresh")}),(b,B)=>{const Y=Oe,K=ye("IconBtn");return n(),h(G,{class:"pa-6"},{default:t(()=>[a(E)?(n(),p("div",_i,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1})])):k("",!0),e(se,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":B[0]||(B[0]=w=>f.value=w),density:"compact",placeholder:a(c)("projects.user_stories.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(R,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:_.value,"onUpdate:modelValue":B[1]||(B[1]=w=>_.value=w),items:O,density:"compact","hide-details":"",label:a(c)("projects.user_stories.fields.status"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[a(T)&&s.requirementId?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:C,loading:F.value,block:""},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.add")),1)]),_:1},8,["loading"])):k("",!0)]),_:1})]),_:1}),e(ae,{class:"my-5"}),s.loading?(n(),p("div",gi,[e(ie,{indeterminate:"",color:"primary"})])):a(A).length===0?(n(),p("div",hi,[e(V,{icon:"tabler-notebook",size:"64",color:"secondary",class:"mb-4"}),i("h4",yi,l(a(c)("projects.user_stories.empty.title")),1),i("p",bi,l(f.value||_.value.length>0?a(c)("projects.user_stories.empty.filtered"):a(c)("projects.user_stories.empty.description")),1),a(T)&&s.requirementId&&!f.value&&_.value.length===0?(n(),h(L,{key:0,color:"primary",onClick:C,"prepend-icon":"tabler-plus"},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.create")),1)]),_:1})):k("",!0)])):(n(),h(se,{key:3},{default:t(()=>[(n(!0),p(X,null,ne(a(A),w=>(n(),h(R,{key:w.id,cols:"12",md:"6"},{default:t(()=>[e(Q,{class:"user-story-card h-100 d-flex flex-column",onClick:D=>(async g=>{const{data:m}=await r.fetchUserStoryById(g.id);j.value=m||g,q.value=!0})(w),border:"",hover:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",size:"42"},{default:t(()=>[e(V,{icon:"tabler-user-check"})]),_:1})]),append:t(()=>[i("div",ji,[w.generation_status==="in_progress"||w.generation_status==="pending"?(n(),h(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):k("",!0),w.generation_status==="pending"?(n(),h(H,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1})):k("",!0),e(H,{color:a(he)(w.status),size:"small",label:""},{default:t(()=>[d(l(b.$t(`projects.status.${w.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(c)("projects.user_stories.fields.role"))+" "+l(w.role),1)]),_:2},1024)]),_:2},1024),e(G,{class:"d-flex flex-column"},{default:t(()=>{return[i("p",ki,[i("span",xi,l(a(c)("projects.user_stories.fields.action"))+":",1),d(" "+l(w.action),1)]),i("p",wi,[i("span",Vi,l(a(c)("projects.user_stories.fields.benefit"))+":",1),d(" "+l(w.benefit),1)]),w.acceptance_criteria&&w.acceptance_criteria.length>0?(n(),p("div",qi,[i("div",Ci,l(a(c)("projects.user_stories.fields.acceptance_criteria"))+":",1),i("ul",zi,[(n(!0),p(X,null,ne(w.acceptance_criteria.slice(0,2),(g,m)=>(n(),p("li",{key:m},l(g),1))),128)),w.acceptance_criteria.length>2?(n(),p("li",Si,l(a(c)("projects.user_stories.and_more",{count:w.acceptance_criteria.length-2})),1)):k("",!0)])])):k("",!0),e(le),i("div",Ui,[i("div",Di,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Ii,l((D=w.updated_at,D?(D=parseInt(D),new Date(D).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)]),i("div",Mi,[e(V,{size:"16",icon:"tabler-history",class:"me-1"}),i("span",Pi,"v"+l(w.version_number),1)])])];var D}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),j.value?(n(),h(ui,{key:4,modelValue:q.value,"onUpdate:modelValue":B[2]||(B[2]=w=>q.value=w),"user-story":j.value,onDelete:B[3]||(B[3]=w=>$.value=!0),onUpdate:ee,onRegenerate:U,"is-admin":a(N),"has-manager-permission":a(J),"has-moderator-permission":a(T)},null,8,["modelValue","user-story","is-admin","has-manager-permission","has-moderator-permission"])):k("",!0),e(fi,{modelValue:z.value,"onUpdate:modelValue":B[4]||(B[4]=w=>z.value=w),onSubmit:M},null,8,["modelValue"]),e(Y,{isDialogVisible:$.value,"onUpdate:isDialogVisible":B[5]||(B[5]=w=>$.value=w),confirmationMsg:a(c)("projects.user_stories.delete_confirm.message"),onConfirm:x},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:I.value.show,"onUpdate:modelValue":B[7]||(B[7]=w=>I.value.show=w),color:I.value.color,timeout:5e3},{actions:t(()=>[e(K,{onClick:B[6]||(B[6]=w=>I.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(I.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-917627be"]]),$i={key:0,class:"text-h5"},Fi={class:"text-h5"},Li={key:0},Ri={class:"text-subtitle-1 font-weight-medium mb-2"},Oi={class:"bg-grey-lighten-5 rounded pa-3"},Ai={class:"text-medium-emphasis text-caption mb-2"},Ti={key:1},Ni={key:0,class:"pa-5"},Hi={class:"d-flex justify-center my-8"},Yi={class:"d-flex align-center justify-center text-medium-emphasis"},Zi={class:"text-caption me-4"},Ji={class:"text-caption"},Ki={key:1,class:"diagram-content pa-0"},Ei={class:"diagram-metadata d-flex align-center px-6 py-3"},Gi={key:0,class:"ms-2"},Wi={class:"text-medium-emphasis d-flex align-center"},Qi={class:"text-caption me-4"},Xi={class:"text-caption"},en={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},tn={class:"text-h6 mb-2"},an={class:"text-medium-emphasis text-center"},ln=Ve({__name:"UmlDiagramDetailsDialog",props:{modelValue:{type:Boolean,default:!1},diagram:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(s,{emit:u}){const o=s,r=Z({get:()=>o.modelValue,set:C=>u("update:modelValue",C)}),v=rt(),c=S(!1),f=S(!1),_=S({...o.diagram}),j=S(!1),q=S({show:!1,text:"",color:"success"}),{t:z}=ge(),$=[{title:z("projects.status.draft"),value:"draft"},{title:z("projects.status.active"),value:"active"},{title:z("projects.status.archived"),value:"archived"},{title:z("projects.status.completed"),value:"completed"}],F=C=>C?(C=parseInt(C),new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",I=()=>{c.value=!c.value},P=()=>{f.value&&(_.value={...o.diagram}),f.value=!f.value},N=S(null),J=()=>{r.value&&v.fetchDiagramById(o.diagram.id).then(({data:C})=>{C&&Object.assign(o.diagram,C)})};qe(()=>{N.value=setInterval(J,5e3)}),Re(()=>{N.value&&clearInterval(N.value)});const T=async()=>{j.value=!0;try{const{data:C,error:M}=await v.updateDiagram(o.diagram.id,_.value);C&&!M?(E(z("projects.uml_diagrams.notifications.updated")),Object.assign(o.diagram,C),f.value=!1,r.value=!1):E(z("projects.uml_diagrams.notifications.update_failed"),"error")}catch(C){E(z("projects.uml_diagrams.notifications.update_failed")+": "+C.message,"error")}finally{j.value=!1}},O=()=>{u("delete"),r.value=!1},A=async()=>{j.value=!0;try{const{data:C,error:M}=await v.regenerateDiagram(o.diagram.id);C&&!M?(E(z("projects.uml_diagrams.notifications.regeneration_started")),r.value=!1,setTimeout(()=>{u("regenerate")},3e3)):E(z("projects.uml_diagrams.notifications.regeneration_failed"),"error")}catch(C){E(z("projects.uml_diagrams.notifications.regeneration_failed")+": "+C.message,"error")}finally{j.value=!1}},E=(C,M="success")=>{q.value={show:!0,text:C,color:M}};return je(()=>o.diagram,C=>{_.value={...C}},{deep:!0}),(C,M)=>{const ee=ye("IconBtn");return n(),h(xe,{modelValue:a(r),"onUpdate:modelValue":M[7]||(M[7]=x=>De(r)?r.value=x:null),fullscreen:c.value,"max-width":c.value?"100%":"900",scrollable:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[f.value?(n(),p("h5",$i,l(a(z)("projects.uml_diagrams.actions.edit")),1)):(n(),p(X,{key:1},[i("h5",Fi,l(s.diagram.name),1),e(H,{class:"ms-2",color:"secondary",size:"small",label:""},{default:t(()=>[d(l(a(z)(`projects.uml_diagrams.types.${s.diagram.diagram_type}`)),1)]),_:1})],64)),e(le),e(L,{icon:"",variant:"text",onClick:I},{default:t(()=>[e(V,{icon:c.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(ee,{onClick:M[0]||(M[0]=x=>r.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(ae),e(G,{class:et({"pa-0":!f.value&&s.diagram.content,"pa-6":f.value||!s.diagram.content}),style:Pe({height:c.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:t(()=>[f.value?(n(),p("div",Li,[e(Ie,{onSubmit:Ce(T,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(de,{modelValue:_.value.name,"onUpdate:modelValue":M[1]||(M[1]=x=>_.value.name=x),label:a(z)("projects.uml_diagrams.name"),required:"",rules:[x=>!!x||a(z)("projects.uml_diagrams.validation.name_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:_.value.status,"onUpdate:modelValue":M[2]||(M[2]=x=>_.value.status=x),label:a(z)("projects.uml_diagrams.status.title"),items:$,required:""},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(be,{modelValue:_.value.notes,"onUpdate:modelValue":M[3]||(M[3]=x=>_.value.notes=x),label:a(z)("projects.uml_diagrams.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12"},{default:t(()=>[i("div",Ri,l(a(z)("projects.uml_diagrams.content")),1),i("div",Oi,[i("div",Ai,l(a(z)("projects.uml_diagrams.content_hint")),1),e(be,{modelValue:_.value.content,"onUpdate:modelValue":M[4]||(M[4]=x=>_.value.content=x),rows:"15",monospace:"","hide-details":""},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",Ti,[s.diagram.generation_status==="in_progress"?(n(),p("div",Ni,[e(Ue,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:t(()=>[e(bt,null,{default:t(()=>[d(l(a(z)("projects.uml_diagrams.status.generating")),1)]),_:1}),i("p",null,l(a(z)("projects.uml_diagrams.status.generating_description")),1)]),_:1}),i("div",Hi,[e(ie,{indeterminate:"",color:"primary",size:"64"})]),i("div",Yi,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",Zi,l(a(z)("projects.details.updated_at"))+": "+l(F(s.diagram.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",Ji,l(a(z)("projects.details.created_at"))+": "+l(F(s.diagram.created_at)),1)])])):s.diagram.content?(n(),p("div",Ki,[i("div",Ei,[e(H,{color:a(he)(s.diagram.status),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(z)(`projects.status.${s.diagram.status}`)),1)]),_:1},8,["color"]),s.diagram.notes?(n(),p("div",Gi,[e(Rt,null,{activator:t(({props:x})=>[e(V,gt({icon:"tabler-info-circle",size:"18",color:"info"},x),null,16)]),default:t(()=>[i("span",null,l(s.diagram.notes),1)]),_:1})])):k("",!0),e(le),i("div",Wi,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",Qi,l(a(z)("projects.details.updated_at"))+": "+l(F(s.diagram.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",Xi,l(a(z)("projects.details.created_at"))+": "+l(F(s.diagram.created_at)),1)])]),e(ae),i("div",{class:"diagram-svg-container pa-4 d-flex justify-center align-center",style:Pe({height:c.value?"calc(100vh - 180px)":"calc(70vh - 110px)",overflow:"auto"})},[s.diagram.content?(n(),h(ht,{key:0,src:a(yt)(s.diagram.content),class:"diagram-svg",alt:"Generated Diagram"},null,8,["src"])):k("",!0)],4)])):(n(),p("div",en,[e(V,{icon:"tabler-chart-dots-2",size:"64",color:"secondary",class:"mb-4"}),i("h4",tn,l(a(z)("projects.uml_diagrams.status.no_content.title")),1),i("p",an,l(a(z)("projects.uml_diagrams.status.no_content.description")),1)]))]))]),_:1},8,["class","style"]),e(ae),e(fe,{class:"pa-4"},{default:t(()=>[f.value?(n(),p(X,{key:0},[e(L,{color:"secondary",variant:"tonal",onClick:P,disabled:j.value},{default:t(()=>[d(l(a(z)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(le),e(L,{color:"primary",onClick:T,loading:j.value},{default:t(()=>[d(l(a(z)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),p(X,{key:1},[s.isAdmin?(n(),h(L,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:O},{default:t(()=>[d(l(a(z)("projects.uml_diagrams.actions.delete")),1)]),_:1})):k("",!0),s.hasModeratorPermission?(n(),h(L,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:A,loading:j.value},{default:t(()=>[d(l(a(z)("projects.uml_diagrams.actions.regenerate")),1)]),_:1},8,["loading"])):k("",!0),e(le),s.hasModeratorPermission?(n(),h(L,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:P},{default:t(()=>[d(l(a(z)("projects.uml_diagrams.actions.edit")),1)]),_:1})):k("",!0)],64))]),_:1})]),_:1}),e(we,{modelValue:q.value.show,"onUpdate:modelValue":M[6]||(M[6]=x=>q.value.show=x),color:q.value.color,timeout:5e3},{actions:t(()=>[e(ee,{onClick:M[5]||(M[5]=x=>q.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(q.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-c7c71d81"]]),rn={key:0,class:"mb-4"},sn={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},on={key:2,class:"text-center pa-4"},nn={class:"text-h6 mb-2"},cn={class:"text-body-1 text-medium-emphasis mb-6"},un={class:"d-flex align-center"},dn={class:"mb-3 d-flex align-center"},mn={class:"diagram-preview mb-3"},pn={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},vn={class:"d-flex justify-center align-center h-100"},fn={key:0,class:"text-center pa-2"},_n={class:"text-caption"},gn={key:1,class:"diagram-thumbnail pa-2"},hn={key:2,class:"text-center"},yn={class:"text-caption mt-2"},bn={class:"preview-overlay d-flex justify-center align-center"},jn={class:"d-flex align-center justify-space-between"},kn={class:"d-flex align-center"},xn={class:"text-caption"},wn={class:"text-body-1 mb-4"},Vn=Ve({__name:"UmlDiagramList",props:{projectId:{type:String,required:!0},diagrams:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,r=rt(),v=Be(),{t:c}=ge(),f=S(""),_=S("all"),j=S(null),q=S(!1),z=S(!1),$=S(!1),F=S(!1),I=S({show:!1,text:"",color:"success"}),P=Z(()=>v.is_admin()),N=Z(()=>v.userData.role>=2),J=Z(()=>v.userData.role>=3),T=[{title:c("projects.uml_diagrams.types.all"),value:"all"},{title:c("projects.uml_diagrams.types.class"),value:"class"},{title:c("projects.uml_diagrams.types.sequence"),value:"sequence"},{title:c("projects.uml_diagrams.types.activity"),value:"activity"},{title:c("projects.uml_diagrams.types.usecase"),value:"use_case"},{title:c("projects.uml_diagrams.types.state"),value:"state"},{title:c("projects.uml_diagrams.types.component"),value:"component"},{title:c("projects.uml_diagrams.types.deployment"),value:"deployment"},{title:c("projects.uml_diagrams.types.er"),value:"er"}],O=S("class"),A=Z(()=>o.diagrams.filter(b=>{const B=!f.value||b.name.toLowerCase().includes(f.value.toLowerCase())||b.diagram_type.toLowerCase().includes(f.value.toLowerCase()),Y=_.value==="all"||b.diagram_type.toLowerCase()===_.value.toLowerCase();return B&&Y})),E=Ae(),C=()=>{O.value="class",$.value=!0},M=async()=>{$.value=!1,F.value=!0;try{const{data:b,error:B}=await r.generateDiagrams(o.projectId,O.value);b&&!B?(x(c("projects.uml_diagrams.notifications.generation_started")),setTimeout(()=>{u("refresh")},3e3)):x(c("projects.uml_diagrams.notifications.generation_failed"),"error")}catch(b){x(c("projects.uml_diagrams.notifications.generation_failed")+": "+b.message,"error")}finally{F.value=!1}},ee=async()=>{if(j.value){F.value=!0,z.value=!1;try{const{success:b,error:B}=await r.deleteDiagram(j.value.id);b&&!B?(x(c("projects.uml_diagrams.notifications.delete_success")),u("refresh"),q.value=!1):x(c("projects.uml_diagrams.notifications.delete_failed"),"error")}catch(b){x(c("projects.uml_diagrams.notifications.delete_failed")+": "+b.message,"error")}finally{F.value=!1}}},x=(b,B="success")=>{I.value={show:!0,text:b,color:B}},U=b=>{switch(b.toLowerCase()){case"all":default:return"tabler-chart-dots";case"class":return"tabler-box";case"sequence":return"tabler-arrow-right-square";case"activity":return"tabler-activity";case"usecase":return"tabler-user-check";case"state":return"tabler-circle-check";case"component":return"tabler-puzzle";case"deployment":return"tabler-server";case"er":return"tabler-database"}},W=b=>{switch(b.toLowerCase()){case"all":return c("projects.uml_diagrams.types.all");case"class":return c("projects.uml_diagrams.types.class");case"sequence":return c("projects.uml_diagrams.types.sequence");case"activity":return c("projects.uml_diagrams.types.activity");case"usecase":return c("projects.uml_diagrams.types.usecase");case"state":return c("projects.uml_diagrams.types.state");case"component":return c("projects.uml_diagrams.types.component");case"deployment":return c("projects.uml_diagrams.types.deployment");case"er":return c("projects.uml_diagrams.types.er");default:return b.charAt(0).toUpperCase()+b.slice(1)+" "+c("projects.uml_diagrams.types.diagram")}};return qe(()=>{E.on("project-refresh",()=>{r.fetchDiagrams(o.projectId,{silent:!0}).then(({data:b})=>{b&&u("refresh")})})}),je(q,b=>{b?E.on("project-refresh",async()=>{if(j.value){const{data:B}=await r.fetchDiagram(j.value.id);B&&(j.value=B)}}):E.off("project-refresh")}),(b,B)=>{const Y=Oe,K=ye("IconBtn");return n(),h(G,{class:"pa-6"},{default:t(()=>[b.anyDiagramInProgress?(n(),p("div",rn,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(c)("projects.uml_diagrams.status.generating")),1)]),_:1})])):k("",!0),e(se,null,{default:t(()=>[e(R,{cols:"12",md:"4"},{default:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":B[0]||(B[0]=w=>f.value=w),density:"compact",placeholder:a(c)("projects.uml_diagrams.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(R,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:_.value,"onUpdate:modelValue":B[1]||(B[1]=w=>_.value=w),items:T,density:"compact","hide-details":"",label:a(c)("projects.uml_diagrams.type"),variant:"outlined"},null,8,["modelValue","label"])]),_:1}),e(R,{cols:"12",md:"4",class:"d-flex align-center"},{default:t(()=>[a(J)?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:C,loading:F.value,block:""},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1},8,["loading"])):k("",!0)]),_:1})]),_:1}),e(ae,{class:"my-5"}),s.loading?(n(),p("div",sn,[e(ie,{indeterminate:"",color:"primary"})])):a(A).length===0?(n(),p("div",on,[e(V,{icon:"tabler-chart-dots",size:"64",color:"secondary",class:"mb-4"}),i("h4",nn,l(a(c)("projects.uml_diagrams.empty.title")),1),i("p",cn,l(f.value||_.value!=="all"?a(c)("projects.uml_diagrams.empty.filtered"):a(c)("projects.uml_diagrams.empty.description")),1),a(J)&&!f.value&&_.value==="all"?(n(),h(L,{key:0,color:"primary",onClick:C,"prepend-icon":"tabler-plus"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1})):k("",!0)])):(n(),h(se,{key:3},{default:t(()=>[(n(!0),p(X,null,ne(a(A),w=>(n(),h(R,{key:w.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(Q,{class:"diagram-card h-100",onClick:D=>(async g=>{const{data:m}=await r.fetchDiagram(g.id);j.value=m||g,q.value=!0})(w),border:"",hover:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",size:"42"},{default:t(()=>[e(V,{icon:U(w.diagram_type)},null,8,["icon"])]),_:2},1024)]),append:t(()=>[i("div",un,[w.generation_status==="in_progress"||w.generation_status==="pending"?(n(),h(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):k("",!0),w.generation_status==="pending"?(n(),h(H,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.status.generating")),1)]),_:1})):k("",!0),e(H,{color:a(he)(w.status),size:"small",label:""},{default:t(()=>[d(l(w.status),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(w.name),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>{return[i("div",dn,[e(H,{color:"secondary",size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(W(w.diagram_type)),1)]),_:2},1024)]),i("div",mn,[i("div",pn,[i("div",vn,[w.generation_status==="in_progress"?(n(),p("div",fn,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",_n,l(a(c)("projects.uml_diagrams.status.generating")),1)])):w.content?(n(),p("div",gn,[w.content?(n(),h(ht,{key:0,src:a(yt)(w.content),class:"diagram-svg",alt:a(c)("projects.uml_diagrams.title")},null,8,["src","alt"])):k("",!0)])):(n(),p("div",hn,[e(V,{icon:U(w.diagram_type),size:"48",color:"secondary"},null,8,["icon"]),i("div",yn,l(a(c)("projects.uml_diagrams.status.no_content.title")),1)]))]),i("div",bn,[e(L,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.view")),1)]),_:1})])])]),i("div",jn,[i("div",kn,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",xn,l((D=w.created_at,D?(D=parseInt(D),new Date(D).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)])])];var D}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),j.value?(n(),h(ln,{key:4,modelValue:q.value,"onUpdate:modelValue":B[2]||(B[2]=w=>q.value=w),diagram:j.value,onDelete:B[3]||(B[3]=w=>z.value=!0),"is-admin":a(P),"has-manager-permission":a(N),"has-moderator-permission":a(J)},null,8,["modelValue","diagram","is-admin","has-manager-permission","has-moderator-permission"])):k("",!0),e(xe,{modelValue:$.value,"onUpdate:modelValue":B[6]||(B[6]=w=>$.value=w),"max-width":"600",persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(re,{class:"pt-5 pb-2"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.generation.title")),1)]),_:1}),e(G,null,{default:t(()=>[i("p",wn,l(a(c)("projects.uml_diagrams.generation.description")),1),e(_e,{modelValue:O.value,"onUpdate:modelValue":B[4]||(B[4]=w=>O.value=w),items:T,label:a(c)("projects.uml_diagrams.type")},null,8,["modelValue","label"])]),_:1}),e(fe,null,{default:t(()=>[e(L,{color:"secondary",variant:"tonal",onClick:B[5]||(B[5]=w=>$.value=!1)},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(L,{color:"primary",onClick:M},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{isDialogVisible:z.value,"onUpdate:isDialogVisible":B[7]||(B[7]=w=>z.value=w),confirmationMsg:a(c)("projects.uml_diagrams.delete_confirm.message"),onConfirm:ee},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:I.value.show,"onUpdate:modelValue":B[9]||(B[9]=w=>I.value.show=w),color:I.value.color,timeout:5e3},{actions:t(()=>[e(K,{onClick:B[8]||(B[8]=w=>I.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(I.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-220f545e"]]),qn={key:2,class:"d-flex justify-center align-center",style:{"min-height":"200px"}},Cn={__name:"ProjectExportsList",props:{projectId:{type:String,required:!0},exports:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const{t:o}=ge(),r=v=>{switch(v){case"active":return"success";case"pending":return"warning";case"failed":return"error";default:return"grey"}};return(v,c)=>(n(),h(Q,null,{default:t(()=>[e(G,null,{default:t(()=>[!s.loading&&s.exports.length>0?(n(),h(Ze,{key:0},{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(o)("projects.exports.table.template")),1),i("th",null,l(a(o)("projects.exports.table.format")),1),i("th",null,l(a(o)("projects.exports.table.status")),1),i("th",null,l(a(o)("projects.exports.table.created_by")),1),i("th",null,l(a(o)("projects.exports.table.created_at")),1),i("th",null,l(a(o)("projects.exports.table.actions")),1)])]),i("tbody",null,[(n(!0),p(X,null,ne(s.exports,f=>{return n(),p("tr",{key:f.id},[i("td",null,l(f.template.name),1),i("td",null,l(f.fmt.toUpperCase()),1),i("td",null,[e(H,{color:r(f.status),size:"small"},{default:t(()=>[d(l(a(o)(`projects.exports.status.${f.status}`)),1)]),_:2},1032,["color"])]),i("td",null,l(f.created_by.username),1),i("td",null,l((_=f.created_at,new Date(parseInt(_)).toLocaleString())),1),i("td",null,[f.url?(n(),h(L,{key:0,icon:"",variant:"text",color:"primary",onClick:j=>(q=>{q.url&&window.open(q.url,"_blank")})(f)},{default:t(()=>[e(V,{icon:"tabler-download"})]),_:2},1032,["onClick"])):k("",!0)])]);var _}),128))])]),_:1})):s.loading||s.exports.length!==0?(n(),p("div",qn,[e(ie,{indeterminate:"",color:"primary",size:"64"})])):(n(),h(Ue,{key:1,type:"info",variant:"tonal",class:"mt-4"},{default:t(()=>[d(l(a(o)("projects.exports.empty")),1)]),_:1}))]),_:1})]),_:1}))}},zn={class:"text-center"},Sn={class:"d-flex flex-wrap justify-space-between align-center"},Un={class:"d-flex align-center"},Dn={class:"text-h3"},In={class:"d-flex align-center mt-3 mt-sm-0"},Mn={__name:"[id]",setup(s){const u=Pt(),o=Bt(),r=$t();lt(),rt();const v=Be(),{t:c}=ge(),f=S(!0),_=S(null),j=S("0"),q=S(!1),z=S(!1),$=S(!1),F=S({show:!1,text:"",color:"success"}),I=Z(()=>u.params.id),P=Z(()=>r.currentProject),N=Z(()=>v.is_admin()),J=Z(()=>v.userData.role>=2),T=Z(()=>v.userData.role>=3),O=S(null),A=S(!1),E=[{title:"Markdown",value:"md",icon:"tabler-markdown"},{title:"PDF",value:"pdf",icon:"tabler-file-text"},{title:"HTML",value:"html",icon:"tabler-code"}],C=Ae(),M=S(null),ee=async()=>{P.value||(f.value=!0),_.value=null;try{const{data:D,error:g}=await r.fetchProjectById(I.value);g&&(_.value=g,x("projects.errors.loading_failed"))}catch(D){_.value=D.message||"Failed to load project details",x("projects.errors.loading_failed")}finally{f.value=!1}},x=(D,g="success")=>{F.value={show:!0,text:c(D),color:g}},U=()=>{q.value=!0},W=async(D=!1)=>{if(D){z.value=!1,$.value=!0;try{const{success:g,error:m}=await r.deleteProject(I.value);g&&!m?(x("projects.notifications.deleted"),o.push({name:"projects"})):x("projects.notifications.error")}catch{x("projects.errors.delete_failed","error")}finally{$.value=!1}}},b=async D=>{$.value=!0;try{const{data:g,error:m}=await r.updateProject(I.value,D);x(g&&!m?"projects.notifications.updated":"projects.notifications.error")}catch{x("projects.errors.update_failed","error")}finally{$.value=!1}},B=async()=>{$.value=!0;try{const{data:D,error:g}=await r.generateRequirements(I.value);D&&!g?x("projects.notifications.requirements_generation_started"):x("projects.notifications.requirements_generation_failed","error")}catch{x("projects.notifications.requirements_generation_failed","error")}finally{$.value=!1}},Y=async()=>{$.value=!0;try{const{data:D,error:g}=await r.generatePlan(I.value);D&&!g?x("projects.notifications.plan_generation_started"):x("projects.notifications.plan_generation_failed","error")}catch{x("projects.notifications.plan_generation_failed","error")}finally{$.value=!1}},K=async()=>{$.value=!0;try{const{data:D,error:g}=await r.generateMockups(I.value);D&&!g?x("projects.notifications.mockups_generation_started"):x("projects.notifications.mockups_generation_failed","error")}catch{x("projects.notifications.mockups_generation_failed","error")}finally{$.value=!1}},w=D=>{O.value=D,j.value="2"};return qe(()=>{ee(),M.value=setInterval(()=>{C.emit("project-refresh"),ee()},8e3)}),Mt(()=>{M.value&&(clearInterval(M.value),M.value=null)}),(D,g)=>{const m=Oe,ce=ye("IconBtn");return n(),h(Lt,{fluid:""},{default:t(()=>[f.value&&!a(P)?(n(),h(se,{key:0},{default:t(()=>[e(R,{cols:"12",class:"d-flex justify-center align-center",style:{"min-height":"400px"}},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"64"})]),_:1})]),_:1})):_.value&&!a(P)?(n(),h(se,{key:1},{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(Ue,{color:"error",variant:"tonal",title:a(c)("projects.errors.loading_failed"),text:a(c)("projects.errors.loading_failed"),class:"mb-4"},null,8,["title","text"]),i("div",zn,[e(L,{color:"primary",onClick:ee},{default:t(()=>[d(l(D.$t("projects.actions.retry")),1)]),_:1}),e(L,{color:"secondary",variant:"outlined",class:"ms-2",to:{name:"projects"}},{default:t(()=>[d(l(D.$t("projects.actions.back_to_projects")),1)]),_:1})])]),_:1})]),_:1})):a(P)?(n(),p(X,{key:2},[e(se,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[i("div",Sn,[i("div",Un,[e(L,{icon:"",variant:"text",class:"me-3",to:{name:"projects"}},{default:t(()=>[e(V,{icon:"tabler-arrow-left"})]),_:1}),i("h3",Dn,l(a(P).name),1)]),i("div",In,[e(L,{color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"me-2",onClick:ee,loading:$.value},{default:t(()=>[d(l(D.$t("projects.actions.refresh")),1)]),_:1},8,["loading"]),a(T)?(n(),h(Ot,{key:0,modelValue:A.value,"onUpdate:modelValue":g[0]||(g[0]=y=>A.value=y),location:"top",loading:$.value},{activator:t(({props:y})=>[e(L,gt(y,{color:"secondary",variant:"outlined","prepend-icon":"tabler-file-export",class:"me-2"}),{default:t(()=>[d(l(D.$t("projects.actions.export_srs")),1)]),_:2},1040)]),default:t(()=>[e(Ne,null,{default:t(()=>[(n(),p(X,null,ne(E,y=>e(He,{key:y.value,value:y.value,onClick:oe=>{(async(ke="md")=>{$.value=!0;try{const{data:me,error:ze}=await r.exportSrs(I.value,ke);me&&!ze?(x("projects.notifications.srs_export_started"),j.value="6"):x("projects.notifications.srs_export_failed","error")}catch{x("projects.notifications.srs_export_failed","error")}finally{$.value=!1}})(y.value),A.value=!1}},{prepend:t(()=>[e(V,{icon:y.icon},null,8,["icon"])]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(y.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1},8,["modelValue","loading"])):k("",!0),a(J)?(n(),h(L,{key:1,color:"primary","prepend-icon":"tabler-edit",class:"me-2",onClick:U,loading:$.value},{default:t(()=>[d(l(D.$t("projects.actions.edit")),1)]),_:1},8,["loading"])):k("",!0),a(N)?(n(),h(L,{key:2,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:g[1]||(g[1]=y=>z.value=!0),loading:$.value},{default:t(()=>[d(l(D.$t("projects.actions.delete")),1)]),_:1},8,["loading"])):k("",!0)])])]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(Q,null,{default:t(()=>[e(tt,{modelValue:j.value,"onUpdate:modelValue":g[2]||(g[2]=y=>j.value=y),"bg-color":"primary",grow:"","slider-color":"white"},{default:t(()=>[e(pe,{value:"0",color:"white"},{default:t(()=>[e(V,{size:"18",icon:"tabler-info-circle",start:""}),d(" "+l(D.$t("projects.tabs.overview")),1)]),_:1}),e(pe,{value:"1",color:"white"},{default:t(()=>{var y;return[e(V,{size:"18",icon:"tabler-list",start:""}),d(" "+l(D.$t("projects.tabs.requirements"))+" ",1),(y=a(P).requirements)!=null&&y.length?(n(),h(H,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>[d(l(a(P).requirements.length),1)]),_:1})):k("",!0)]}),_:1}),e(pe,{value:"2",color:"white"},{default:t(()=>{var y;return[e(V,{size:"18",icon:"tabler-user-check",start:""}),d(" "+l(D.$t("projects.tabs.user_stories"))+" ",1),(y=a(P).user_stories)!=null&&y.length?(n(),h(H,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var oe;return[d(l(((oe=a(P).user_stories)==null?void 0:oe.length)||0),1)]}),_:1})):k("",!0)]}),_:1}),e(pe,{value:"3",color:"white"},{default:t(()=>{var y;return[e(V,{size:"18",icon:"tabler-layout-kanban",start:""}),d(" "+l(D.$t("projects.tabs.mockups"))+" ",1),(y=a(P).mockups)!=null&&y.length?(n(),h(H,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>[d(l(a(P).mockups.length),1)]),_:1})):k("",!0)]}),_:1}),e(pe,{value:"4",color:"white"},{default:t(()=>{var y;return[e(V,{size:"18",icon:"tabler-chart-dots",start:""}),d(" "+l(D.$t("projects.tabs.uml_diagrams"))+" ",1),(y=a(P).uml_diagrams)!=null&&y.length?(n(),h(H,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var oe;return[d(l(((oe=a(P).uml_diagrams)==null?void 0:oe.length)||0),1)]}),_:1})):k("",!0)]}),_:1}),e(pe,{value:"5",color:"white"},{default:t(()=>[e(V,{size:"18",icon:"tabler-chart-dots",start:""}),d(" "+l(D.$t("projects.tabs.development_plan")),1)]),_:1}),e(pe,{value:"6",color:"white"},{default:t(()=>{var y;return[e(V,{size:"18",icon:"tabler-file-export",start:""}),d(" "+l(D.$t("projects.tabs.exports"))+" ",1),(y=a(P).srs_exports)!=null&&y.length?(n(),h(H,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var oe;return[d(l(((oe=a(P).srs_exports)==null?void 0:oe.length)||0),1)]}),_:1})):k("",!0)]}),_:1})]),_:1},8,["modelValue"]),e(ae),e(at,{modelValue:j.value,"onUpdate:modelValue":g[5]||(g[5]=y=>j.value=y)},{default:t(()=>[e(ve,{value:"0"},{default:t(()=>[e(Ma,{project:a(P),loading:f.value},null,8,["project","loading"])]),_:1}),e(ve,{value:"1"},{default:t(()=>[e(fe,{class:"pt-3 px-6"},{default:t(()=>[e(le),a(T)?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:B,loading:$.value},{default:t(()=>[d(l(a(c)("projects.requirements.actions.generate")),1)]),_:1},8,["loading"])):k("",!0)]),_:1}),e(Cr,{"project-id":a(I),requirements:a(P).requirements||[],loading:f.value,onRefresh:ee,onViewUserStories:w},null,8,["project-id","requirements","loading"])]),_:1}),e(ve,{value:"2"},{default:t(()=>{var y,oe;return[e(fe,{class:"pt-3 px-6"},{default:t(()=>[O.value?(n(),h(L,{key:0,color:"secondary",variant:"tonal","prepend-icon":"tabler-arrow-left",onClick:g[3]||(g[3]=ke=>O.value=null)},{default:t(()=>[d(l(D.$t("projects.actions.back_to_all_user_stories")),1)]),_:1})):k("",!0),e(le),a(T)?(n(),h(L,{key:1,color:"primary","prepend-icon":"tabler-refresh",onClick:g[4]||(g[4]=ke=>(async(me=null)=>{$.value=!0;try{let ze;if(me){const{data:Me,error:We}=await r.generateUserStories(I.value,me);ze={data:Me,error:We}}else{const{data:Me,error:We}=await r.generateUserStories(I.value);ze={data:Me,error:We}}ze.data&&!ze.error?x("projects.notifications.user_stories_generation_started"):x("projects.notifications.user_stories_generation_failed","error")}catch{x("projects.notifications.user_stories_generation_failed","error")}finally{$.value=!1}})(O.value?O.value.id:null)),loading:$.value},{default:t(()=>[d(l(D.$t(O.value?"projects.actions.generate_user_stories_for_requirement":"projects.actions.generate_all_user_stories")),1)]),_:1},8,["loading"])):k("",!0)]),_:1}),e(Bi,{"project-id":a(I),"requirement-id":O.value?O.value.id:null,"user-stories":O.value?((oe=(y=a(P).requirements)==null?void 0:y.find(ke=>ke.id===O.value.id))==null?void 0:oe.user_stories)||[]:a(P).user_stories||[],loading:f.value,onRefresh:ee},null,8,["project-id","requirement-id","user-stories","loading"])]}),_:1}),e(ve,{value:"3"},{default:t(()=>[e(fe,{class:"pt-3 px-6"},{default:t(()=>[e(le),a(T)?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:K,loading:$.value},{default:t(()=>[d(l(a(c)("projects.mockups.actions.generate")),1)]),_:1},8,["loading"])):k("",!0)]),_:1}),e(Xr,{"project-id":a(I),mockups:a(P).mockups||[],loading:f.value,onRefresh:ee},null,8,["project-id","mockups","loading"])]),_:1}),e(ve,{value:"4"},{default:t(()=>[e(Vn,{"project-id":a(I),diagrams:a(P).uml_diagrams||[],loading:f.value,onRefresh:ee},null,8,["project-id","diagrams","loading"])]),_:1}),e(ve,{value:"5"},{default:t(()=>[e(fe,{class:"pt-3 px-6"},{default:t(()=>[e(le),a(J)?(n(),h(L,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:Y,loading:$.value},{default:t(()=>[d(l(D.$t("projects.development_plan.actions.generate")),1)]),_:1},8,["loading"])):k("",!0)]),_:1}),e(Gs,{"project-id":a(I),"development-plan":a(P).development_plan,loading:f.value,onRefresh:ee},null,8,["project-id","development-plan","loading"])]),_:1}),e(ve,{value:"6"},{default:t(()=>[e(Cn,{"project-id":a(I),exports:a(P).srs_exports||[],loading:f.value,onRefresh:ee},null,8,["project-id","exports","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):k("",!0),a(P)?(n(),h(Ft,{key:3,modelValue:q.value,"onUpdate:modelValue":g[6]||(g[6]=y=>q.value=y),"edit-mode":"","project-data":a(P),onSubmit:b},null,8,["modelValue","project-data"])):k("",!0),e(m,{isDialogVisible:z.value,"onUpdate:isDialogVisible":g[7]||(g[7]=y=>z.value=y),confirmationMsg:a(c)("projects.delete_confirm.message"),onConfirm:W},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:F.value.show,"onUpdate:modelValue":g[9]||(g[9]=y=>F.value.show=y),color:F.value.color,timeout:5e3},{actions:t(()=>[e(ce,{onClick:g[8]||(g[8]=y=>F.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(F.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}};typeof it=="function"&&it(Mn);export{Mn as default};
