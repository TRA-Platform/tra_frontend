import{L,ab as R,ad as $,E as z,a9 as E,ae as J,p as a,aa as x,aB as K,k as b,w as S,o as T,c as X,y as l,D as h,A as f,q as e,aX as Y,m as g,aJ as Z,V as G,z as V,aK as H,aY as k,aZ as M,C as N,aI as O,t as Q,r as W}from"./index-5df66acf.js";import{r as D}from"./validators-3c49fec8.js";import{b as U}from"./route-block-83d24a4e.js";import{V as ee}from"./VForm-f85999e5.js";import{V as ae,a as y}from"./VRow-5d460fef.js";import{m as se,u as le,V as C,b as j}from"./VTextField-7c270f59.js";import{c as te,d as q}from"./VCheckboxBtn-2106bebb.js";import"./index-731cfb7e.js";const oe=L()({name:"VCheckbox",inheritAttrs:!1,props:{...se(),...R(te(),["inline"])},emits:{"update:focused":c=>!0},setup(c,t){let{attrs:r,slots:u}=t;const{isFocused:n,focus:m,blur:_}=le(c),i=$(),p=z(()=>c.id||`checkbox-${i}`);return E(()=>{const[w,o]=J(r),[s,v]=C.filterProps(c),[d,pe]=q.filterProps(c);return a(C,x({class:["v-checkbox",c.class]},w,s,{id:p.value,focused:n.value,style:c.style}),{...u,default:B=>{let{id:F,messagesId:I,isDisabled:P,isReadonly:A}=B;return a(q,x(d,{id:F.value,"aria-describedby":I.value,disabled:P.value,readonly:A.value},o,{onFocus:m,onBlur:_}),u)}})}),{}}}),re={class:"auth-wrapper d-flex justify-center align-center pa-md-4"},ue={class:"position-relative"},de={class:"d-flex"},ne={class:"text-h5 font-weight-semibold mb-1"},ie={class:"mb-0"},ce={class:"d-flex align-center justify-space-between flex-wrap mt-2 mb-4"},me={__name:"login",setup(c){const{t}=K(),r=b({enabled:!1,type:"error",message:t("auth.login.messages.error")}),u=b({username:"",password:"",stay_signed:!1,code:""}),n=b(!1),m=b(!1),_=Q(),i=S(),p=b(),w=async()=>{var s;let o;if((await((s=p==null?void 0:p.value)==null?void 0:s.validate())).valid){n.value=!0;try{if(o=await i.login(u.value),!o.data.access)return r.value={enabled:!0,type:"error",message:o.data},void(n.value=!1)}catch(v){return r.value={enabled:!0,type:"error",message:v.data},void(n.value=!1)}if(i.authData={...i.authData,access:`${o.data.access}`,refresh:`${o.data.refresh}`},o=await i.me({}),o.data.error)return r.value={enabled:!0,type:"error",message:o.data.error},void(n.value=!1);i.userData=o.data,r.value={enabled:!0,type:"success",message:t("auth.login.messages.success")},n.value=!1,setTimeout(()=>{_.push({name:i.authData.nextUrl,params:i.authData.nextParams})},1e3)}else r.value={enabled:!0,type:"error",message:t("validation.required")}};return(o,s)=>{const v=W("RouterLink");return T(),X("div",re,[a(Y,{modelValue:e(r).enabled,"onUpdate:modelValue":s[0]||(s[0]=d=>e(r).enabled=d),location:"bottom end",variant:"flat",transition:"scroll-y-reverse-transition",color:e(r).type},{default:l(()=>[h(f(e(r).message),1)]),_:1},8,["modelValue","color"]),g("div",ue,[a(O,{class:"auth-card pa-4","min-width":"448","max-width":"448"},{default:l(()=>[a(Z,{class:"justify-center"},{prepend:l(()=>[g("div",de,[a(e(G),{nodes:e(V).app.logo},null,8,["nodes"])])]),default:l(()=>[a(H,{class:"font-weight-bold text-h5 py-1"},{default:l(()=>[h(f(e(V).app.title),1)]),_:1})]),_:1}),a(k,{class:"pt-1"},{default:l(()=>[g("h5",ne,f(e(t)("auth.login.welcome")),1),g("p",ie,f(e(t)("auth.login.slogan")),1)]),_:1}),a(k,null,{default:l(()=>[a(ee,{ref_key:"refForm",ref:p,onSubmit:s[5]||(s[5]=M(()=>{},["prevent"]))},{default:l(()=>[a(ae,null,{default:l(()=>[a(y,{cols:"12"},{default:l(()=>[a(j,{modelValue:e(u).username,"onUpdate:modelValue":s[1]||(s[1]=d=>e(u).username=d),label:e(t)("auth.login.username"),type:"text",rules:[e(D)]},null,8,["modelValue","label","rules"])]),_:1}),a(y,{cols:"12"},{default:l(()=>[a(j,{modelValue:e(u).password,"onUpdate:modelValue":s[2]||(s[2]=d=>e(u).password=d),label:e(t)("auth.login.password"),type:e(m)?"text":"password",rules:[e(D)],autocomplete:"on","append-inner-icon":e(m)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[3]||(s[3]=d=>m.value=!e(m))},null,8,["modelValue","label","type","rules","append-inner-icon"])]),_:1}),a(y,{cols:"12"},{default:l(()=>[g("div",ce,[a(oe,{modelValue:e(u).stay_signed,"onUpdate:modelValue":s[4]||(s[4]=d=>e(u).stay_signed=d),label:e(t)("auth.login.remember_me")},null,8,["modelValue","label"])]),a(N,{loading:e(n),disabled:e(n),block:"",type:"submit",onClick:w},{default:l(()=>[h(f(e(t)("auth.login.login_btn")),1)]),_:1},8,["loading","disabled"])]),_:1}),a(y,{cols:"12",class:"text-center"},{default:l(()=>[a(v,{to:{name:"auth-register"},class:"text-decoration-none"},{default:l(()=>[h(f(e(t)("auth.login.no_account")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])])}}};typeof U=="function"&&U(me);export{me as default};
