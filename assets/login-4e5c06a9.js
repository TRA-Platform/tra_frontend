import{L as S,ab as z,ad as E,E as J,a9 as K,ae as L,p as s,aa as w,b3 as R,k as p,w as T,aB as X,o as Y,c as Z,y as r,D as h,A as f,q as a,aX as G,m as b,aJ as H,V as M,z as V,aK as N,aY as x,aZ as O,C as Q,aI as W,t as aa}from"./index-5789d73a.js";import{b as $}from"./route-block-83d24a4e.js";import{V as ea}from"./VForm-73098b32.js";import{V as sa,a as _}from"./VRow-7265fa83.js";import{m as la,u as ta,V as k,b as D}from"./VTextField-196356ff.js";import{c as oa,d as P}from"./VCheckboxBtn-09426770.js";import"./index-6cdb1ca7.js";const ra=S()({name:"VCheckbox",inheritAttrs:!1,props:{...la(),...z(oa(),["inline"])},emits:{"update:focused":o=>!0},setup(o,t){let{attrs:n,slots:u}=t;const{isFocused:m,focus:v,blur:i}=ta(o),c=E(),g=J(()=>o.id||`checkbox-${c}`);return K(()=>{const[y,e]=L(n),[l,d]=k.filterProps(o),[C,fa]=P.filterProps(o);return s(k,w({class:["v-checkbox",o.class]},y,l,{id:g.value,focused:m.value,style:o.style}),{...u,default:F=>{let{id:j,messagesId:q,isDisabled:I,isReadonly:B}=F;return s(P,w(C,{id:j.value,"aria-describedby":q.value,disabled:I.value,readonly:B.value},e,{onFocus:v,onBlur:i}),u)}})}),{}}}),{t:U}=R.global,A=o=>{return(n=>n==null)(o)||(t=o,Array.isArray(t)&&t.length===0)||o===!1?U("validation.required"):!!String(o).trim().length||U("validation.required");var t},na={class:"auth-wrapper d-flex justify-center align-center pa-md-4"},da={class:"position-relative"},ua={class:"d-flex"},ia={class:"text-h5 font-weight-semibold mb-1"},ma={class:"mb-0"},ca={class:"d-flex align-center justify-space-between flex-wrap mt-2 mb-4"},pa={__name:"login",setup(o){const t=p({enabled:!1,type:"error",message:"Permission denied!"}),n=p({username:"",password:"",stay_signed:!1,code:""}),u=p(!1),m=p(!1),v=aa(),i=T(),c=p(),{t:g}=X(),y=async()=>{var l;let e;if((await((l=c==null?void 0:c.value)==null?void 0:l.validate())).valid){u.value=!0;try{if(e=await i.login(n.value),!e.data.access)return t.value={enabled:!0,type:"error",message:e.data},void(u.value=!1)}catch(d){return t.value={enabled:!0,type:"error",message:d.data},void(u.value=!1)}if(i.authData={...i.authData,access:`${e.data.access}`,refresh:`${e.data.refresh}`},e=await i.me({}),e.data.error)return t.value={enabled:!0,type:"error",message:e.data.error},void(u.value=!1);i.userData=e.data,t.value={enabled:!0,type:"success",message:g("auth.login.messages.success")},u.value=!1,setTimeout(()=>{v.push({name:i.authData.nextUrl,params:i.authData.nextParams})},1e3)}else t.value={enabled:!0,type:"error",message:"Проверьте правильность заполнения всех полей!"}};return(e,l)=>(Y(),Z("div",na,[s(G,{modelValue:a(t).enabled,"onUpdate:modelValue":l[0]||(l[0]=d=>a(t).enabled=d),location:"bottom end",variant:"flat",transition:"scroll-y-reverse-transition",color:a(t).type},{default:r(()=>[h(f(a(t).message),1)]),_:1},8,["modelValue","color"]),b("div",da,[s(W,{class:"auth-card pa-4","min-width":"448","max-width":"448"},{default:r(()=>[s(H,{class:"justify-center"},{prepend:r(()=>[b("div",ua,[s(a(M),{nodes:a(V).app.logo},null,8,["nodes"])])]),default:r(()=>[s(N,{class:"font-weight-bold text-h5 py-1"},{default:r(()=>[h(f(a(V).app.title),1)]),_:1})]),_:1}),s(x,{class:"pt-1"},{default:r(()=>[b("h5",ia,f(e.$t("auth.login.welcome")),1),b("p",ma,f(e.$t("auth.login.slogan")),1)]),_:1}),s(x,null,{default:r(()=>[s(ea,{ref_key:"refForm",ref:c,onSubmit:l[5]||(l[5]=O(()=>{},["prevent"]))},{default:r(()=>[s(sa,null,{default:r(()=>[s(_,{cols:"12"},{default:r(()=>[s(D,{modelValue:a(n).username,"onUpdate:modelValue":l[1]||(l[1]=d=>a(n).username=d),label:e.$t("auth.login.username"),type:"text",rules:[a(A)]},null,8,["modelValue","label","rules"])]),_:1}),s(_,{cols:"12"},{default:r(()=>[s(D,{modelValue:a(n).password,"onUpdate:modelValue":l[2]||(l[2]=d=>a(n).password=d),label:e.$t("auth.login.password"),type:a(m)?"text":"password",rules:[a(A)],autocomplete:"on","append-inner-icon":a(m)?"tabler-eye-off":"tabler-eye","onClick:appendInner":l[3]||(l[3]=d=>m.value=!a(m))},null,8,["modelValue","label","type","rules","append-inner-icon"])]),_:1}),s(_,{cols:"12"},{default:r(()=>[b("div",ca,[s(ra,{modelValue:a(n).stay_signed,"onUpdate:modelValue":l[4]||(l[4]=d=>a(n).stay_signed=d),label:e.$t("auth.login.remember_me")},null,8,["modelValue","label"])]),s(Q,{loading:a(u),disabled:a(u),block:"",type:"submit",onClick:y},{default:r(()=>[h(f(e.$t("auth.login.login_btn")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])]))}};typeof $=="function"&&$(pa);export{pa as default};
