import{L as Je,N as Ke,b4 as ct,R as Xe,S as ut,W as dt,b5 as mt,a9 as Ee,p as e,G as $e,a8 as Vt,Z as Fe,E as J,ac as pt,Q as vt,b6 as ft,O as _t,b7 as qt,Y as it,a1 as Ct,$ as zt,ap as V,b8 as St,b9 as Ut,ba as Dt,k as z,I as je,o as n,b as y,y as t,aI as W,aY as G,C as $,m as i,A as l,b1 as fe,D as d,aV as Le,bb as X,aD as Ve,aB as ge,aJ as ue,aL as Se,q as a,aK as re,c as p,aj as x,F as Q,a as ne,at as Pe,bc as Te,H as qe,a$ as Re,r as ye,ah as ie,s as et,aZ as Ce,aX as we,ar as De,w as Be,b3 as tt,bd as It,be as gt,aa as ht,J as Mt,b0 as Pt,t as Bt}from"./index-e8b63828.js";import{V as xe}from"./VDialog-905be39c.js";import{a as be,u as $t,_ as Ft,V as Lt}from"./ProjectCreateDialog-d3cfaa6a.js";import{V as se,a as F}from"./VRow-1119710b.js";import{V as Y}from"./VChip-60159b69.js";import{V as ee}from"./VDivider-b0b7ca7d.js";import{g as he,a as Qe,b as yt}from"./formatters-b966212f.js";import{V as ae}from"./VSpacer-eb0b7b84.js";import{V as Ie}from"./VForm-0819d548.js";import{b as de}from"./VTextField-348ad488.js";import{V as _e}from"./VSelect-7e55ecc0.js";import{b as at,c as pe,V as Ue,a as bt}from"./VTabs-9c17417b.js";import{V as lt,a as ve}from"./VSlideGroup-b1bc71f9.js";import{V as Ne,a as He,b as Ye}from"./VList-e4070065.js";import{V as Rt}from"./VTooltip-22298a8d.js";import{b as nt}from"./route-block-83d24a4e.js";import{V as Ot}from"./VMenu-d8d152ac.js";import"./index-ecf02037.js";import"./VCheckboxBtn-6658bce8.js";import"./ssrBoot-72d82303.js";const Ze=Je()({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...Ke(),...ct(),...Xe(),...ut()},setup(s,u){let{slots:o}=u;const{themeClasses:r}=dt(s),{densityClasses:f}=mt(s);return Ee(()=>e(s.tag,{class:["v-table",{"v-table--fixed-height":!!s.height,"v-table--fixed-header":s.fixedHeader,"v-table--fixed-footer":s.fixedFooter,"v-table--has-top":!!o.top,"v-table--has-bottom":!!o.bottom,"v-table--hover":s.hover},r.value,f.value,s.class],style:s.style},{default:()=>{var c,_,g;return[(c=o.top)==null?void 0:c.call(o),o.default?e("div",{class:"v-table__wrapper",style:{height:$e(s.height)}},[e("table",null,[o.default()])]):(_=o.wrapper)==null?void 0:_.call(o),(g=o.bottom)==null?void 0:g.call(o)]}})),{}}}),jt=Je()({name:"VTimeline",props:{align:{type:String,default:"center",validator:s=>["center","start"].includes(s)},direction:{type:String,default:"vertical",validator:s=>["vertical","horizontal"].includes(s)},justify:{type:String,default:"auto",validator:s=>["auto","center"].includes(s)},side:{type:String,validator:s=>s==null||["start","end"].includes(s)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:s=>["start","end","both"].includes(s)},...Ke(),...ct(),...Xe(),...ut()},setup(s,u){let{slots:o}=u;const{themeClasses:r}=dt(s),{densityClasses:f}=mt(s);Vt({VTimelineDivider:{lineColor:Fe(s,"lineColor")},VTimelineItem:{density:Fe(s,"density"),lineInset:Fe(s,"lineInset")}});const c=J(()=>{const g=s.side?s.side:s.density!=="default"?"end":null;return g&&`v-timeline--side-${g}`}),_=J(()=>{const g=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(s.truncateLine){case"both":return g;case"start":return g[0];case"end":return g[1];default:return null}});return Ee(()=>e(s.tag,{class:["v-timeline",`v-timeline--${s.direction}`,`v-timeline--align-${s.align}`,`v-timeline--justify-${s.justify}`,_.value,{"v-timeline--inset-line":!!s.lineInset},r.value,f.value,c.value,s.class],style:[{"--v-timeline-line-thickness":$e(s.lineThickness)},s.style]},o)),{}}}),At=Je()({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:pt,iconColor:String,lineColor:String,...Ke(),...vt(),...ft(),..._t()},setup(s,u){let{slots:o}=u;const{sizeClasses:r,sizeStyles:f}=qt(s,"v-timeline-divider__dot"),{backgroundColorStyles:c,backgroundColorClasses:_}=it(Fe(s,"dotColor")),{roundedClasses:g}=Ct(s,"v-timeline-divider__dot"),{elevationClasses:k}=zt(s),{backgroundColorClasses:q,backgroundColorStyles:C}=it(Fe(s,"lineColor"));return Ee(()=>e("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":s.fillDot},s.class],style:s.style},[e("div",{class:["v-timeline-divider__before",q.value],style:C.value},null),!s.hideDot&&e("div",{key:"dot",class:["v-timeline-divider__dot",k.value,g.value,r.value],style:f.value},[e("div",{class:["v-timeline-divider__inner-dot",_.value,g.value],style:c.value},[o.default?e(St,{key:"icon-defaults",disabled:!s.icon,defaults:{VIcon:{color:s.iconColor,icon:s.icon,size:s.size}}},o.default):e(V,{key:"icon",color:s.iconColor,icon:s.icon,size:s.size},null)])]),e("div",{class:["v-timeline-divider__after",q.value],style:C.value},null)])),{}}}),kt=Je()({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:pt,iconColor:String,lineInset:[Number,String],...Ke(),...Ut(),..._t(),...vt(),...ft(),...Xe()},setup(s,u){let{slots:o}=u;const{dimensionStyles:r}=Dt(s),f=z(0),c=z();return je(c,_=>{var g;_&&(f.value=((g=_.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:g.getBoundingClientRect().width)??0)},{flush:"post"}),Ee(()=>{var _,g;return e("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":s.fillDot},s.class],style:[{"--v-timeline-dot-size":$e(f.value),"--v-timeline-line-inset":s.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${$e(s.lineInset)})`:$e(0)},s.style]},[e("div",{class:"v-timeline-item__body",style:r.value},[(_=o.default)==null?void 0:_.call(o)]),e(At,{ref:c,hideDot:s.hideDot,icon:s.icon,iconColor:s.iconColor,size:s.size,elevation:s.elevation,dotColor:s.dotColor,fillDot:s.fillDot,rounded:s.rounded},{default:o.icon}),s.density!=="compact"&&e("div",{class:"v-timeline-item__opposite"},[!s.hideOpposite&&((g=o.opposite)==null?void 0:g.call(o))])])}),{}}}),Tt=i("span",{class:"text-5xl"},"!",-1),Nt={class:"text-lg font-weight-medium"},Oe={__name:"ConfirmDialog",props:{confirmationMsg:{type:String,required:!0},isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","confirm"],setup(s,{emit:u}){const o=s,r=_=>{u("update:isDialogVisible",_)},f=()=>{u("confirm",!0),r(!1)},c=()=>{u("confirm",!1),u("update:isDialogVisible",!1)};return(_,g)=>(n(),y(xe,{"max-width":"500","model-value":o.isDialogVisible,"onUpdate:modelValue":r},{default:t(()=>[e(W,{class:"text-center px-10 py-6"},{default:t(()=>[e(G,null,{default:t(()=>[e($,{icon:"",variant:"outlined",color:"warning",class:"mb-4",style:{width:"88px",height:"88px","pointer-events":"none"}},{default:t(()=>[Tt]),_:1}),i("h6",Nt,l(o.confirmationMsg),1)]),_:1}),e(fe,{class:"align-center justify-center gap-2"},{default:t(()=>[e($,{variant:"elevated",onClick:f},{default:t(()=>[d(l(_.$t("confirmation.confirm")),1)]),_:1}),e($,{color:"secondary",variant:"tonal",onClick:c},{default:t(()=>[d(l(_.$t("confirmation.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},rt=Le({id:"UserStoryStore",state:()=>({userStories:[],currentUserStory:null,loading:!1,error:null}),actions:{async fetchUserStories(s=null){this.loading=!0;try{let u="/service/user-stories/";s&&(u+=`?requirement=${s}`);const o=await X.get(u);return o.status===200?(this.userStories=o.data,{data:o.data,error:null}):{data:[],error:o.data}}catch(u){return this.error=u.message||"Failed to fetch user stories",{data:[],error:this.error}}finally{this.loading=!1}},async fetchUserStoryById(s){this.loading=!0;try{const u=await X.get(`/service/user-stories/${s}/`);return u.status===200?(this.currentUserStory=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch user story",{data:null,error:this.error}}finally{this.loading=!1}},async createUserStory(s){this.loading=!0;try{const u=await X.post("/service/user-stories/",s);return u.status===201?(this.userStories.length&&this.userStories.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create user story",{data:null,error:this.error}}finally{this.loading=!1}},async updateUserStory(s,u){this.loading=!0;try{const o=await X.put(`/service/user-stories/${s}/`,u);if(o.status===200){if(this.userStories.length){const r=this.userStories.findIndex(f=>f.id===s);r!==-1&&(this.userStories[r]=o.data)}return this.currentUserStory&&this.currentUserStory.id===s&&(this.currentUserStory=o.data),{data:o.data,error:null}}return{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update user story",{data:null,error:this.error}}finally{this.loading=!1}},async deleteUserStory(s){this.loading=!0;try{const u=await X.delete(`/service/user-stories/${s}/`);return u.status===204?(this.userStories.length&&(this.userStories=this.userStories.filter(o=>o.id!==s)),this.currentUserStory&&this.currentUserStory.id===s&&(this.currentUserStory=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete user story",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateUserStory(s,u=""){this.loading=!0;try{const o=await X.post(`/service/user-stories/${s}/regenerate/`,{feedback:u});return o.status===202?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to regenerate user story",{data:null,error:this.error}}finally{this.loading=!1}},async createComment(s,u){this.loading=!0;try{const o=await X.post("/service/user-story-comments/",{user_story:s,text:u.text,status:u.status||"active"});return o.status===201?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(s){this.loading=!0;try{const u=await X.delete(`/service/user-story-comments/${s}/`);return u.status===204?{success:!0,error:null}:{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),st=Le({id:"UmlDiagramStore",state:()=>({diagrams:[],currentDiagram:null,loading:!1,error:null}),actions:{async fetchDiagrams(s=null,u=null){this.loading=!0;try{let o="/service/uml-diagrams/";const r={};s&&(r.project=s),u&&(r.diagram_type=u);const f=await X.get(o,{params:r});return f.status===200?(this.diagrams=f.data,{data:f.data,error:null}):{data:[],error:f.data}}catch(o){return this.error=o.message||"Failed to fetch UML diagrams",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDiagramById(s){this.loading=!0;try{const u=await X.get(`/service/uml-diagrams/${s}/`);return u.status===200?(this.currentDiagram=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async createDiagram(s){this.loading=!0;try{const u=await X.post("/service/uml-diagrams/",s);return u.status===201?(this.diagrams.length&&this.diagrams.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async updateDiagram(s,u){this.loading=!0;try{const o=await X.put(`/service/uml-diagrams/${s}/`,u);if(o.status===200){if(this.diagrams.length){const r=this.diagrams.findIndex(f=>f.id===s);r!==-1&&(this.diagrams[r]=o.data)}return this.currentDiagram&&this.currentDiagram.id===s&&(this.currentDiagram=o.data),{data:o.data,error:null}}return{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async deleteDiagram(s){this.loading=!0;try{const u=await X.delete(`/service/uml-diagrams/${s}/`);return u.status===204?(this.diagrams.length&&(this.diagrams=this.diagrams.filter(o=>o.id!==s)),this.currentDiagram&&this.currentDiagram.id===s&&(this.currentDiagram=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete UML diagram",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateDiagram(s){this.loading=!0;try{const u=await X.post(`/service/uml-diagrams/${s}/regenerate/`);return u.status===202?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to regenerate UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async generateDiagrams(s,u="class"){this.loading=!0;try{const o=await X.post(`/service/projects/${s}/generate_uml_diagrams/`,{diagram_type:u});return o.status===202?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to generate UML diagrams",{data:null,error:this.error}}finally{this.loading=!1}}}}),Ht={class:"d-flex flex-column gap-4"},Yt={class:"d-flex flex-column gap-2"},Zt={class:"d-flex align-center"},Jt={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},Kt={class:"d-flex align-center"},Et={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},Gt={class:"d-flex align-center"},Wt={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},Qt={class:"d-flex align-center"},Xt={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ea={key:0,class:"d-flex align-center"},ta={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},aa={key:1,class:"d-flex align-center"},la={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ra={key:2,class:"d-flex align-center"},sa={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},oa={class:"d-flex align-center"},ia=["title"],na={class:"ms-2"},ca={class:"whitespace-pre-wrap"},ua={class:"d-flex flex-column gap-4"},da={key:0},ma={class:"text-subtitle-1 font-weight-bold mb-2"},pa={class:"whitespace-pre-wrap"},va={key:1},fa={class:"text-subtitle-1 font-weight-bold mb-2"},_a={class:"d-flex flex-column gap-4"},ga={class:"whitespace-pre-wrap mb-4"},ha={key:0,class:"whitespace-pre-wrap"},ya={class:"text-subtitle-1 font-weight-bold mb-2"},ba={class:"whitespace-pre-wrap"},ja={class:"whitespace-pre-wrap"},ka={class:"whitespace-pre-wrap"},xa={class:"d-flex flex-column gap-3"},wa={class:"font-weight-medium mb-1"},Va={class:"d-flex justify-space-between mt-1"},qa={class:"font-weight-medium mb-1"},Ca={class:"d-flex justify-space-between mt-1"},za={class:"font-weight-medium mb-1"},Sa={class:"d-flex align-center gap-2"},Ua={class:"flex-grow-1"},Da={class:"font-weight-medium mb-1"},Ia={class:"d-flex justify-space-between mt-1"},Ma=Ve({__name:"ProjectDetailsInfo",props:{project:{type:Object,required:!0},loading:{type:Boolean,default:!1}},setup(s){const u=s,{t:o}=ge(),r=g=>g?new Date(parseInt(g)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):o("projects.details.not_set"),f=J(()=>{switch(u.project.status){case"draft":return"warning";case"active":return"success";case"archived":return"secondary";case"completed":return"info";default:return"primary"}}),c=J(()=>{switch(u.project.type_of_application){case"website":return"tabler-world-www";case"mobile":return"tabler-device-mobile";case"desktop":return"tabler-device-desktop";case"api":return"tabler-api";default:return"tabler-code"}}),_={en:o("projects.languages.english"),ru:o("projects.languages.russian"),de:o("projects.languages.german")};return(g,k)=>(n(),y(G,{class:"pa-6"},{default:t(()=>[e(se,null,{default:t(()=>[e(F,{cols:"12",md:"6"},{default:t(()=>[i("div",Ht,[e(W,{border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(V,{icon:a(c)},null,8,["icon"])]),_:1})]),append:t(()=>[e(Y,{size:"small",color:a(f),label:""},{default:t(()=>[d(l(a(o)(`projects.status.${s.project.status}`)),1)]),_:1},8,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.project_overview")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",Yt,[i("div",Zt,[i("span",Jt,l(a(o)("projects.details.created_at"))+":",1),i("span",null,l(r(s.project.created_at)),1)]),i("div",Kt,[i("span",Et,l(a(o)("projects.details.updated_at"))+":",1),i("span",null,l(r(s.project.updated_at)),1)]),i("div",Gt,[i("span",Wt,l(a(o)("projects.details.type"))+":",1),e(Y,{size:"small"},{default:t(()=>[d(l(a(o)(`projects.types.${s.project.type_of_application}`)),1)]),_:1})]),i("div",Qt,[i("span",Xt,l(a(o)("projects.details.language"))+":",1),e(Y,{size:"small"},{default:t(()=>{return[d(l((q=s.project.language,_[q]||q)),1)];var q}),_:1})]),s.project.deadline?(n(),p("div",ea,[i("span",ta,l(a(o)("projects.details.deadline"))+":",1),i("span",null,l(r(s.project.deadline)),1)])):x("",!0),s.project.preliminary_budget?(n(),p("div",aa,[i("span",la,l(a(o)("projects.details.budget"))+":",1),i("span",null,"$"+l(s.project.preliminary_budget),1)])):x("",!0),s.project.color_scheme?(n(),p("div",ra,[i("span",sa,l(a(o)("projects.details.color_scheme"))+":",1),i("div",oa,[(n(!0),p(Q,null,ne(s.project.color_scheme.split(","),(q,C)=>(n(),p("div",{key:C,class:"color-swatch rounded me-1",style:Pe({backgroundColor:q.trim()}),title:a(o)("projects.details.color")},null,12,ia))),128)),i("span",na,l(s.project.color_scheme),1)])])):x("",!0)])]),_:1})]),_:1}),s.project.additional_requirements?(n(),y(W,{key:0,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-list-details"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.additional_requirements")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",ca,l(s.project.additional_requirements),1)]),_:1})]),_:1})):x("",!0),s.project.technology_stack||s.project.operating_system?(n(),y(W,{key:1,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-device-laptop-code"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.technical_details")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",ua,[s.project.technology_stack?(n(),p("div",da,[i("h6",ma,l(a(o)("projects.details.technology_stack")),1),i("div",pa,l(s.project.technology_stack),1)])):x("",!0),s.project.operating_system?(n(),p("div",va,[i("h6",fa,l(a(o)("projects.details.operating_system")),1),i("div",null,l(s.project.operating_system),1)])):x("",!0)])]),_:1})]),_:1})):x("",!0)])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[i("div",_a,[e(W,{border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-file-description"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.description")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",ga,l(s.project.short_description),1),s.project.application_description?(n(),p("div",ha,[i("h6",ya,l(a(o)("projects.details.application_description")),1),i("div",null,l(s.project.application_description),1)])):x("",!0)]),_:1})]),_:1}),s.project.target_users?(n(),y(W,{key:0,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-users"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.target_users")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",ba,l(s.project.target_users),1)]),_:1})]),_:1})):x("",!0),s.project.non_functional_requirements?(n(),y(W,{key:1,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-chart-bubble"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.non_functional_requirements")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",ja,l(s.project.non_functional_requirements),1)]),_:1})]),_:1})):x("",!0),s.project.priority_modules?(n(),y(W,{key:2,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(V,{color:"primary",icon:"tabler-star"})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.priority_modules")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",ka,l(s.project.priority_modules),1)]),_:1})]),_:1})):x("",!0),s.project.generation_progress?(n(),y(W,{key:3,border:"",class:"project-info-card"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"info",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(V,{icon:"tabler-info-circle"})]),_:1})]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(o)("projects.details.generation_status")),1)]),_:1})]),_:1}),e(ee),e(G,null,{default:t(()=>[i("div",xa,[i("div",null,[i("div",wa,l(a(o)("projects.details.requirements")),1),e(Te,{"model-value":s.project.generation_progress.requirements.status==="completed"?100:s.project.generation_progress.requirements.status==="in_progress"?50:s.project.generation_progress.requirements.status==="pending"?10:0,color:s.project.generation_progress.requirements.status==="completed"?"success":s.project.generation_progress.requirements.status==="in_progress"?"info":s.project.generation_progress.requirements.status==="failed"?"error":"warning",height:"8",rounded:""},null,8,["model-value","color"]),i("div",Va,[i("small",null,l(a(o)(`projects.details.${s.project.generation_progress.requirements.status}`)),1),i("small",null,l(s.project.requirements?s.project.requirements.length:0)+" "+l(a(o)("projects.details.requirements_count")),1)])]),i("div",null,[i("div",qa,l(a(o)("projects.details.user_stories")),1),e(Te,{"model-value":s.project.generation_progress.user_stories.total>0?s.project.generation_progress.user_stories.completed/s.project.generation_progress.user_stories.total*100:0,color:"info",height:"8",rounded:""},null,8,["model-value"]),i("div",Ca,[i("small",null,l(s.project.generation_progress.user_stories.completed)+" "+l(a(o)("projects.details.completed")),1),i("small",null,l(s.project.generation_progress.user_stories.total)+" "+l(a(o)("projects.details.total")),1)])]),i("div",null,[i("div",za,l(a(o)("projects.details.mockups")),1),i("div",Sa,[i("div",Ua,[e(Te,{"model-value":s.project.mockups&&s.project.mockups.length?s.project.mockups.filter(q=>q.generation_status==="completed"&&!q.needs_regeneration).length/s.project.mockups.length*100:0,color:"success",height:"8",rounded:""},null,8,["model-value"])]),i("div",null,[s.project.mockups&&s.project.mockups.some(q=>q.needs_regeneration||q.generation_status==="in_progress"||q.generation_status==="pending")?(n(),y(Y,{key:0,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(s.project.mockups.filter(q=>q.needs_regeneration||q.generation_status==="in_progress"||q.generation_status==="pending").length)+" "+l(a(o)("projects.details.pending")),1)]),_:1})):x("",!0)])])]),i("div",null,[i("div",Da,l(a(o)("projects.details.uml_diagrams")),1),e(Te,{"model-value":s.project.generation_progress.uml_diagrams.total>0?s.project.generation_progress.uml_diagrams.completed/s.project.generation_progress.uml_diagrams.total*100:0,color:"primary",height:"8",rounded:""},null,8,["model-value"]),i("div",Ia,[i("small",null,l(s.project.generation_progress.uml_diagrams.completed)+" "+l(a(o)("projects.details.completed")),1),i("small",null,l(s.project.generation_progress.uml_diagrams.total)+" "+l(a(o)("projects.details.total")),1)])])])]),_:1})]),_:1})):x("",!0)])]),_:1})]),_:1})]),_:1}))}},[["__scopeId","data-v-7dff8a18"]]),xt=Le({id:"RequirementStore",state:()=>({requirements:[],currentRequirement:null,loading:!1,error:null}),actions:{async fetchRequirements(s=null){this.loading=!0;try{let u="/service/requirements/";s&&(u+=`?project=${s}`);const o=await X.get(u);return o.status===200?(this.requirements=o.data,{data:o.data,error:null}):{data:[],error:o.data}}catch(u){return this.error=u.message||"Failed to fetch requirements",{data:[],error:this.error}}finally{this.loading=!1}},async fetchRequirementById(s){this.loading=!0;try{const u=await X.get(`/service/requirements/${s}/`);return u.status===200?(this.currentRequirement=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch requirement",{data:null,error:this.error}}finally{this.loading=!1}},async createRequirement(s){this.loading=!0;try{const u=await X.post("/service/requirements/",s);return u.status===201?(this.requirements.length&&this.requirements.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create requirement",{data:null,error:this.error}}finally{this.loading=!1}},async updateRequirement(s,u){this.loading=!0;try{const o=await X.put(`/service/requirements/${s}/`,u);if(o.status===200){if(this.requirements.length){const r=this.requirements.findIndex(f=>f.id===s);r!==-1&&(this.requirements[r]=o.data)}return this.currentRequirement&&this.currentRequirement.id===s&&(this.currentRequirement=o.data),{data:o.data,error:null}}return{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update requirement",{data:null,error:this.error}}finally{this.loading=!1}},async deleteRequirement(s){this.loading=!0;try{const u=await X.delete(`/service/requirements/${s}/`);return u.status===204?(this.requirements.length&&(this.requirements=this.requirements.filter(o=>o.id!==s)),this.currentRequirement&&this.currentRequirement.id===s&&(this.currentRequirement=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete requirement",{success:!1,error:this.error}}finally{this.loading=!1}},async createComment(s,u){this.loading=!0;try{const o=await X.post("/service/requirement-comments/",{requirement:s,text:u.text,status:u.status||"active",responsible_user:u.responsibleUser||null});return o.status===201?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(s){this.loading=!0;try{const u=await X.delete(`/service/requirement-comments/${s}/`);return u.status===204?{success:!0,error:null}:{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),Ge=Le("mockup",()=>{const s=z([]),u=z(!1),o=z(null);return{mockups:s,loading:u,error:o,fetchProjectMockups:async r=>{u.value=!0,o.value=null;try{const f=await X.get(`/service/projects/${r}/mockups/`);return s.value=f.data,f.data}catch(f){throw o.value="Failed to fetch mockups",console.error(f),f}finally{u.value=!1}},fetchMockupById:async r=>{u.value=!0,o.value=null;try{const f=await X.get(`/service/mockups/${r}/`),c=s.value.findIndex(_=>_.id===r);return c!==-1&&(s.value[c]=f.data),f}catch(f){throw o.value="Failed to fetch mockup",console.error(f),f}finally{u.value=!1}},regenerateMockup:async(r,f)=>{u.value=!0,o.value=null;try{const c=await X.post(`/service/mockups/${r}/regenerate/`,f),_=s.value.findIndex(g=>g.id===r);return _!==-1&&(s.value[_]=c.data),c.data}catch(c){throw o.value="Failed to regenerate mockup",console.error(c),c}finally{u.value=!1}},regenerateAllMockups:async r=>{u.value=!0,o.value=null;try{const f=await X.post(`/service/projects/${r}/regenerate-mockups/`);return s.value=f.data,f.data}catch(f){throw o.value="Failed to regenerate all mockups",console.error(f),f}finally{u.value=!1}},updateMockupById:async(r,f)=>{u.value=!0,o.value=null;try{return await X.put(`/service/mockups/${r}/`,f)}catch(c){throw o.value="Failed to update mockup",console.error(c),c}finally{u.value=!1}},deleteMockupById:async r=>{u.value=!0,o.value=null;try{return(await X.delete(`/service/mockups/${r}/`)).status===204}catch(f){throw o.value="Failed to delete mockup",console.error(f),f}finally{u.value=!1}}}}),Pa={key:0,class:"text-h5"},Ba={class:"text-h5"},$a={key:0,class:"ms-2 d-flex align-center"},Fa={class:"text-caption"},La={key:0},Ra={key:1},Oa={class:"mockup-metadata d-flex align-center px-6 py-3"},Aa={class:"d-flex align-center"},Ta={class:"text-caption"},Na={class:"d-flex align-center ms-4"},Ha={class:"text-caption"},Ya={key:0,class:"d-flex align-center ms-4"},Za={class:"text-caption"},Ja={key:1,class:"d-flex align-center ms-4"},Ka={class:"text-caption"},Ea={class:"mockup-content pa-0"},Ga={class:"text-h6 mb-2"},Wa={class:"text-body-1 text-medium-emphasis max-width-md text-center"},Qa=["srcdoc","title"],Xa={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},el={class:"text-h6 mb-2"},tl={class:"text-medium-emphasis text-center"},al={class:"text-body-1 mb-3"},ot=Ve({__name:"MockupPreviewDialog",props:{modelValue:{type:Boolean,default:!1},mockup:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=J({get:()=>o.modelValue,set:v=>u("update:modelValue",v)}),c=Ge(),_=z(!1),g=z(!1),k=z({...o.mockup}),q=z(!1),C=z(null),P=z(!1),B=z(""),D=z({show:!1,text:"",color:"success"}),I=J(()=>o.mockup.generation_status==="in_progress"||o.mockup.generation_status==="pending"||o.mockup.needs_regeneration),H=v=>v?(v=parseInt(v),new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",K=()=>{_.value=!_.value},N=()=>{g.value&&(k.value={...o.mockup}),g.value=!g.value},L=async()=>{q.value=!0;try{const{data:v,error:O}=await c.updateMockupById(o.mockup.id,{...k.value,needs_regeneration:!1});v&&!O?(A(r("projects.mockups.notifications.updated")),Object.assign(o.mockup,v),g.value=!1,f.value=!1):A(r("projects.mockups.notifications.update_failed"),"error")}catch(v){A(r("projects.mockups.notifications.update_error",{error:v.message}),"error")}finally{q.value=!1}},R=()=>{u("delete"),f.value=!1},T=async()=>{P.value=!0},S=async()=>{q.value=!0;try{o.mockup.user_story?await c.regenerateMockup(o.mockup.id,{user_story_id:o.mockup.user_story.id,feedback:B.value}):o.mockup.requirement?await c.regenerateMockup(o.mockup.id,{requirement_id:o.mockup.requirement.id,feedback:B.value}):await c.regenerateMockup(o.mockup.id,{feedback:B.value}),A(r("projects.mockups.notifications.regeneration_started")),P.value=!1,B.value="",f.value=!1,C.value=setInterval(le,5e3)}catch(v){A(r("projects.mockups.notifications.regeneration_error",{error:v.message}),"error")}finally{q.value=!1}},A=(v,O="success")=>{D.value={show:!0,text:v,color:O}},le=()=>{I.value&&f.value&&c.fetchMockupById(o.mockup.id).then(({data:v})=>{v&&Object.assign(o.mockup,v)})};return je(()=>o.mockup,v=>{k.value={...v}},{deep:!0}),qe(()=>{C.value=setInterval(le,5e3)}),Re(()=>{C.value&&clearInterval(C.value)}),(v,O)=>{const te=ye("IconBtn");return n(),y(xe,{modelValue:a(f),"onUpdate:modelValue":O[9]||(O[9]=j=>De(f)?f.value=j:null),fullscreen:_.value,"max-width":_.value?"100%":"900",scrollable:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[g.value?(n(),p("h5",Pa,l(a(r)("projects.mockups.actions.edit")),1)):(n(),p(Q,{key:1},[i("h5",Ba,l(s.mockup.name),1),e(Y,{color:a(he)(s.mockup.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${s.mockup.status}`)),1)]),_:1},8,["color"]),a(I)?(n(),p("div",$a,[e(ie,{indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"}),i("span",Fa,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating"):a(r)("projects.mockups.status.pending")),1)])):x("",!0)],64)),e(ae),e($,{icon:"",variant:"text",onClick:K},{default:t(()=>[e(V,{icon:_.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(te,{onClick:O[0]||(O[0]=j=>f.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(ee),e(G,{class:et({"pa-0":!g.value&&s.mockup.html_content,"pa-6":g.value||!s.mockup.html_content}),style:Pe({height:_.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:t(()=>[g.value?(n(),p("div",La,[e(Ie,{onSubmit:Ce(L,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:k.value.name,"onUpdate:modelValue":O[1]||(O[1]=j=>k.value.name=j),label:a(r)("projects.mockups.name"),required:"",rules:[j=>!!j||a(r)("projects.mockups.validation.name_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:k.value.status,"onUpdate:modelValue":O[2]||(O[2]=j=>k.value.status=j),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:k.value.html_content,"onUpdate:modelValue":O[3]||(O[3]=j=>k.value.html_content=j),label:a(r)("projects.mockups.html_content"),rows:"15",rules:[j=>!!j||a(r)("projects.mockups.validation.html_required")],monospace:""},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",Ra,[i("div",Oa,[i("div",Aa,[e(V,{icon:"tabler-calendar",class:"me-2",size:"18"}),i("span",Ta,l(a(r)("projects.details.created_at"))+": "+l(H(s.mockup.created_at)),1)]),i("div",Na,[e(V,{icon:"tabler-calendar-event",class:"me-2",size:"18"}),i("span",Ha,l(a(r)("projects.details.updated_at"))+": "+l(H(s.mockup.updated_at)),1)]),s.mockup.requirement?(n(),p("div",Ya,[e(V,{icon:"tabler-file-check",class:"me-2",size:"18"}),i("span",Za,l(a(r)("projects.details.requirement"))+": "+l(s.mockup.requirement_name),1)])):x("",!0),s.mockup.user_story?(n(),p("div",Ja,[e(V,{icon:"tabler-user-check",class:"me-2",size:"18"}),i("span",Ka,l(a(r)("projects.details.user_story"))+": "+l(s.mockup.user_story_name),1)])):x("",!0)]),e(ee),i("div",Ea,[a(I)?(n(),p("div",{key:0,class:"d-flex flex-column justify-center align-center",style:Pe({height:_.value?"calc(100vh - 180px)":"calc(70vh - 110px)"})},[e(ie,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),i("h4",Ga,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating"):a(r)("projects.mockups.status.preparing")),1),i("p",Wa,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating_description"):a(r)("projects.mockups.status.preparing_description")),1)],4)):s.mockup.html_content?(n(),p("iframe",{key:1,srcdoc:s.mockup.html_content,class:"mockup-iframe",style:Pe([{width:"100%",border:"none"},{height:_.value?"calc(100vh - 180px)":"calc(70vh - 110px)"}]),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",title:a(r)("projects.mockups.preview")},null,12,Qa)):(n(),p("div",Xa,[e(V,{icon:"tabler-code-off",size:"64",color:"secondary",class:"mb-4"}),i("h4",el,l(a(r)("projects.mockups.no_content.title")),1),i("p",tl,l(a(r)("projects.mockups.no_content.description")),1)]))])]))]),_:1},8,["class","style"]),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[g.value?(n(),p(Q,{key:0},[e($,{color:"secondary",variant:"tonal",onClick:N,disabled:q.value},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(ae),e($,{color:"primary",onClick:L,loading:q.value},{default:t(()=>[d(l(a(r)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),p(Q,{key:1},[s.isAdmin?(n(),y($,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:R},{default:t(()=>[d(l(a(r)("projects.actions.delete")),1)]),_:1})):x("",!0),s.hasManagerPermission?(n(),y($,{key:1,color:"warning",variant:"tonal","prepend-icon":"tabler-refresh",onClick:T,loading:a(I)||q.value,disabled:a(I),class:"ms-2"},{default:t(()=>[d(l(a(r)("projects.mockups.actions.regenerate")),1)]),_:1},8,["loading","disabled"])):x("",!0),e(ae),s.hasManagerPermission?(n(),y($,{key:2,class:"ms-2",color:"primary",variant:"tonal","prepend-icon":"tabler-code",onClick:N},{default:t(()=>[d(l(a(r)("projects.mockups.actions.edit")),1)]),_:1})):x("",!0)],64))]),_:1})]),_:1}),e(xe,{modelValue:P.value,"onUpdate:modelValue":O[6]||(O[6]=j=>P.value=j),"max-width":"600",persistent:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"pt-3 pb-0"},{default:t(()=>[d(l(a(r)("projects.mockups.regeneration.title")),1)]),_:1}),e(G,null,{default:t(()=>[i("p",al,l(a(r)("projects.mockups.regeneration.description")),1),e(be,{autofocus:"",modelValue:B.value,"onUpdate:modelValue":O[4]||(O[4]=j=>B.value=j),label:a(r)("projects.mockups.fields.feedback"),hint:a(r)("projects.mockups.placeholders.feedback"),"aria-placeholder":"t('projects.mockups.placeholders.feedback')",rows:"4",counter:""},null,8,["modelValue","label","hint"])]),_:1}),e(fe,null,{default:t(()=>[e($,{color:"secondary",variant:"tonal",onClick:O[5]||(O[5]=j=>P.value=!1)},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:S,loading:q.value},{default:t(()=>[d(l(a(r)("projects.mockups.actions.regenerate")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(we,{modelValue:D.value.show,"onUpdate:modelValue":O[8]||(O[8]=j=>D.value.show=j),color:D.value.color,timeout:5e3},{actions:t(()=>[e(te,{onClick:O[7]||(O[7]=j=>D.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(D.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-58eb46b3"]]),ll={key:0,class:"text-h5"},rl={key:1,class:"text-h5"},sl={key:0},ol={key:1},il={class:"d-flex align-center mb-5"},nl={class:"d-flex align-center"},cl={class:"text-medium-emphasis d-flex align-center"},ul={class:"text-caption me-4"},dl={class:"text-caption"},ml={class:"text-h4 mb-4"},pl={class:"text-body-1 whitespace-pre-wrap"},vl={key:0,class:"text-center pa-6"},fl={class:"text-h6 mb-2"},_l={class:"text-medium-emphasis mb-4"},gl={key:1},hl={class:"d-flex justify-space-between align-center mb-4"},yl={class:"text-h5"},bl={class:"mb-2"},jl={key:0,class:"mt-3"},kl={class:"text-subtitle-2"},xl={class:"pl-4"},wl={key:0},Vl={key:0,class:"text-center mt-4"},ql={key:0,class:"text-center pa-6"},Cl={class:"text-h6 mb-2"},zl={class:"text-medium-emphasis"},Sl={key:1},Ul={class:"d-flex align-center"},Dl={class:"mockup-preview mb-3"},Il={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Ml={key:0,class:"d-flex justify-center align-center h-100"},Pl={class:"text-center"},Bl={class:"text-caption"},$l={key:1,class:"html-preview"},Fl=["innerHTML"],Ll={key:2,class:"d-flex justify-center align-center h-100"},Rl={class:"preview-overlay d-flex justify-center align-center"},Ol={key:0,class:"mb-2"},Al={class:"d-flex align-center justify-space-between"},Tl={class:"d-flex align-center"},Nl={class:"text-caption"},Hl={key:0,class:"text-center pa-6"},Yl={class:"text-h6 mb-2"},Zl={class:"text-medium-emphasis"},Jl={key:1},Kl={class:"text-caption"},El={class:"text-caption text-medium-emphasis"},Gl={class:"d-flex align-center mb-2"},Wl={class:"text-caption"},Ql={class:"text-body-2 whitespace-pre-wrap"},Xl={class:"d-flex justify-end mt-2"},er={key:1,class:"text-center pa-6"},tr={class:"text-h6 mb-2"},ar={class:"text-medium-emphasis"},lr={key:2},rr={class:"d-flex align-center"},sr={class:"d-flex align-center"},or={class:"text-caption text-medium-emphasis ml-2"},ir={class:"comment-text mt-2 whitespace-pre-wrap"},nr=Ve({__name:"RequirementDetailsDialog",props:{modelValue:{type:Boolean,default:!1},requirement:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","view-user-stories"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=J({get:()=>o.modelValue,set:w=>u("update:modelValue",w)}),c=xt();Ge();const _=z(0),g=z(!1),k=z({...o.requirement}),q=z(""),C=z(!1),P=z({show:!1,text:"",color:"success"}),B=z(null),D=z(!1),I=z(null),H=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],K=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],N=[{title:r("projects.requirements.types.feature"),value:"feature"},{title:r("projects.requirements.types.constraint"),value:"constraint"},{title:r("projects.requirements.types.quality"),value:"quality"},{title:r("projects.requirements.types.interface"),value:"interface"},{title:r("projects.requirements.types.security"),value:"security"},{title:r("projects.requirements.types.performance"),value:"performance"},{title:r("projects.requirements.types.other"),value:"other"}],L=J(()=>o.requirement.history||[]),R=J(()=>o.requirement.comments||[]),T=J(()=>o.requirement.user_stories||[]),S=J(()=>o.requirement.mockups||[]),A=w=>w?(w=parseInt(w),new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",le=()=>{g.value&&(k.value={...o.requirement}),g.value=!g.value,_.value="0"},v=()=>{f.value&&c.fetchRequirementById(o.requirement.id).then(({data:w})=>{w&&Object.assign(o.requirement,w)})};qe(()=>{I.value=setInterval(v,5e3)}),Re(()=>{I.value&&clearInterval(I.value)});const O=()=>{u("update",k.value),g.value=!1,f.value=!1},te=()=>{u("delete"),f.value=!1},j=()=>{u("view-user-stories",o.requirement),f.value=!1},M=async()=>{if(q.value.trim()){C.value=!0;try{const{data:w,error:U}=await c.createComment(o.requirement.id,{text:q.value,status:"active"});if(w&&!U){Z(r("projects.requirements.notifications.comment_added")),q.value="";const{data:h}=await c.fetchRequirementById(o.requirement.id);h&&Object.assign(o.requirement,h)}else Z(r("projects.requirements.notifications.comment_add_failed"),"error")}catch(w){Z(r("projects.requirements.notifications.comment_add_failed")+": "+w.message,"error")}finally{C.value=!1}}},Z=(w,U="success")=>{P.value={show:!0,text:w,color:U}};je(()=>o.requirement,w=>{k.value={...w}},{deep:!0});const E=(w,U=150)=>{if(!w||w.length<=U)return w;const h=w.replace(/<[^>]*>/g,"");return h.length<=U?w:h.substring(0,U)+"..."};return(w,U)=>{const h=ye("IconBtn");return n(),y(xe,{modelValue:a(f),"onUpdate:modelValue":U[12]||(U[12]=m=>De(f)?f.value=m:null),"max-width":"900",scrollable:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[g.value?(n(),p("h5",ll,l(a(r)("projects.requirements.actions.edit")),1)):(n(),p("h5",rl,l(a(r)("projects.requirements.actions.view_details")),1)),e(ae),e(h,{onClick:U[0]||(U[0]=m=>f.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"pb-0"},{default:t(()=>[e(at,{modelValue:_.value,"onUpdate:modelValue":U[1]||(U[1]=m=>_.value=m),"slider-color":"primary","align-tabs":"start"},{default:t(()=>[e(pe,{value:"0"},{default:t(()=>[e(V,{size:"18",icon:"tabler-info-circle",start:""}),d(" "+l(a(r)("projects.requirements.tabs.details")),1)]),_:1}),e(pe,{value:"1"},{default:t(()=>[e(V,{size:"18",icon:"tabler-user-check",start:""}),d(" "+l(a(r)("projects.requirements.tabs.user_stories"))+" ",1),a(T).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(T).length),1)]),_:1})):x("",!0)]),_:1}),e(pe,{value:"2"},{default:t(()=>[e(V,{size:"18",icon:"tabler-photo",start:""}),d(" "+l(a(r)("projects.requirements.tabs.mockups"))+" ",1),a(S).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(S).length),1)]),_:1})):x("",!0)]),_:1}),e(pe,{value:"3"},{default:t(()=>[e(V,{size:"18",icon:"tabler-history",start:""}),d(" "+l(a(r)("projects.requirements.tabs.history"))+" ",1),a(L).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(L).length),1)]),_:1})):x("",!0)]),_:1}),e(pe,{value:"4"},{default:t(()=>[e(V,{size:"18",icon:"tabler-messages",start:""}),d(" "+l(a(r)("projects.requirements.tabs.comments"))+" ",1),a(R).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(R).length),1)]),_:1})):x("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(G,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:t(()=>[e(lt,{modelValue:_.value,"onUpdate:modelValue":U[8]||(U[8]=m=>_.value=m),class:"mt-5"},{default:t(()=>[e(ve,{value:"0"},{default:t(()=>[g.value?(n(),p("div",sl,[e(Ie,{onSubmit:Ce(O,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:k.value.title,"onUpdate:modelValue":U[2]||(U[2]=m=>k.value.title=m),label:a(r)("projects.requirements.title"),required:"",rules:[m=>!!m||a(r)("validation.required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:k.value.category,"onUpdate:modelValue":U[3]||(U[3]=m=>k.value.category=m),label:a(r)("projects.requirements.category"),items:H,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:k.value.requirement_type,"onUpdate:modelValue":U[4]||(U[4]=m=>k.value.requirement_type=m),label:a(r)("projects.requirements.type"),items:N,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:k.value.status,"onUpdate:modelValue":U[5]||(U[5]=m=>k.value.status=m),label:a(r)("projects.requirements.status"),items:K,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:k.value.description,"onUpdate:modelValue":U[6]||(U[6]=m=>k.value.description=m),label:a(r)("projects.requirements.description"),required:"",rows:"8",rules:[m=>!!m||a(r)("validation.required")]},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",ol,[i("div",il,[e(Y,{color:a(Qe)(s.requirement.category),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(r)(`projects.categories.${s.requirement.category}`)),1)]),_:1},8,["color"]),e(Y,{color:a(he)(s.requirement.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${s.requirement.status}`)),1)]),_:1},8,["color"]),e(Y,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(" v"+l(s.requirement.version_number),1)]),_:1}),s.requirement.requirement_type?(n(),y(Y,{key:0,color:"info",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)(`projects.requirements.types.${s.requirement.requirement_type}`)),1)]),_:1})):x("",!0),e(ae)]),i("div",nl,[i("div",cl,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",ul,l(a(r)("projects.details.updated_at"))+": "+l(A(s.requirement.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",dl,l(a(r)("projects.details.created_at"))+": "+l(A(s.requirement.created_at)),1)])]),i("h4",ml,l(s.requirement.title),1),i("div",pl,l(s.requirement.description),1)]))]),_:1}),e(ve,{value:"1"},{default:t(()=>[a(T).length===0?(n(),p("div",vl,[e(V,{icon:"tabler-user-check",size:"64",color:"secondary",class:"mb-3"}),i("h4",fl,l(a(r)("projects.requirements.user_stories.empty.title")),1),i("p",_l,l(a(r)("projects.requirements.user_stories.empty.description")),1),e($,{color:"primary",onClick:j},{default:t(()=>[d(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})])):(n(),p("div",gl,[i("div",hl,[i("h5",yl,l(a(r)("projects.requirements.user_stories.title")),1),e($,{color:"primary",variant:"tonal",onClick:j},{default:t(()=>[d(l(a(r)("projects.requirements.actions.view_all_stories")),1)]),_:1})]),(n(!0),p(Q,null,ne(a(T).slice(0,3),(m,ce)=>(n(),y(W,{key:m.id,class:"mb-4",border:""},{default:t(()=>[e(ue,null,{append:t(()=>[e(Y,{color:a(he)(m.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${m.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.requirements.user_stories.as_a",{role:m.role})),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>[i("p",bl,[i("strong",null,l(a(r)("projects.requirements.user_stories.i_want_to"))+":",1),d(" "+l(m.action),1)]),i("p",null,[i("strong",null,l(a(r)("projects.requirements.user_stories.so_that"))+":",1),d(" "+l(m.benefit),1)]),m.acceptance_criteria&&m.acceptance_criteria.length>0?(n(),p("div",jl,[i("div",kl,l(a(r)("projects.requirements.user_stories.acceptance_criteria"))+":",1),i("ul",xl,[(n(!0),p(Q,null,ne(m.acceptance_criteria.slice(0,2),(b,oe)=>(n(),p("li",{key:oe},l(b),1))),128)),m.acceptance_criteria.length>2?(n(),p("li",wl,l(a(r)("projects.requirements.user_stories.and_more",{count:m.acceptance_criteria.length-2})),1)):x("",!0)])])):x("",!0)]),_:2},1024)]),_:2},1024))),128)),a(T).length>3?(n(),p("div",Vl,[e($,{color:"primary",variant:"tonal",onClick:j},{default:t(()=>[d(l(a(r)("projects.requirements.actions.view_all_stories_count",{count:a(T).length})),1)]),_:1})])):x("",!0)]))]),_:1}),e(ve,{value:"2"},{default:t(()=>[a(S).length===0?(n(),p("div",ql,[e(V,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-3"}),i("h4",Cl,l(a(r)("projects.requirements.mockups.empty.title")),1),i("p",zl,l(a(r)("projects.requirements.mockups.empty.description")),1)])):(n(),p("div",Sl,[e(se,null,{default:t(()=>[(n(!0),p(Q,null,ne(a(S),m=>(n(),y(F,{key:m.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(W,{class:"mockup-card h-100",onClick:ce=>{B.value=m,D.value=!0},border:"",hover:""},{default:t(()=>[e(ue,null,{append:t(()=>[i("div",Ul,[m.generation_status==="in_progress"||m.generation_status==="pending"||m.needs_regeneration?(n(),y(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):x("",!0),e(Y,{color:a(he)(m.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${m.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(m.name),1)]),_:2},1024)]),_:2},1024),e(ee),e(G,null,{default:t(()=>[i("div",Dl,[i("div",Il,[m.generation_status==="in_progress"||m.generation_status==="pending"?(n(),p("div",Ml,[i("div",Pl,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",Bl,l(a(r)("projects.mockups.status.generating")),1)])])):m.html_content?(n(),p("div",$l,[i("div",{innerHTML:E(m.html_content)},null,8,Fl)])):(n(),p("div",Ll,[e(V,{icon:"tabler-file-code",size:"48",color:"secondary"})])),i("div",Rl,[e($,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:m.generation_status==="in_progress"||m.generation_status==="pending"},{default:t(()=>[d(l(a(r)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),m.needs_regeneration?(n(),p("div",Ol,[e(Y,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(r)("projects.mockups.status.regenerating")),1)]),_:1})])):x("",!0),i("div",Al,[i("div",Tl,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Nl,l(A(m.created_at)),1)])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"3"},{default:t(()=>[a(L).length===0?(n(),p("div",Hl,[e(V,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),i("h4",Yl,l(a(r)("projects.requirements.history.empty.title")),1),i("p",Zl,l(a(r)("projects.requirements.history.empty.description")),1)])):(n(),p("div",Jl,[e(jt,{density:"compact",align:"start"},{default:t(()=>[(n(!0),p(Q,null,ne(a(L),(m,ce)=>(n(),y(kt,{key:ce,"dot-color":"primary",size:"small"},{opposite:t(()=>[i("div",Kl,l(A(m.changed_at)),1),i("div",El,"v"+l(m.version_number),1)]),default:t(()=>[e(W,{border:""},{default:t(()=>[e(ue,null,{append:t(()=>[e(Y,{color:a(he)(m.status),size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)(`projects.status.${m.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(m.title),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>[i("div",Gl,[e(Y,{color:a(Qe)(m.category),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(r)(`projects.categories.${m.category}`)),1)]),_:2},1032,["color"]),i("span",Wl,l(a(r)("projects.requirements.history.changed_by"))+": "+l(m.changed_by?m.changed_by.username:a(r)("projects.requirements.history.unknown")),1)]),i("div",Ql,l(m.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"4"},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:q.value,"onUpdate:modelValue":U[7]||(U[7]=m=>q.value=m),label:a(r)("projects.requirements.comments.add"),rows:"3",counter:"",disabled:C.value},null,8,["modelValue","label","disabled"]),i("div",Xl,[e($,{color:"primary",size:"small",loading:C.value,disabled:!q.value.trim(),onClick:M},{default:t(()=>[d(l(a(r)("projects.requirements.comments.add_button")),1)]),_:1},8,["loading","disabled"])])]),_:1}),e(F,{cols:"12"},{default:t(()=>[a(R).length?(n(),y(ee,{key:0,class:"mb-4"})):x("",!0),a(R).length===0?(n(),p("div",er,[e(V,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),i("h4",tr,l(a(r)("projects.requirements.comments.empty.title")),1),i("p",ar,l(a(r)("projects.requirements.comments.empty.description")),1)])):(n(),p("div",lr,[(n(!0),p(Q,null,ne(a(R),m=>(n(),p("div",{key:m.id,class:"comment-item mb-4"},[e(W,{border:""},{default:t(()=>[e(G,{class:"py-2"},{default:t(()=>[i("div",rr,[e(Se,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:t(()=>[e(V,{icon:"tabler-user"})]),_:1}),i("div",null,[i("div",sr,[i("strong",null,l(m.user?m.user.username:a(r)("projects.requirements.comments.unknown_user")),1),i("div",or,l(A(m.created_at)),1)])]),e(ae),s.isAdmin||s.hasManagerPermission?(n(),y(h,{key:0,size:"small",color:"error",variant:"text",onClick:ce=>(async b=>{C.value=!0;try{const{success:oe,error:ke}=await c.deleteComment(b);if(oe&&!ke){Z(r("projects.requirements.notifications.comment_deleted"));const{data:me}=await c.fetchRequirementById(o.requirement.id);me&&Object.assign(o.requirement,me)}else Z(r("projects.requirements.notifications.comment_delete_failed"),"error")}catch(oe){Z(r("projects.requirements.notifications.comment_delete_failed")+": "+oe.message,"error")}finally{C.value=!1}})(m.id),disabled:C.value},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):x("",!0)]),i("div",ir,l(m.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[g.value?(n(),p(Q,{key:0},[e($,{color:"secondary",variant:"tonal",onClick:le},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:O},{default:t(()=>[d(l(a(r)("projects.actions.save")),1)]),_:1})],64)):(n(),p(Q,{key:1},[s.isAdmin?(n(),y($,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:te},{default:t(()=>[d(l(a(r)("projects.requirements.actions.delete")),1)]),_:1})):x("",!0),s.hasModeratorPermission&&a(T).length===0?(n(),y($,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-user-check",class:"ms-2",onClick:j},{default:t(()=>[d(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})):x("",!0),e(ae),s.hasModeratorPermission?(n(),y($,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:le},{default:t(()=>[d(l(a(r)("projects.requirements.actions.edit")),1)]),_:1})):x("",!0)],64))]),_:1})]),_:1}),e(we,{modelValue:P.value.show,"onUpdate:modelValue":U[10]||(U[10]=m=>P.value.show=m),color:P.value.color,timeout:5e3},{actions:t(()=>[e(h,{onClick:U[9]||(U[9]=m=>P.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(P.value.text)+" ",1)]),_:1},8,["modelValue","color"]),B.value?(n(),y(ot,{key:0,modelValue:D.value,"onUpdate:modelValue":U[11]||(U[11]=m=>D.value=m),mockup:B.value,"is-admin":s.isAdmin,"has-manager-permission":s.hasManagerPermission},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):x("",!0)]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-1f023d99"]]),cr={class:"text-h5"},ur={__name:"RequirementCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},requirementData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=J({get:()=>o.modelValue,set:I=>u("update:modelValue",I)}),c=z({title:o.editMode&&o.requirementData?o.requirementData.title:"",description:o.editMode&&o.requirementData?o.requirementData.description:"",category:o.editMode&&o.requirementData?o.requirementData.category:"functional",status:o.editMode&&o.requirementData?o.requirementData.status:"draft"}),_=[I=>!!I||r("validation.required"),I=>I.length<=255||r("projects.requirements.validation.title_length")],g=[I=>!!I||r("validation.required")],k=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],q=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],C=z(null),P=()=>{c.value={title:"",description:"",category:"functional",status:"draft"},C.value&&C.value.resetValidation()},B=()=>{f.value=!1,P()},D=async()=>{const{valid:I}=await C.value.validate();I&&(u("submit",c.value),f.value=!1,P())};return je(f,I=>{I||P()}),(I,H)=>{const K=ye("IconBtn");return n(),y(xe,{modelValue:a(f),"onUpdate:modelValue":H[4]||(H[4]=N=>De(f)?f.value=N:null),"max-width":"700",persistent:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[i("h5",cr,l(o.editMode?a(r)("projects.requirements.actions.edit"):a(r)("projects.requirements.actions.add")),1),e(ae),e(K,{onClick:B},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"px-5 pt-4"},{default:t(()=>[e(Ie,{ref_key:"formRef",ref:C,onSubmit:Ce(D,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.title,"onUpdate:modelValue":H[0]||(H[0]=N=>c.value.title=N),label:a(r)("projects.requirements.title"),rules:_,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.category,"onUpdate:modelValue":H[1]||(H[1]=N=>c.value.category=N),label:a(r)("projects.requirements.category"),items:k,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.status,"onUpdate:modelValue":H[2]||(H[2]=N=>c.value.status=N),label:a(r)("projects.requirements.status"),items:q,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:c.value.description,"onUpdate:modelValue":H[3]||(H[3]=N=>c.value.description=N),label:a(r)("projects.requirements.description"),rules:g,required:"",rows:"6"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[e($,{variant:"tonal",color:"secondary",onClick:B},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:D},{default:t(()=>[d(l(o.editMode?a(r)("projects.actions.update"):a(r)("projects.actions.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};function Ae(s){return{all:s=s||new Map,on:function(u,o){var r=s.get(u);r?r.push(o):s.set(u,[o])},off:function(u,o){var r=s.get(u);r&&(o?r.splice(r.indexOf(o)>>>0,1):s.set(u,[]))},emit:function(u,o){var r=s.get(u);r&&r.slice().map(function(f){f(o)}),(r=s.get("*"))&&r.slice().map(function(f){f(u,o)})}}}const dr={key:0,class:"mb-4"},mr={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},pr={key:2,class:"text-center pa-4"},vr={class:"text-h6 mb-2"},fr={class:"text-body-1 text-medium-emphasis mb-6"},_r={class:"d-flex align-center"},gr={class:"text-body-2 mb-3"},hr={class:"d-flex align-center justify-space-between mb-2"},yr={class:"d-flex align-center"},br={class:"text-caption text-capitalize"},jr={class:"d-flex align-center"},kr={class:"text-caption"},xr={class:"d-flex align-center"},wr={class:"text-caption"},Vr={key:0,class:"mt-3"},qr={__name:"ProjectRequirementsList",props:{projectId:{type:String,required:!0},requirements:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh","view-user-stories"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=xt(),c=Be(),_=z(""),g=z([]),k=z(["draft","active","completed"]),q=z(null),C=z(!1),P=z(!1),B=z(!1),D=z(!1),I=z({show:!1,text:"",color:"success"}),H=J(()=>c.is_admin()),K=J(()=>c.userData.role>=2),N=J(()=>c.userData.role>=3),L=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],R=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],T=J(()=>o.requirements.filter(Z=>{const E=!_.value||Z.title.toLowerCase().includes(_.value.toLowerCase())||Z.description.toLowerCase().includes(_.value.toLowerCase()),w=g.value.length===0||g.value.includes(Z.category),U=k.value.includes(Z.status);return E&&w&&U})),S=Ae(),A=()=>{P.value=!0},le=async Z=>{D.value=!0;try{const{data:E,error:w}=await f.createRequirement({...Z,project:o.projectId});E&&!w?(j("projects.requirements.notifications.created"),u("refresh")):j("projects.requirements.notifications.create_failed","error")}catch{j("projects.requirements.notifications.create_failed","error")}finally{D.value=!1}},v=async Z=>{D.value=!0;try{const{data:E,error:w}=await f.updateRequirement(q.value.id,Z);E&&!w?(j("projects.requirements.notifications.updated"),u("refresh")):j("projects.requirements.notifications.update_failed","error")}catch{j("projects.requirements.notifications.update_failed","error")}finally{D.value=!1}},O=async()=>{if(q.value){D.value=!0,B.value=!1;try{const{success:Z,error:E}=await f.deleteRequirement(q.value.id);Z&&!E?(j("projects.requirements.notifications.deleted"),u("refresh"),C.value=!1):j("projects.requirements.notifications.delete_failed","error")}catch{j("projects.requirements.notifications.delete_failed","error")}finally{D.value=!1}}},te=Z=>{u("view-user-stories",Z)},j=(Z,E="success")=>{I.value={show:!0,text:r(Z),color:E}},M=(Z,E=120)=>!Z||Z.length<=E?Z:Z.substring(0,E)+"...";return qe(()=>{S.on("project-refresh",()=>{f.fetchRequirements(o.projectId,{silent:!0}).then(({data:Z})=>{Z&&u("refresh")})})}),je(C,Z=>{Z?S.on("project-refresh",async()=>{if(q.value){const{data:E}=await f.fetchRequirement(q.value.id);E&&(q.value=E)}}):S.off("project-refresh")}),(Z,E)=>{const w=Oe,U=ye("IconBtn");return n(),y(G,{class:"pa-6"},{default:t(()=>[Z.anyRequirementInProgress?(n(),p("div",dr,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})])):x("",!0),e(se,null,{default:t(()=>[e(F,{cols:"12",md:"4"},{default:t(()=>[e(de,{modelValue:_.value,"onUpdate:modelValue":E[0]||(E[0]=h=>_.value=h),density:"compact",placeholder:a(r)("projects.requirements.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(F,{cols:"12",md:"3"},{default:t(()=>[e(_e,{modelValue:g.value,"onUpdate:modelValue":E[1]||(E[1]=h=>g.value=h),items:L,density:"compact","hide-details":"",label:a(r)("projects.requirements.actions.category"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"3"},{default:t(()=>[e(_e,{modelValue:k.value,"onUpdate:modelValue":E[2]||(E[2]=h=>k.value=h),items:R,density:"compact","hide-details":"",label:a(r)("projects.requirements.actions.status"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[a(N)?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:A,loading:D.value,block:""},{default:t(()=>[d(l(a(r)("projects.requirements.actions.add")),1)]),_:1},8,["loading"])):x("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),s.loading?(n(),p("div",mr,[e(ie,{indeterminate:"",color:"primary"})])):a(T).length===0?(n(),p("div",pr,[e(V,{icon:"tabler-file-search",size:"64",color:"secondary",class:"mb-4"}),i("h4",vr,l(a(r)("projects.requirements.empty.title")),1),i("p",fr,l(_.value||g.value.length>0||k.value.length>0?a(r)("projects.requirements.empty.filtered"):a(r)("projects.requirements.empty.no_requirements")),1),a(N)&&!_.value&&g.value.length===0&&k.value.length===0?(n(),y($,{key:0,color:"primary",onClick:A,"prepend-icon":"tabler-plus"},{default:t(()=>[d(l(a(r)("projects.requirements.actions.add_requirement")),1)]),_:1})):x("",!0)])):(n(),y(se,{key:3},{default:t(()=>[(n(!0),p(Q,null,ne(a(T),h=>(n(),y(F,{key:h.id,cols:"12"},{default:t(()=>[e(W,{class:"requirement-card",onClick:m=>(async ce=>{const{data:b}=await f.fetchRequirement(ce.id);q.value=b||ce,C.value=!0})(h),border:"",hover:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:a(Qe)(h.category),variant:"tonal",size:"42"},{default:t(()=>[h.category==="functional"?(n(),y(V,{key:0,icon:"tabler-function"})):h.category==="nonfunctional"?(n(),y(V,{key:1,icon:"tabler-chart-bar"})):h.category==="uiux"?(n(),y(V,{key:2,icon:"tabler-palette"})):(n(),y(V,{key:3,icon:"tabler-file-description"}))]),_:2},1032,["color"])]),append:t(()=>[i("div",_r,[h.user_stories&&h.user_stories.some(m=>m.generation_status==="in_progress"||m.generation_status==="pending")||h.mockups&&h.mockups.some(m=>m.generation_status==="in_progress"||m.generation_status==="pending"||m.needs_regeneration)?(n(),y(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):x("",!0),h.user_stories&&h.user_stories.some(m=>m.generation_status==="pending")||h.mockups&&h.mockups.some(m=>m.generation_status==="pending"||m.needs_regeneration)?(n(),y(Y,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})):x("",!0),e(Y,{color:a(he)(h.status),size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${h.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(h.handle)+" "+l(h.title),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>{return[i("p",gr,l(M(h.description)),1),i("div",hr,[i("div",yr,[e(V,{size:"16",icon:"tabler-tag",class:"me-1"}),i("span",br,l(a(r)(`projects.categories.${h.category}`)),1)]),i("div",jr,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",kr,l((m=h.updated_at,m?(m=parseInt(m),new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"")),1)]),i("div",xr,[e(V,{size:"16",icon:"tabler-history",class:"me-1"}),i("span",wr,"v"+l(h.version_number),1)])]),h.user_stories&&h.user_stories.length>0?(n(),p("div",Vr,[e($,{size:"small",variant:"tonal",color:"primary","prepend-icon":"tabler-user-check",onClick:Ce(ce=>te(h),["stop"])},{default:t(()=>[d(l(h.user_stories.length)+" "+l(a(r)(h.user_stories.length===1?"projects.requirements.user_stories.single":"projects.requirements.user_stories.multiple")),1)]),_:2},1032,["onClick"])])):x("",!0)];var m}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),q.value?(n(),y(nr,{key:4,modelValue:C.value,"onUpdate:modelValue":E[3]||(E[3]=h=>C.value=h),requirement:q.value,onDelete:E[4]||(E[4]=h=>B.value=!0),onUpdate:v,onViewUserStories:te,"is-admin":a(H),"has-manager-permission":a(K),"has-moderator-permission":a(N)},null,8,["modelValue","requirement","is-admin","has-manager-permission","has-moderator-permission"])):x("",!0),e(ur,{modelValue:P.value,"onUpdate:modelValue":E[5]||(E[5]=h=>P.value=h),onSubmit:le},null,8,["modelValue"]),e(w,{isDialogVisible:B.value,"onUpdate:isDialogVisible":E[6]||(E[6]=h=>B.value=h),confirmationMsg:a(r)("projects.requirements.delete_confirm.message"),onConfirm:O},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:I.value.show,"onUpdate:modelValue":E[8]||(E[8]=h=>I.value.show=h),color:I.value.color,timeout:5e3},{actions:t(()=>[e(U,{onClick:E[7]||(E[7]=h=>I.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(I.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Cr=Ve(qr,[["__scopeId","data-v-da84999d"]]),zr={key:0,class:"mb-4"},Sr={class:"d-flex align-center"},Ur={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},Dr={key:2,class:"text-center pa-4"},Ir={class:"text-h6 mb-2"},Mr={class:"text-body-1 text-medium-emphasis mb-6"},Pr={class:"d-flex align-center"},Br={class:"mockup-preview mb-3"},$r={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Fr={key:0,class:"d-flex justify-center align-center h-100"},Lr={class:"text-center"},Rr={class:"text-caption"},Or={key:1,class:"html-preview"},Ar={key:2,class:"d-flex justify-center align-center h-100"},Tr={class:"preview-overlay d-flex justify-center align-center"},Nr={key:0,class:"mb-2"},Hr={key:1,class:"mb-2"},Yr={class:"text-caption font-weight-medium"},Zr={key:2,class:"mb-2"},Jr={class:"text-caption font-weight-medium"},Kr={class:"d-flex align-center justify-space-between"},Er={class:"d-flex align-center"},Gr={class:"text-caption"},Wr={__name:"ProjectMockupsList",props:{projectId:{type:String,required:!0},mockups:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,r=Ge(),f=Be(),{t:c}=ge(),_=z(""),g=z(null),k=z(!1),q=z(!1),C=z(!1);z(null);const P=z({show:!1,text:"",color:"success"}),B=J(()=>f.is_admin()),D=J(()=>f.userData.role>=2);J(()=>f.userData.role>=3);const I=J(()=>o.mockups.filter(T=>T.needs_regeneration||T.generation_status==="in_progress"||T.generation_status==="pending").length),H=J(()=>o.mockups.filter(T=>!_.value||T.name.toLowerCase().includes(_.value.toLowerCase())||T.requirement&&T.requirement.toLowerCase().includes(_.value.toLowerCase()))),K=Ae(),N=async()=>{if(g.value){C.value=!0,q.value=!1;try{const{success:T,error:S}=await r.deleteMockupById(g.value.id);T&&!S?(L(c("projects.mockups.notifications.deleted")),u("refresh"),k.value=!1):L(c("projects.mockups.notifications.delete_failed"),"error")}catch(T){L(c("projects.mockups.notifications.delete_failed")+": "+T.message,"error")}finally{C.value=!1}}},L=(T,S="success")=>{P.value={show:!0,text:T,color:S}},R=J(()=>o.mockups.some(T=>T.generation_status==="in_progress"||T.generation_status==="pending"||T.needs_regeneration));return qe(()=>{K.on("project-refresh",()=>{r.fetchProjectMockups(o.projectId).then(({data:T})=>{T&&u("refresh")})})}),je(k,T=>{T?K.on("project-refresh",async()=>{if(g.value){const{data:S}=await r.fetchMockupById(g.value.id);S&&(g.value=S)}}):K.off("project-refresh")}),(T,S)=>{const A=Oe,le=ye("IconBtn");return n(),y(G,{class:"pa-6"},{default:t(()=>[a(R)?(n(),p("div",zr,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(c)("projects.mockups.status.generating")),1)]),_:1})])):x("",!0),e(se,null,{default:t(()=>[e(F,{cols:"12",md:"6"},{default:t(()=>[e(de,{modelValue:_.value,"onUpdate:modelValue":S[0]||(S[0]=v=>_.value=v),density:"compact",placeholder:a(c)("projects.mockups.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(F,{cols:"12",md:"6",class:"d-flex align-center"},{default:t(()=>[a(I)>0?(n(),y(Ue,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-0 flex-grow-1 me-2"},{default:t(()=>[i("div",Sr,[e(ie,{indeterminate:"",color:"info",size:"16",width:"2",class:"me-2"}),i("span",null,l(a(I))+" "+l(a(c)("projects.mockups.status.pending_count")),1)])]),_:1})):x("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),s.loading?(n(),p("div",Ur,[e(ie,{indeterminate:"",color:"primary"})])):a(H).length===0?(n(),p("div",Dr,[e(V,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-4"}),i("h4",Ir,l(a(c)("projects.mockups.empty.title")),1),i("p",Mr,l(_.value?a(c)("projects.mockups.empty.filtered"):a(c)("projects.mockups.empty.description")),1)])):(n(),y(se,{key:3},{default:t(()=>[(n(!0),p(Q,null,ne(a(H),v=>(n(),y(F,{key:v.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(W,{class:"mockup-card h-100",onClick:O=>(async te=>{const{data:j}=await r.fetchMockupById(te.id);g.value=j||te,k.value=!0})(v),border:"",hover:""},{default:t(()=>[e(ue,null,{append:t(()=>[i("div",Pr,[v.generation_status==="in_progress"||v.generation_status==="pending"||v.needs_regeneration?(n(),y(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):x("",!0),v.generation_status==="pending"||v.needs_regeneration?(n(),y(Y,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.mockups.status.generating")),1)]),_:1})):x("",!0),e(Y,{color:a(he)(v.status),size:"small",label:""},{default:t(()=>[d(l(a(c)(`projects.status.${v.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(v.name),1)]),_:2},1024)]),_:2},1024),e(ee),e(G,null,{default:t(()=>{return[i("div",Br,[i("div",$r,[v.generation_status==="in_progress"||v.generation_status==="pending"?(n(),p("div",Fr,[i("div",Lr,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",Rr,l(a(c)("projects.mockups.status.generating")),1)])])):v.image?(n(),p("div",Or,[e(tt,{src:v.image,alt:v.name},null,8,["src","alt"])])):(n(),p("div",Ar,[e(V,{icon:"tabler-file-code",size:"48",color:"secondary"})])),i("div",Tr,[e($,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:v.generation_status==="in_progress"||v.generation_status==="pending"},{default:t(()=>[d(l(a(c)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),v.needs_regeneration?(n(),p("div",Nr,[e(Y,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.mockups.status.regenerating")),1)]),_:1})])):x("",!0),v.requirement?(n(),p("div",Hr,[i("span",Yr,l(a(c)("projects.details.requirement"))+": ",1),e(Y,{size:"x-small",color:"primary",class:"ms-1"},{default:t(()=>[d(l(v.requirement_name),1)]),_:2},1024)])):x("",!0),v.user_story?(n(),p("div",Zr,[i("span",Jr,l(a(c)("projects.details.user_story"))+": ",1),e(Y,{size:"x-small",color:"primary",class:"ms-1"},{default:t(()=>[d(l(v.user_story_name),1)]),_:2},1024)])):x("",!0),i("div",Kr,[i("div",Er,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Gr,l((O=v.created_at,O?new Date(parseInt(O)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1)])])];var O}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),g.value?(n(),y(ot,{key:4,modelValue:k.value,"onUpdate:modelValue":S[1]||(S[1]=v=>k.value=v),mockup:g.value,onDelete:S[2]||(S[2]=v=>q.value=!0),"is-admin":a(B),"has-manager-permission":a(D)},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):x("",!0),e(A,{isDialogVisible:q.value,"onUpdate:isDialogVisible":S[3]||(S[3]=v=>q.value=v),confirmationMsg:a(c)("projects.mockups.delete_confirm.message"),onConfirm:N},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:P.value.show,"onUpdate:modelValue":S[5]||(S[5]=v=>P.value.show=v),color:P.value.color,timeout:5e3},{actions:t(()=>[e(le,{onClick:S[4]||(S[4]=v=>P.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(P.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Qr=Ve(Wr,[["__scopeId","data-v-9e73564e"]]),wt=Le({id:"DevelopmentPlanStore",state:()=>({plans:[],currentPlan:null,loading:!1,error:null}),actions:{async fetchDevelopmentPlans(s=null){this.loading=!0;try{let u="/service/development-plans/";s&&(u+=`?project=${s}`);const o=await X.get(u);return o.status===200?(this.plans=o.data,{data:o.data,error:null}):{data:[],error:o.data}}catch(u){return this.error=u.message||"Failed to fetch development plans",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDevelopmentPlanById(s){this.loading=!0;try{const u=await X.get(`/service/development-plans/${s}/`);return u.status===200?(this.currentPlan=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createDevelopmentPlan(s){this.loading=!0;try{const u=await X.post("/service/development-plans/",{project:s,status:"draft"});return u.status===201?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create development plan",{data:null,error:this.error}}finally{this.loading=!1}},async updateDevelopmentPlan(s,u){this.loading=!0;try{const o=await X.put(`/service/development-plans/${s}/`,u);return o.status===200?(this.currentPlan&&this.currentPlan.id===s&&(this.currentPlan=o.data),{data:o.data,error:null}):{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createPlanVersion(s,u){this.loading=!0;try{const o=await X.post(`/service/development-plans/${s}/new_version/`,u);return o.status===201?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to create plan version",{data:null,error:this.error}}finally{this.loading=!1}},async fetchPlanVersionById(s){this.loading=!0;try{const u=await X.get(`/service/development-plan-versions/${s}/`);return u.status===200?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch plan version",{data:null,error:this.error}}finally{this.loading=!1}},async updatePlanVersion(s,u){this.loading=!0;try{const o=await X.put(`/service/development-plan-versions/${s}/`,u);return o.status===200?{data:o.data,error:null}:{data:null,error:o.data}}catch(o){return this.error=o.message||"Failed to update plan version",{data:null,error:this.error}}finally{this.loading=!1}},async setCurrentPlanVersion(s,u){this.loading=!0;try{const o=await this.fetchDevelopmentPlanById(s);if(!o.data)return{data:null,error:"Plan not found"};const r=await this.fetchPlanVersionById(u);return r.data?await this.updateDevelopmentPlan(s,{current_version_number:r.data.version_number,status:o.data.status}):{data:null,error:"Version not found"}}catch(o){return this.error=o.message||"Failed to set current plan version",{data:null,error:this.error}}finally{this.loading=!1}}}}),Xr={key:0,class:"text-h5"},es={key:1,class:"text-h5"},ts={key:0},as={class:"text-subtitle-1 font-weight-bold mb-2"},ls={key:1},rs={class:"d-flex flex-wrap justify-space-between mb-4"},ss={class:"d-flex align-center"},os={class:"d-flex align-center"},is={class:"text-caption"},ns={key:0,class:"text-caption ms-3"},cs={class:"text-h4 font-weight-bold"},us={class:"text-caption text-medium-emphasis text-right"},ds={class:"text-right"},ms={class:"text-right"},ps={class:"text-right"},vs={class:"text-right"},fs={key:0},_s={colspan:"3",class:"text-center"},gs={class:"text-body-1 whitespace-pre-wrap"},hs=Ve({__name:"PlanVersionDialog",props:{modelValue:{type:Boolean,default:!1},version:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},planId:{type:String,default:null}},emits:["update:modelValue","refresh"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=J({get:()=>o.modelValue,set:L=>u("update:modelValue",L)}),c=wt(),_=z(!1),g=z({...o.version}),k=z(!1),q=z({show:!1,text:"",color:"success"}),C=z(null),P=L=>L||L===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(L):"-",B=()=>{_.value&&(g.value={...o.version}),_.value=!_.value},D=()=>{f.value&&c.fetchPlanVersionById(o.version.id).then(({data:L})=>{L&&Object.assign(o.version,L)})};qe(()=>{C.value=setInterval(D,5e3)}),Re(()=>{C.value&&clearInterval(C.value)});const I=async()=>{k.value=!0;try{const{data:L,error:R}=await c.updatePlanVersion(o.version.id,g.value);L&&!R?(N(r("projects.development_plan.notifications.version_updated")),Object.assign(o.version,L),_.value=!1,f.value=!1,u("refresh")):N(r("projects.development_plan.notifications.version_update_failed"),"error")}catch(L){N(r("projects.development_plan.notifications.version_update_failed")+": "+L.message,"error")}finally{k.value=!1}},H=async()=>{if(o.planId){k.value=!0;try{const{data:L,error:R}=await c.setCurrentPlanVersion(o.planId,o.version.id);L&&!R?(N(r("projects.development_plan.notifications.set_current_success")),f.value=!1,u("refresh")):N(r("projects.development_plan.notifications.set_current_failed"),"error")}catch(L){N(r("projects.development_plan.notifications.set_current_failed")+": "+L.message,"error")}finally{k.value=!1}}},K=L=>{if(!L)return[];try{return typeof L=="string"?JSON.parse(L):L}catch(R){return console.error("Error parsing roles and hours:",R),[]}},N=(L,R="success")=>{q.value={show:!0,text:L,color:R}};return je(()=>o.version,L=>{g.value={...L}},{deep:!0}),(L,R)=>{const T=ye("IconBtn");return n(),y(xe,{modelValue:a(f),"onUpdate:modelValue":R[7]||(R[7]=S=>De(f)?f.value=S:null),"max-width":"900",scrollable:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[_.value?(n(),p("h5",Xr,l(a(r)("projects.development_plan.actions.edit")),1)):(n(),p("h5",es,[d(l(a(r)("projects.development_plan.version.version"))+" "+l(s.version.version_number)+" ",1),s.isCurrent?(n(),y(Y,{key:0,color:"primary",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)("projects.development_plan.version.current")),1)]),_:1})):x("",!0)])),e(ae),e(T,{onClick:R[0]||(R[0]=S=>f.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(ee),e(G,{class:"pa-6"},{default:t(()=>[_.value?(n(),p("div",ts,[e(Ie,{onSubmit:Ce(I,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12",md:"4"},{default:t(()=>[e(de,{modelValue:g.value.estimated_cost,"onUpdate:modelValue":R[1]||(R[1]=S=>g.value.estimated_cost=S),modelModifiers:{number:!0},label:a(r)("projects.development_plan.estimated_cost"),type:"number",required:"",rules:[S=>!!S||a(r)("projects.development_plan.validation.estimated_cost_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:g.value.status,"onUpdate:modelValue":R[2]||(R[2]=S=>g.value.status=S),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:g.value.notes,"onUpdate:modelValue":R[3]||(R[3]=S=>g.value.notes=S),label:a(r)("projects.development_plan.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[i("p",as,l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1),e(be,{modelValue:g.value.roles_and_hours,"onUpdate:modelValue":R[4]||(R[4]=S=>g.value.roles_and_hours=S),label:a(r)("projects.development_plan.roles_hours"),rows:"8",monospace:"",hint:a(r)("projects.development_plan.roles_hours_hint"),"persistent-hint":""},null,8,["modelValue","label","hint"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",ls,[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>{return[i("div",rs,[i("div",ss,[e(Y,{color:a(he)(s.version.status),size:"small",label:""},{default:t(()=>[d(l(It(s.version.status)),1)]),_:1},8,["color"])]),i("div",os,[i("span",is,l(a(r)("projects.development_plan.version.created"))+": "+l((S=s.version.created_at,S?new Date(parseInt(S)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1),s.version.created_by?(n(),p("span",ns,l(a(r)("projects.development_plan.version.created_by"))+": "+l(s.version.created_by.username),1)):x("",!0)]),i("div",null,[i("h4",cs,l(P(s.version.estimated_cost)),1),i("div",us,l(a(r)("projects.development_plan.version.estimated_total_cost")),1)])])];var S}),_:1}),e(F,{cols:"12"},{default:t(()=>[e(W,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1)]),_:1}),e(G,null,{default:t(()=>[e(Ze,null,{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(r)("projects.development_plan.version.role")),1),i("th",ds,l(a(r)("projects.development_plan.version.hours")),1),i("th",ms,l(a(r)("projects.development_plan.version.cost")),1)])]),i("tbody",null,[(n(!0),p(Q,null,ne(K(s.version.roles_and_hours),(S,A)=>(n(),p("tr",{key:A},[i("td",null,l(S.role),1),i("td",ps,l(S.hours),1),i("td",vs,l(P(S.cost)),1)]))),128)),K(s.version.roles_and_hours).length===0?(n(),p("tr",fs,[i("td",_s,l(a(r)("projects.development_plan.version.no_roles")),1)])):x("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),s.version.notes?(n(),y(F,{key:0,cols:"12"},{default:t(()=>[e(W,{variant:"outlined"},{default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.development_plan.notes")),1)]),_:1}),e(G,null,{default:t(()=>[i("div",gs,l(s.version.notes),1)]),_:1})]),_:1})]),_:1})):x("",!0)]),_:1})]))]),_:1}),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[_.value?(n(),p(Q,{key:0},[e($,{color:"secondary",variant:"tonal",onClick:B,disabled:k.value},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(ae),e($,{color:"primary",onClick:I,loading:k.value},{default:t(()=>[d(l(a(r)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),p(Q,{key:1},[!s.isCurrent&&s.hasManagerPermission?(n(),y($,{key:0,color:"primary",variant:"tonal",onClick:H,loading:k.value,"prepend-icon":"tabler-check"},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.set_current")),1)]),_:1},8,["loading"])):x("",!0),e(ae),s.hasManagerPermission?(n(),y($,{key:1,color:"primary","prepend-icon":"tabler-edit",onClick:B},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.edit")),1)]),_:1})):x("",!0)],64))]),_:1})]),_:1}),e(we,{modelValue:q.value.show,"onUpdate:modelValue":R[6]||(R[6]=S=>q.value.show=S),color:q.value.color,timeout:5e3},{actions:t(()=>[e(T,{onClick:R[5]||(R[5]=S=>q.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(q.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-20fb9f39"]]),ys={class:"text-h5"},bs={class:"text-subtitle-1 mb-4"},js={__name:"PlanVersionCreateDialog",props:{modelValue:{type:Boolean,default:!1},planId:{type:String,required:!0},currentVersionNumber:{type:Number,default:0}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=J({get:()=>o.modelValue,set:B=>u("update:modelValue",B)}),c=z({roles_and_hours:'[{"role": "Project Manager", "hours": 20, "cost": 2000}, {"role": "Developer", "hours": 80, "cost": 8000}]',estimated_cost:1e4,notes:"",status:"draft"}),_=[B=>!!B||r("projects.development_plan.validation.estimated_cost_required"),B=>!isNaN(parseFloat(B))||r("projects.development_plan.validation.estimated_cost_number")],g=[B=>{try{return JSON.parse(B),!0}catch{return r("projects.development_plan.validation.roles_hours_json")}}],k=z(null),q=()=>{c.value={roles_and_hours:'[{"role": "Project Manager", "hours": 20, "cost": 2000}, {"role": "Developer", "hours": 80, "cost": 8000}]',estimated_cost:1e4,notes:"",status:"draft"},k.value&&k.value.resetValidation()},C=()=>{f.value=!1,q()},P=async()=>{const{valid:B}=await k.value.validate();if(B){const D={...c.value};D.estimated_cost=parseFloat(D.estimated_cost),u("submit",D),f.value=!1,q()}};return je(f,B=>{B||q()}),(B,D)=>{const I=ye("IconBtn");return n(),y(xe,{modelValue:a(f),"onUpdate:modelValue":D[4]||(D[4]=H=>De(f)?f.value=H:null),"max-width":"700",persistent:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[i("h5",ys,l(a(r)("projects.development_plan.actions.new_version")),1),e(ae),e(I,{onClick:C},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"px-5 pt-4"},{default:t(()=>[i("p",bs,l(a(r)("projects.development_plan.creating_version",{version:s.currentVersionNumber+1})),1),e(Ie,{ref_key:"formRef",ref:k,onSubmit:Ce(P,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12",md:"6"},{default:t(()=>[e(de,{modelValue:c.value.estimated_cost,"onUpdate:modelValue":D[0]||(D[0]=H=>c.value.estimated_cost=H),modelModifiers:{number:!0},label:a(r)("projects.development_plan.estimated_cost"),type:"number",rules:_,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.status,"onUpdate:modelValue":D[1]||(D[1]=H=>c.value.status=H),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:c.value.roles_and_hours,"onUpdate:modelValue":D[2]||(D[2]=H=>c.value.roles_and_hours=H),label:a(r)("projects.development_plan.roles_hours"),rules:g,rows:"6",monospace:"",hint:a(r)("projects.development_plan.roles_hours_hint"),"persistent-hint":""},null,8,["modelValue","label","hint"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:c.value.notes,"onUpdate:modelValue":D[3]||(D[3]=H=>c.value.notes=H),label:a(r)("projects.development_plan.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[e($,{variant:"tonal",color:"secondary",onClick:C},{default:t(()=>[d(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:P},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.create_version")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},ks={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},xs={key:1,class:"text-center pa-6"},ws={class:"text-h6 mb-2"},Vs={class:"text-body-1 text-medium-emphasis mb-6"},qs={key:2},Cs={class:"d-flex flex-column"},zs={class:"text-h6 mb-2"},Ss={class:"text-h4 font-weight-bold"},Us={class:"text-caption text-medium-emphasis"},Ds={class:"text-h6 mb-3"},Is={class:"text-right"},Ms={class:"text-right"},Ps={class:"text-right"},Bs={class:"text-right"},$s={class:"d-flex align-center justify-space-between mb-4"},Fs={class:"text-h5"},Ls={class:"text-right"},Rs={class:"text-right"},Os=["onClick"],As={class:"d-flex align-center"},Ts={class:"font-weight-medium"},Ns={class:"text-right"},Hs={class:"text-right"},Ys={key:1,class:"text-center pa-4"},Zs={class:"text-medium-emphasis"},Js={key:2,class:"text-center pa-4"},Ks={class:"text-medium-emphasis"},Es={__name:"ProjectDevelopmentPlan",props:{projectId:{type:String,required:!0},developmentPlan:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=wt(),c=Be(),_=z(null),g=z(!1),k=z(!1),q=z(!1),C=z({show:!1,text:"",color:"success"}),P=J(()=>c.is_admin()),B=J(()=>c.userData.role>=2),D=J(()=>o.developmentPlan&&o.developmentPlan.id),I=J(()=>D.value&&o.developmentPlan.versions?[...o.developmentPlan.versions].sort((v,O)=>O.version_number-v.version_number):[]),H=J(()=>D.value?I.value.find(v=>v.version_number===o.developmentPlan.current_version_number):null),K=v=>v?new Date(parseInt(v)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",N=v=>v||v===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(v):"-",L=v=>{_.value=v,g.value=!0},R=()=>{k.value=!0},T=async v=>{q.value=!0;try{const{data:O,error:te}=await f.createPlanVersion(o.developmentPlan.id,v);O&&!te?(A(r("projects.development_plan.notifications.version_created")),u("refresh")):A(r("projects.development_plan.notifications.version_create_failed"),"error")}catch(O){A(r("projects.development_plan.notifications.version_create_failed")+": "+O.message,"error")}finally{q.value=!1,k.value=!1}},S=async()=>{q.value=!0;try{const{data:v,error:O}=await f.createDevelopmentPlan(o.projectId);v&&!O?(A(r("projects.development_plan.notifications.created")),u("refresh")):A(r("projects.development_plan.notifications.create_failed"),"error")}catch(v){A(r("projects.development_plan.notifications.create_failed")+": "+v.message,"error")}finally{q.value=!1}},A=(v,O="success")=>{C.value={show:!0,text:v,color:O}},le=v=>{if(!v)return[];try{return typeof v=="string"?JSON.parse(v):v}catch(O){return console.error("Error parsing roles and hours:",O),[]}};return(v,O)=>{const te=ye("IconBtn");return n(),y(G,{class:"pa-6"},{default:t(()=>[s.loading?(n(),p("div",ks,[e(ie,{indeterminate:"",color:"primary"})])):a(D)?(n(),p("div",qs,[e(se,null,{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(W,{border:"",class:"mb-4"},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(V,{icon:"tabler-calendar-stats"})]),_:1})]),append:t(()=>[e(Y,{color:"primary",size:"small",label:"",class:"me-2"},{default:t(()=>[d(" v"+l(s.developmentPlan.current_version_number),1)]),_:1}),e(Y,{color:s.developmentPlan.status==="active"?"success":"warning",size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${s.developmentPlan.status}`)),1)]),_:1},8,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(r)("projects.development_plan.current_plan")),1)]),_:1})]),_:1}),e(ee),a(H)?(n(),y(G,{key:0},{default:t(()=>[e(se,null,{default:t(()=>[e(F,{cols:"12",md:"4"},{default:t(()=>[i("div",Cs,[i("div",zs,l(a(r)("projects.development_plan.estimated_cost")),1),i("div",Ss,l(N(a(H).estimated_cost)),1),i("div",Us,l(a(r)("projects.development_plan.version.created"))+": "+l(K(a(H).created_at)),1)])]),_:1}),e(F,{cols:"12",md:"8"},{default:t(()=>[i("div",Ds,l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1),e(Ze,{density:"compact"},{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(r)("projects.development_plan.version.role")),1),i("th",Is,l(a(r)("projects.development_plan.version.hours")),1),i("th",Ms,l(a(r)("projects.development_plan.version.cost")),1)])]),i("tbody",null,[(n(!0),p(Q,null,ne(le(a(H).roles_and_hours),(j,M)=>(n(),p("tr",{key:M},[i("td",null,l(j.role),1),i("td",Ps,l(j.hours),1),i("td",Bs,l(N(j.cost)),1)]))),128))])]),_:1}),e($,{color:"primary",variant:"tonal",class:"mt-4",size:"small",onClick:O[0]||(O[0]=j=>L(a(H)))},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.view_details")),1)]),_:1})]),_:1})]),_:1})]),_:1})):x("",!0)]),_:1})]),_:1}),e(F,{cols:"12"},{default:t(()=>[i("div",$s,[i("h5",Fs,l(a(r)("projects.development_plan.version_history")),1),a(B)?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:R,disabled:q.value},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.new_version")),1)]),_:1},8,["disabled"])):x("",!0)]),a(I).length>1?(n(),y(Ze,{key:0},{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(r)("projects.development_plan.version.version")),1),i("th",null,l(a(r)("projects.development_plan.version.created")),1),i("th",null,l(a(r)("projects.details.status")),1),i("th",Ls,l(a(r)("projects.development_plan.estimated_cost")),1),i("th",Rs,l(a(r)("projects.actions.title")),1)])]),i("tbody",null,[(n(!0),p(Q,null,ne(a(I),j=>(n(),p("tr",{key:j.id,class:et({"bg-primary-lighten-5":j.version_number===s.developmentPlan.current_version_number}),style:{cursor:"pointer"},onClick:M=>L(j)},[i("td",null,[i("div",As,[i("span",Ts,"v"+l(j.version_number),1),j.version_number===s.developmentPlan.current_version_number?(n(),y(Y,{key:0,color:"primary",size:"x-small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(r)("projects.development_plan.version.current")),1)]),_:1})):x("",!0)])]),i("td",null,l(K(j.created_at)),1),i("td",null,[e(Y,{color:j.status==="active"?"success":"warning",size:"small",label:""},{default:t(()=>[d(l(a(r)(`projects.status.${j.status}`)),1)]),_:2},1032,["color"])]),i("td",Ns,l(N(j.estimated_cost)),1),i("td",Hs,[e($,{icon:"",variant:"text",size:"small",color:"primary",onClick:Ce(M=>L(j),["stop"])},{default:t(()=>[e(V,{icon:"tabler-eye"})]),_:2},1032,["onClick"])])],10,Os))),128))])]),_:1})):a(I).length===1?(n(),p("div",Ys,[i("p",Zs,l(a(r)("projects.development_plan.version.only_one_version")),1)])):(n(),p("div",Js,[i("p",Ks,l(a(r)("projects.development_plan.version.no_versions")),1)]))]),_:1})]),_:1})])):(n(),p("div",xs,[e(V,{icon:"tabler-calendar-time",size:"64",color:"secondary",class:"mb-4"}),i("h4",ws,l(a(r)("projects.development_plan.empty.title")),1),i("p",Vs,l(a(r)("projects.development_plan.empty.description")),1),a(B)?(n(),y($,{key:0,color:"primary",onClick:S,loading:q.value},{default:t(()=>[d(l(a(r)("projects.development_plan.actions.create_plan")),1)]),_:1},8,["loading"])):x("",!0)])),_.value?(n(),y(hs,{key:3,modelValue:g.value,"onUpdate:modelValue":O[1]||(O[1]=j=>g.value=j),version:_.value,"is-current":_.value&&s.developmentPlan&&_.value.version_number===s.developmentPlan.current_version_number,"is-admin":a(P),"has-manager-permission":a(B),"plan-id":s.developmentPlan?s.developmentPlan.id:null,onRefresh:O[2]||(O[2]=j=>u("refresh"))},null,8,["modelValue","version","is-current","is-admin","has-manager-permission","plan-id"])):x("",!0),e(js,{modelValue:k.value,"onUpdate:modelValue":O[3]||(O[3]=j=>k.value=j),"plan-id":s.developmentPlan?s.developmentPlan.id:null,"current-version-number":s.developmentPlan?s.developmentPlan.current_version_number:0,onSubmit:T},null,8,["modelValue","plan-id","current-version-number"]),e(we,{modelValue:C.value.show,"onUpdate:modelValue":O[5]||(O[5]=j=>C.value.show=j),color:C.value.color,timeout:5e3},{actions:t(()=>[e(te,{onClick:O[4]||(O[4]=j=>C.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(C.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Gs={key:0,class:"text-h5"},Ws={key:1,class:"text-h5"},Qs={key:0},Xs={class:"align-center justify-space-between mb-3"},eo={class:"text-subtitle-1 font-weight-medium"},to={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},ao={key:1},lo={class:"d-flex align-center mb-5"},ro={class:"d-flex align-center"},so={class:"text-medium-emphasis d-flex align-center"},oo={class:"text-caption me-4"},io={class:"text-caption"},no={class:"user-story-format mb-6"},co={class:"text-h5 mb-4"},uo={class:"text-primary"},mo={class:"text-h5 mb-4"},po={class:"text-primary"},vo={class:"text-h5 mb-4"},fo={class:"text-primary"},_o={key:0},go={class:"text-h6 mb-3"},ho={key:1,class:"text-medium-emphasis text-center pa-4"},yo={key:2,class:"mt-6"},bo={key:0,class:"text-center pa-6"},jo={class:"text-h6 mb-2"},ko={class:"text-medium-emphasis"},xo={key:1},wo={class:"d-flex align-center"},Vo={class:"mockup-preview mb-3"},qo={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Co={key:0,class:"d-flex justify-center align-center h-100"},zo={class:"text-center"},So={class:"text-caption"},Uo={key:1,class:"html-preview"},Do=["innerHTML"],Io={key:2,class:"d-flex justify-center align-center h-100"},Mo={class:"preview-overlay d-flex justify-center align-center"},Po={key:0,class:"mb-2"},Bo={class:"d-flex align-center justify-space-between"},$o={class:"d-flex align-center"},Fo={class:"text-caption"},Lo={key:0,class:"text-center pa-6"},Ro={class:"text-h6 mb-2"},Oo={class:"text-medium-emphasis"},Ao={key:1},To={class:"text-caption"},No={class:"text-caption text-medium-emphasis"},Ho={class:"text-primary"},Yo={class:"mb-2"},Zo={class:"text-primary"},Jo={class:"mb-4"},Ko={class:"text-primary"},Eo={key:0},Go={class:"text-subtitle-2 font-weight-medium mb-2"},Wo={class:"ms-3"},Qo={class:"text-caption mt-3"},Xo={class:"d-flex justify-end mt-2"},ei={key:1,class:"text-center pa-6"},ti={class:"text-h6 mb-2"},ai={class:"text-medium-emphasis"},li={key:2},ri={class:"d-flex align-center"},si={class:"d-flex align-center"},oi={class:"text-caption text-medium-emphasis ml-2"},ii={class:"comment-text mt-2 whitespace-pre-wrap"},ni={class:"text-body-1 mb-3"},ci=Ve({__name:"UserStoryDetailsDialog",props:{modelValue:{type:Boolean,default:!1},userStory:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","regenerate"],setup(s,{emit:u}){const o=s,r=J({get:()=>o.modelValue,set:h=>u("update:modelValue",h)}),f=rt();Ge();const{t:c}=ge(),_=z(0),g=z(!1),k=z({...o.userStory}),q=z(""),C=z(""),P=z(""),B=z(!1),D=z(!1),I=z(null),H=z(!1),K=z({show:!1,text:"",color:"success"}),N=z(null),L=[{title:c("projects.status.draft"),value:"draft"},{title:c("projects.status.active"),value:"active"},{title:c("projects.status.archived"),value:"archived"},{title:c("projects.status.completed"),value:"completed"}],R=J(()=>o.userStory.history||[]),T=J(()=>o.userStory.comments||[]),S=J(()=>o.userStory.mockups||[]),A=h=>h?(h=parseInt(h),new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",le=()=>{g.value&&(k.value={...o.userStory},q.value=""),g.value=!g.value,_.value="0"},v=()=>{q.value.trim()&&(k.value.acceptance_criteria||(k.value.acceptance_criteria=[]),k.value.acceptance_criteria.push(q.value.trim()),q.value="")},O=()=>{r.value&&f.fetchUserStoryById(o.userStory.id).then(({data:h})=>{h&&Object.assign(o.userStory,h)})};qe(()=>{N.value=setInterval(O,5e3)}),Re(()=>{N.value&&clearInterval(N.value)});const te=()=>{u("update",k.value),g.value=!1,r.value=!1},j=()=>{u("delete"),r.value=!1},M=()=>{P.value="",B.value=!0},Z=()=>{u("regenerate",P.value),B.value=!1,r.value=!1},E=async()=>{if(C.value.trim()){D.value=!0;try{const{data:h,error:m}=await f.createComment(o.userStory.id,{text:C.value,status:"active"});if(h&&!m){w("Comment added successfully"),C.value="";const{data:ce}=await f.fetchUserStoryById(o.userStory.id);ce&&Object.assign(o.userStory,ce)}else w("Failed to add comment","error")}catch(h){w("Failed to add comment: "+h.message,"error")}finally{D.value=!1}}},w=(h,m="success")=>{K.value={show:!0,text:h,color:m}},U=(h,m=150)=>{if(!h||h.length<=m)return h;const ce=h.replace(/<[^>]*>/g,"");return ce.length<=m?h:ce.substring(0,m)+"..."};return je(()=>o.userStory,h=>{k.value={...h}},{deep:!0}),(h,m)=>{const ce=ye("IconBtn");return n(),y(xe,{modelValue:a(r),"onUpdate:modelValue":m[15]||(m[15]=b=>De(r)?r.value=b:null),"max-width":"900",scrollable:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[g.value?(n(),p("h5",Gs,l(a(c)("projects.user_stories.title.edit")),1)):(n(),p("h5",Ws,l(a(c)("projects.user_stories.title.details")),1)),e(ae),e(ce,{onClick:m[0]||(m[0]=b=>r.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"pb-0"},{default:t(()=>[e(at,{modelValue:_.value,"onUpdate:modelValue":m[1]||(m[1]=b=>_.value=b),"slider-color":"primary","align-tabs":"start"},{default:t(()=>[e(pe,{value:"0"},{default:t(()=>[e(V,{size:"18",icon:"tabler-user-check",start:""}),d(" "+l(a(c)("projects.requirements.tabs.details")),1)]),_:1}),e(pe,{value:"1"},{default:t(()=>[e(V,{size:"18",icon:"tabler-photo",start:""}),d(" "+l(a(c)("projects.requirements.tabs.mockups"))+" ",1),a(S).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(S).length),1)]),_:1})):x("",!0)]),_:1}),e(pe,{value:"2"},{default:t(()=>[e(V,{size:"18",icon:"tabler-history",start:""}),d(" "+l(a(c)("projects.requirements.tabs.history"))+" ",1),a(R).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(R).length),1)]),_:1})):x("",!0)]),_:1}),e(pe,{value:"3"},{default:t(()=>[e(V,{size:"18",icon:"tabler-messages",start:""}),d(" "+l(a(c)("projects.requirements.tabs.comments"))+" ",1),a(T).length?(n(),y(Y,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[d(l(a(T).length),1)]),_:1})):x("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(G,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:t(()=>[e(lt,{modelValue:_.value,"onUpdate:modelValue":m[8]||(m[8]=b=>_.value=b),class:"mt-5"},{default:t(()=>[e(ve,{value:"0"},{default:t(()=>[g.value?(n(),p("div",Qs,[e(Ie,{onSubmit:Ce(te,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:k.value.role,"onUpdate:modelValue":m[2]||(m[2]=b=>k.value.role=b),label:a(c)("projects.user_stories.fields.role"),required:"",rules:[b=>!!b||a(c)("projects.user_stories.validation.role_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:k.value.action,"onUpdate:modelValue":m[3]||(m[3]=b=>k.value.action=b),label:a(c)("projects.user_stories.fields.action"),required:"",rules:[b=>!!b||a(c)("projects.user_stories.validation.action_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:k.value.benefit,"onUpdate:modelValue":m[4]||(m[4]=b=>k.value.benefit=b),label:a(c)("projects.user_stories.fields.benefit"),required:"",rules:[b=>!!b||a(c)("projects.user_stories.validation.benefit_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:k.value.status,"onUpdate:modelValue":m[5]||(m[5]=b=>k.value.status=b),label:a(c)("projects.user_stories.fields.status"),items:L,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[i("div",Xs,[i("div",eo,l(a(c)("projects.user_stories.fields.acceptance_criteria")),1),e(se,{class:"w-100"},{default:t(()=>[e(F,{cols:"10",sm:"8"},{default:t(()=>[e(de,{modelValue:q.value,"onUpdate:modelValue":m[6]||(m[6]=b=>q.value=b),placeholder:a(c)("projects.user_stories.fields.add_criterion"),density:"compact","hide-details":"",class:"me-2",onKeyup:gt(v,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1}),e(F,{cols:"2",sm:"4"},{default:t(()=>[e($,{color:"primary",size:"small",disabled:!q.value.trim(),onClick:v},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.add")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),k.value.acceptance_criteria&&k.value.acceptance_criteria.length>0?(n(),y(Ne,{key:0},{default:t(()=>[(n(!0),p(Q,null,ne(k.value.acceptance_criteria,(b,oe)=>(n(),y(He,{key:oe},{prepend:t(()=>[e(V,{icon:"tabler-check",color:"success"})]),append:t(()=>[e(ce,{color:"error",variant:"text",size:"small",onClick:ke=>(me=>{k.value.acceptance_criteria.splice(me,1)})(oe)},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(b),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),p("div",to,l(a(c)("projects.user_stories.empty.acceptance_criteria.description")),1))]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",ao,[i("div",lo,[e(Y,{color:a(he)(s.userStory.status),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(c)(`projects.status.${s.userStory.status}`)),1)]),_:1},8,["color"]),e(Y,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:t(()=>[d(" v"+l(s.userStory.version_number),1)]),_:1})]),i("div",ro,[i("div",so,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",oo,l(a(c)("projects.details.updated_at"))+": "+l(A(s.userStory.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",io,l(a(c)("projects.details.created_at"))+": "+l(A(s.userStory.created_at)),1)])]),i("div",no,[i("div",co,[i("span",uo,l(a(c)("projects.user_stories.fields.role")),1),d(" "+l(s.userStory.role)+", ",1)]),i("div",mo,[i("span",po,l(a(c)("projects.user_stories.fields.action")),1),d(" "+l(s.userStory.action)+", ",1)]),i("div",vo,[i("span",fo,l(a(c)("projects.user_stories.fields.benefit")),1),d(" "+l(s.userStory.benefit)+". ",1)])]),e(ee,{class:"mb-4"}),s.userStory.acceptance_criteria&&s.userStory.acceptance_criteria.length>0?(n(),p("div",_o,[i("div",go,l(a(c)("projects.user_stories.fields.acceptance_criteria")),1),e(Ne,null,{default:t(()=>[(n(!0),p(Q,null,ne(s.userStory.acceptance_criteria,(b,oe)=>(n(),y(He,{key:oe,class:"px-0"},{prepend:t(()=>[e(V,{icon:"tabler-check",color:"success",class:"me-2"})]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(b),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(n(),p("div",ho,l(a(c)("projects.user_stories.empty.acceptance_criteria.description")),1)),s.userStory.generation_status==="in_progress"?(n(),p("div",yo,[e(Ue,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:t(()=>[e(bt,null,{default:t(()=>[d(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1}),i("p",null,l(a(c)("projects.user_stories.regeneration.description")),1)]),_:1})])):x("",!0)]))]),_:1}),e(ve,{value:"1"},{default:t(()=>[a(S).length===0?(n(),p("div",bo,[e(V,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-3"}),i("h4",jo,l(a(c)("projects.user_stories.mockups.empty.title")),1),i("p",ko,l(a(c)("projects.user_stories.mockups.empty.description")),1)])):(n(),p("div",xo,[e(se,null,{default:t(()=>[(n(!0),p(Q,null,ne(a(S),b=>(n(),y(F,{key:b.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(W,{class:"mockup-card h-100",onClick:oe=>{I.value=b,H.value=!0},border:"",hover:""},{default:t(()=>[e(ue,null,{append:t(()=>[i("div",wo,[b.generation_status==="in_progress"||b.generation_status==="pending"||b.needs_regeneration?(n(),y(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):x("",!0),e(Y,{color:a(he)(b.status),size:"small",label:""},{default:t(()=>[d(l(a(c)(`projects.status.${b.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(b.name),1)]),_:2},1024)]),_:2},1024),e(ee),e(G,null,{default:t(()=>[i("div",Vo,[i("div",qo,[b.generation_status==="in_progress"||b.generation_status==="pending"?(n(),p("div",Co,[i("div",zo,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",So,l(a(c)("projects.mockups.status.generating")),1)])])):b.html_content?(n(),p("div",Uo,[i("div",{innerHTML:U(b.html_content)},null,8,Do)])):(n(),p("div",Io,[e(V,{icon:"tabler-file-code",size:"48",color:"secondary"})])),i("div",Mo,[e($,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:b.generation_status==="in_progress"||b.generation_status==="pending"},{default:t(()=>[d(l(a(c)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),b.needs_regeneration?(n(),p("div",Po,[e(Y,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.mockups.status.regenerating")),1)]),_:1})])):x("",!0),i("div",Bo,[i("div",$o,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Fo,l(A(b.created_at)),1)])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"2"},{default:t(()=>[a(R).length===0?(n(),p("div",Lo,[e(V,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),i("h4",Ro,l(a(c)("projects.user_stories.empty.history.title")),1),i("p",Oo,l(a(c)("projects.user_stories.empty.history.description")),1)])):(n(),p("div",Ao,[e(jt,{density:"compact",align:"start"},{default:t(()=>[(n(!0),p(Q,null,ne(a(R),(b,oe)=>(n(),y(kt,{key:oe,"dot-color":"primary",size:"small"},{opposite:t(()=>[i("div",To,l(A(b.changed_at)),1),i("div",No,"v"+l(b.version_number),1)]),default:t(()=>[e(W,{border:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",size:"36"},{default:t(()=>[e(V,{icon:"tabler-user-check"})]),_:1})]),append:t(()=>[e(Y,{color:a(he)(b.status),size:"small",label:"",class:"ms-2"},{default:t(()=>[d(l(a(c)(`projects.status.${b.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[i("span",Ho,l(a(c)("projects.user_stories.fields.role")),1),d(" "+l(b.role),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>[i("p",Yo,[i("span",Zo,l(a(c)("projects.user_stories.fields.action")),1),d(" "+l(b.action),1)]),i("p",Jo,[i("span",Ko,l(a(c)("projects.user_stories.fields.benefit")),1),d(" "+l(b.benefit),1)]),b.acceptance_criteria&&b.acceptance_criteria.length>0?(n(),p("div",Eo,[i("div",Go,l(a(c)("projects.user_stories.fields.acceptance_criteria"))+": ",1),i("ul",Wo,[(n(!0),p(Q,null,ne(b.acceptance_criteria,(ke,me)=>(n(),p("li",{key:me},l(ke),1))),128))])])):x("",!0),i("div",Qo,l(a(c)("projects.requirements.history.changed_by"))+": "+l(b.changed_by?b.changed_by.username:a(c)("projects.requirements.history.unknown")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ve,{value:"3"},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:C.value,"onUpdate:modelValue":m[7]||(m[7]=b=>C.value=b),label:a(c)("projects.requirements.comments.add"),rows:"3",counter:"",disabled:D.value},null,8,["modelValue","label","disabled"]),i("div",Xo,[e($,{color:"primary",size:"small",loading:D.value,disabled:!C.value.trim(),onClick:E},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.add_comment")),1)]),_:1},8,["loading","disabled"])])]),_:1}),e(F,{cols:"12"},{default:t(()=>[a(T).length?(n(),y(ee,{key:0,class:"mb-4"})):x("",!0),a(T).length===0?(n(),p("div",ei,[e(V,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),i("h4",ti,l(a(c)("projects.user_stories.empty.comments.title")),1),i("p",ai,l(a(c)("projects.user_stories.empty.comments.description")),1)])):(n(),p("div",li,[(n(!0),p(Q,null,ne(a(T),b=>(n(),p("div",{key:b.id,class:"comment-item mb-4"},[e(W,{border:""},{default:t(()=>[e(G,{class:"py-2"},{default:t(()=>[i("div",ri,[e(Se,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:t(()=>[e(V,{icon:"tabler-user"})]),_:1}),i("div",null,[i("div",si,[i("strong",null,l(b.user?b.user.username:a(c)("projects.requirements.comments.unknown_user")),1),i("div",oi,l(A(b.created_at)),1)])]),e(ae),s.isAdmin||s.hasManagerPermission?(n(),y(ce,{key:0,size:"small",color:"error",variant:"text",onClick:oe=>(async ke=>{D.value=!0;try{const{success:me,error:ze}=await f.deleteComment(ke);if(me&&!ze){w("Comment deleted successfully");const{data:Me}=await f.fetchUserStoryById(o.userStory.id);Me&&Object.assign(o.userStory,Me)}else w("Failed to delete comment","error")}catch(me){w("Failed to delete comment: "+me.message,"error")}finally{D.value=!1}})(b.id),disabled:D.value},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):x("",!0)]),i("div",ii,l(b.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[g.value?(n(),p(Q,{key:0},[e($,{color:"secondary",variant:"tonal",onClick:le},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:te},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.save")),1)]),_:1})],64)):(n(),p(Q,{key:1},[s.isAdmin?(n(),y($,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:j},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.delete")),1)]),_:1})):x("",!0),s.hasModeratorPermission?(n(),y($,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:M},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.regenerate")),1)]),_:1})):x("",!0),e(ae),s.hasModeratorPermission?(n(),y($,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:le},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.edit")),1)]),_:1})):x("",!0)],64))]),_:1})]),_:1}),e(xe,{modelValue:B.value,"onUpdate:modelValue":m[11]||(m[11]=b=>B.value=b),"max-width":"600",persistent:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"pt-3 pb-0"},{default:t(()=>[d(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1}),e(G,null,{default:t(()=>[i("p",ni,l(a(c)("projects.user_stories.regeneration.description")),1),e(be,{autofocus:"",modelValue:P.value,"onUpdate:modelValue":m[9]||(m[9]=b=>P.value=b),label:a(c)("projects.user_stories.fields.feedback"),hint:a(c)("projects.user_stories.placeholders.feedback"),rows:"4",counter:""},null,8,["modelValue","label","hint"])]),_:1}),e(fe,null,{default:t(()=>[e($,{color:"secondary",variant:"tonal",onClick:m[10]||(m[10]=b=>B.value=!1)},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:Z},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.regenerate")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),I.value?(n(),y(ot,{key:0,modelValue:H.value,"onUpdate:modelValue":m[12]||(m[12]=b=>H.value=b),mockup:I.value,"is-admin":s.isAdmin,"has-manager-permission":s.hasManagerPermission},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):x("",!0),e(we,{modelValue:K.value.show,"onUpdate:modelValue":m[14]||(m[14]=b=>K.value.show=b),color:K.value.color,timeout:5e3},{actions:t(()=>[e(ce,{onClick:m[13]||(m[13]=b=>K.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(K.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-6ec6a9e7"]]),ui={class:"text-h5"},di={class:"text-subtitle-1 font-weight-medium"},mi={class:"d-flex align-center justify-space-between mb-3"},pi={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},vi={__name:"UserStoryCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},userStoryData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const o=s,{t:r}=ge(),f=J({get:()=>o.modelValue,set:K=>u("update:modelValue",K)}),c=z({role:o.editMode&&o.userStoryData?o.userStoryData.role:"",action:o.editMode&&o.userStoryData?o.userStoryData.action:"",benefit:o.editMode&&o.userStoryData?o.userStoryData.benefit:"",acceptance_criteria:o.editMode&&o.userStoryData?[...o.userStoryData.acceptance_criteria]:[],status:o.editMode&&o.userStoryData?o.userStoryData.status:"draft"}),_=z(""),g=z(null),k=[K=>!!K||r("projects.user_stories.validation.role_required")],q=[K=>!!K||r("projects.user_stories.validation.action_required")],C=[K=>!!K||r("projects.user_stories.validation.benefit_required")],P=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],B=()=>{_.value.trim()&&(c.value.acceptance_criteria||(c.value.acceptance_criteria=[]),c.value.acceptance_criteria.push(_.value.trim()),_.value="")},D=()=>{c.value={role:"",action:"",benefit:"",acceptance_criteria:[],status:"draft"},_.value="",g.value&&g.value.resetValidation()},I=()=>{f.value=!1,D()},H=async()=>{const{valid:K}=await g.value.validate();K&&(u("submit",c.value),f.value=!1,D())};return je(f,K=>{K||D()}),(K,N)=>{const L=ye("IconBtn");return n(),y(xe,{modelValue:a(f),"onUpdate:modelValue":N[5]||(N[5]=R=>De(f)?f.value=R:null),"max-width":"700",persistent:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[i("h5",ui,l(o.editMode?a(r)("projects.user_stories.title.edit"):a(r)("projects.user_stories.title.create")),1),e(ae),e(L,{onClick:I},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(G,{class:"px-5 pt-4"},{default:t(()=>[e(Ie,{ref_key:"formRef",ref:g,onSubmit:Ce(H,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.role,"onUpdate:modelValue":N[0]||(N[0]=R=>c.value.role=R),label:a(r)("projects.user_stories.fields.role"),rules:k,placeholder:a(r)("projects.user_stories.placeholders.role"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.action,"onUpdate:modelValue":N[1]||(N[1]=R=>c.value.action=R),label:a(r)("projects.user_stories.fields.action"),rules:q,placeholder:a(r)("projects.user_stories.placeholders.action"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:c.value.benefit,"onUpdate:modelValue":N[2]||(N[2]=R=>c.value.benefit=R),label:a(r)("projects.user_stories.fields.benefit"),rules:C,placeholder:a(r)("projects.user_stories.placeholders.benefit"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:c.value.status,"onUpdate:modelValue":N[3]||(N[3]=R=>c.value.status=R),label:a(r)("projects.user_stories.fields.status"),items:P,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[i("div",di,l(a(r)("projects.user_stories.fields.acceptance_criteria")),1),i("div",mi,[e(se,{class:"w-100"},{default:t(()=>[e(F,{cols:"10",sm:"8"},{default:t(()=>[e(de,{modelValue:_.value,"onUpdate:modelValue":N[4]||(N[4]=R=>_.value=R),placeholder:a(r)("projects.user_stories.fields.add_criterion"),density:"compact","hide-details":"",class:"me-2",onKeyup:gt(B,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1}),e(F,{cols:"2",sm:"4"},{default:t(()=>[e($,{color:"primary",size:"small",disabled:!_.value.trim(),onClick:B},{default:t(()=>[d(l(a(r)("projects.user_stories.actions.add")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),c.value.acceptance_criteria&&c.value.acceptance_criteria.length>0?(n(),y(Ne,{key:0},{default:t(()=>[(n(!0),p(Q,null,ne(c.value.acceptance_criteria,(R,T)=>(n(),y(He,{key:T},{prepend:t(()=>[e(V,{icon:"tabler-check",color:"success"})]),append:t(()=>[e(L,{color:"error",variant:"text",size:"small",onClick:S=>(A=>{c.value.acceptance_criteria.splice(A,1)})(T)},{default:t(()=>[e(V,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(R),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),p("div",pi,l(a(r)("projects.user_stories.empty.acceptance_criteria.description")),1))]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[e($,{variant:"tonal",color:"secondary",onClick:I},{default:t(()=>[d(l(a(r)("projects.user_stories.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:H},{default:t(()=>[d(l(o.editMode?a(r)("projects.user_stories.actions.save"):a(r)("projects.user_stories.actions.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},fi={key:0,class:"mb-4"},_i={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},gi={key:2,class:"text-center pa-4"},hi={class:"text-h6 mb-2"},yi={class:"text-body-1 text-medium-emphasis mb-6"},bi={class:"d-flex align-center"},ji={class:"text-body-1 mb-2"},ki={class:"font-weight-medium text-primary"},xi={class:"text-body-1 mb-4"},wi={class:"font-weight-medium text-primary"},Vi={key:0},qi={class:"text-subtitle-2 font-weight-medium mb-2 text-primary"},Ci={class:"ml-4"},zi={key:0},Si={class:"d-flex align-center justify-space-between mt-3"},Ui={class:"d-flex align-center"},Di={class:"text-caption"},Ii={class:"d-flex align-center"},Mi={class:"text-caption"},Pi=Ve({__name:"UserStoriesList",props:{projectId:{type:String,required:!0},requirementId:{type:String,required:!1,default:null},userStories:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,r=rt(),f=Be(),{t:c}=ge(),_=z(""),g=z(["draft","active","completed"]),k=z(null),q=z(!1),C=z(!1),P=z(!1),B=z(!1),D=z({show:!1,text:"",color:"success"}),I=Ae(),H=J(()=>f.is_admin()),K=J(()=>f.userData.role>=2),N=J(()=>f.userData.role>=3),L=[{title:c("projects.status.draft"),value:"draft"},{title:c("projects.status.active"),value:"active"},{title:c("projects.status.archived"),value:"archived"},{title:c("projects.status.completed"),value:"completed"}],R=J(()=>o.userStories.filter(j=>{const M=!_.value||j.role.toLowerCase().includes(_.value.toLowerCase())||j.action.toLowerCase().includes(_.value.toLowerCase())||j.benefit.toLowerCase().includes(_.value.toLowerCase()),Z=g.value.includes(j.status);return M&&Z})),T=J(()=>o.userStories.some(j=>j.generation_status==="in_progress"||j.generation_status==="pending")),S=()=>{C.value=!0},A=async j=>{B.value=!0;try{const{data:M,error:Z}=await r.createUserStory({...j,requirement:o.requirementId});M&&!Z?(te("User story created successfully"),u("refresh")):te("Failed to create user story","error")}catch(M){te("Failed to create user story: "+M.message,"error")}finally{B.value=!1}},le=async j=>{B.value=!0;try{const{data:M,error:Z}=await r.updateUserStory(k.value.id,j);M&&!Z?(te("User story updated successfully"),u("refresh")):te("Failed to update user story","error")}catch(M){te("Failed to update user story: "+M.message,"error")}finally{B.value=!1}},v=async()=>{if(k.value){B.value=!0,P.value=!1;try{const{success:j,error:M}=await r.deleteUserStory(k.value.id);j&&!M?(te("User story deleted successfully"),u("refresh"),q.value=!1):te("Failed to delete user story","error")}catch(j){te("Failed to delete user story: "+j.message,"error")}finally{B.value=!1}}},O=async(j="")=>{if(k.value){B.value=!0;try{const{data:M,error:Z}=await r.regenerateUserStory(k.value.id,j);M&&!Z?(te("User story regeneration started"),setTimeout(()=>{u("refresh")},3e3)):te("Failed to regenerate user story","error")}catch(M){te("Failed to regenerate user story: "+M.message,"error")}finally{B.value=!1}}},te=(j,M="success")=>{D.value={show:!0,text:j,color:M}};return qe(()=>{!o.requirementId||o.userStories.length||o.loading||r.fetchUserStories(o.requirementId).then(({data:j})=>{j&&u("refresh")}),I.on("project-refresh",()=>{r.fetchUserStories(o.requirementId,{silent:!0}).then(({data:j})=>{j&&u("refresh")})})}),je(q,j=>{j?I.on("project-refresh",async()=>{if(k.value){const{data:M}=await r.fetchUserStoryById(k.value.id);M&&(k.value=M)}}):I.off("project-refresh")}),(j,M)=>{const Z=Oe,E=ye("IconBtn");return n(),y(G,{class:"pa-6"},{default:t(()=>[a(T)?(n(),p("div",fi,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1})])):x("",!0),e(se,null,{default:t(()=>[e(F,{cols:"12",md:"6"},{default:t(()=>[e(de,{modelValue:_.value,"onUpdate:modelValue":M[0]||(M[0]=w=>_.value=w),density:"compact",placeholder:a(c)("projects.user_stories.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(F,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:g.value,"onUpdate:modelValue":M[1]||(M[1]=w=>g.value=w),items:L,density:"compact","hide-details":"",label:a(c)("projects.user_stories.fields.status"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[a(N)&&s.requirementId?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:S,loading:B.value,block:""},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.add")),1)]),_:1},8,["loading"])):x("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),s.loading?(n(),p("div",_i,[e(ie,{indeterminate:"",color:"primary"})])):a(R).length===0?(n(),p("div",gi,[e(V,{icon:"tabler-notebook",size:"64",color:"secondary",class:"mb-4"}),i("h4",hi,l(a(c)("projects.user_stories.empty.title")),1),i("p",yi,l(_.value||g.value.length>0?a(c)("projects.user_stories.empty.filtered"):a(c)("projects.user_stories.empty.description")),1),a(N)&&s.requirementId&&!_.value&&g.value.length===0?(n(),y($,{key:0,color:"primary",onClick:S,"prepend-icon":"tabler-plus"},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.create")),1)]),_:1})):x("",!0)])):(n(),y(se,{key:3},{default:t(()=>[(n(!0),p(Q,null,ne(a(R),w=>(n(),y(F,{key:w.id,cols:"12",md:"6"},{default:t(()=>[e(W,{class:"user-story-card h-100 d-flex flex-column",onClick:U=>(async h=>{const{data:m}=await r.fetchUserStoryById(h.id);k.value=m||h,q.value=!0})(w),border:"",hover:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",size:"42"},{default:t(()=>[e(V,{icon:"tabler-user-check"})]),_:1})]),append:t(()=>[i("div",bi,[w.generation_status==="in_progress"||w.generation_status==="pending"?(n(),y(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):x("",!0),w.generation_status==="pending"?(n(),y(Y,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1})):x("",!0),e(Y,{color:a(he)(w.status),size:"small",label:""},{default:t(()=>[d(l(j.$t(`projects.status.${w.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(a(c)("projects.user_stories.fields.role"))+" "+l(w.role),1)]),_:2},1024)]),_:2},1024),e(G,{class:"d-flex flex-column"},{default:t(()=>{return[i("p",ji,[i("span",ki,l(a(c)("projects.user_stories.fields.action"))+":",1),d(" "+l(w.action),1)]),i("p",xi,[i("span",wi,l(a(c)("projects.user_stories.fields.benefit"))+":",1),d(" "+l(w.benefit),1)]),w.acceptance_criteria&&w.acceptance_criteria.length>0?(n(),p("div",Vi,[i("div",qi,l(a(c)("projects.user_stories.fields.acceptance_criteria"))+":",1),i("ul",Ci,[(n(!0),p(Q,null,ne(w.acceptance_criteria.slice(0,2),(h,m)=>(n(),p("li",{key:m},l(h),1))),128)),w.acceptance_criteria.length>2?(n(),p("li",zi,l(a(c)("projects.user_stories.and_more",{count:w.acceptance_criteria.length-2})),1)):x("",!0)])])):x("",!0),e(ae),i("div",Si,[i("div",Ui,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",Di,l((U=w.updated_at,U?(U=parseInt(U),new Date(U).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)]),i("div",Ii,[e(V,{size:"16",icon:"tabler-history",class:"me-1"}),i("span",Mi,"v"+l(w.version_number),1)])])];var U}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),k.value?(n(),y(ci,{key:4,modelValue:q.value,"onUpdate:modelValue":M[2]||(M[2]=w=>q.value=w),"user-story":k.value,onDelete:M[3]||(M[3]=w=>P.value=!0),onUpdate:le,onRegenerate:O,"is-admin":a(H),"has-manager-permission":a(K),"has-moderator-permission":a(N)},null,8,["modelValue","user-story","is-admin","has-manager-permission","has-moderator-permission"])):x("",!0),e(vi,{modelValue:C.value,"onUpdate:modelValue":M[4]||(M[4]=w=>C.value=w),onSubmit:A},null,8,["modelValue"]),e(Z,{isDialogVisible:P.value,"onUpdate:isDialogVisible":M[5]||(M[5]=w=>P.value=w),confirmationMsg:a(c)("projects.user_stories.delete_confirm.message"),onConfirm:v},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:D.value.show,"onUpdate:modelValue":M[7]||(M[7]=w=>D.value.show=w),color:D.value.color,timeout:5e3},{actions:t(()=>[e(E,{onClick:M[6]||(M[6]=w=>D.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(D.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-917627be"]]),Bi={key:0,class:"text-h5"},$i={class:"text-h5"},Fi={key:0},Li={class:"text-subtitle-1 font-weight-medium mb-2"},Ri={class:"bg-grey-lighten-5 rounded pa-3"},Oi={class:"text-medium-emphasis text-caption mb-2"},Ai={key:1},Ti={key:0,class:"pa-5"},Ni={class:"d-flex justify-center my-8"},Hi={class:"d-flex align-center justify-center text-medium-emphasis"},Yi={class:"text-caption me-4"},Zi={class:"text-caption"},Ji={key:1,class:"diagram-content pa-0"},Ki={class:"diagram-metadata d-flex align-center px-6 py-3"},Ei={key:0,class:"ms-2"},Gi={class:"text-medium-emphasis d-flex align-center"},Wi={class:"text-caption me-4"},Qi={class:"text-caption"},Xi={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},en={class:"text-h6 mb-2"},tn={class:"text-medium-emphasis text-center"},an=Ve({__name:"UmlDiagramDetailsDialog",props:{modelValue:{type:Boolean,default:!1},diagram:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(s,{emit:u}){const o=s,r=J({get:()=>o.modelValue,set:S=>u("update:modelValue",S)}),f=st(),c=z(!1),_=z(!1),g=z({...o.diagram}),k=z(!1),q=z({show:!1,text:"",color:"success"}),{t:C}=ge(),P=[{title:C("projects.status.draft"),value:"draft"},{title:C("projects.status.active"),value:"active"},{title:C("projects.status.archived"),value:"archived"},{title:C("projects.status.completed"),value:"completed"}],B=S=>S?(S=parseInt(S),new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",D=()=>{c.value=!c.value},I=()=>{_.value&&(g.value={...o.diagram}),_.value=!_.value},H=z(null),K=()=>{r.value&&f.fetchDiagramById(o.diagram.id).then(({data:S})=>{S&&Object.assign(o.diagram,S)})};qe(()=>{H.value=setInterval(K,5e3)}),Re(()=>{H.value&&clearInterval(H.value)});const N=async()=>{k.value=!0;try{const{data:S,error:A}=await f.updateDiagram(o.diagram.id,g.value);S&&!A?(T(C("projects.uml_diagrams.notifications.updated")),Object.assign(o.diagram,S),_.value=!1,r.value=!1):T(C("projects.uml_diagrams.notifications.update_failed"),"error")}catch(S){T(C("projects.uml_diagrams.notifications.update_failed")+": "+S.message,"error")}finally{k.value=!1}},L=()=>{u("delete"),r.value=!1},R=async()=>{k.value=!0;try{const{data:S,error:A}=await f.regenerateDiagram(o.diagram.id);S&&!A?(T(C("projects.uml_diagrams.notifications.regeneration_started")),r.value=!1,setTimeout(()=>{u("regenerate")},3e3)):T(C("projects.uml_diagrams.notifications.regeneration_failed"),"error")}catch(S){T(C("projects.uml_diagrams.notifications.regeneration_failed")+": "+S.message,"error")}finally{k.value=!1}},T=(S,A="success")=>{q.value={show:!0,text:S,color:A}};return je(()=>o.diagram,S=>{g.value={...S}},{deep:!0}),(S,A)=>{const le=ye("IconBtn");return n(),y(xe,{modelValue:a(r),"onUpdate:modelValue":A[7]||(A[7]=v=>De(r)?r.value=v:null),fullscreen:c.value,"max-width":c.value?"100%":"900",scrollable:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[_.value?(n(),p("h5",Bi,l(a(C)("projects.uml_diagrams.actions.edit")),1)):(n(),p(Q,{key:1},[i("h5",$i,l(s.diagram.name),1),e(Y,{class:"ms-2",color:"secondary",size:"small",label:""},{default:t(()=>[d(l(a(C)(`projects.uml_diagrams.types.${s.diagram.diagram_type}`)),1)]),_:1})],64)),e(ae),e($,{icon:"",variant:"text",onClick:D},{default:t(()=>[e(V,{icon:c.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(le,{onClick:A[0]||(A[0]=v=>r.value=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),_:1}),e(ee),e(G,{class:et({"pa-0":!_.value&&s.diagram.content,"pa-6":_.value||!s.diagram.content}),style:Pe({height:c.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:t(()=>[_.value?(n(),p("div",Fi,[e(Ie,{onSubmit:Ce(N,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(de,{modelValue:g.value.name,"onUpdate:modelValue":A[1]||(A[1]=v=>g.value.name=v),label:a(C)("projects.uml_diagrams.name"),required:"",rules:[v=>!!v||a(C)("projects.uml_diagrams.validation.name_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(_e,{modelValue:g.value.status,"onUpdate:modelValue":A[2]||(A[2]=v=>g.value.status=v),label:a(C)("projects.uml_diagrams.status.title"),items:P,required:""},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[e(be,{modelValue:g.value.notes,"onUpdate:modelValue":A[3]||(A[3]=v=>g.value.notes=v),label:a(C)("projects.uml_diagrams.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[i("div",Li,l(a(C)("projects.uml_diagrams.content")),1),i("div",Ri,[i("div",Oi,l(a(C)("projects.uml_diagrams.content_hint")),1),e(be,{modelValue:g.value.content,"onUpdate:modelValue":A[4]||(A[4]=v=>g.value.content=v),rows:"15",monospace:"","hide-details":""},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),p("div",Ai,[s.diagram.generation_status==="in_progress"?(n(),p("div",Ti,[e(Ue,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:t(()=>[e(bt,null,{default:t(()=>[d(l(a(C)("projects.uml_diagrams.status.generating")),1)]),_:1}),i("p",null,l(a(C)("projects.uml_diagrams.status.generating_description")),1)]),_:1}),i("div",Ni,[e(ie,{indeterminate:"",color:"primary",size:"64"})]),i("div",Hi,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",Yi,l(a(C)("projects.details.updated_at"))+": "+l(B(s.diagram.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",Zi,l(a(C)("projects.details.created_at"))+": "+l(B(s.diagram.created_at)),1)])])):s.diagram.content?(n(),p("div",Ji,[i("div",Ki,[e(Y,{color:a(he)(s.diagram.status),size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(a(C)(`projects.status.${s.diagram.status}`)),1)]),_:1},8,["color"]),s.diagram.notes?(n(),p("div",Ei,[e(Rt,null,{activator:t(({props:v})=>[e(V,ht({icon:"tabler-info-circle",size:"18",color:"info"},v),null,16)]),default:t(()=>[i("span",null,l(s.diagram.notes),1)]),_:1})])):x("",!0),e(ae),i("div",Gi,[e(V,{size:"18",icon:"tabler-calendar",class:"me-1"}),i("span",Wi,l(a(C)("projects.details.updated_at"))+": "+l(B(s.diagram.updated_at)),1),e(V,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),i("span",Qi,l(a(C)("projects.details.created_at"))+": "+l(B(s.diagram.created_at)),1)])]),e(ee),i("div",{class:"diagram-svg-container pa-4 d-flex justify-center align-center",style:Pe({height:c.value?"calc(100vh - 180px)":"calc(70vh - 110px)",overflow:"auto"})},[s.diagram.content?(n(),y(tt,{key:0,src:a(yt)(s.diagram.content),class:"diagram-svg",alt:"Generated Diagram"},null,8,["src"])):x("",!0)],4)])):(n(),p("div",Xi,[e(V,{icon:"tabler-chart-dots-2",size:"64",color:"secondary",class:"mb-4"}),i("h4",en,l(a(C)("projects.uml_diagrams.status.no_content.title")),1),i("p",tn,l(a(C)("projects.uml_diagrams.status.no_content.description")),1)]))]))]),_:1},8,["class","style"]),e(ee),e(fe,{class:"pa-4"},{default:t(()=>[_.value?(n(),p(Q,{key:0},[e($,{color:"secondary",variant:"tonal",onClick:I,disabled:k.value},{default:t(()=>[d(l(a(C)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(ae),e($,{color:"primary",onClick:N,loading:k.value},{default:t(()=>[d(l(a(C)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),p(Q,{key:1},[s.isAdmin?(n(),y($,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:L},{default:t(()=>[d(l(a(C)("projects.uml_diagrams.actions.delete")),1)]),_:1})):x("",!0),s.hasModeratorPermission?(n(),y($,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:R,loading:k.value},{default:t(()=>[d(l(a(C)("projects.uml_diagrams.actions.regenerate")),1)]),_:1},8,["loading"])):x("",!0),e(ae),s.hasModeratorPermission?(n(),y($,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:I},{default:t(()=>[d(l(a(C)("projects.uml_diagrams.actions.edit")),1)]),_:1})):x("",!0)],64))]),_:1})]),_:1}),e(we,{modelValue:q.value.show,"onUpdate:modelValue":A[6]||(A[6]=v=>q.value.show=v),color:q.value.color,timeout:5e3},{actions:t(()=>[e(le,{onClick:A[5]||(A[5]=v=>q.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(q.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-c7c71d81"]]),ln={key:0,class:"mb-4"},rn={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},sn={key:2,class:"text-center pa-4"},on={class:"text-h6 mb-2"},nn={class:"text-body-1 text-medium-emphasis mb-6"},cn={class:"d-flex align-center"},un={class:"mb-3 d-flex align-center"},dn={class:"diagram-preview mb-3"},mn={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},pn={class:"d-flex justify-center align-center h-100"},vn={key:0,class:"text-center pa-2"},fn={class:"text-caption"},_n={key:1,class:"diagram-thumbnail pa-2"},gn={key:2,class:"text-center"},hn={class:"text-caption mt-2"},yn={class:"preview-overlay d-flex justify-center align-center"},bn={class:"d-flex align-center justify-space-between"},jn={class:"d-flex align-center"},kn={class:"text-caption"},xn={class:"text-body-1 mb-4"},wn=Ve({__name:"UmlDiagramList",props:{projectId:{type:String,required:!0},diagrams:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const o=s,r=st(),f=Be(),{t:c}=ge(),_=z(""),g=z("all"),k=z(null),q=z(!1),C=z(!1),P=z(!1),B=z(!1),D=z({show:!1,text:"",color:"success"}),I=J(()=>f.is_admin()),H=J(()=>f.userData.role>=2),K=J(()=>f.userData.role>=3),N=[{title:c("projects.uml_diagrams.types.all"),value:"all"},{title:c("projects.uml_diagrams.types.class"),value:"class"},{title:c("projects.uml_diagrams.types.sequence"),value:"sequence"},{title:c("projects.uml_diagrams.types.activity"),value:"activity"},{title:c("projects.uml_diagrams.types.usecase"),value:"use_case"},{title:c("projects.uml_diagrams.types.state"),value:"state"},{title:c("projects.uml_diagrams.types.component"),value:"component"},{title:c("projects.uml_diagrams.types.deployment"),value:"deployment"},{title:c("projects.uml_diagrams.types.er"),value:"er"}],L=z("class"),R=J(()=>o.diagrams.filter(j=>{const M=!_.value||j.name.toLowerCase().includes(_.value.toLowerCase())||j.diagram_type.toLowerCase().includes(_.value.toLowerCase()),Z=g.value==="all"||j.diagram_type.toLowerCase()===g.value.toLowerCase();return M&&Z})),T=Ae(),S=()=>{L.value="class",P.value=!0},A=async()=>{P.value=!1,B.value=!0;try{const{data:j,error:M}=await r.generateDiagrams(o.projectId,L.value);j&&!M?(v(c("projects.uml_diagrams.notifications.generation_started")),setTimeout(()=>{u("refresh")},3e3)):v(c("projects.uml_diagrams.notifications.generation_failed"),"error")}catch(j){v(c("projects.uml_diagrams.notifications.generation_failed")+": "+j.message,"error")}finally{B.value=!1}},le=async()=>{if(k.value){B.value=!0,C.value=!1;try{const{success:j,error:M}=await r.deleteDiagram(k.value.id);j&&!M?(v(c("projects.uml_diagrams.notifications.delete_success")),u("refresh"),q.value=!1):v(c("projects.uml_diagrams.notifications.delete_failed"),"error")}catch(j){v(c("projects.uml_diagrams.notifications.delete_failed")+": "+j.message,"error")}finally{B.value=!1}}},v=(j,M="success")=>{D.value={show:!0,text:j,color:M}},O=j=>{switch(j.toLowerCase()){case"all":default:return"tabler-chart-dots";case"class":return"tabler-box";case"sequence":return"tabler-arrow-right-square";case"activity":return"tabler-activity";case"usecase":return"tabler-user-check";case"state":return"tabler-circle-check";case"component":return"tabler-puzzle";case"deployment":return"tabler-server";case"er":return"tabler-database"}},te=j=>{switch(j.toLowerCase()){case"all":return c("projects.uml_diagrams.types.all");case"class":return c("projects.uml_diagrams.types.class");case"sequence":return c("projects.uml_diagrams.types.sequence");case"activity":return c("projects.uml_diagrams.types.activity");case"usecase":return c("projects.uml_diagrams.types.usecase");case"state":return c("projects.uml_diagrams.types.state");case"component":return c("projects.uml_diagrams.types.component");case"deployment":return c("projects.uml_diagrams.types.deployment");case"er":return c("projects.uml_diagrams.types.er");default:return j.charAt(0).toUpperCase()+j.slice(1)+" "+c("projects.uml_diagrams.types.diagram")}};return qe(()=>{T.on("project-refresh",()=>{r.fetchDiagrams(o.projectId,{silent:!0}).then(({data:j})=>{j&&u("refresh")})})}),je(q,j=>{j?T.on("project-refresh",async()=>{if(k.value){const{data:M}=await r.fetchDiagramById(k.value.id);M&&(k.value=M)}}):T.off("project-refresh")}),(j,M)=>{const Z=Oe,E=ye("IconBtn");return n(),y(G,{class:"pa-6"},{default:t(()=>[j.anyDiagramInProgress?(n(),p("div",ln,[e(Ue,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),i("span",null,l(a(c)("projects.uml_diagrams.status.generating")),1)]),_:1})])):x("",!0),e(se,null,{default:t(()=>[e(F,{cols:"12",md:"4"},{default:t(()=>[e(de,{modelValue:_.value,"onUpdate:modelValue":M[0]||(M[0]=w=>_.value=w),density:"compact",placeholder:a(c)("projects.uml_diagrams.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(F,{cols:"12",md:"4"},{default:t(()=>[e(_e,{modelValue:g.value,"onUpdate:modelValue":M[1]||(M[1]=w=>g.value=w),items:N,density:"compact","hide-details":"",label:a(c)("projects.uml_diagrams.type"),variant:"outlined"},null,8,["modelValue","label"])]),_:1}),e(F,{cols:"12",md:"4",class:"d-flex align-center"},{default:t(()=>[a(K)?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:S,loading:B.value,block:""},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1},8,["loading"])):x("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),s.loading?(n(),p("div",rn,[e(ie,{indeterminate:"",color:"primary"})])):a(R).length===0?(n(),p("div",sn,[e(V,{icon:"tabler-chart-dots",size:"64",color:"secondary",class:"mb-4"}),i("h4",on,l(a(c)("projects.uml_diagrams.empty.title")),1),i("p",nn,l(_.value||g.value!=="all"?a(c)("projects.uml_diagrams.empty.filtered"):a(c)("projects.uml_diagrams.empty.description")),1),a(K)&&!_.value&&g.value==="all"?(n(),y($,{key:0,color:"primary",onClick:S,"prepend-icon":"tabler-plus"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1})):x("",!0)])):(n(),y(se,{key:3},{default:t(()=>[(n(!0),p(Q,null,ne(a(R),w=>(n(),y(F,{key:w.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(W,{class:"diagram-card h-100",onClick:U=>(async h=>{const{data:m}=await r.fetchDiagramById(h.id);k.value=m||h,q.value=!0})(w),border:"",hover:""},{default:t(()=>[e(ue,null,{prepend:t(()=>[e(Se,{color:"primary",variant:"tonal",size:"42"},{default:t(()=>[e(V,{icon:O(w.diagram_type)},null,8,["icon"])]),_:2},1024)]),append:t(()=>[i("div",cn,[w.generation_status==="in_progress"||w.generation_status==="pending"?(n(),y(ie,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):x("",!0),w.generation_status==="pending"?(n(),y(Y,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.status.generating")),1)]),_:1})):x("",!0),e(Y,{color:a(he)(w.status),size:"small",label:""},{default:t(()=>[d(l(w.status),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[d(l(w.name),1)]),_:2},1024)]),_:2},1024),e(G,null,{default:t(()=>{return[i("div",un,[e(Y,{color:"secondary",size:"small",label:"",class:"me-2"},{default:t(()=>[d(l(te(w.diagram_type)),1)]),_:2},1024)]),i("div",dn,[i("div",mn,[i("div",pn,[w.generation_status==="in_progress"?(n(),p("div",vn,[e(ie,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),i("div",fn,l(a(c)("projects.uml_diagrams.status.generating")),1)])):w.content?(n(),p("div",_n,[w.content?(n(),y(tt,{key:0,src:a(yt)(w.content),class:"diagram-svg",alt:a(c)("projects.uml_diagrams.title")},null,8,["src","alt"])):x("",!0)])):(n(),p("div",gn,[e(V,{icon:O(w.diagram_type),size:"48",color:"secondary"},null,8,["icon"]),i("div",hn,l(a(c)("projects.uml_diagrams.status.no_content.title")),1)]))]),i("div",yn,[e($,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.view")),1)]),_:1})])])]),i("div",bn,[i("div",jn,[e(V,{size:"16",icon:"tabler-calendar",class:"me-1"}),i("span",kn,l((U=w.created_at,U?(U=parseInt(U),new Date(U).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)])])];var U}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),k.value?(n(),y(an,{key:4,modelValue:q.value,"onUpdate:modelValue":M[2]||(M[2]=w=>q.value=w),diagram:k.value,onDelete:M[3]||(M[3]=w=>C.value=!0),"is-admin":a(I),"has-manager-permission":a(H),"has-moderator-permission":a(K)},null,8,["modelValue","diagram","is-admin","has-manager-permission","has-moderator-permission"])):x("",!0),e(xe,{modelValue:P.value,"onUpdate:modelValue":M[6]||(M[6]=w=>P.value=w),"max-width":"600",persistent:""},{default:t(()=>[e(W,null,{default:t(()=>[e(re,{class:"pt-5 pb-2"},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.generation.title")),1)]),_:1}),e(G,null,{default:t(()=>[i("p",xn,l(a(c)("projects.uml_diagrams.generation.description")),1),e(_e,{modelValue:L.value,"onUpdate:modelValue":M[4]||(M[4]=w=>L.value=w),items:N,label:a(c)("projects.uml_diagrams.type")},null,8,["modelValue","label"])]),_:1}),e(fe,null,{default:t(()=>[e($,{color:"secondary",variant:"tonal",onClick:M[5]||(M[5]=w=>P.value=!1)},{default:t(()=>[d(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(ae),e($,{color:"primary",onClick:A},{default:t(()=>[d(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{isDialogVisible:C.value,"onUpdate:isDialogVisible":M[7]||(M[7]=w=>C.value=w),confirmationMsg:a(c)("projects.uml_diagrams.delete_confirm.message"),onConfirm:le},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:D.value.show,"onUpdate:modelValue":M[9]||(M[9]=w=>D.value.show=w),color:D.value.color,timeout:5e3},{actions:t(()=>[e(E,{onClick:M[8]||(M[8]=w=>D.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(D.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-571ead72"]]),Vn={key:2,class:"d-flex justify-center align-center",style:{"min-height":"200px"}},qn={__name:"ProjectExportsList",props:{projectId:{type:String,required:!0},exports:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const{t:o}=ge(),r=f=>{switch(f){case"active":return"success";case"pending":return"warning";case"failed":return"error";default:return"grey"}};return(f,c)=>(n(),y(W,null,{default:t(()=>[e(G,null,{default:t(()=>[!s.loading&&s.exports.length>0?(n(),y(Ze,{key:0},{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,l(a(o)("projects.exports.table.template")),1),i("th",null,l(a(o)("projects.exports.table.format")),1),i("th",null,l(a(o)("projects.exports.table.status")),1),i("th",null,l(a(o)("projects.exports.table.created_by")),1),i("th",null,l(a(o)("projects.exports.table.created_at")),1),i("th",null,l(a(o)("projects.exports.table.actions")),1)])]),i("tbody",null,[(n(!0),p(Q,null,ne(s.exports,_=>{return n(),p("tr",{key:_.id},[i("td",null,l(_.template.name),1),i("td",null,l(_.fmt.toUpperCase()),1),i("td",null,[e(Y,{color:r(_.status),size:"small"},{default:t(()=>[d(l(a(o)(`projects.exports.status.${_.status}`)),1)]),_:2},1032,["color"])]),i("td",null,l(_.created_by.username),1),i("td",null,l((g=_.created_at,new Date(parseInt(g)).toLocaleString())),1),i("td",null,[_.url?(n(),y($,{key:0,icon:"",variant:"text",color:"primary",onClick:k=>(q=>{q.url&&window.open(q.url,"_blank")})(_)},{default:t(()=>[e(V,{icon:"tabler-download"})]),_:2},1032,["onClick"])):x("",!0)])]);var g}),128))])]),_:1})):s.loading||s.exports.length!==0?(n(),p("div",Vn,[e(ie,{indeterminate:"",color:"primary",size:"64"})])):(n(),y(Ue,{key:1,type:"info",variant:"tonal",class:"mt-4"},{default:t(()=>[d(l(a(o)("projects.exports.empty")),1)]),_:1}))]),_:1})]),_:1}))}},Cn={class:"text-center"},zn={class:"d-flex flex-wrap justify-space-between align-center"},Sn={class:"d-flex align-center"},Un={class:"text-h3"},Dn={class:"d-flex align-center mt-3 mt-sm-0"},In={__name:"[id]",setup(s){const u=Pt(),o=Bt(),r=$t();rt(),st();const f=Be(),{t:c}=ge(),_=z(!0),g=z(null),k=z("0"),q=z(!1),C=z(!1),P=z(!1),B=z({show:!1,text:"",color:"success"}),D=J(()=>u.params.id),I=J(()=>r.currentProject),H=J(()=>f.is_admin()),K=J(()=>f.userData.role>=2),N=J(()=>f.userData.role>=3),L=z(null),R=z(!1),T=[{title:"Markdown",value:"md",icon:"tabler-markdown"},{title:"PDF",value:"pdf",icon:"tabler-file-text"},{title:"HTML",value:"html",icon:"tabler-code"}],S=Ae(),A=z(null),le=async()=>{I.value||(_.value=!0),g.value=null;try{const{data:U,error:h}=await r.fetchProjectById(D.value);h&&(g.value=h,v("projects.errors.loading_failed"))}catch(U){g.value=U.message||"Failed to load project details",v("projects.errors.loading_failed")}finally{_.value=!1}},v=(U,h="success")=>{B.value={show:!0,text:c(U),color:h}},O=()=>{q.value=!0},te=async(U=!1)=>{if(U){C.value=!1,P.value=!0;try{const{success:h,error:m}=await r.deleteProject(D.value);h&&!m?(v("projects.notifications.deleted"),o.push({name:"projects"})):v("projects.notifications.error")}catch{v("projects.errors.delete_failed","error")}finally{P.value=!1}}},j=async U=>{P.value=!0;try{const{data:h,error:m}=await r.updateProject(D.value,U);v(h&&!m?"projects.notifications.updated":"projects.notifications.error")}catch{v("projects.errors.update_failed","error")}finally{P.value=!1}},M=async()=>{P.value=!0;try{const{data:U,error:h}=await r.generateRequirements(D.value);U&&!h?v("projects.notifications.requirements_generation_started"):v("projects.notifications.requirements_generation_failed","error")}catch{v("projects.notifications.requirements_generation_failed","error")}finally{P.value=!1}},Z=async()=>{P.value=!0;try{const{data:U,error:h}=await r.generatePlan(D.value);U&&!h?v("projects.notifications.plan_generation_started"):v("projects.notifications.plan_generation_failed","error")}catch{v("projects.notifications.plan_generation_failed","error")}finally{P.value=!1}},E=async()=>{P.value=!0;try{const{data:U,error:h}=await r.generateMockups(D.value);U&&!h?v("projects.notifications.mockups_generation_started"):v("projects.notifications.mockups_generation_failed","error")}catch{v("projects.notifications.mockups_generation_failed","error")}finally{P.value=!1}},w=U=>{L.value=U,k.value="2"};return qe(()=>{le(),A.value=setInterval(()=>{S.emit("project-refresh"),le()},8e3)}),Mt(()=>{A.value&&(clearInterval(A.value),A.value=null)}),(U,h)=>{const m=Oe,ce=ye("IconBtn");return n(),y(Lt,{fluid:""},{default:t(()=>[_.value&&!a(I)?(n(),y(se,{key:0},{default:t(()=>[e(F,{cols:"12",class:"d-flex justify-center align-center",style:{"min-height":"400px"}},{default:t(()=>[e(ie,{indeterminate:"",color:"primary",size:"64"})]),_:1})]),_:1})):g.value&&!a(I)?(n(),y(se,{key:1},{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(Ue,{color:"error",variant:"tonal",title:a(c)("projects.errors.loading_failed"),text:a(c)("projects.errors.loading_failed"),class:"mb-4"},null,8,["title","text"]),i("div",Cn,[e($,{color:"primary",onClick:le},{default:t(()=>[d(l(U.$t("projects.actions.retry")),1)]),_:1}),e($,{color:"secondary",variant:"outlined",class:"ms-2",to:{name:"projects"}},{default:t(()=>[d(l(U.$t("projects.actions.back_to_projects")),1)]),_:1})])]),_:1})]),_:1})):a(I)?(n(),p(Q,{key:2},[e(se,null,{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[i("div",zn,[i("div",Sn,[e($,{icon:"",variant:"text",class:"me-3",to:{name:"projects"}},{default:t(()=>[e(V,{icon:"tabler-arrow-left"})]),_:1}),i("h3",Un,l(a(I).name),1)]),i("div",Dn,[e($,{color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"me-2",onClick:le,loading:P.value},{default:t(()=>[d(l(U.$t("projects.actions.refresh")),1)]),_:1},8,["loading"]),a(N)?(n(),y(Ot,{key:0,modelValue:R.value,"onUpdate:modelValue":h[0]||(h[0]=b=>R.value=b),location:"top",loading:P.value},{activator:t(({props:b})=>[e($,ht(b,{color:"secondary",variant:"outlined","prepend-icon":"tabler-file-export",class:"me-2"}),{default:t(()=>[d(l(U.$t("projects.actions.export_srs")),1)]),_:2},1040)]),default:t(()=>[e(Ne,null,{default:t(()=>[(n(),p(Q,null,ne(T,b=>e(He,{key:b.value,value:b.value,onClick:oe=>{(async(ke="md")=>{P.value=!0;try{const{data:me,error:ze}=await r.exportSrs(D.value,ke);me&&!ze?(v("projects.notifications.srs_export_started"),k.value="6"):v("projects.notifications.srs_export_failed","error")}catch{v("projects.notifications.srs_export_failed","error")}finally{P.value=!1}})(b.value),R.value=!1}},{prepend:t(()=>[e(V,{icon:b.icon},null,8,["icon"])]),default:t(()=>[e(Ye,null,{default:t(()=>[d(l(b.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1},8,["modelValue","loading"])):x("",!0),a(K)?(n(),y($,{key:1,color:"primary","prepend-icon":"tabler-edit",class:"me-2",onClick:O,loading:P.value},{default:t(()=>[d(l(U.$t("projects.actions.edit")),1)]),_:1},8,["loading"])):x("",!0),a(H)?(n(),y($,{key:2,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:h[1]||(h[1]=b=>C.value=!0),loading:P.value},{default:t(()=>[d(l(U.$t("projects.actions.delete")),1)]),_:1},8,["loading"])):x("",!0)])])]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(F,{cols:"12"},{default:t(()=>[e(W,null,{default:t(()=>[e(at,{modelValue:k.value,"onUpdate:modelValue":h[2]||(h[2]=b=>k.value=b),"bg-color":"primary",grow:"","slider-color":"white"},{default:t(()=>[e(pe,{value:"0",color:"white"},{default:t(()=>[e(V,{size:"18",icon:"tabler-info-circle",start:""}),d(" "+l(U.$t("projects.tabs.overview")),1)]),_:1}),e(pe,{value:"1",color:"white"},{default:t(()=>{var b;return[e(V,{size:"18",icon:"tabler-list",start:""}),d(" "+l(U.$t("projects.tabs.requirements"))+" ",1),(b=a(I).requirements)!=null&&b.length?(n(),y(Y,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>[d(l(a(I).requirements.length),1)]),_:1})):x("",!0)]}),_:1}),e(pe,{value:"2",color:"white"},{default:t(()=>{var b;return[e(V,{size:"18",icon:"tabler-user-check",start:""}),d(" "+l(U.$t("projects.tabs.user_stories"))+" ",1),(b=a(I).user_stories)!=null&&b.length?(n(),y(Y,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var oe;return[d(l(((oe=a(I).user_stories)==null?void 0:oe.length)||0),1)]}),_:1})):x("",!0)]}),_:1}),e(pe,{value:"3",color:"white"},{default:t(()=>{var b;return[e(V,{size:"18",icon:"tabler-layout-kanban",start:""}),d(" "+l(U.$t("projects.tabs.mockups"))+" ",1),(b=a(I).mockups)!=null&&b.length?(n(),y(Y,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>[d(l(a(I).mockups.length),1)]),_:1})):x("",!0)]}),_:1}),e(pe,{value:"4",color:"white"},{default:t(()=>{var b;return[e(V,{size:"18",icon:"tabler-chart-dots",start:""}),d(" "+l(U.$t("projects.tabs.uml_diagrams"))+" ",1),(b=a(I).uml_diagrams)!=null&&b.length?(n(),y(Y,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var oe;return[d(l(((oe=a(I).uml_diagrams)==null?void 0:oe.length)||0),1)]}),_:1})):x("",!0)]}),_:1}),e(pe,{value:"5",color:"white"},{default:t(()=>[e(V,{size:"18",icon:"tabler-chart-dots",start:""}),d(" "+l(U.$t("projects.tabs.development_plan")),1)]),_:1}),e(pe,{value:"6",color:"white"},{default:t(()=>{var b;return[e(V,{size:"18",icon:"tabler-file-export",start:""}),d(" "+l(U.$t("projects.tabs.exports"))+" ",1),(b=a(I).srs_exports)!=null&&b.length?(n(),y(Y,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var oe;return[d(l(((oe=a(I).srs_exports)==null?void 0:oe.length)||0),1)]}),_:1})):x("",!0)]}),_:1})]),_:1},8,["modelValue"]),e(ee),e(lt,{modelValue:k.value,"onUpdate:modelValue":h[5]||(h[5]=b=>k.value=b)},{default:t(()=>[e(ve,{value:"0"},{default:t(()=>[e(Ma,{project:a(I),loading:_.value},null,8,["project","loading"])]),_:1}),e(ve,{value:"1"},{default:t(()=>[e(fe,{class:"pt-3 px-6"},{default:t(()=>[e(ae),a(N)?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:M,loading:P.value},{default:t(()=>[d(l(a(c)("projects.requirements.actions.generate")),1)]),_:1},8,["loading"])):x("",!0)]),_:1}),e(Cr,{"project-id":a(D),requirements:a(I).requirements||[],loading:_.value,onRefresh:le,onViewUserStories:w},null,8,["project-id","requirements","loading"])]),_:1}),e(ve,{value:"2"},{default:t(()=>{var b,oe;return[e(fe,{class:"pt-3 px-6"},{default:t(()=>[L.value?(n(),y($,{key:0,color:"secondary",variant:"tonal","prepend-icon":"tabler-arrow-left",onClick:h[3]||(h[3]=ke=>L.value=null)},{default:t(()=>[d(l(U.$t("projects.actions.back_to_all_user_stories")),1)]),_:1})):x("",!0),e(ae),a(N)?(n(),y($,{key:1,color:"primary","prepend-icon":"tabler-refresh",onClick:h[4]||(h[4]=ke=>(async(me=null)=>{P.value=!0;try{let ze;if(me){const{data:Me,error:We}=await r.generateUserStories(D.value,me);ze={data:Me,error:We}}else{const{data:Me,error:We}=await r.generateUserStories(D.value);ze={data:Me,error:We}}ze.data&&!ze.error?v("projects.notifications.user_stories_generation_started"):v("projects.notifications.user_stories_generation_failed","error")}catch{v("projects.notifications.user_stories_generation_failed","error")}finally{P.value=!1}})(L.value?L.value.id:null)),loading:P.value},{default:t(()=>[d(l(U.$t(L.value?"projects.actions.generate_user_stories_for_requirement":"projects.actions.generate_all_user_stories")),1)]),_:1},8,["loading"])):x("",!0)]),_:1}),e(Pi,{"project-id":a(D),"requirement-id":L.value?L.value.id:null,"user-stories":L.value?((oe=(b=a(I).requirements)==null?void 0:b.find(ke=>ke.id===L.value.id))==null?void 0:oe.user_stories)||[]:a(I).user_stories||[],loading:_.value,onRefresh:le},null,8,["project-id","requirement-id","user-stories","loading"])]}),_:1}),e(ve,{value:"3"},{default:t(()=>[e(fe,{class:"pt-3 px-6"},{default:t(()=>[e(ae),a(N)?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:E,loading:P.value},{default:t(()=>[d(l(a(c)("projects.mockups.actions.generate")),1)]),_:1},8,["loading"])):x("",!0)]),_:1}),e(Qr,{"project-id":a(D),mockups:a(I).mockups||[],loading:_.value,onRefresh:le},null,8,["project-id","mockups","loading"])]),_:1}),e(ve,{value:"4"},{default:t(()=>[e(wn,{"project-id":a(D),diagrams:a(I).uml_diagrams||[],loading:_.value,onRefresh:le},null,8,["project-id","diagrams","loading"])]),_:1}),e(ve,{value:"5"},{default:t(()=>[e(fe,{class:"pt-3 px-6"},{default:t(()=>[e(ae),a(K)?(n(),y($,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:Z,loading:P.value},{default:t(()=>[d(l(U.$t("projects.development_plan.actions.generate")),1)]),_:1},8,["loading"])):x("",!0)]),_:1}),e(Es,{"project-id":a(D),"development-plan":a(I).development_plan,loading:_.value,onRefresh:le},null,8,["project-id","development-plan","loading"])]),_:1}),e(ve,{value:"6"},{default:t(()=>[e(qn,{"project-id":a(D),exports:a(I).srs_exports||[],loading:_.value,onRefresh:le},null,8,["project-id","exports","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):x("",!0),a(I)?(n(),y(Ft,{key:3,modelValue:q.value,"onUpdate:modelValue":h[6]||(h[6]=b=>q.value=b),"edit-mode":"","project-data":a(I),onSubmit:j},null,8,["modelValue","project-data"])):x("",!0),e(m,{isDialogVisible:C.value,"onUpdate:isDialogVisible":h[7]||(h[7]=b=>C.value=b),confirmationMsg:a(c)("projects.delete_confirm.message"),onConfirm:te},null,8,["isDialogVisible","confirmationMsg"]),e(we,{modelValue:B.value.show,"onUpdate:modelValue":h[9]||(h[9]=b=>B.value.show=b),color:B.value.color,timeout:5e3},{actions:t(()=>[e(ce,{onClick:h[8]||(h[8]=b=>B.value.show=!1)},{default:t(()=>[e(V,{icon:"tabler-x"})]),_:1})]),default:t(()=>[d(l(B.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}};typeof nt=="function"&&nt(In);export{In as default};
