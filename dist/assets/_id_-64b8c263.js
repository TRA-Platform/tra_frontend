import{L as Je,N as Ke,b4 as dt,R as at,S as mt,W as pt,b5 as vt,a9 as Ze,p as e,G as Ae,a8 as St,Z as Fe,E as ee,ac as ft,Q as _t,b6 as gt,O as yt,b7 as Ut,Y as ct,a1 as zt,$ as It,ap as q,b8 as Dt,b9 as $t,ba as Pt,k,I as pe,o as n,b as g,y as t,aI as te,aY as Y,C as P,m as o,A as l,b1 as me,D as m,aV as Oe,bb as oe,aD as Ue,aB as ye,aJ as ve,bc as Mt,aL as ze,aK as re,q as a,bd as Le,aj as w,c as f,F as ae,a as ue,at as Be,H as Ce,a$ as Ne,r as ke,ah as de,s as lt,aZ as we,aX as Ve,ar as De,b3 as Ee,w as Me,be as Bt,aG as Rt,aH as Lt,bf as ht,aa as jt,bg as At,J as Ft,b0 as Ot,t as Nt}from"./index-e9072ce0.js";import{V as je}from"./VDialog-e1ace5b5.js";import{a as qe,u as Et,_ as Wt,V as Tt}from"./ProjectCreateDialog-5b1e5fa0.js";import{V as se,a as B}from"./VRow-36cb30de.js";import{V as ie}from"./VDivider-8d1faf33.js";import{V as K}from"./VChip-73a50b88.js";import{g as be,a as tt,b as bt}from"./formatters-29e4fec9.js";import{V as le}from"./VSpacer-bd838855.js";import{V as Se}from"./VForm-220aabec.js";import{b as ne}from"./VTextField-0203ba02.js";import{V as fe}from"./VSelect-55c3b9b7.js";import{b as rt,c as _e,V as xe,a as kt}from"./VTabs-c84e3d0d.js";import{V as st,a as ge}from"./VSlideGroup-b8a54ec2.js";import{V as Ge,a as Xe,b as He}from"./VList-637c4a10.js";import{V as Gt}from"./VTooltip-ea13f802.js";import{b as ut}from"./route-block-83d24a4e.js";import{V as Xt}from"./VMenu-f88d2d6a.js";import"./index-45054087.js";import"./VCheckboxBtn-ca3cb990.js";import"./ssrBoot-67c93f2a.js";const Pe=Je()({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...Ke(),...dt(),...at(),...mt()},setup(s,u){let{slots:i}=u;const{themeClasses:r}=pt(s),{densityClasses:v}=vt(s);return Ze(()=>e(s.tag,{class:["v-table",{"v-table--fixed-height":!!s.height,"v-table--fixed-header":s.fixedHeader,"v-table--fixed-footer":s.fixedFooter,"v-table--has-top":!!i.top,"v-table--has-bottom":!!i.bottom,"v-table--hover":s.hover},r.value,v.value,s.class],style:s.style},{default:()=>{var c,_,h;return[(c=i.top)==null?void 0:c.call(i),i.default?e("div",{class:"v-table__wrapper",style:{height:Ae(s.height)}},[e("table",null,[i.default()])]):(_=i.wrapper)==null?void 0:_.call(i),(h=i.bottom)==null?void 0:h.call(i)]}})),{}}}),xt=Je()({name:"VTimeline",props:{align:{type:String,default:"center",validator:s=>["center","start"].includes(s)},direction:{type:String,default:"vertical",validator:s=>["vertical","horizontal"].includes(s)},justify:{type:String,default:"auto",validator:s=>["auto","center"].includes(s)},side:{type:String,validator:s=>s==null||["start","end"].includes(s)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:s=>["start","end","both"].includes(s)},...Ke(),...dt(),...at(),...mt()},setup(s,u){let{slots:i}=u;const{themeClasses:r}=pt(s),{densityClasses:v}=vt(s);St({VTimelineDivider:{lineColor:Fe(s,"lineColor")},VTimelineItem:{density:Fe(s,"density"),lineInset:Fe(s,"lineInset")}});const c=ee(()=>{const h=s.side?s.side:s.density!=="default"?"end":null;return h&&`v-timeline--side-${h}`}),_=ee(()=>{const h=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(s.truncateLine){case"both":return h;case"start":return h[0];case"end":return h[1];default:return null}});return Ze(()=>e(s.tag,{class:["v-timeline",`v-timeline--${s.direction}`,`v-timeline--align-${s.align}`,`v-timeline--justify-${s.justify}`,_.value,{"v-timeline--inset-line":!!s.lineInset},r.value,v.value,c.value,s.class],style:[{"--v-timeline-line-thickness":Ae(s.lineThickness)},s.style]},i)),{}}}),Ht=Je()({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:ft,iconColor:String,lineColor:String,...Ke(),..._t(),...gt(),...yt()},setup(s,u){let{slots:i}=u;const{sizeClasses:r,sizeStyles:v}=Ut(s,"v-timeline-divider__dot"),{backgroundColorStyles:c,backgroundColorClasses:_}=ct(Fe(s,"dotColor")),{roundedClasses:h}=zt(s,"v-timeline-divider__dot"),{elevationClasses:j}=It(s),{backgroundColorClasses:U,backgroundColorStyles:C}=ct(Fe(s,"lineColor"));return Ze(()=>e("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":s.fillDot},s.class],style:s.style},[e("div",{class:["v-timeline-divider__before",U.value],style:C.value},null),!s.hideDot&&e("div",{key:"dot",class:["v-timeline-divider__dot",j.value,h.value,r.value],style:v.value},[e("div",{class:["v-timeline-divider__inner-dot",_.value,h.value],style:c.value},[i.default?e(Dt,{key:"icon-defaults",disabled:!s.icon,defaults:{VIcon:{color:s.iconColor,icon:s.icon,size:s.size}}},i.default):e(q,{key:"icon",color:s.iconColor,icon:s.icon,size:s.size},null)])]),e("div",{class:["v-timeline-divider__after",U.value],style:C.value},null)])),{}}}),wt=Je()({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:ft,iconColor:String,lineInset:[Number,String],...Ke(),...$t(),...yt(),..._t(),...gt(),...at()},setup(s,u){let{slots:i}=u;const{dimensionStyles:r}=Pt(s),v=k(0),c=k();return pe(c,_=>{var h;_&&(v.value=((h=_.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:h.getBoundingClientRect().width)??0)},{flush:"post"}),Ze(()=>{var _,h;return e("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":s.fillDot},s.class],style:[{"--v-timeline-dot-size":Ae(v.value),"--v-timeline-line-inset":s.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${Ae(s.lineInset)})`:Ae(0)},s.style]},[e("div",{class:"v-timeline-item__body",style:r.value},[(_=i.default)==null?void 0:_.call(i)]),e(Ht,{ref:c,hideDot:s.hideDot,icon:s.icon,iconColor:s.iconColor,size:s.size,elevation:s.elevation,dotColor:s.dotColor,fillDot:s.fillDot,rounded:s.rounded},{default:i.icon}),s.density!=="compact"&&e("div",{class:"v-timeline-item__opposite"},[!s.hideOpposite&&((h=i.opposite)==null?void 0:h.call(i))])])}),{}}}),Jt=o("span",{class:"text-5xl"},"!",-1),Kt={class:"text-lg font-weight-medium"},We={__name:"ConfirmDialog",props:{confirmationMsg:{type:String,required:!0},isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","confirm"],setup(s,{emit:u}){const i=s,r=_=>{u("update:isDialogVisible",_)},v=()=>{u("confirm",!0),r(!1)},c=()=>{u("confirm",!1),u("update:isDialogVisible",!1)};return(_,h)=>(n(),g(je,{"max-width":"500","model-value":i.isDialogVisible,"onUpdate:modelValue":r},{default:t(()=>[e(te,{class:"text-center px-10 py-6"},{default:t(()=>[e(Y,null,{default:t(()=>[e(P,{icon:"",variant:"outlined",color:"warning",class:"mb-4",style:{width:"88px",height:"88px","pointer-events":"none"}},{default:t(()=>[Jt]),_:1}),o("h6",Kt,l(i.confirmationMsg),1)]),_:1}),e(me,{class:"align-center justify-center gap-2"},{default:t(()=>[e(P,{variant:"elevated",onClick:v},{default:t(()=>[m(l(_.$t("confirmation.confirm")),1)]),_:1}),e(P,{color:"secondary",variant:"tonal",onClick:c},{default:t(()=>[m(l(_.$t("confirmation.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},ot=Oe({id:"UserStoryStore",state:()=>({userStories:[],currentUserStory:null,loading:!1,error:null}),actions:{async fetchUserStories(s=null){this.loading=!0;try{let u="/service/user-stories/";s&&(u+=`?requirement=${s}`);const i=await oe.get(u);return i.status===200?(this.userStories=i.data,{data:i.data,error:null}):{data:[],error:i.data}}catch(u){return this.error=u.message||"Failed to fetch user stories",{data:[],error:this.error}}finally{this.loading=!1}},async fetchUserStoryById(s){this.loading=!0;try{const u=await oe.get(`/service/user-stories/${s}/`);return u.status===200?(this.currentUserStory=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch user story",{data:null,error:this.error}}finally{this.loading=!1}},async createUserStory(s){this.loading=!0;try{const u=await oe.post("/service/user-stories/",s);return u.status===201?(this.userStories.length&&this.userStories.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create user story",{data:null,error:this.error}}finally{this.loading=!1}},async updateUserStory(s,u){this.loading=!0;try{const i=await oe.put(`/service/user-stories/${s}/`,u);if(i.status===200){if(this.userStories.length){const r=this.userStories.findIndex(v=>v.id===s);r!==-1&&(this.userStories[r]=i.data)}return this.currentUserStory&&this.currentUserStory.id===s&&(this.currentUserStory=i.data),{data:i.data,error:null}}return{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to update user story",{data:null,error:this.error}}finally{this.loading=!1}},async deleteUserStory(s){this.loading=!0;try{const u=await oe.delete(`/service/user-stories/${s}/`);return u.status===204?(this.userStories.length&&(this.userStories=this.userStories.filter(i=>i.id!==s)),this.currentUserStory&&this.currentUserStory.id===s&&(this.currentUserStory=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete user story",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateUserStory(s,u=""){this.loading=!0;try{const i=await oe.post(`/service/user-stories/${s}/regenerate/`,{feedback:u});return i.status===202?{data:i.data,error:null}:{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to regenerate user story",{data:null,error:this.error}}finally{this.loading=!1}},async createComment(s,u){this.loading=!0;try{const i=await oe.post("/service/user-story-comments/",{user_story:s,text:u.text,status:u.status||"active"});return i.status===201?{data:i.data,error:null}:{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(s){this.loading=!0;try{const u=await oe.delete(`/service/user-story-comments/${s}/`);return u.status===204?{success:!0,error:null}:{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),it=Oe({id:"UmlDiagramStore",state:()=>({diagrams:[],currentDiagram:null,loading:!1,error:null}),actions:{async fetchDiagrams(s=null,u=null){this.loading=!0;try{let i="/service/uml-diagrams/";const r={};s&&(r.project=s),u&&(r.diagram_type=u);const v=await oe.get(i,{params:r});return v.status===200?(this.diagrams=v.data,{data:v.data,error:null}):{data:[],error:v.data}}catch(i){return this.error=i.message||"Failed to fetch UML diagrams",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDiagramById(s){this.loading=!0;try{const u=await oe.get(`/service/uml-diagrams/${s}/`);return u.status===200?(this.currentDiagram=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async createDiagram(s){this.loading=!0;try{const u=await oe.post("/service/uml-diagrams/",s);return u.status===201?(this.diagrams.length&&this.diagrams.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async updateDiagram(s,u){this.loading=!0;try{const i=await oe.put(`/service/uml-diagrams/${s}/`,u);if(i.status===200){if(this.diagrams.length){const r=this.diagrams.findIndex(v=>v.id===s);r!==-1&&(this.diagrams[r]=i.data)}return this.currentDiagram&&this.currentDiagram.id===s&&(this.currentDiagram=i.data),{data:i.data,error:null}}return{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to update UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async deleteDiagram(s){this.loading=!0;try{const u=await oe.delete(`/service/uml-diagrams/${s}/`);return u.status===204?(this.diagrams.length&&(this.diagrams=this.diagrams.filter(i=>i.id!==s)),this.currentDiagram&&this.currentDiagram.id===s&&(this.currentDiagram=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete UML diagram",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateDiagram(s){this.loading=!0;try{const u=await oe.post(`/service/uml-diagrams/${s}/regenerate/`);return u.status===202?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to regenerate UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async generateDiagrams(s,u="class"){this.loading=!0;try{const i=await oe.post(`/service/projects/${s}/generate_uml_diagrams/`,{diagram_type:u});return i.status===202?{data:i.data,error:null}:{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to generate UML diagrams",{data:null,error:this.error}}finally{this.loading=!1}}}}),Zt={class:"d-flex flex-column gap-4"},Qt={class:"d-flex flex-column gap-3"},Yt={class:"font-weight-medium mb-1"},ea={class:"d-flex justify-space-between mt-1"},ta={class:"font-weight-medium mb-1"},aa={class:"d-flex justify-space-between mt-1"},la={class:"font-weight-medium mb-1"},ra={class:"d-flex align-center gap-2"},sa={class:"flex-grow-1"},oa={class:"font-weight-medium mb-1"},ia={class:"d-flex justify-space-between mt-1"},na={class:"d-flex flex-column gap-2"},ca={class:"d-flex align-center"},ua={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},da={class:"d-flex align-center"},ma={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},pa={class:"d-flex align-center"},va={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},fa={class:"d-flex align-center"},_a={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ga={key:0,class:"d-flex align-center"},ya={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ha={key:1,class:"d-flex align-center"},ja={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},ba={key:2,class:"d-flex align-center"},ka={class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},xa={class:"d-flex align-center"},wa=["title"],Va={class:"ms-2"},qa={class:"whitespace-pre-wrap"},Ca={class:"d-flex flex-column gap-4"},Sa={key:0},Ua={class:"text-subtitle-1 font-weight-bold mb-2"},za={class:"whitespace-pre-wrap"},Ia={key:1},Da={class:"text-subtitle-1 font-weight-bold mb-2"},$a={class:"d-flex flex-column gap-4"},Pa={class:"whitespace-pre-wrap mb-4"},Ma={key:0,class:"whitespace-pre-wrap"},Ba={class:"text-subtitle-1 font-weight-bold mb-2"},Ra={class:"whitespace-pre-wrap"},La={class:"whitespace-pre-wrap"},Aa={class:"whitespace-pre-wrap"},Fa=Ue({__name:"ProjectDetailsInfo",props:{project:{type:Object,required:!0},loading:{type:Boolean,default:!1},canManage:{type:Boolean,default:!1}},emits:["update","generate-requirements"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=U=>U?new Date(parseInt(U)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):r("projects.details.not_set"),c=ee(()=>{switch(i.project.status){case"draft":return"warning";case"active":return"success";case"archived":return"secondary";case"completed":return"info";default:return"primary"}}),_=ee(()=>{switch(i.project.type_of_application){case"website":return"tabler-world-www";case"mobile":return"tabler-device-mobile";case"desktop":return"tabler-device-desktop";case"api":return"tabler-api";default:return"tabler-code"}}),h={en:r("projects.languages.english"),ru:r("projects.languages.russian"),de:r("projects.languages.german")},j=()=>{u("generate-requirements")};return(U,C)=>(n(),g(Y,{class:"pa-6"},{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12",md:"6"},{default:t(()=>[o("div",Zt,[s.project.generation_progress?(n(),g(te,{key:0,border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,Mt({prepend:t(()=>[e(ze,{color:"info",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(q,{icon:"tabler-info-circle"})]),_:1})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.generation_status")),1)]),_:1})]),_:2},[s.canManage?{name:"append",fn:t(()=>[e(P,{variant:"text",color:"primary",icon:"tabler-refresh",size:"small",onClick:j})]),key:"0"}:void 0]),1024),e(ie),e(Y,null,{default:t(()=>[o("div",Qt,[o("div",null,[o("div",Yt,l(a(r)("projects.details.requirements")),1),e(Le,{"model-value":s.project.generation_progress.requirements.status==="completed"?100:s.project.generation_progress.requirements.status==="in_progress"?50:s.project.generation_progress.requirements.status==="pending"?10:0,color:s.project.generation_progress.requirements.status==="completed"?"success":s.project.generation_progress.requirements.status==="in_progress"?"info":s.project.generation_progress.requirements.status==="failed"?"error":"warning",height:"8",rounded:""},null,8,["model-value","color"]),o("div",ea,[o("small",null,l(a(r)(`projects.details.${s.project.generation_progress.requirements.status}`)),1),o("small",null,l(s.project.requirements?s.project.requirements.length:0)+" "+l(a(r)("projects.details.requirements_count")),1)])]),o("div",null,[o("div",ta,l(a(r)("projects.details.user_stories")),1),e(Le,{"model-value":s.project.generation_progress.user_stories.total>0?s.project.generation_progress.user_stories.completed/s.project.generation_progress.user_stories.total*100:0,color:"info",height:"8",rounded:""},null,8,["model-value"]),o("div",aa,[o("small",null,l(s.project.generation_progress.user_stories.completed)+" "+l(a(r)("projects.details.completed")),1),o("small",null,l(s.project.generation_progress.user_stories.total)+" "+l(a(r)("projects.details.total")),1)])]),o("div",null,[o("div",la,l(a(r)("projects.details.mockups")),1),o("div",ra,[o("div",sa,[e(Le,{"model-value":s.project.mockups&&s.project.mockups.length?s.project.mockups.filter(S=>S.generation_status==="completed"&&!S.needs_regeneration).length/s.project.mockups.length*100:0,color:"success",height:"8",rounded:""},null,8,["model-value"])]),o("div",null,[s.project.mockups&&s.project.mockups.some(S=>S.needs_regeneration||S.generation_status==="in_progress"||S.generation_status==="pending")?(n(),g(K,{key:0,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(s.project.mockups.filter(S=>S.needs_regeneration||S.generation_status==="in_progress"||S.generation_status==="pending").length)+" "+l(a(r)("projects.details.pending")),1)]),_:1})):w("",!0)])])]),o("div",null,[o("div",oa,l(a(r)("projects.details.uml_diagrams")),1),e(Le,{"model-value":s.project.generation_progress.uml_diagrams.total>0?s.project.generation_progress.uml_diagrams.completed/s.project.generation_progress.uml_diagrams.total*100:0,color:"primary",height:"8",rounded:""},null,8,["model-value"]),o("div",ia,[o("small",null,l(s.project.generation_progress.uml_diagrams.completed)+" "+l(a(r)("projects.details.completed")),1),o("small",null,l(s.project.generation_progress.uml_diagrams.total)+" "+l(a(r)("projects.details.total")),1)])])])]),_:1})]),_:1})):w("",!0),e(te,{border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(ze,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(q,{icon:a(_)},null,8,["icon"])]),_:1})]),append:t(()=>[e(K,{size:"small",color:a(c),label:""},{default:t(()=>[m(l(a(r)(`projects.status.${s.project.status}`)),1)]),_:1},8,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.project_overview")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",na,[o("div",ca,[o("span",ua,l(a(r)("projects.details.created_at"))+":",1),o("span",null,l(v(s.project.created_at)),1)]),o("div",da,[o("span",ma,l(a(r)("projects.details.updated_at"))+":",1),o("span",null,l(v(s.project.updated_at)),1)]),o("div",pa,[o("span",va,l(a(r)("projects.details.type"))+":",1),e(K,{size:"small"},{default:t(()=>[m(l(a(r)(`projects.types.${s.project.type_of_application}`)),1)]),_:1})]),o("div",fa,[o("span",_a,l(a(r)("projects.details.language"))+":",1),e(K,{size:"small"},{default:t(()=>{return[m(l((S=s.project.language,h[S]||S)),1)];var S}),_:1})]),s.project.deadline?(n(),f("div",ga,[o("span",ya,l(a(r)("projects.details.deadline"))+":",1),o("span",null,l(v(s.project.deadline)),1)])):w("",!0),s.project.preliminary_budget?(n(),f("div",ha,[o("span",ja,l(a(r)("projects.details.budget"))+":",1),o("span",null,"$"+l(s.project.preliminary_budget),1)])):w("",!0),s.project.color_scheme?(n(),f("div",ba,[o("span",ka,l(a(r)("projects.details.color_scheme"))+":",1),o("div",xa,[(n(!0),f(ae,null,ue(s.project.color_scheme.split(","),(S,R)=>(n(),f("div",{key:R,class:"color-swatch rounded me-1",style:Be({backgroundColor:S.trim()}),title:a(r)("projects.details.color")},null,12,wa))),128)),o("span",Va,l(s.project.color_scheme),1)])])):w("",!0)])]),_:1})]),_:1}),s.project.additional_requirements?(n(),g(te,{key:1,border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(q,{color:"primary",icon:"tabler-list-details"})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.additional_requirements")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",qa,l(s.project.additional_requirements),1)]),_:1})]),_:1})):w("",!0),s.project.technology_stack||s.project.operating_system?(n(),g(te,{key:2,border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(q,{color:"primary",icon:"tabler-device-laptop"})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.technical_details")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",Ca,[s.project.technology_stack?(n(),f("div",Sa,[o("h6",Ua,l(a(r)("projects.details.technology_stack")),1),o("div",za,l(s.project.technology_stack),1)])):w("",!0),s.project.operating_system?(n(),f("div",Ia,[o("h6",Da,l(a(r)("projects.details.operating_system")),1),o("div",null,l(s.project.operating_system),1)])):w("",!0)])]),_:1})]),_:1})):w("",!0)])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[o("div",$a,[e(te,{border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(q,{color:"primary",icon:"tabler-file-description"})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.description")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",Pa,l(s.project.short_description),1),s.project.application_description?(n(),f("div",Ma,[o("h6",Ba,l(a(r)("projects.details.application_description")),1),o("div",null,l(s.project.application_description),1)])):w("",!0)]),_:1})]),_:1}),s.project.target_users?(n(),g(te,{key:0,border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(q,{color:"primary",icon:"tabler-users"})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.target_users")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",Ra,l(s.project.target_users),1)]),_:1})]),_:1})):w("",!0),s.project.non_functional_requirements?(n(),g(te,{key:1,border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(q,{color:"primary",icon:"tabler-chart-bubble"})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.non_functional_requirements")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",La,l(s.project.non_functional_requirements),1)]),_:1})]),_:1})):w("",!0),s.project.priority_modules?(n(),g(te,{key:2,border:"",class:"project-info-card"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(q,{color:"primary",icon:"tabler-star"})]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.details.priority_modules")),1)]),_:1})]),_:1}),e(ie),e(Y,null,{default:t(()=>[o("div",Aa,l(s.project.priority_modules),1)]),_:1})]),_:1})):w("",!0)])]),_:1})]),_:1})]),_:1}))}},[["__scopeId","data-v-64ae6fbd"]]),Vt=Oe({id:"RequirementStore",state:()=>({requirements:[],currentRequirement:null,loading:!1,error:null}),actions:{async fetchRequirements(s=null){this.loading=!0;try{let u="/service/requirements/";s&&(u+=`?project=${s}`);const i=await oe.get(u);return i.status===200?(this.requirements=i.data,{data:i.data,error:null}):{data:[],error:i.data}}catch(u){return this.error=u.message||"Failed to fetch requirements",{data:[],error:this.error}}finally{this.loading=!1}},async fetchRequirementById(s){this.loading=!0;try{const u=await oe.get(`/service/requirements/${s}/`);return u.status===200?(this.currentRequirement=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch requirement",{data:null,error:this.error}}finally{this.loading=!1}},async createRequirement(s){this.loading=!0;try{const u=await oe.post("/service/requirements/",s);return u.status===201?(this.requirements.length&&this.requirements.push(u.data),{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create requirement",{data:null,error:this.error}}finally{this.loading=!1}},async updateRequirement(s,u){this.loading=!0;try{const i=await oe.put(`/service/requirements/${s}/`,u);if(i.status===200){if(this.requirements.length){const r=this.requirements.findIndex(v=>v.id===s);r!==-1&&(this.requirements[r]=i.data)}return this.currentRequirement&&this.currentRequirement.id===s&&(this.currentRequirement=i.data),{data:i.data,error:null}}return{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to update requirement",{data:null,error:this.error}}finally{this.loading=!1}},async deleteRequirement(s){this.loading=!0;try{const u=await oe.delete(`/service/requirements/${s}/`);return u.status===204?(this.requirements.length&&(this.requirements=this.requirements.filter(i=>i.id!==s)),this.currentRequirement&&this.currentRequirement.id===s&&(this.currentRequirement=null),{success:!0,error:null}):{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete requirement",{success:!1,error:this.error}}finally{this.loading=!1}},async createComment(s,u){this.loading=!0;try{const i=await oe.post("/service/requirement-comments/",{requirement:s,text:u.text,status:u.status||"active",responsible_user:u.responsibleUser||null});return i.status===201?{data:i.data,error:null}:{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(s){this.loading=!0;try{const u=await oe.delete(`/service/requirement-comments/${s}/`);return u.status===204?{success:!0,error:null}:{success:!1,error:u.data}}catch(u){return this.error=u.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),Qe=Oe("mockup",()=>{const s=k([]),u=k(!1),i=k(null);return{mockups:s,loading:u,error:i,fetchProjectMockups:async r=>{u.value=!0,i.value=null;try{const v=await oe.get(`/service/projects/${r}/mockups/`);return s.value=v.data,v.data}catch(v){throw i.value="Failed to fetch mockups",console.error(v),v}finally{u.value=!1}},fetchMockupById:async r=>{u.value=!0,i.value=null;try{const v=await oe.get(`/service/mockups/${r}/`),c=s.value.findIndex(_=>_.id===r);return c!==-1&&(s.value[c]=v.data),v}catch(v){throw i.value="Failed to fetch mockup",console.error(v),v}finally{u.value=!1}},regenerateMockup:async(r,v)=>{u.value=!0,i.value=null;try{const c=await oe.post(`/service/mockups/${r}/regenerate/`,v),_=s.value.findIndex(h=>h.id===r);return _!==-1&&(s.value[_]=c.data),c.data}catch(c){throw i.value="Failed to regenerate mockup",console.error(c),c}finally{u.value=!1}},regenerateAllMockups:async r=>{u.value=!0,i.value=null;try{const v=await oe.post(`/service/projects/${r}/regenerate-mockups/`);return s.value=v.data,v.data}catch(v){throw i.value="Failed to regenerate all mockups",console.error(v),v}finally{u.value=!1}},updateMockupById:async(r,v)=>{u.value=!0,i.value=null;try{return await oe.put(`/service/mockups/${r}/`,v)}catch(c){throw i.value="Failed to update mockup",console.error(c),c}finally{u.value=!1}},deleteMockupById:async r=>{u.value=!0,i.value=null;try{return(await oe.delete(`/service/mockups/${r}/`)).status===204}catch(v){throw i.value="Failed to delete mockup",console.error(v),v}finally{u.value=!1}}}}),Oa={key:0,class:"text-h5"},Na={class:"text-h5"},Ea={key:0,class:"ms-2 d-flex align-center"},Wa={class:"text-caption"},Ta={key:0},Ga={key:1},Xa={class:"mockup-metadata d-flex align-center px-6 py-3"},Ha={class:"d-flex align-center"},Ja={class:"text-caption"},Ka={class:"d-flex align-center ms-4"},Za={class:"text-caption"},Qa={key:0,class:"d-flex align-center ms-4"},Ya={class:"text-caption"},el={key:1,class:"d-flex align-center ms-4"},tl={class:"text-caption"},al={class:"mockup-content pa-0"},ll={class:"text-h6 mb-2"},rl={class:"text-body-1 text-medium-emphasis max-width-md text-center"},sl=["srcdoc","title"],ol={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},il={class:"text-h6 mb-2"},nl={class:"text-medium-emphasis text-center"},cl={class:"text-body-1 mb-3"},nt=Ue({__name:"MockupPreviewDialog",props:{modelValue:{type:Boolean,default:!1},mockup:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=ee({get:()=>i.modelValue,set:I=>u("update:modelValue",I)}),c=Qe(),_=k(!1),h=k(!1),j=k({...i.mockup}),U=k(!1),C=k(null),S=k(!1),R=k(""),L=k({show:!1,text:"",color:"success"}),z=ee(()=>i.mockup.generation_status==="in_progress"||i.mockup.generation_status==="pending"||i.mockup.needs_regeneration),Z=I=>I?(I=parseInt(I),new Date(I).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",F=()=>{_.value=!_.value},O=()=>{h.value&&(j.value={...i.mockup}),h.value=!h.value},Q=async()=>{U.value=!0;try{const{data:I,error:D}=await c.updateMockupById(i.mockup.id,{...j.value,needs_regeneration:!1,generation_status:"completed"});I&&!D?($(r("projects.mockups.notifications.updated")),Object.assign(i.mockup,I),h.value=!1,v.value=!1):$(r("projects.mockups.notifications.update_failed"),"error")}catch(I){$(r("projects.mockups.notifications.update_error",{error:I.message}),"error")}finally{U.value=!1}},A=()=>{u("delete"),v.value=!1},H=async()=>{S.value=!0},N=async()=>{U.value=!0;try{i.mockup.user_story?await c.regenerateMockup(i.mockup.id,{user_story_id:i.mockup.user_story.id,feedback:R.value}):i.mockup.requirement?await c.regenerateMockup(i.mockup.id,{requirement_id:i.mockup.requirement.id,feedback:R.value}):await c.regenerateMockup(i.mockup.id,{feedback:R.value}),$(r("projects.mockups.notifications.regeneration_started")),S.value=!1,R.value="",v.value=!1,C.value=setInterval(M,5e3)}catch(I){$(r("projects.mockups.notifications.regeneration_error",{error:I.message}),"error")}finally{U.value=!1}},$=(I,D="success")=>{L.value={show:!0,text:I,color:D}},M=()=>{z.value&&v.value&&c.fetchMockupById(i.mockup.id).then(({data:I})=>{I&&Object.assign(i.mockup,I)})};return pe(()=>i.mockup,I=>{j.value={...I}},{deep:!0}),Ce(()=>{C.value=setInterval(M,5e3)}),Ne(()=>{C.value&&clearInterval(C.value)}),(I,D)=>{const V=ke("IconBtn");return n(),g(je,{modelValue:a(v),"onUpdate:modelValue":D[9]||(D[9]=G=>De(v)?v.value=G:null),fullscreen:_.value,"max-width":_.value?"100%":"900",scrollable:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[h.value?(n(),f("h5",Oa,l(a(r)("projects.mockups.actions.edit")),1)):(n(),f(ae,{key:1},[o("h5",Na,l(s.mockup.name),1),e(K,{color:a(be)(s.mockup.status),size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${s.mockup.status}`)),1)]),_:1},8,["color"]),a(z)?(n(),f("div",Ea,[e(de,{indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"}),o("span",Wa,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating"):a(r)("projects.mockups.status.pending")),1)])):w("",!0)],64)),e(le),e(P,{icon:"",variant:"text",onClick:F},{default:t(()=>[e(q,{icon:_.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(V,{onClick:D[0]||(D[0]=G=>v.value=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(ie),e(Y,{class:lt({"pa-0":!h.value&&s.mockup.html_content,"pa-6":h.value||!s.mockup.html_content}),style:Be({height:_.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:t(()=>[h.value?(n(),f("div",Ta,[e(Se,{onSubmit:we(Q,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:j.value.name,"onUpdate:modelValue":D[1]||(D[1]=G=>j.value.name=G),label:a(r)("projects.mockups.name"),required:"",rules:[G=>!!G||a(r)("projects.mockups.validation.name_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:j.value.status,"onUpdate:modelValue":D[2]||(D[2]=G=>j.value.status=G),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:j.value.html_content,"onUpdate:modelValue":D[3]||(D[3]=G=>j.value.html_content=G),label:a(r)("projects.mockups.html_content"),rows:"15",rules:[G=>!!G||a(r)("projects.mockups.validation.html_required")],monospace:""},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),f("div",Ga,[o("div",Xa,[o("div",Ha,[e(q,{icon:"tabler-calendar",class:"me-2",size:"18"}),o("span",Ja,l(a(r)("projects.details.created_at"))+": "+l(Z(s.mockup.created_at)),1)]),o("div",Ka,[e(q,{icon:"tabler-calendar-event",class:"me-2",size:"18"}),o("span",Za,l(a(r)("projects.details.updated_at"))+": "+l(Z(s.mockup.updated_at)),1)]),s.mockup.requirement?(n(),f("div",Qa,[e(q,{icon:"tabler-file-check",class:"me-2",size:"18"}),o("span",Ya,l(a(r)("projects.details.requirement"))+": "+l(s.mockup.requirement_name),1)])):w("",!0),s.mockup.user_story?(n(),f("div",el,[e(q,{icon:"tabler-user-check",class:"me-2",size:"18"}),o("span",tl,l(a(r)("projects.details.user_story"))+": "+l(s.mockup.user_story_name),1)])):w("",!0)]),e(ie),o("div",al,[a(z)?(n(),f("div",{key:0,class:"d-flex flex-column justify-center align-center",style:Be({height:_.value?"calc(100vh - 180px)":"calc(70vh - 110px)"})},[e(de,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),o("h4",ll,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating"):a(r)("projects.mockups.status.preparing")),1),o("p",rl,l(s.mockup.generation_status==="in_progress"?a(r)("projects.mockups.status.generating_description"):a(r)("projects.mockups.status.preparing_description")),1)],4)):s.mockup.html_content?(n(),f("iframe",{key:1,srcdoc:s.mockup.html_content,class:"mockup-iframe",style:Be([{width:"100%",border:"none"},{height:_.value?"calc(100vh - 180px)":"calc(70vh - 110px)"}]),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",title:a(r)("projects.mockups.preview")},null,12,sl)):(n(),f("div",ol,[e(q,{icon:"tabler-code-off",size:"64",color:"secondary",class:"mb-4"}),o("h4",il,l(a(r)("projects.mockups.no_content.title")),1),o("p",nl,l(a(r)("projects.mockups.no_content.description")),1)]))])]))]),_:1},8,["class","style"]),e(ie),e(me,{class:"pa-4"},{default:t(()=>[h.value?(n(),f(ae,{key:0},[e(P,{color:"secondary",variant:"tonal",onClick:O,disabled:U.value},{default:t(()=>[m(l(a(r)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(le),e(P,{color:"primary",onClick:Q,loading:U.value},{default:t(()=>[m(l(a(r)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),f(ae,{key:1},[s.isAdmin?(n(),g(P,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:A},{default:t(()=>[m(l(a(r)("projects.actions.delete")),1)]),_:1})):w("",!0),s.hasManagerPermission?(n(),g(P,{key:1,color:"warning",variant:"tonal","prepend-icon":"tabler-refresh",onClick:H,loading:a(z)||U.value,disabled:a(z),class:"ms-2"},{default:t(()=>[m(l(a(r)("projects.mockups.actions.regenerate")),1)]),_:1},8,["loading","disabled"])):w("",!0),e(le),s.hasManagerPermission?(n(),g(P,{key:2,class:"ms-2",color:"primary",variant:"tonal","prepend-icon":"tabler-code",onClick:O},{default:t(()=>[m(l(a(r)("projects.mockups.actions.edit")),1)]),_:1})):w("",!0)],64))]),_:1})]),_:1}),e(je,{modelValue:S.value,"onUpdate:modelValue":D[6]||(D[6]=G=>S.value=G),"max-width":"600",persistent:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"pt-3 pb-0"},{default:t(()=>[m(l(a(r)("projects.mockups.regeneration.title")),1)]),_:1}),e(Y,null,{default:t(()=>[o("p",cl,l(a(r)("projects.mockups.regeneration.description")),1),e(qe,{autofocus:"",modelValue:R.value,"onUpdate:modelValue":D[4]||(D[4]=G=>R.value=G),label:a(r)("projects.mockups.fields.feedback"),hint:a(r)("projects.mockups.placeholders.feedback"),"aria-placeholder":"t('projects.mockups.placeholders.feedback')",rows:"4",counter:""},null,8,["modelValue","label","hint"])]),_:1}),e(me,null,{default:t(()=>[e(P,{color:"secondary",variant:"tonal",onClick:D[5]||(D[5]=G=>S.value=!1)},{default:t(()=>[m(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:N,loading:U.value},{default:t(()=>[m(l(a(r)("projects.mockups.actions.regenerate")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ve,{modelValue:L.value.show,"onUpdate:modelValue":D[8]||(D[8]=G=>L.value.show=G),color:L.value.color,timeout:5e3},{actions:t(()=>[e(V,{onClick:D[7]||(D[7]=G=>L.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(L.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-e7f2b0d9"]]),ul={key:0,class:"text-h5"},dl={key:1,class:"text-h5"},ml={key:0},pl={key:1},vl={class:"d-flex align-center mb-5"},fl={class:"d-flex align-center"},_l={class:"text-medium-emphasis d-flex align-center"},gl={class:"text-caption me-4"},yl={class:"text-caption"},hl={class:"text-h4 mb-4"},jl={class:"text-body-1 whitespace-pre-wrap"},bl={key:0,class:"text-center pa-6"},kl={class:"text-h6 mb-2"},xl={class:"text-medium-emphasis mb-4"},wl={key:1},Vl={class:"d-flex justify-space-between align-center mb-4"},ql={class:"text-h5"},Cl={class:"mb-2"},Sl={key:0,class:"mt-3"},Ul={class:"text-subtitle-2"},zl={class:"pl-4"},Il={key:0},Dl={key:0,class:"text-center mt-4"},$l={key:0,class:"text-center pa-6"},Pl={class:"text-h6 mb-2"},Ml={class:"text-medium-emphasis"},Bl={key:1},Rl={class:"d-flex align-center"},Ll={class:"mockup-preview mb-3"},Al={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Fl={key:0,class:"d-flex justify-center align-center h-100"},Ol={class:"text-center"},Nl={class:"text-caption"},El={key:1,class:"html-preview"},Wl={key:2,class:"d-flex justify-center align-center h-100"},Tl={class:"preview-overlay d-flex justify-center align-center"},Gl={key:0,class:"mb-2"},Xl={class:"d-flex align-center justify-space-between"},Hl={class:"d-flex align-center"},Jl={class:"text-caption"},Kl={key:0,class:"text-center pa-6"},Zl={class:"text-h6 mb-2"},Ql={class:"text-medium-emphasis"},Yl={key:1},er={class:"text-caption"},tr={class:"text-caption text-medium-emphasis"},ar={class:"d-flex align-center mb-2"},lr={class:"text-caption"},rr={class:"text-body-2 whitespace-pre-wrap"},sr={class:"d-flex justify-end mt-2"},or={key:1,class:"text-center pa-6"},ir={class:"text-h6 mb-2"},nr={class:"text-medium-emphasis"},cr={key:2},ur={class:"d-flex align-center"},dr={class:"d-flex align-center"},mr={class:"text-caption text-medium-emphasis ml-2"},pr={class:"comment-text mt-2 whitespace-pre-wrap"},vr=Ue({__name:"RequirementDetailsDialog",props:{modelValue:{type:Boolean,default:!1},requirement:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","view-user-stories"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=ee({get:()=>i.modelValue,set:p=>u("update:modelValue",p)}),c=Vt();Qe();const _=k(0),h=k(!1),j=k({...i.requirement}),U=k(""),C=k(!1),S=k({show:!1,text:"",color:"success"}),R=k(null),L=k(!1),z=k(null),Z=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],F=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],O=[{title:r("projects.requirements.types.feature"),value:"feature"},{title:r("projects.requirements.types.constraint"),value:"constraint"},{title:r("projects.requirements.types.quality"),value:"quality"},{title:r("projects.requirements.types.interface"),value:"interface"},{title:r("projects.requirements.types.security"),value:"security"},{title:r("projects.requirements.types.performance"),value:"performance"},{title:r("projects.requirements.types.other"),value:"other"}],Q=ee(()=>i.requirement.history||[]),A=ee(()=>i.requirement.comments||[]),H=ee(()=>i.requirement.user_stories||[]),N=ee(()=>i.requirement.mockups||[]),$=p=>p?(p=parseInt(p),new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",M=()=>{h.value&&(j.value={...i.requirement}),h.value=!h.value,_.value="0"},I=()=>{v.value&&c.fetchRequirementById(i.requirement.id).then(({data:p})=>{p&&Object.assign(i.requirement,p)})};Ce(()=>{z.value=setInterval(I,5e3)}),Ne(()=>{z.value&&clearInterval(z.value)});const D=()=>{u("update",j.value),h.value=!1,v.value=!1},V=()=>{u("delete"),v.value=!1},G=()=>{u("view-user-stories",i.requirement),v.value=!1},x=async()=>{if(U.value.trim()){C.value=!0;try{const{data:p,error:X}=await c.createComment(i.requirement.id,{text:U.value,status:"active"});if(p&&!X){b(r("projects.requirements.notifications.comment_added")),U.value="";const{data:T}=await c.fetchRequirementById(i.requirement.id);T&&Object.assign(i.requirement,T)}else b(r("projects.requirements.notifications.comment_add_failed"),"error")}catch(p){b(r("projects.requirements.notifications.comment_add_failed")+": "+p.message,"error")}finally{C.value=!1}}},b=(p,X="success")=>{S.value={show:!0,text:p,color:X}};return pe(()=>i.requirement,p=>{j.value={...p}},{deep:!0}),(p,X)=>{const T=ke("IconBtn");return n(),g(je,{modelValue:a(v),"onUpdate:modelValue":X[12]||(X[12]=d=>De(v)?v.value=d:null),"max-width":"900",scrollable:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[h.value?(n(),f("h5",ul,l(a(r)("projects.requirements.actions.edit")),1)):(n(),f("h5",dl,l(a(r)("projects.requirements.actions.view_details")),1)),e(le),e(T,{onClick:X[0]||(X[0]=d=>v.value=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(Y,{class:"pb-0"},{default:t(()=>[e(rt,{modelValue:_.value,"onUpdate:modelValue":X[1]||(X[1]=d=>_.value=d),"slider-color":"primary","align-tabs":"start"},{default:t(()=>[e(_e,{value:"0"},{default:t(()=>[e(q,{size:"18",icon:"tabler-info-circle",start:""}),m(" "+l(a(r)("projects.requirements.tabs.details")),1)]),_:1}),e(_e,{value:"1"},{default:t(()=>[e(q,{size:"18",icon:"tabler-user-check",start:""}),m(" "+l(a(r)("projects.requirements.tabs.user_stories"))+" ",1),a(H).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(H).length),1)]),_:1})):w("",!0)]),_:1}),e(_e,{value:"2"},{default:t(()=>[e(q,{size:"18",icon:"tabler-photo",start:""}),m(" "+l(a(r)("projects.requirements.tabs.mockups"))+" ",1),a(N).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(N).length),1)]),_:1})):w("",!0)]),_:1}),e(_e,{value:"3"},{default:t(()=>[e(q,{size:"18",icon:"tabler-history",start:""}),m(" "+l(a(r)("projects.requirements.tabs.history"))+" ",1),a(Q).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(Q).length),1)]),_:1})):w("",!0)]),_:1}),e(_e,{value:"4"},{default:t(()=>[e(q,{size:"18",icon:"tabler-messages",start:""}),m(" "+l(a(r)("projects.requirements.tabs.comments"))+" ",1),a(A).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(A).length),1)]),_:1})):w("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ie),e(Y,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:t(()=>[e(st,{modelValue:_.value,"onUpdate:modelValue":X[8]||(X[8]=d=>_.value=d),class:"mt-5"},{default:t(()=>[e(ge,{value:"0"},{default:t(()=>[h.value?(n(),f("div",ml,[e(Se,{onSubmit:we(D,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:j.value.title,"onUpdate:modelValue":X[2]||(X[2]=d=>j.value.title=d),label:a(r)("projects.requirements.title"),required:"",rules:[d=>!!d||a(r)("validation.required")]},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12",md:"4"},{default:t(()=>[e(fe,{modelValue:j.value.category,"onUpdate:modelValue":X[3]||(X[3]=d=>j.value.category=d),label:a(r)("projects.requirements.category"),items:Z,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"4"},{default:t(()=>[e(fe,{modelValue:j.value.requirement_type,"onUpdate:modelValue":X[4]||(X[4]=d=>j.value.requirement_type=d),label:a(r)("projects.requirements.type"),items:O,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"4"},{default:t(()=>[e(fe,{modelValue:j.value.status,"onUpdate:modelValue":X[5]||(X[5]=d=>j.value.status=d),label:a(r)("projects.requirements.status"),items:F,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:j.value.description,"onUpdate:modelValue":X[6]||(X[6]=d=>j.value.description=d),label:a(r)("projects.requirements.description"),required:"",rows:"8",rules:[d=>!!d||a(r)("validation.required")]},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),f("div",pl,[o("div",vl,[e(K,{color:a(tt)(s.requirement.category),size:"small",label:"",class:"me-2"},{default:t(()=>[m(l(a(r)(`projects.categories.${s.requirement.category}`)),1)]),_:1},8,["color"]),e(K,{color:a(be)(s.requirement.status),size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${s.requirement.status}`)),1)]),_:1},8,["color"]),e(K,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:t(()=>[m(" v"+l(s.requirement.version_number),1)]),_:1}),s.requirement.requirement_type?(n(),g(K,{key:0,color:"info",size:"small",label:"",class:"ms-2"},{default:t(()=>[m(l(a(r)(`projects.requirements.types.${s.requirement.requirement_type}`)),1)]),_:1})):w("",!0),e(le)]),o("div",fl,[o("div",_l,[e(q,{size:"18",icon:"tabler-calendar",class:"me-1"}),o("span",gl,l(a(r)("projects.details.updated_at"))+": "+l($(s.requirement.updated_at)),1),e(q,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),o("span",yl,l(a(r)("projects.details.created_at"))+": "+l($(s.requirement.created_at)),1)])]),o("h4",hl,l(s.requirement.title),1),o("div",jl,l(s.requirement.description),1)]))]),_:1}),e(ge,{value:"1"},{default:t(()=>[a(H).length===0?(n(),f("div",bl,[e(q,{icon:"tabler-user-check",size:"64",color:"secondary",class:"mb-3"}),o("h4",kl,l(a(r)("projects.requirements.user_stories.empty.title")),1),o("p",xl,l(a(r)("projects.requirements.user_stories.empty.description")),1),e(P,{color:"primary",onClick:G},{default:t(()=>[m(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})])):(n(),f("div",wl,[o("div",Vl,[o("h5",ql,l(a(r)("projects.requirements.user_stories.title")),1),e(P,{color:"primary",variant:"tonal",onClick:G},{default:t(()=>[m(l(a(r)("projects.requirements.actions.view_all_stories")),1)]),_:1})]),(n(!0),f(ae,null,ue(a(H).slice(0,3),(d,E)=>(n(),g(te,{key:d.id,class:"mb-4",border:""},{default:t(()=>[e(ve,null,{append:t(()=>[e(K,{color:a(be)(d.status),size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${d.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.requirements.user_stories.as_a",{role:d.role})),1)]),_:2},1024)]),_:2},1024),e(Y,null,{default:t(()=>[o("p",Cl,[o("strong",null,l(a(r)("projects.requirements.user_stories.i_want_to"))+":",1),m(" "+l(d.action),1)]),o("p",null,[o("strong",null,l(a(r)("projects.requirements.user_stories.so_that"))+":",1),m(" "+l(d.benefit),1)]),d.acceptance_criteria&&d.acceptance_criteria.length>0?(n(),f("div",Sl,[o("div",Ul,l(a(r)("projects.requirements.user_stories.acceptance_criteria"))+":",1),o("ul",zl,[(n(!0),f(ae,null,ue(d.acceptance_criteria.slice(0,2),(y,W)=>(n(),f("li",{key:W},l(y),1))),128)),d.acceptance_criteria.length>2?(n(),f("li",Il,l(a(r)("projects.requirements.user_stories.and_more",{count:d.acceptance_criteria.length-2})),1)):w("",!0)])])):w("",!0)]),_:2},1024)]),_:2},1024))),128)),a(H).length>3?(n(),f("div",Dl,[e(P,{color:"primary",variant:"tonal",onClick:G},{default:t(()=>[m(l(a(r)("projects.requirements.actions.view_all_stories_count",{count:a(H).length})),1)]),_:1})])):w("",!0)]))]),_:1}),e(ge,{value:"2"},{default:t(()=>[a(N).length===0?(n(),f("div",$l,[e(q,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-3"}),o("h4",Pl,l(a(r)("projects.requirements.mockups.empty.title")),1),o("p",Ml,l(a(r)("projects.requirements.mockups.empty.description")),1)])):(n(),f("div",Bl,[e(se,null,{default:t(()=>[(n(!0),f(ae,null,ue(a(N),d=>(n(),g(B,{key:d.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(te,{class:"mockup-card h-100",onClick:E=>{R.value=d,L.value=!0},border:"",hover:""},{default:t(()=>[e(ve,null,{append:t(()=>[o("div",Rl,[d.generation_status==="in_progress"||d.generation_status==="pending"||d.needs_regeneration?(n(),g(de,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):w("",!0),e(K,{color:a(be)(d.status),size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${d.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(d.name),1)]),_:2},1024)]),_:2},1024),e(ie),e(Y,null,{default:t(()=>[o("div",Ll,[o("div",Al,[d.generation_status==="in_progress"||d.generation_status==="pending"?(n(),f("div",Fl,[o("div",Ol,[e(de,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),o("div",Nl,l(a(r)("projects.mockups.status.generating")),1)])])):d.image?(n(),f("div",El,[e(Ee,{src:d.image,alt:d.name},null,8,["src","alt"])])):(n(),f("div",Wl,[e(q,{icon:"tabler-file-code",size:"48",color:"secondary"})])),o("div",Tl,[e(P,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:d.generation_status==="in_progress"||d.generation_status==="pending"},{default:t(()=>[m(l(a(r)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),d.needs_regeneration?(n(),f("div",Gl,[e(K,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(r)("projects.mockups.status.regenerating")),1)]),_:1})])):w("",!0),o("div",Xl,[o("div",Hl,[e(q,{size:"16",icon:"tabler-calendar",class:"me-1"}),o("span",Jl,l($(d.created_at)),1)])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ge,{value:"3"},{default:t(()=>[a(Q).length===0?(n(),f("div",Kl,[e(q,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),o("h4",Zl,l(a(r)("projects.requirements.history.empty.title")),1),o("p",Ql,l(a(r)("projects.requirements.history.empty.description")),1)])):(n(),f("div",Yl,[e(xt,{density:"compact",align:"start"},{default:t(()=>[(n(!0),f(ae,null,ue(a(Q),(d,E)=>(n(),g(wt,{key:E,"dot-color":"primary",size:"small"},{opposite:t(()=>[o("div",er,l($(d.changed_at)),1),o("div",tr,"v"+l(d.version_number),1)]),default:t(()=>[e(te,{border:""},{default:t(()=>[e(ve,null,{append:t(()=>[e(K,{color:a(be)(d.status),size:"small",label:"",class:"ms-2"},{default:t(()=>[m(l(a(r)(`projects.status.${d.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(d.title),1)]),_:2},1024)]),_:2},1024),e(Y,null,{default:t(()=>[o("div",ar,[e(K,{color:a(tt)(d.category),size:"small",label:"",class:"me-2"},{default:t(()=>[m(l(a(r)(`projects.categories.${d.category}`)),1)]),_:2},1032,["color"]),o("span",lr,l(a(r)("projects.requirements.history.changed_by"))+": "+l(d.changed_by?d.changed_by.username:a(r)("projects.requirements.history.unknown")),1)]),o("div",rr,l(d.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ge,{value:"4"},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:U.value,"onUpdate:modelValue":X[7]||(X[7]=d=>U.value=d),label:a(r)("projects.requirements.comments.add"),rows:"3",counter:"",disabled:C.value},null,8,["modelValue","label","disabled"]),o("div",sr,[e(P,{color:"primary",size:"small",loading:C.value,disabled:!U.value.trim(),onClick:x},{default:t(()=>[m(l(a(r)("projects.requirements.comments.add_button")),1)]),_:1},8,["loading","disabled"])])]),_:1}),e(B,{cols:"12"},{default:t(()=>[a(A).length?(n(),g(ie,{key:0,class:"mb-4"})):w("",!0),a(A).length===0?(n(),f("div",or,[e(q,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),o("h4",ir,l(a(r)("projects.requirements.comments.empty.title")),1),o("p",nr,l(a(r)("projects.requirements.comments.empty.description")),1)])):(n(),f("div",cr,[(n(!0),f(ae,null,ue(a(A),d=>(n(),f("div",{key:d.id,class:"comment-item mb-4"},[e(te,{border:""},{default:t(()=>[e(Y,{class:"py-2"},{default:t(()=>[o("div",ur,[e(ze,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:t(()=>[e(q,{icon:"tabler-user"})]),_:1}),o("div",null,[o("div",dr,[o("strong",null,l(d.user?d.user.username:a(r)("projects.requirements.comments.unknown_user")),1),o("div",mr,l($(d.created_at)),1)])]),e(le),s.isAdmin||s.hasManagerPermission?(n(),g(T,{key:0,size:"small",color:"error",variant:"text",onClick:E=>(async y=>{C.value=!0;try{const{success:W,error:ce}=await c.deleteComment(y);if(W&&!ce){b(r("projects.requirements.notifications.comment_deleted"));const{data:J}=await c.fetchRequirementById(i.requirement.id);J&&Object.assign(i.requirement,J)}else b(r("projects.requirements.notifications.comment_delete_failed"),"error")}catch(W){b(r("projects.requirements.notifications.comment_delete_failed")+": "+W.message,"error")}finally{C.value=!1}})(d.id),disabled:C.value},{default:t(()=>[e(q,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):w("",!0)]),o("div",pr,l(d.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ie),e(me,{class:"pa-4"},{default:t(()=>[h.value?(n(),f(ae,{key:0},[e(P,{color:"secondary",variant:"tonal",onClick:M},{default:t(()=>[m(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:D},{default:t(()=>[m(l(a(r)("projects.actions.save")),1)]),_:1})],64)):(n(),f(ae,{key:1},[s.isAdmin?(n(),g(P,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:V},{default:t(()=>[m(l(a(r)("projects.requirements.actions.delete")),1)]),_:1})):w("",!0),s.hasModeratorPermission&&a(H).length===0?(n(),g(P,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-user-check",class:"ms-2",onClick:G},{default:t(()=>[m(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})):w("",!0),e(le),s.hasModeratorPermission?(n(),g(P,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:M},{default:t(()=>[m(l(a(r)("projects.requirements.actions.edit")),1)]),_:1})):w("",!0)],64))]),_:1})]),_:1}),e(Ve,{modelValue:S.value.show,"onUpdate:modelValue":X[10]||(X[10]=d=>S.value.show=d),color:S.value.color,timeout:5e3},{actions:t(()=>[e(T,{onClick:X[9]||(X[9]=d=>S.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(S.value.text)+" ",1)]),_:1},8,["modelValue","color"]),R.value?(n(),g(nt,{key:0,modelValue:L.value,"onUpdate:modelValue":X[11]||(X[11]=d=>L.value=d),mockup:R.value,"is-admin":s.isAdmin,"has-manager-permission":s.hasManagerPermission},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):w("",!0)]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-29cf6a42"]]),fr={class:"text-h5"},_r={__name:"RequirementCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},requirementData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=ee({get:()=>i.modelValue,set:z=>u("update:modelValue",z)}),c=k({title:i.editMode&&i.requirementData?i.requirementData.title:"",description:i.editMode&&i.requirementData?i.requirementData.description:"",category:i.editMode&&i.requirementData?i.requirementData.category:"functional",status:i.editMode&&i.requirementData?i.requirementData.status:"draft"}),_=[z=>!!z||r("validation.required"),z=>z.length<=255||r("projects.requirements.validation.title_length")],h=[z=>!!z||r("validation.required")],j=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],U=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],C=k(null),S=()=>{c.value={title:"",description:"",category:"functional",status:"draft"},C.value&&C.value.resetValidation()},R=()=>{v.value=!1,S()},L=async()=>{const{valid:z}=await C.value.validate();z&&(u("submit",c.value),v.value=!1,S())};return pe(v,z=>{z||S()}),(z,Z)=>{const F=ke("IconBtn");return n(),g(je,{modelValue:a(v),"onUpdate:modelValue":Z[4]||(Z[4]=O=>De(v)?v.value=O:null),"max-width":"700",persistent:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[o("h5",fr,l(i.editMode?a(r)("projects.requirements.actions.edit"):a(r)("projects.requirements.actions.add")),1),e(le),e(F,{onClick:R},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(Y,{class:"px-5 pt-4"},{default:t(()=>[e(Se,{ref_key:"formRef",ref:C,onSubmit:we(L,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:c.value.title,"onUpdate:modelValue":Z[0]||(Z[0]=O=>c.value.title=O),label:a(r)("projects.requirements.title"),rules:_,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:c.value.category,"onUpdate:modelValue":Z[1]||(Z[1]=O=>c.value.category=O),label:a(r)("projects.requirements.category"),items:j,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:c.value.status,"onUpdate:modelValue":Z[2]||(Z[2]=O=>c.value.status=O),label:a(r)("projects.requirements.status"),items:U,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:c.value.description,"onUpdate:modelValue":Z[3]||(Z[3]=O=>c.value.description=O),label:a(r)("projects.requirements.description"),rules:h,required:"",rows:"6"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ie),e(me,{class:"pa-4"},{default:t(()=>[e(P,{variant:"tonal",color:"secondary",onClick:R},{default:t(()=>[m(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:L},{default:t(()=>[m(l(i.editMode?a(r)("projects.actions.update"):a(r)("projects.actions.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};function Te(s){return{all:s=s||new Map,on:function(u,i){var r=s.get(u);r?r.push(i):s.set(u,[i])},off:function(u,i){var r=s.get(u);r&&(i?r.splice(r.indexOf(i)>>>0,1):s.set(u,[]))},emit:function(u,i){var r=s.get(u);r&&r.slice().map(function(v){v(i)}),(r=s.get("*"))&&r.slice().map(function(v){v(u,i)})}}}const gr={key:0,class:"mb-4"},yr={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},hr={key:2,class:"text-center pa-4"},jr={class:"text-h6 mb-2"},br={class:"text-body-1 text-medium-emphasis mb-6"},kr={class:"d-flex align-center"},xr={class:"text-body-2 mb-3"},wr={class:"d-flex align-center justify-space-between mb-2"},Vr={class:"d-flex align-center"},qr={class:"text-caption text-capitalize"},Cr={class:"d-flex align-center"},Sr={class:"text-caption"},Ur={class:"d-flex align-center"},zr={class:"text-caption"},Ir={key:0,class:"mt-3"},Dr={__name:"ProjectRequirementsList",props:{projectId:{type:String,required:!0},requirements:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh","view-user-stories"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=Vt(),c=Me(),_=k(""),h=k([]),j=k(["draft","active","completed"]),U=k(null),C=k(!1),S=k(!1),R=k(!1),L=k(!1),z=k({show:!1,text:"",color:"success"}),Z=ee(()=>c.is_admin()),F=k(!1),O=k(!1),Q=k(!1),A=async()=>{F.value=await c.hasProjectRoleAtLeast(i.projectId,"MANAGER"),O.value=await c.hasProjectRoleAtLeast(i.projectId,"ADMIN"),Q.value=await c.hasProjectWriteAccess(i.projectId)},H=ee(()=>i.requirements.some(T=>T.user_stories&&T.user_stories.some(d=>d.generation_status==="in_progress"||d.generation_status==="pending")||T.mockups&&T.mockups.some(d=>d.generation_status==="in_progress"||d.generation_status==="pending"||d.needs_regeneration))),N=[{title:r("projects.categories.functional"),value:"functional"},{title:r("projects.categories.nonfunctional"),value:"nonfunctional"},{title:r("projects.categories.uiux"),value:"uiux"},{title:r("projects.categories.other"),value:"other"}],$=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],M=ee(()=>i.requirements.filter(T=>{const d=!_.value||T.title.toLowerCase().includes(_.value.toLowerCase())||T.description.toLowerCase().includes(_.value.toLowerCase()),E=h.value.length===0||h.value.includes(T.category),y=j.value.includes(T.status);return d&&E&&y})),I=Te(),D=()=>{S.value=!0},V=async T=>{L.value=!0;try{const{data:d,error:E}=await v.createRequirement({...T,project:i.projectId});d&&!E?(p("projects.requirements.notifications.created"),u("refresh")):p("projects.requirements.notifications.create_failed","error")}catch{p("projects.requirements.notifications.create_failed","error")}finally{L.value=!1}},G=async T=>{L.value=!0;try{const{data:d,error:E}=await v.updateRequirement(U.value.id,T);d&&!E?(p("projects.requirements.notifications.updated"),u("refresh")):p("projects.requirements.notifications.update_failed","error")}catch{p("projects.requirements.notifications.update_failed","error")}finally{L.value=!1}},x=async()=>{if(U.value){L.value=!0,R.value=!1;try{const{success:T,error:d}=await v.deleteRequirement(U.value.id);T&&!d?(p("projects.requirements.notifications.deleted"),u("refresh"),C.value=!1):p("projects.requirements.notifications.delete_failed","error")}catch{p("projects.requirements.notifications.delete_failed","error")}finally{L.value=!1}}},b=T=>{u("view-user-stories",T)},p=(T,d="success")=>{z.value={show:!0,text:r(T),color:d}},X=(T,d=120)=>!T||T.length<=d?T:T.substring(0,d)+"...";return Ce(()=>{A(),I.on("project-refresh",()=>{v.fetchRequirements(i.projectId,{silent:!0}).then(({data:T})=>{T&&u("refresh")})})}),pe(C,T=>{T?I.on("project-refresh",async()=>{if(U.value){const{data:d}=await v.fetchRequirementById(U.value.id);d&&(U.value=d)}}):I.off("project-refresh")}),pe(()=>i.projectId,()=>{A()}),(T,d)=>{const E=We,y=ke("IconBtn");return n(),g(Y,{class:"pa-6"},{default:t(()=>[a(H)?(n(),f("div",gr,[e(xe,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(de,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),o("span",null,l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})])):w("",!0),e(se,null,{default:t(()=>[e(B,{cols:"12",md:"4"},{default:t(()=>[e(ne,{modelValue:_.value,"onUpdate:modelValue":d[0]||(d[0]=W=>_.value=W),density:"compact",placeholder:a(r)("projects.requirements.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(B,{cols:"12",md:"3"},{default:t(()=>[e(fe,{modelValue:h.value,"onUpdate:modelValue":d[1]||(d[1]=W=>h.value=W),items:N,density:"compact","hide-details":"",label:a(r)("projects.requirements.actions.category"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"3"},{default:t(()=>[e(fe,{modelValue:j.value,"onUpdate:modelValue":d[2]||(d[2]=W=>j.value=W),items:$,density:"compact","hide-details":"",label:a(r)("projects.requirements.actions.status"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[O.value?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:D,loading:L.value,block:""},{default:t(()=>[m(l(a(r)("projects.requirements.actions.add")),1)]),_:1},8,["loading"])):w("",!0)]),_:1})]),_:1}),e(ie,{class:"my-5"}),s.loading?(n(),f("div",yr,[e(de,{indeterminate:"",color:"primary"})])):a(M).length===0?(n(),f("div",hr,[e(q,{icon:"tabler-file-search",size:"64",color:"secondary",class:"mb-4"}),o("h4",jr,l(a(r)("projects.requirements.empty.title")),1),o("p",br,l(_.value||h.value.length>0||j.value.length>0?a(r)("projects.requirements.empty.filtered"):a(r)("projects.requirements.empty.no_requirements")),1),O.value&&!_.value&&h.value.length===0&&j.value.length===0?(n(),g(P,{key:0,color:"primary",onClick:D,"prepend-icon":"tabler-plus"},{default:t(()=>[m(l(a(r)("projects.requirements.actions.add_requirement")),1)]),_:1})):w("",!0)])):(n(),g(se,{key:3},{default:t(()=>[(n(!0),f(ae,null,ue(a(M),W=>(n(),g(B,{key:W.id,cols:"12"},{default:t(()=>[e(te,{class:"requirement-card",onClick:ce=>(async J=>{const{data:he}=await v.fetchRequirementById(J.id);U.value=he||J,C.value=!0})(W),border:"",hover:""},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(ze,{color:a(tt)(W.category),variant:"tonal",size:"42"},{default:t(()=>[W.category==="functional"?(n(),g(q,{key:0,icon:"tabler-function"})):W.category==="nonfunctional"?(n(),g(q,{key:1,icon:"tabler-chart-bar"})):W.category==="uiux"?(n(),g(q,{key:2,icon:"tabler-palette"})):(n(),g(q,{key:3,icon:"tabler-file-description"}))]),_:2},1032,["color"])]),append:t(()=>[o("div",kr,[W.user_stories&&W.user_stories.some(ce=>ce.generation_status==="in_progress"||ce.generation_status==="pending")||W.mockups&&W.mockups.some(ce=>ce.generation_status==="in_progress"||ce.generation_status==="pending"||ce.needs_regeneration)?(n(),g(de,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):w("",!0),W.user_stories&&W.user_stories.some(ce=>ce.generation_status==="pending")||W.mockups&&W.mockups.some(ce=>ce.generation_status==="pending"||ce.needs_regeneration)?(n(),g(K,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(r)("projects.requirements.actions.generate_user_stories")),1)]),_:1})):w("",!0),e(K,{color:a(be)(W.status),size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${W.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(W.handle)+" "+l(W.title),1)]),_:2},1024)]),_:2},1024),e(Y,null,{default:t(()=>{return[o("p",xr,l(X(W.description)),1),o("div",wr,[o("div",Vr,[e(q,{size:"16",icon:"tabler-tag",class:"me-1"}),o("span",qr,l(a(r)(`projects.categories.${W.category}`)),1)]),o("div",Cr,[e(q,{size:"16",icon:"tabler-calendar",class:"me-1"}),o("span",Sr,l((ce=W.updated_at,ce?(ce=parseInt(ce),new Date(ce).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"")),1)]),o("div",Ur,[e(q,{size:"16",icon:"tabler-history",class:"me-1"}),o("span",zr,"v"+l(W.version_number),1)])]),W.user_stories&&W.user_stories.length>0?(n(),f("div",Ir,[e(P,{size:"small",variant:"tonal",color:"primary","prepend-icon":"tabler-user-check",onClick:we(J=>b(W),["stop"])},{default:t(()=>[m(l(W.user_stories.length)+" "+l(a(r)(W.user_stories.length===1?"projects.requirements.user_stories.single":"projects.requirements.user_stories.multiple")),1)]),_:2},1032,["onClick"])])):w("",!0)];var ce}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),U.value?(n(),g(vr,{key:4,modelValue:C.value,"onUpdate:modelValue":d[3]||(d[3]=W=>C.value=W),requirement:U.value,onDelete:d[4]||(d[4]=W=>R.value=!0),onUpdate:G,onViewUserStories:b,"is-admin":a(Z),"has-manager-permission":F.value,"has-moderator-permission":O.value},null,8,["modelValue","requirement","is-admin","has-manager-permission","has-moderator-permission"])):w("",!0),e(_r,{modelValue:S.value,"onUpdate:modelValue":d[5]||(d[5]=W=>S.value=W),onSubmit:V},null,8,["modelValue"]),e(E,{isDialogVisible:R.value,"onUpdate:isDialogVisible":d[6]||(d[6]=W=>R.value=W),confirmationMsg:a(r)("projects.requirements.delete_confirm.message"),onConfirm:x},null,8,["isDialogVisible","confirmationMsg"]),e(Ve,{modelValue:z.value.show,"onUpdate:modelValue":d[8]||(d[8]=W=>z.value.show=W),color:z.value.color,timeout:5e3},{actions:t(()=>[e(y,{onClick:d[7]||(d[7]=W=>z.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(z.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},$r=Ue(Dr,[["__scopeId","data-v-bdd85f3f"]]),Pr={key:0,class:"mb-4"},Mr={class:"d-flex align-center"},Br={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},Rr={key:2,class:"text-center pa-4"},Lr={class:"text-h6 mb-2"},Ar={class:"text-body-1 text-medium-emphasis mb-6"},Fr={class:"d-flex align-center"},Or={class:"mockup-preview mb-3"},Nr={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Er={key:0,class:"d-flex justify-center align-center h-100"},Wr={class:"text-center"},Tr={class:"text-caption"},Gr={key:1,class:"html-preview"},Xr={key:2,class:"d-flex justify-center align-center h-100"},Hr={class:"preview-overlay d-flex justify-center align-center"},Jr={key:0,class:"mb-2"},Kr={key:1,class:"mb-2"},Zr={class:"text-caption font-weight-medium"},Qr={key:2,class:"mb-2"},Yr={class:"text-caption font-weight-medium"},es={class:"d-flex align-center justify-space-between"},ts={class:"d-flex align-center"},as={class:"text-caption"},ls={__name:"ProjectMockupsList",props:{projectId:{type:String,required:!0},mockups:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const i=s,r=Qe(),v=Me(),{t:c}=ye(),_=k(""),h=k(null),j=k(!1),U=k(!1),C=k(!1);k(null);const S=k({show:!1,text:"",color:"success"}),R=ee(()=>v.is_admin()),L=k(!1),z=k(!1),Z=async()=>{L.value=await v.hasProjectRoleAtLeast(i.projectId,"MANAGER"),z.value=await v.hasProjectRoleAtLeast(i.projectId,"ADMIN")},F=ee(()=>i.mockups.filter($=>$.needs_regeneration||$.generation_status==="in_progress"||$.generation_status==="pending").length),O=ee(()=>i.mockups.filter($=>!_.value||$.name.toLowerCase().includes(_.value.toLowerCase())||$.requirement&&$.requirement.toLowerCase().includes(_.value.toLowerCase()))),Q=Te(),A=async()=>{if(h.value){C.value=!0,U.value=!1;try{const{success:$,error:M}=await r.deleteMockupById(h.value.id);$&&!M?(H(c("projects.mockups.notifications.deleted")),u("refresh"),j.value=!1):H(c("projects.mockups.notifications.delete_failed"),"error")}catch($){H(c("projects.mockups.notifications.delete_failed")+": "+$.message,"error")}finally{C.value=!1}}},H=($,M="success")=>{S.value={show:!0,text:$,color:M}},N=ee(()=>i.mockups.some($=>$.generation_status==="in_progress"||$.generation_status==="pending"||$.needs_regeneration));return Ce(()=>{Z(),Q.on("project-refresh",()=>{r.fetchProjectMockups(i.projectId).then(({data:$})=>{$&&u("refresh")})})}),pe(j,$=>{$?Q.on("project-refresh",async()=>{if(h.value){const{data:M}=await r.fetchMockupById(h.value.id);M&&(h.value=M)}}):Q.off("project-refresh")}),pe(()=>i.projectId,()=>{Z()}),($,M)=>{const I=We,D=ke("IconBtn");return n(),g(Y,{class:"pa-6"},{default:t(()=>[a(N)?(n(),f("div",Pr,[e(xe,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(de,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),o("span",null,l(a(c)("projects.mockups.status.generating")),1)]),_:1})])):w("",!0),e(se,null,{default:t(()=>[e(B,{cols:"12",md:"6"},{default:t(()=>[e(ne,{modelValue:_.value,"onUpdate:modelValue":M[0]||(M[0]=V=>_.value=V),density:"compact",placeholder:a(c)("projects.mockups.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(B,{cols:"12",md:"6",class:"d-flex align-center"},{default:t(()=>[a(F)>0?(n(),g(xe,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-0 flex-grow-1 me-2"},{default:t(()=>[o("div",Mr,[e(de,{indeterminate:"",color:"info",size:"16",width:"2",class:"me-2"}),o("span",null,l(a(F))+" "+l(a(c)("projects.mockups.status.pending_count")),1)])]),_:1})):w("",!0)]),_:1})]),_:1}),e(ie,{class:"my-5"}),s.loading?(n(),f("div",Br,[e(de,{indeterminate:"",color:"primary"})])):a(O).length===0?(n(),f("div",Rr,[e(q,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-4"}),o("h4",Lr,l(a(c)("projects.mockups.empty.title")),1),o("p",Ar,l(_.value?a(c)("projects.mockups.empty.filtered"):a(c)("projects.mockups.empty.description")),1)])):(n(),g(se,{key:3},{default:t(()=>[(n(!0),f(ae,null,ue(a(O),V=>(n(),g(B,{key:V.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(te,{class:"mockup-card h-100",onClick:G=>(async x=>{const{data:b}=await r.fetchMockupById(x.id);h.value=b||x,j.value=!0})(V),border:"",hover:""},{default:t(()=>[e(ve,null,{append:t(()=>[o("div",Fr,[V.generation_status==="in_progress"||V.generation_status==="pending"||V.needs_regeneration?(n(),g(de,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):w("",!0),V.generation_status==="pending"||V.needs_regeneration?(n(),g(K,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(c)("projects.mockups.status.generating")),1)]),_:1})):w("",!0),e(K,{color:a(be)(V.status),size:"small",label:""},{default:t(()=>[m(l(a(c)(`projects.status.${V.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(V.name),1)]),_:2},1024)]),_:2},1024),e(ie),e(Y,null,{default:t(()=>{return[o("div",Or,[o("div",Nr,[V.generation_status==="in_progress"||V.generation_status==="pending"?(n(),f("div",Er,[o("div",Wr,[e(de,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),o("div",Tr,l(a(c)("projects.mockups.status.generating")),1)])])):V.image?(n(),f("div",Gr,[e(Ee,{src:V.image,alt:V.name},null,8,["src","alt"])])):(n(),f("div",Xr,[e(q,{icon:"tabler-file-code",size:"48",color:"secondary"})])),o("div",Hr,[e(P,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:V.generation_status==="in_progress"||V.generation_status==="pending"},{default:t(()=>[m(l(a(c)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),V.needs_regeneration?(n(),f("div",Jr,[e(K,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(c)("projects.mockups.status.regenerating")),1)]),_:1})])):w("",!0),V.requirement?(n(),f("div",Kr,[o("span",Zr,l(a(c)("projects.details.requirement"))+": ",1),e(K,{size:"x-small",color:"primary",class:"ms-1"},{default:t(()=>[m(l(V.requirement_name),1)]),_:2},1024)])):w("",!0),V.user_story?(n(),f("div",Qr,[o("span",Yr,l(a(c)("projects.details.user_story"))+": ",1),e(K,{size:"x-small",color:"primary",class:"ms-1"},{default:t(()=>[m(l(V.user_story_name),1)]),_:2},1024)])):w("",!0),o("div",es,[o("div",ts,[e(q,{size:"16",icon:"tabler-calendar",class:"me-1"}),o("span",as,l((G=V.created_at,G?new Date(parseInt(G)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1)])])];var G}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),h.value?(n(),g(nt,{key:4,modelValue:j.value,"onUpdate:modelValue":M[1]||(M[1]=V=>j.value=V),mockup:h.value,onDelete:M[2]||(M[2]=V=>U.value=!0),"is-admin":a(R),"has-manager-permission":L.value},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):w("",!0),e(I,{isDialogVisible:U.value,"onUpdate:isDialogVisible":M[3]||(M[3]=V=>U.value=V),confirmationMsg:a(c)("projects.mockups.delete_confirm.message"),onConfirm:A},null,8,["isDialogVisible","confirmationMsg"]),e(Ve,{modelValue:S.value.show,"onUpdate:modelValue":M[5]||(M[5]=V=>S.value.show=V),color:S.value.color,timeout:5e3},{actions:t(()=>[e(D,{onClick:M[4]||(M[4]=V=>S.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(S.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},rs=Ue(ls,[["__scopeId","data-v-aa91b02c"]]),qt=Oe({id:"DevelopmentPlanStore",state:()=>({plans:[],currentPlan:null,loading:!1,error:null}),actions:{async fetchDevelopmentPlans(s=null){this.loading=!0;try{let u="/service/development-plans/";s&&(u+=`?project=${s}`);const i=await oe.get(u);return i.status===200?(this.plans=i.data,{data:i.data,error:null}):{data:[],error:i.data}}catch(u){return this.error=u.message||"Failed to fetch development plans",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDevelopmentPlanById(s){this.loading=!0;try{const u=await oe.get(`/service/development-plans/${s}/`);return u.status===200?(this.currentPlan=u.data,{data:u.data,error:null}):{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createDevelopmentPlan(s){this.loading=!0;try{const u=await oe.post("/service/development-plans/",{project:s,status:"draft"});return u.status===201?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to create development plan",{data:null,error:this.error}}finally{this.loading=!1}},async updateDevelopmentPlan(s,u){this.loading=!0;try{const i=await oe.put(`/service/development-plans/${s}/`,u);return i.status===200?(this.currentPlan&&this.currentPlan.id===s&&(this.currentPlan=i.data),{data:i.data,error:null}):{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to update development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createPlanVersion(s,u){this.loading=!0;try{const i=await oe.post(`/service/development-plans/${s}/new_version/`,u);return i.status===201?{data:i.data,error:null}:{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to create plan version",{data:null,error:this.error}}finally{this.loading=!1}},async fetchPlanVersionById(s){this.loading=!0;try{const u=await oe.get(`/service/development-plan-versions/${s}/`);return u.status===200?{data:u.data,error:null}:{data:null,error:u.data}}catch(u){return this.error=u.message||"Failed to fetch plan version",{data:null,error:this.error}}finally{this.loading=!1}},async updatePlanVersion(s,u){this.loading=!0;try{const i=await oe.put(`/service/development-plan-versions/${s}/`,u);return i.status===200?{data:i.data,error:null}:{data:null,error:i.data}}catch(i){return this.error=i.message||"Failed to update plan version",{data:null,error:this.error}}finally{this.loading=!1}},async setCurrentPlanVersion(s,u,i){this.loading=!0;try{const r=await this.fetchDevelopmentPlanById(s);if(!r.data)return{data:null,error:"Plan not found"};const v=await this.fetchPlanVersionById(u);return v.data?await this.updateDevelopmentPlan(s,{current_version_number:v.data.version_number,status:r.data.status,project:i}):{data:null,error:"Version not found"}}catch(r){return this.error=r.message||"Failed to set current plan version",{data:null,error:this.error}}finally{this.loading=!1}}}}),Ct=s=>(Rt("data-v-a1b84d78"),s=s(),Lt(),s),ss={key:0,class:"text-h5"},os={key:1,class:"text-h5"},is={key:0},ns={class:"text-left",style:{"min-width":"200px"}},cs={class:"text-right",style:{"min-width":"120px"}},us={class:"text-right",style:{"min-width":"120px"}},ds={class:"text-right",style:{"min-width":"120px"}},ms=Ct(()=>o("th",{class:"text-right",style:{width:"50px"}},null,-1)),ps={class:"text-right"},vs={colspan:"3",class:"text-right font-weight-bold"},fs={class:"text-right font-weight-bold"},_s=Ct(()=>o("td",null,null,-1)),gs={key:1},ys={class:"d-flex flex-wrap justify-space-between mb-4"},hs={class:"d-flex align-center"},js={class:"d-flex align-center"},bs={class:"text-caption"},ks={key:0,class:"text-caption ms-3"},xs={class:"text-h4 font-weight-bold"},ws={class:"text-caption text-medium-emphasis text-right"},Vs={class:"text-left",style:{"min-width":"200px"}},qs={class:"text-right",style:{"min-width":"120px"}},Cs={class:"text-right",style:{"min-width":"120px"}},Ss={class:"text-right",style:{"min-width":"120px"}},Us={class:"text-right"},zs={class:"text-right"},Is={class:"text-right"},Ds={key:0},$s={colspan:"4",class:"text-center"},Ps={class:"text-body-1 whitespace-pre-wrap"},Ms=Ue({__name:"PlanVersionDialog",props:{modelValue:{type:Boolean,default:!1},version:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},planId:{type:String,default:null},projectId:{type:String,default:null},preliminaryBudget:{type:Number,default:0}},emits:["update:modelValue","refresh"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=ee({get:()=>i.modelValue,set:M=>u("update:modelValue",M)}),c=qt(),_=k(!1),h=k({...i.version}),j=k([]),U=k(!1),C=k({show:!1,text:"",color:"success"}),S=k(null),R=ee(()=>j.value.reduce((M,I)=>M+I.cost,0)),L=ee(()=>i.preliminaryBudget>0&&R.value>i.preliminaryBudget),z=M=>M||M===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(M):"-",Z=()=>{_.value&&(h.value={...i.version},j.value=N(i.version.roles_and_hours)),_.value=!_.value},F=()=>{v.value&&c.fetchPlanVersionById(i.version.id).then(({data:M})=>{M&&(Object.assign(i.version,M),_.value||(j.value=N(M.roles_and_hours)))})};Ce(()=>{j.value=N(i.version.roles_and_hours),S.value=setInterval(F,5e3)}),Ne(()=>{S.value&&clearInterval(S.value)});const O=()=>{j.value.push({role:"",hours:0,cost:0})},Q=M=>{M.cost=M.hours*(M.rate||30)},A=async()=>{U.value=!0;try{const M={...h.value,roles_and_hours:JSON.stringify(j.value),estimated_cost:R.value},{data:I,error:D}=await c.updatePlanVersion(i.version.id,M);I&&!D?($(r("projects.development_plan.notifications.version_updated")),Object.assign(i.version,I),_.value=!1,v.value=!1,u("refresh")):$(r("projects.development_plan.notifications.version_update_failed"),"error")}catch(M){$(r("projects.development_plan.notifications.version_update_failed")+": "+M.message,"error")}finally{U.value=!1}},H=async()=>{if(i.planId){U.value=!0;try{const{data:M,error:I}=await c.setCurrentPlanVersion(i.planId,i.version.id,i.projectId);M&&!I?($(r("projects.development_plan.notifications.set_current_success")),v.value=!1,u("refresh")):$(r("projects.development_plan.notifications.set_current_failed"),"error")}catch(M){$(r("projects.development_plan.notifications.set_current_failed")+": "+M.message,"error")}finally{U.value=!1}}},N=M=>{if(!M)return[];try{return typeof M=="string"?JSON.parse(M):M}catch(I){return console.error("Error parsing roles and hours:",I),[]}},$=(M,I="success")=>{C.value={show:!0,text:M,color:I}};return pe(()=>i.version,M=>{h.value={...M},j.value=N(M.roles_and_hours)},{deep:!0}),(M,I)=>{const D=ke("IconBtn");return n(),g(je,{modelValue:a(v),"onUpdate:modelValue":I[6]||(I[6]=V=>De(v)?v.value=V:null),"max-width":"900",scrollable:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[_.value?(n(),f("h5",ss,l(a(r)("projects.development_plan.actions.edit")),1)):(n(),f("h5",os,[m(l(a(r)("projects.development_plan.version.version"))+" "+l(s.version.version_number)+" ",1),s.isCurrent?(n(),g(K,{key:0,color:"primary",size:"small",label:"",class:"ms-2"},{default:t(()=>[m(l(a(r)("projects.development_plan.version.current")),1)]),_:1})):w("",!0)])),e(le),e(D,{onClick:I[0]||(I[0]=V=>v.value=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(ie),e(Y,{class:"pa-6"},{default:t(()=>[_.value?(n(),f("div",is,[e(Se,{onSubmit:we(A,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12",md:"4"},{default:t(()=>[e(ne,{modelValue:h.value.estimated_cost,"onUpdate:modelValue":I[1]||(I[1]=V=>h.value.estimated_cost=V),modelModifiers:{number:!0},label:a(r)("projects.development_plan.estimated_cost"),type:"number",required:"",disabled:"","model-value":a(R)},null,8,["modelValue","label","model-value"])]),_:1}),e(B,{cols:"12",md:"4"},{default:t(()=>[e(fe,{modelValue:h.value.status,"onUpdate:modelValue":I[2]||(I[2]=V=>h.value.status=V),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(te,{variant:"outlined"},{default:t(()=>[e(re,{class:"d-flex align-center"},{default:t(()=>[m(l(a(r)("projects.development_plan.version.roles_hours_breakdown"))+" ",1),e(le),e(P,{color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-plus",onClick:O},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.add_role")),1)]),_:1})]),_:1}),e(Y,null,{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(Pe,null,{default:t(()=>[o("thead",null,[o("tr",null,[o("th",ns,l(a(r)("projects.development_plan.version.role")),1),o("th",cs,l(a(r)("projects.development_plan.version.hours")),1),o("th",us,l(a(r)("projects.development_plan.version.rate")),1),o("th",ds,l(a(r)("projects.development_plan.version.cost")),1),ms])]),o("tbody",null,[(n(!0),f(ae,null,ue(j.value,(V,G)=>(n(),f("tr",{key:G},[o("td",null,[e(ne,{modelValue:V.role,"onUpdate:modelValue":x=>V.role=x,density:"compact","hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[e(ne,{modelValue:V.hours,"onUpdate:modelValue":[x=>V.hours=x,x=>Q(V)],modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",variant:"outlined",class:"text-right"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[e(ne,{modelValue:V.rate,"onUpdate:modelValue":[x=>V.rate=x,x=>Q(V)],modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",variant:"outlined",class:"text-right","model-value":V.rate||30},null,8,["modelValue","onUpdate:modelValue","model-value"])]),o("td",null,[e(ne,{modelValue:V.cost,"onUpdate:modelValue":x=>V.cost=x,modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",variant:"outlined",class:"text-right",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),o("td",ps,[e(P,{icon:"",variant:"text",color:"error",size:"small",onClick:x=>(b=>{j.value.splice(b,1)})(G)},{default:t(()=>[e(q,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),128))]),o("tfoot",null,[o("tr",null,[o("td",vs,l(a(r)("projects.development_plan.version.total"))+": ",1),o("td",fs,l(a(R).toLocaleString("en-US",{style:"currency",currency:"USD"})),1),_s])])]),_:1})]),_:1}),e(B,{cols:"12"},{default:t(()=>[a(L)?(n(),g(xe,{key:0,type:"warning",variant:"tonal",class:"mt-4"},{default:t(()=>[m(l(a(r)("projects.development_plan.validation.over_budget",{total:a(R).toLocaleString("en-US",{style:"currency",currency:"USD"}),budget:s.preliminaryBudget.toLocaleString("en-US",{style:"currency",currency:"USD"})})),1)]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:h.value.notes,"onUpdate:modelValue":I[3]||(I[3]=V=>h.value.notes=V),label:a(r)("projects.development_plan.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),f("div",gs,[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>{return[o("div",ys,[o("div",hs,[e(K,{color:a(be)(s.version.status),size:"small",label:""},{default:t(()=>[m(l(Bt(s.version.status)),1)]),_:1},8,["color"])]),o("div",js,[o("span",bs,l(a(r)("projects.development_plan.version.created"))+": "+l((V=s.version.created_at,V?new Date(parseInt(V)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1),s.version.created_by?(n(),f("span",ks,l(a(r)("projects.development_plan.version.created_by"))+": "+l(s.version.created_by.username),1)):w("",!0)]),o("div",null,[o("h4",xs,l(z(s.version.estimated_cost)),1),o("div",ws,l(a(r)("projects.development_plan.version.estimated_total_cost")),1)])])];var V}),_:1}),e(B,{cols:"12"},{default:t(()=>[a(L)?(n(),g(xe,{key:0,type:"warning",variant:"tonal",class:"mt-4"},{default:t(()=>[m(l(a(r)("projects.development_plan.validation.over_budget",{total:a(R).toLocaleString("en-US",{style:"currency",currency:"USD"}),budget:s.preliminaryBudget.toLocaleString("en-US",{style:"currency",currency:"USD"})})),1)]),_:1})):w("",!0)]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(te,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1)]),_:1}),e(Y,null,{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(Pe,null,{default:t(()=>[o("thead",null,[o("tr",null,[o("th",Vs,l(a(r)("projects.development_plan.version.role")),1),o("th",qs,l(a(r)("projects.development_plan.version.hours")),1),o("th",Cs,l(a(r)("projects.development_plan.version.rate")),1),o("th",Ss,l(a(r)("projects.development_plan.version.cost")),1)])]),o("tbody",null,[(n(!0),f(ae,null,ue(j.value,(V,G)=>(n(),f("tr",{key:G},[o("td",null,l(V.role),1),o("td",Us,l(V.hours),1),o("td",zs,l(V.rate||30),1),o("td",Is,l(z(V.cost)),1)]))),128)),j.value.length===0?(n(),f("tr",Ds,[o("td",$s,l(a(r)("projects.development_plan.version.no_roles")),1)])):w("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s.version.notes?(n(),g(B,{key:0,cols:"12"},{default:t(()=>[e(te,{variant:"outlined"},{default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.development_plan.notes")),1)]),_:1}),e(Y,null,{default:t(()=>[o("div",Ps,l(s.version.notes),1)]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]))]),_:1}),e(ie),e(me,{class:"pa-4"},{default:t(()=>[_.value?(n(),f(ae,{key:0},[e(P,{color:"secondary",variant:"tonal",onClick:Z,disabled:U.value},{default:t(()=>[m(l(a(r)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(le),e(P,{color:"primary",onClick:A,loading:U.value},{default:t(()=>[m(l(a(r)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),f(ae,{key:1},[!s.isCurrent&&s.hasManagerPermission?(n(),g(P,{key:0,color:"primary",variant:"tonal",onClick:H,loading:U.value,"prepend-icon":"tabler-check"},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.set_current")),1)]),_:1},8,["loading"])):w("",!0),e(le),s.hasManagerPermission?(n(),g(P,{key:1,color:"primary","prepend-icon":"tabler-edit",onClick:Z},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.edit")),1)]),_:1})):w("",!0)],64))]),_:1})]),_:1}),e(Ve,{modelValue:C.value.show,"onUpdate:modelValue":I[5]||(I[5]=V=>C.value.show=V),color:C.value.color,timeout:5e3},{actions:t(()=>[e(D,{onClick:I[4]||(I[4]=V=>C.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(C.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-a1b84d78"]]),Bs={class:"text-h5"},Rs={class:"text-subtitle-1 mb-4"},Ls={class:"text-left",style:{"min-width":"200px"}},As={class:"text-right",style:{"min-width":"120px"}},Fs={class:"text-right",style:{"min-width":"120px"}},Os={class:"text-right",style:{"min-width":"120px"}},Ns=o("th",{class:"text-right",style:{width:"50px"}},null,-1),Es={class:"text-right"},Ws={colspan:"3",class:"text-right font-weight-bold"},Ts={class:"text-right font-weight-bold"},Gs=o("td",null,null,-1),Xs={__name:"PlanVersionCreateDialog",props:{modelValue:{type:Boolean,default:!1},planId:{type:String,required:!0},projectId:{type:String,required:!0},currentVersionNumber:{type:Number,default:0},preliminaryBudget:{type:Number,default:0}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=ee({get:()=>i.modelValue,set:F=>u("update:modelValue",F)}),c=k([{role:"Product Manager",hours:60,cost:1800},{role:"System Analyst",hours:40,cost:1e3},{role:"UX/UI Designer",hours:90,cost:2250},{role:"Flutter Developer (Middle)",hours:240,cost:4800},{role:"Backend Developer",hours:120,cost:2400},{role:"QA Engineer",hours:80,cost:1440},{role:"DevOps/Deployment Specialist",hours:20,cost:400},{role:"Support/Documentation Specialist",hours:16,cost:320}]),_=k({estimated_cost:1e4,notes:"",status:"draft"}),h=ee(()=>c.value.reduce((F,O)=>F+O.cost,0)),j=ee(()=>i.preliminaryBudget>0&&h.value>i.preliminaryBudget),U=[F=>!!F||r("projects.development_plan.validation.estimated_cost_required"),F=>!isNaN(parseFloat(F))||r("projects.development_plan.validation.estimated_cost_number")],C=k(null),S=()=>{c.value=[{role:"Product Manager",hours:60,cost:1800},{role:"System Analyst",hours:40,cost:1e3},{role:"UX/UI Designer",hours:90,cost:2250},{role:"Flutter Developer (Middle)",hours:240,cost:4800},{role:"Backend Developer",hours:120,cost:2400},{role:"QA Engineer",hours:80,cost:1440},{role:"DevOps/Deployment Specialist",hours:20,cost:400},{role:"Support/Documentation Specialist",hours:16,cost:320}],_.value={estimated_cost:1e4,notes:"",status:"draft"},C.value&&C.value.resetValidation()},R=()=>{v.value=!1,S()},L=()=>{c.value.push({role:"",hours:0,cost:0})},z=F=>{F.cost=F.hours*(F.rate||30)},Z=async()=>{const{valid:F}=await C.value.validate();if(F){const O={..._.value,roles_and_hours:JSON.stringify(c.value),estimated_cost:h.value};u("submit",O),v.value=!1,S()}};return pe(v,F=>{F||S()}),(F,O)=>{const Q=ke("IconBtn");return n(),g(je,{modelValue:a(v),"onUpdate:modelValue":O[3]||(O[3]=A=>De(v)?v.value=A:null),"max-width":"900",persistent:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[o("h5",Bs,l(a(r)("projects.development_plan.actions.new_version")),1),e(le),e(Q,{onClick:R},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(Y,{class:"px-5 pt-4"},{default:t(()=>[o("p",Rs,l(a(r)("projects.development_plan.creating_version",{version:s.currentVersionNumber+1})),1),e(Se,{ref_key:"formRef",ref:C,onSubmit:we(Z,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12",md:"6"},{default:t(()=>[e(ne,{modelValue:_.value.estimated_cost,"onUpdate:modelValue":O[0]||(O[0]=A=>_.value.estimated_cost=A),modelModifiers:{number:!0},label:a(r)("projects.development_plan.estimated_cost"),type:"number",rules:U,required:"",disabled:"","model-value":a(h)},null,8,["modelValue","label","model-value"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:_.value.status,"onUpdate:modelValue":O[1]||(O[1]=A=>_.value.status=A),label:a(r)("projects.details.status"),items:[{title:a(r)("projects.status.draft"),value:"draft"},{title:a(r)("projects.status.active"),value:"active"},{title:a(r)("projects.status.archived"),value:"archived"},{title:a(r)("projects.status.completed"),value:"completed"}],required:""},null,8,["modelValue","label","items"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(te,{variant:"outlined"},{default:t(()=>[e(re,{class:"d-flex align-center"},{default:t(()=>[m(l(a(r)("projects.development_plan.version.roles_hours_breakdown"))+" ",1),e(le),e(P,{color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-plus",onClick:L},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.add_role")),1)]),_:1})]),_:1}),e(Y,null,{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(Pe,null,{default:t(()=>[o("thead",null,[o("tr",null,[o("th",Ls,l(a(r)("projects.development_plan.version.role")),1),o("th",As,l(a(r)("projects.development_plan.version.hours")),1),o("th",Fs,l(a(r)("projects.development_plan.version.rate")),1),o("th",Os,l(a(r)("projects.development_plan.version.cost")),1),Ns])]),o("tbody",null,[(n(!0),f(ae,null,ue(c.value,(A,H)=>(n(),f("tr",{key:H},[o("td",null,[e(ne,{modelValue:A.role,"onUpdate:modelValue":N=>A.role=N,density:"compact","hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[e(ne,{modelValue:A.hours,"onUpdate:modelValue":[N=>A.hours=N,N=>z(A)],modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",variant:"outlined",class:"text-right"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[e(ne,{modelValue:A.rate,"onUpdate:modelValue":[N=>A.rate=N,N=>z(A)],modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",variant:"outlined",class:"text-right","model-value":A.rate||30},null,8,["modelValue","onUpdate:modelValue","model-value"])]),o("td",null,[e(ne,{modelValue:A.cost,"onUpdate:modelValue":N=>A.cost=N,modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",variant:"outlined",class:"text-right",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),o("td",Es,[e(P,{icon:"",variant:"text",color:"error",size:"small",onClick:N=>($=>{c.value.splice($,1)})(H)},{default:t(()=>[e(q,{icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),128))]),o("tfoot",null,[o("tr",null,[o("td",Ws,l(a(r)("projects.development_plan.version.total"))+": ",1),o("td",Ts,l(a(h).toLocaleString("en-US",{style:"currency",currency:"USD"})),1),Gs])])]),_:1})]),_:1}),e(B,{cols:"12"},{default:t(()=>[a(j)?(n(),g(xe,{key:0,type:"warning",variant:"tonal",class:"mt-4"},{default:t(()=>[m(l(a(r)("projects.development_plan.validation.over_budget",{total:a(h).toLocaleString("en-US",{style:"currency",currency:"USD"}),budget:s.preliminaryBudget.toLocaleString("en-US",{style:"currency",currency:"USD"})})),1)]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:_.value.notes,"onUpdate:modelValue":O[2]||(O[2]=A=>_.value.notes=A),label:a(r)("projects.development_plan.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ie),e(me,{class:"pa-4"},{default:t(()=>[e(P,{variant:"tonal",color:"secondary",onClick:R},{default:t(()=>[m(l(a(r)("projects.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:Z},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.create_version")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Hs={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},Js={key:1,class:"text-center pa-6"},Ks={class:"text-h6 mb-2"},Zs={class:"text-body-1 text-medium-emphasis mb-6"},Qs={key:2},Ys={class:"d-flex flex-column"},eo={class:"text-h6 mb-2"},to={class:"text-h4 font-weight-bold"},ao={class:"text-caption text-medium-emphasis"},lo={class:"text-h6 mb-3"},ro={class:"text-right"},so={class:"text-right"},oo={class:"text-right"},io={class:"text-right"},no={class:"d-flex align-center justify-space-between mb-4"},co={class:"text-h5"},uo={class:"text-right"},mo={class:"text-right"},po=["onClick"],vo={class:"d-flex align-center"},fo={class:"font-weight-medium"},_o={class:"text-right"},go={class:"text-right"},yo={key:1,class:"text-center pa-4"},ho={class:"text-medium-emphasis"},jo={key:2,class:"text-center pa-4"},bo={class:"text-medium-emphasis"},ko={__name:"ProjectDevelopmentPlan",props:{projectId:{type:String,required:!0},developmentPlan:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1},preliminaryBudget:{type:Number,default:0}},emits:["refresh"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=qt(),c=Me(),_=k(null),h=k(!1),j=k(!1),U=k(!1),C=k({show:!1,text:"",color:"success"}),S=ee(()=>c.is_admin()),R=k(!1),L=async()=>{R.value=await c.hasProjectRoleAtLeast(i.projectId,"MANAGER")},z=ee(()=>i.developmentPlan&&i.developmentPlan.id),Z=ee(()=>z.value&&i.developmentPlan.versions?[...i.developmentPlan.versions].sort((D,V)=>V.version_number-D.version_number):[]),F=ee(()=>z.value?Z.value.find(D=>D.version_number===i.developmentPlan.current_version_number):null),O=D=>D?new Date(parseInt(D)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",Q=D=>D||D===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(D):"-",A=D=>{_.value=D,h.value=!0},H=()=>{j.value=!0},N=async D=>{U.value=!0;try{const{data:V,error:G}=await v.createPlanVersion(i.developmentPlan.id,D);V&&!G?(M(r("projects.development_plan.notifications.version_created")),u("refresh")):M(r("projects.development_plan.notifications.version_create_failed"),"error")}catch(V){M(r("projects.development_plan.notifications.version_create_failed")+": "+V.message,"error")}finally{U.value=!1,j.value=!1}},$=async()=>{U.value=!0;try{const{data:D,error:V}=await v.createDevelopmentPlan(i.projectId);D&&!V?(M(r("projects.development_plan.notifications.created")),u("refresh")):M(r("projects.development_plan.notifications.create_failed"),"error")}catch(D){M(r("projects.development_plan.notifications.create_failed")+": "+D.message,"error")}finally{U.value=!1}},M=(D,V="success")=>{C.value={show:!0,text:D,color:V}},I=D=>{if(!D)return[];try{return typeof D=="string"?JSON.parse(D):D}catch(V){return console.error("Error parsing roles and hours:",V),[]}};return L(),pe(()=>i.projectId,()=>{L()}),(D,V)=>{const G=ke("IconBtn");return n(),g(Y,{class:"pa-6"},{default:t(()=>[s.loading?(n(),f("div",Hs,[e(de,{indeterminate:"",color:"primary"})])):a(z)?(n(),f("div",Qs,[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(te,{border:"",class:"mb-4"},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(ze,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:t(()=>[e(q,{icon:"tabler-calendar-stats"})]),_:1})]),append:t(()=>[e(K,{color:"primary",size:"small",label:"",class:"me-2"},{default:t(()=>[m(" v"+l(s.developmentPlan.current_version_number),1)]),_:1}),e(K,{color:s.developmentPlan.status==="active"?"success":"warning",size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${s.developmentPlan.status}`)),1)]),_:1},8,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(r)("projects.development_plan.current_plan")),1)]),_:1})]),_:1}),e(ie),a(F)?(n(),g(Y,{key:0},{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12",md:"4"},{default:t(()=>[o("div",Ys,[o("div",eo,l(a(r)("projects.development_plan.estimated_cost")),1),o("div",to,l(Q(a(F).estimated_cost)),1),o("div",ao,l(a(r)("projects.development_plan.version.created"))+": "+l(O(a(F).created_at)),1)])]),_:1}),e(B,{cols:"12",md:"8"},{default:t(()=>[o("div",lo,l(a(r)("projects.development_plan.version.roles_hours_breakdown")),1),e(Pe,{density:"compact"},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",null,l(a(r)("projects.development_plan.version.role")),1),o("th",ro,l(a(r)("projects.development_plan.version.hours")),1),o("th",so,l(a(r)("projects.development_plan.version.cost")),1)])]),o("tbody",null,[(n(!0),f(ae,null,ue(I(a(F).roles_and_hours),(x,b)=>(n(),f("tr",{key:b},[o("td",null,l(x.role),1),o("td",oo,l(x.hours),1),o("td",io,l(Q(x.cost)),1)]))),128))])]),_:1}),e(P,{color:"primary",variant:"tonal",class:"mt-4",size:"small",onClick:V[0]||(V[0]=x=>A(a(F)))},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.view_details")),1)]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1}),e(B,{cols:"12"},{default:t(()=>[o("div",no,[o("h5",co,l(a(r)("projects.development_plan.version_history")),1),R.value?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:H,disabled:U.value},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.new_version")),1)]),_:1},8,["disabled"])):w("",!0)]),a(Z).length>1?(n(),g(Pe,{key:0},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",null,l(a(r)("projects.development_plan.version.version")),1),o("th",null,l(a(r)("projects.development_plan.version.created")),1),o("th",null,l(a(r)("projects.details.status")),1),o("th",uo,l(a(r)("projects.development_plan.estimated_cost")),1),o("th",mo,l(a(r)("projects.actions.title")),1)])]),o("tbody",null,[(n(!0),f(ae,null,ue(a(Z),x=>(n(),f("tr",{key:x.id,class:lt({"bg-primary-lighten-5":x.version_number===s.developmentPlan.current_version_number}),style:{cursor:"pointer"},onClick:b=>A(x)},[o("td",null,[o("div",vo,[o("span",fo,"v"+l(x.version_number),1),x.version_number===s.developmentPlan.current_version_number?(n(),g(K,{key:0,color:"primary",size:"x-small",label:"",class:"ms-2"},{default:t(()=>[m(l(a(r)("projects.development_plan.version.current")),1)]),_:1})):w("",!0)])]),o("td",null,l(O(x.created_at)),1),o("td",null,[e(K,{color:x.status==="active"?"success":"warning",size:"small",label:""},{default:t(()=>[m(l(a(r)(`projects.status.${x.status}`)),1)]),_:2},1032,["color"])]),o("td",_o,l(Q(x.estimated_cost)),1),o("td",go,[e(P,{icon:"",variant:"text",size:"small",color:"primary",onClick:we(b=>A(x),["stop"])},{default:t(()=>[e(q,{icon:"tabler-eye"})]),_:2},1032,["onClick"])])],10,po))),128))])]),_:1})):a(Z).length===1?(n(),f("div",yo,[o("p",ho,l(a(r)("projects.development_plan.version.only_one_version")),1)])):(n(),f("div",jo,[o("p",bo,l(a(r)("projects.development_plan.version.no_versions")),1)]))]),_:1})]),_:1})])):(n(),f("div",Js,[e(q,{icon:"tabler-calendar-time",size:"64",color:"secondary",class:"mb-4"}),o("h4",Ks,l(a(r)("projects.development_plan.empty.title")),1),o("p",Zs,l(a(r)("projects.development_plan.empty.description")),1),R.value?(n(),g(P,{key:0,color:"primary",onClick:$,loading:U.value},{default:t(()=>[m(l(a(r)("projects.development_plan.actions.create_plan")),1)]),_:1},8,["loading"])):w("",!0)])),_.value?(n(),g(Ms,{key:3,modelValue:h.value,"onUpdate:modelValue":V[1]||(V[1]=x=>h.value=x),version:_.value,"is-current":_.value&&s.developmentPlan&&_.value.version_number===s.developmentPlan.current_version_number,"is-admin":a(S),"has-manager-permission":R.value,"plan-id":s.developmentPlan?s.developmentPlan.id:null,"preliminary-budget":s.preliminaryBudget,"project-id":s.developmentPlan?s.developmentPlan.project:null,onRefresh:V[2]||(V[2]=x=>u("refresh"))},null,8,["modelValue","version","is-current","is-admin","has-manager-permission","plan-id","preliminary-budget","project-id"])):w("",!0),e(Xs,{modelValue:j.value,"onUpdate:modelValue":V[3]||(V[3]=x=>j.value=x),"plan-id":s.developmentPlan?s.developmentPlan.id:null,"current-version-number":s.developmentPlan?s.developmentPlan.current_version_number:0,"preliminary-budget":s.preliminaryBudget,"project-id":s.developmentPlan?s.developmentPlan.project:null,onSubmit:N},null,8,["modelValue","plan-id","current-version-number","preliminary-budget","project-id"]),e(Ve,{modelValue:C.value.show,"onUpdate:modelValue":V[5]||(V[5]=x=>C.value.show=x),color:C.value.color,timeout:5e3},{actions:t(()=>[e(G,{onClick:V[4]||(V[4]=x=>C.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(C.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},xo={key:0,class:"text-h5"},wo={key:1,class:"text-h5"},Vo={key:0},qo={class:"align-center justify-space-between mb-3"},Co={class:"text-subtitle-1 font-weight-medium"},So={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},Uo={key:1},zo={class:"d-flex align-center mb-5"},Io={class:"d-flex align-center"},Do={class:"text-medium-emphasis d-flex align-center"},$o={class:"text-caption me-4"},Po={class:"text-caption"},Mo={class:"user-story-format mb-6"},Bo={class:"text-h5 mb-4"},Ro={class:"text-primary"},Lo={class:"text-h5 mb-4"},Ao={class:"text-primary"},Fo={class:"text-h5 mb-4"},Oo={class:"text-primary"},No={key:0},Eo={class:"text-h6 mb-3"},Wo={key:1,class:"text-medium-emphasis text-center pa-4"},To={key:2,class:"mt-6"},Go={key:0,class:"text-center pa-6"},Xo={class:"text-h6 mb-2"},Ho={class:"text-medium-emphasis"},Jo={key:1},Ko={class:"d-flex align-center"},Zo={class:"mockup-preview mb-3"},Qo={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Yo={key:0,class:"d-flex justify-center align-center h-100"},ei={class:"text-center"},ti={class:"text-caption"},ai={key:1,class:"html-preview"},li={key:2,class:"d-flex justify-center align-center h-100"},ri={class:"preview-overlay d-flex justify-center align-center"},si={key:0,class:"mb-2"},oi={class:"d-flex align-center justify-space-between"},ii={class:"d-flex align-center"},ni={class:"text-caption"},ci={key:0,class:"text-center pa-6"},ui={class:"text-h6 mb-2"},di={class:"text-medium-emphasis"},mi={key:1},pi={class:"text-caption"},vi={class:"text-caption text-medium-emphasis"},fi={class:"text-primary"},_i={class:"mb-2"},gi={class:"text-primary"},yi={class:"mb-4"},hi={class:"text-primary"},ji={key:0},bi={class:"text-subtitle-2 font-weight-medium mb-2"},ki={class:"ms-3"},xi={class:"text-caption mt-3"},wi={class:"d-flex justify-end mt-2"},Vi={key:1,class:"text-center pa-6"},qi={class:"text-h6 mb-2"},Ci={class:"text-medium-emphasis"},Si={key:2},Ui={class:"d-flex align-center"},zi={class:"d-flex align-center"},Ii={class:"text-caption text-medium-emphasis ml-2"},Di={class:"comment-text mt-2 whitespace-pre-wrap"},$i={class:"text-body-1 mb-3"},Pi=Ue({__name:"UserStoryDetailsDialog",props:{modelValue:{type:Boolean,default:!1},userStory:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","regenerate"],setup(s,{emit:u}){const i=s,r=ee({get:()=>i.modelValue,set:T=>u("update:modelValue",T)}),v=ot();Qe();const{t:c}=ye(),_=k(0),h=k(!1),j=k({...i.userStory}),U=k(""),C=k(""),S=k(""),R=k(!1),L=k(!1),z=k(null),Z=k(!1),F=k({show:!1,text:"",color:"success"}),O=k(null),Q=[{title:c("projects.status.draft"),value:"draft"},{title:c("projects.status.active"),value:"active"},{title:c("projects.status.archived"),value:"archived"},{title:c("projects.status.completed"),value:"completed"}],A=ee(()=>i.userStory.history||[]),H=ee(()=>i.userStory.comments||[]),N=ee(()=>i.userStory.mockups||[]),$=T=>T?(T=parseInt(T),new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",M=()=>{h.value&&(j.value={...i.userStory},U.value=""),h.value=!h.value,_.value="0"},I=()=>{U.value.trim()&&(j.value.acceptance_criteria||(j.value.acceptance_criteria=[]),j.value.acceptance_criteria.push(U.value.trim()),U.value="")},D=()=>{r.value&&v.fetchUserStoryById(i.userStory.id).then(({data:T})=>{T&&Object.assign(i.userStory,T)})};Ce(()=>{O.value=setInterval(D,5e3)}),Ne(()=>{O.value&&clearInterval(O.value)});const V=()=>{u("update",j.value),h.value=!1,r.value=!1},G=()=>{u("delete"),r.value=!1},x=()=>{S.value="",R.value=!0},b=()=>{u("regenerate",S.value),R.value=!1,r.value=!1},p=async()=>{if(C.value.trim()){L.value=!0;try{const{data:T,error:d}=await v.createComment(i.userStory.id,{text:C.value,status:"active"});if(T&&!d){X("Comment added successfully"),C.value="";const{data:E}=await v.fetchUserStoryById(i.userStory.id);E&&Object.assign(i.userStory,E)}else X("Failed to add comment","error")}catch(T){X("Failed to add comment: "+T.message,"error")}finally{L.value=!1}}},X=(T,d="success")=>{F.value={show:!0,text:T,color:d}};return pe(()=>i.userStory,T=>{j.value={...T}},{deep:!0}),(T,d)=>{const E=ke("IconBtn");return n(),g(je,{modelValue:a(r),"onUpdate:modelValue":d[15]||(d[15]=y=>De(r)?r.value=y:null),"max-width":"900",scrollable:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[h.value?(n(),f("h5",xo,l(a(c)("projects.user_stories.title.edit")),1)):(n(),f("h5",wo,l(a(c)("projects.user_stories.title.details")),1)),e(le),e(E,{onClick:d[0]||(d[0]=y=>r.value=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(Y,{class:"pb-0"},{default:t(()=>[e(rt,{modelValue:_.value,"onUpdate:modelValue":d[1]||(d[1]=y=>_.value=y),"slider-color":"primary","align-tabs":"start"},{default:t(()=>[e(_e,{value:"0"},{default:t(()=>[e(q,{size:"18",icon:"tabler-user-check",start:""}),m(" "+l(a(c)("projects.requirements.tabs.details")),1)]),_:1}),e(_e,{value:"1"},{default:t(()=>[e(q,{size:"18",icon:"tabler-photo",start:""}),m(" "+l(a(c)("projects.requirements.tabs.mockups"))+" ",1),a(N).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(N).length),1)]),_:1})):w("",!0)]),_:1}),e(_e,{value:"2"},{default:t(()=>[e(q,{size:"18",icon:"tabler-history",start:""}),m(" "+l(a(c)("projects.requirements.tabs.history"))+" ",1),a(A).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(A).length),1)]),_:1})):w("",!0)]),_:1}),e(_e,{value:"3"},{default:t(()=>[e(q,{size:"18",icon:"tabler-messages",start:""}),m(" "+l(a(c)("projects.requirements.tabs.comments"))+" ",1),a(H).length?(n(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:t(()=>[m(l(a(H).length),1)]),_:1})):w("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ie),e(Y,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:t(()=>[e(st,{modelValue:_.value,"onUpdate:modelValue":d[8]||(d[8]=y=>_.value=y),class:"mt-5"},{default:t(()=>[e(ge,{value:"0"},{default:t(()=>[h.value?(n(),f("div",Vo,[e(Se,{onSubmit:we(V,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:j.value.role,"onUpdate:modelValue":d[2]||(d[2]=y=>j.value.role=y),label:a(c)("projects.user_stories.fields.role"),required:"",rules:[y=>!!y||a(c)("projects.user_stories.validation.role_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:j.value.action,"onUpdate:modelValue":d[3]||(d[3]=y=>j.value.action=y),label:a(c)("projects.user_stories.fields.action"),required:"",rules:[y=>!!y||a(c)("projects.user_stories.validation.action_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:j.value.benefit,"onUpdate:modelValue":d[4]||(d[4]=y=>j.value.benefit=y),label:a(c)("projects.user_stories.fields.benefit"),required:"",rules:[y=>!!y||a(c)("projects.user_stories.validation.benefit_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:j.value.status,"onUpdate:modelValue":d[5]||(d[5]=y=>j.value.status=y),label:a(c)("projects.user_stories.fields.status"),items:Q,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[o("div",qo,[o("div",Co,l(a(c)("projects.user_stories.fields.acceptance_criteria")),1),e(se,{class:"w-100"},{default:t(()=>[e(B,{cols:"10",sm:"8"},{default:t(()=>[e(ne,{modelValue:U.value,"onUpdate:modelValue":d[6]||(d[6]=y=>U.value=y),placeholder:a(c)("projects.user_stories.fields.add_criterion"),density:"compact","hide-details":"",class:"me-2",onKeyup:ht(I,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1}),e(B,{cols:"2",sm:"4"},{default:t(()=>[e(P,{color:"primary",size:"small",disabled:!U.value.trim(),onClick:I},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.add")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),j.value.acceptance_criteria&&j.value.acceptance_criteria.length>0?(n(),g(Ge,{key:0},{default:t(()=>[(n(!0),f(ae,null,ue(j.value.acceptance_criteria,(y,W)=>(n(),g(Xe,{key:W},{prepend:t(()=>[e(q,{icon:"tabler-check",color:"success"})]),append:t(()=>[e(E,{color:"error",variant:"text",size:"small",onClick:ce=>(J=>{j.value.acceptance_criteria.splice(J,1)})(W)},{default:t(()=>[e(q,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:t(()=>[e(He,null,{default:t(()=>[m(l(y),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),f("div",So,l(a(c)("projects.user_stories.empty.acceptance_criteria.description")),1))]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),f("div",Uo,[o("div",zo,[e(K,{color:a(be)(s.userStory.status),size:"small",label:"",class:"me-2"},{default:t(()=>[m(l(a(c)(`projects.status.${s.userStory.status}`)),1)]),_:1},8,["color"]),e(K,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:t(()=>[m(" v"+l(s.userStory.version_number),1)]),_:1})]),o("div",Io,[o("div",Do,[e(q,{size:"18",icon:"tabler-calendar",class:"me-1"}),o("span",$o,l(a(c)("projects.details.updated_at"))+": "+l($(s.userStory.updated_at)),1),e(q,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),o("span",Po,l(a(c)("projects.details.created_at"))+": "+l($(s.userStory.created_at)),1)])]),o("div",Mo,[o("div",Bo,[o("span",Ro,l(a(c)("projects.user_stories.fields.role")),1),m(" "+l(s.userStory.role)+", ",1)]),o("div",Lo,[o("span",Ao,l(a(c)("projects.user_stories.fields.action")),1),m(" "+l(s.userStory.action)+", ",1)]),o("div",Fo,[o("span",Oo,l(a(c)("projects.user_stories.fields.benefit")),1),m(" "+l(s.userStory.benefit)+". ",1)])]),e(ie,{class:"mb-4"}),s.userStory.acceptance_criteria&&s.userStory.acceptance_criteria.length>0?(n(),f("div",No,[o("div",Eo,l(a(c)("projects.user_stories.fields.acceptance_criteria")),1),e(Ge,null,{default:t(()=>[(n(!0),f(ae,null,ue(s.userStory.acceptance_criteria,(y,W)=>(n(),g(Xe,{key:W,class:"px-0"},{prepend:t(()=>[e(q,{icon:"tabler-check",color:"success",class:"me-2"})]),default:t(()=>[e(He,null,{default:t(()=>[m(l(y),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(n(),f("div",Wo,l(a(c)("projects.user_stories.empty.acceptance_criteria.description")),1)),s.userStory.generation_status==="in_progress"?(n(),f("div",To,[e(xe,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:t(()=>[e(kt,null,{default:t(()=>[m(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1}),o("p",null,l(a(c)("projects.user_stories.regeneration.description")),1)]),_:1})])):w("",!0)]))]),_:1}),e(ge,{value:"1"},{default:t(()=>[a(N).length===0?(n(),f("div",Go,[e(q,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-3"}),o("h4",Xo,l(a(c)("projects.user_stories.mockups.empty.title")),1),o("p",Ho,l(a(c)("projects.user_stories.mockups.empty.description")),1)])):(n(),f("div",Jo,[e(se,null,{default:t(()=>[(n(!0),f(ae,null,ue(a(N),y=>(n(),g(B,{key:y.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(te,{class:"mockup-card h-100",onClick:W=>{z.value=y,Z.value=!0},border:"",hover:""},{default:t(()=>[e(ve,null,{append:t(()=>[o("div",Ko,[y.generation_status==="in_progress"||y.generation_status==="pending"||y.needs_regeneration?(n(),g(de,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):w("",!0),e(K,{color:a(be)(y.status),size:"small",label:""},{default:t(()=>[m(l(a(c)(`projects.status.${y.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(y.name),1)]),_:2},1024)]),_:2},1024),e(ie),e(Y,null,{default:t(()=>[o("div",Zo,[o("div",Qo,[y.generation_status==="in_progress"||y.generation_status==="pending"?(n(),f("div",Yo,[o("div",ei,[e(de,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),o("div",ti,l(a(c)("projects.mockups.status.generating")),1)])])):y.image?(n(),f("div",ai,[e(Ee,{src:y.image,alt:y.name},null,8,["src","alt"])])):(n(),f("div",li,[e(q,{icon:"tabler-file-code",size:"48",color:"secondary"})])),o("div",ri,[e(P,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye",disabled:y.generation_status==="in_progress"||y.generation_status==="pending"},{default:t(()=>[m(l(a(c)("projects.mockups.actions.preview")),1)]),_:2},1032,["disabled"])])])]),y.needs_regeneration?(n(),f("div",si,[e(K,{color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(c)("projects.mockups.status.regenerating")),1)]),_:1})])):w("",!0),o("div",oi,[o("div",ii,[e(q,{size:"16",icon:"tabler-calendar",class:"me-1"}),o("span",ni,l($(y.created_at)),1)])])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ge,{value:"2"},{default:t(()=>[a(A).length===0?(n(),f("div",ci,[e(q,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),o("h4",ui,l(a(c)("projects.user_stories.empty.history.title")),1),o("p",di,l(a(c)("projects.user_stories.empty.history.description")),1)])):(n(),f("div",mi,[e(xt,{density:"compact",align:"start"},{default:t(()=>[(n(!0),f(ae,null,ue(a(A),(y,W)=>(n(),g(wt,{key:W,"dot-color":"primary",size:"small"},{opposite:t(()=>[o("div",pi,l($(y.changed_at)),1),o("div",vi,"v"+l(y.version_number),1)]),default:t(()=>[e(te,{border:""},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(ze,{color:"primary",variant:"tonal",size:"36"},{default:t(()=>[e(q,{icon:"tabler-user-check"})]),_:1})]),append:t(()=>[e(K,{color:a(be)(y.status),size:"small",label:"",class:"ms-2"},{default:t(()=>[m(l(a(c)(`projects.status.${y.status}`)),1)]),_:2},1032,["color"])]),default:t(()=>[e(re,null,{default:t(()=>[o("span",fi,l(a(c)("projects.user_stories.fields.role")),1),m(" "+l(y.role),1)]),_:2},1024)]),_:2},1024),e(Y,null,{default:t(()=>[o("p",_i,[o("span",gi,l(a(c)("projects.user_stories.fields.action")),1),m(" "+l(y.action),1)]),o("p",yi,[o("span",hi,l(a(c)("projects.user_stories.fields.benefit")),1),m(" "+l(y.benefit),1)]),y.acceptance_criteria&&y.acceptance_criteria.length>0?(n(),f("div",ji,[o("div",bi,l(a(c)("projects.user_stories.fields.acceptance_criteria"))+": ",1),o("ul",ki,[(n(!0),f(ae,null,ue(y.acceptance_criteria,(ce,J)=>(n(),f("li",{key:J},l(ce),1))),128))])])):w("",!0),o("div",xi,l(a(c)("projects.requirements.history.changed_by"))+": "+l(y.changed_by?y.changed_by.username:a(c)("projects.requirements.history.unknown")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(ge,{value:"3"},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:C.value,"onUpdate:modelValue":d[7]||(d[7]=y=>C.value=y),label:a(c)("projects.requirements.comments.add"),rows:"3",counter:"",disabled:L.value},null,8,["modelValue","label","disabled"]),o("div",wi,[e(P,{color:"primary",size:"small",loading:L.value,disabled:!C.value.trim(),onClick:p},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.add_comment")),1)]),_:1},8,["loading","disabled"])])]),_:1}),e(B,{cols:"12"},{default:t(()=>[a(H).length?(n(),g(ie,{key:0,class:"mb-4"})):w("",!0),a(H).length===0?(n(),f("div",Vi,[e(q,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),o("h4",qi,l(a(c)("projects.user_stories.empty.comments.title")),1),o("p",Ci,l(a(c)("projects.user_stories.empty.comments.description")),1)])):(n(),f("div",Si,[(n(!0),f(ae,null,ue(a(H),y=>(n(),f("div",{key:y.id,class:"comment-item mb-4"},[e(te,{border:""},{default:t(()=>[e(Y,{class:"py-2"},{default:t(()=>[o("div",Ui,[e(ze,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:t(()=>[e(q,{icon:"tabler-user"})]),_:1}),o("div",null,[o("div",zi,[o("strong",null,l(y.user?y.user.username:a(c)("projects.requirements.comments.unknown_user")),1),o("div",Ii,l($(y.created_at)),1)])]),e(le),s.isAdmin||s.hasManagerPermission?(n(),g(E,{key:0,size:"small",color:"error",variant:"text",onClick:W=>(async ce=>{L.value=!0;try{const{success:J,error:he}=await v.deleteComment(ce);if(J&&!he){X("Comment deleted successfully");const{data:Ie}=await v.fetchUserStoryById(i.userStory.id);Ie&&Object.assign(i.userStory,Ie)}else X("Failed to delete comment","error")}catch(J){X("Failed to delete comment: "+J.message,"error")}finally{L.value=!1}})(y.id),disabled:L.value},{default:t(()=>[e(q,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):w("",!0)]),o("div",Di,l(y.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ie),e(me,{class:"pa-4"},{default:t(()=>[h.value?(n(),f(ae,{key:0},[e(P,{color:"secondary",variant:"tonal",onClick:M},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:V},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.save")),1)]),_:1})],64)):(n(),f(ae,{key:1},[s.isAdmin?(n(),g(P,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:G},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.delete")),1)]),_:1})):w("",!0),s.hasModeratorPermission?(n(),g(P,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:x},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.regenerate")),1)]),_:1})):w("",!0),e(le),s.hasModeratorPermission?(n(),g(P,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:M},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.edit")),1)]),_:1})):w("",!0)],64))]),_:1})]),_:1}),e(je,{modelValue:R.value,"onUpdate:modelValue":d[11]||(d[11]=y=>R.value=y),"max-width":"600",persistent:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"pt-3 pb-0"},{default:t(()=>[m(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1}),e(Y,null,{default:t(()=>[o("p",$i,l(a(c)("projects.user_stories.regeneration.description")),1),e(qe,{autofocus:"",modelValue:S.value,"onUpdate:modelValue":d[9]||(d[9]=y=>S.value=y),label:a(c)("projects.user_stories.fields.feedback"),hint:a(c)("projects.user_stories.placeholders.feedback"),rows:"4",counter:""},null,8,["modelValue","label","hint"])]),_:1}),e(me,null,{default:t(()=>[e(P,{color:"secondary",variant:"tonal",onClick:d[10]||(d[10]=y=>R.value=!1)},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:b},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.regenerate")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),z.value?(n(),g(nt,{key:0,modelValue:Z.value,"onUpdate:modelValue":d[12]||(d[12]=y=>Z.value=y),mockup:z.value,"is-admin":s.isAdmin,"has-manager-permission":s.hasManagerPermission},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):w("",!0),e(Ve,{modelValue:F.value.show,"onUpdate:modelValue":d[14]||(d[14]=y=>F.value.show=y),color:F.value.color,timeout:5e3},{actions:t(()=>[e(E,{onClick:d[13]||(d[13]=y=>F.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(F.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-dd5db4a3"]]),Mi={class:"text-h5"},Bi={class:"text-subtitle-1 font-weight-medium"},Ri={class:"d-flex align-center justify-space-between mb-3"},Li={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},Ai={__name:"UserStoryCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},userStoryData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=ee({get:()=>i.modelValue,set:F=>u("update:modelValue",F)}),c=k({role:i.editMode&&i.userStoryData?i.userStoryData.role:"",action:i.editMode&&i.userStoryData?i.userStoryData.action:"",benefit:i.editMode&&i.userStoryData?i.userStoryData.benefit:"",acceptance_criteria:i.editMode&&i.userStoryData?[...i.userStoryData.acceptance_criteria]:[],status:i.editMode&&i.userStoryData?i.userStoryData.status:"draft"}),_=k(""),h=k(null),j=[F=>!!F||r("projects.user_stories.validation.role_required")],U=[F=>!!F||r("projects.user_stories.validation.action_required")],C=[F=>!!F||r("projects.user_stories.validation.benefit_required")],S=[{title:r("projects.status.draft"),value:"draft"},{title:r("projects.status.active"),value:"active"},{title:r("projects.status.archived"),value:"archived"},{title:r("projects.status.completed"),value:"completed"}],R=()=>{_.value.trim()&&(c.value.acceptance_criteria||(c.value.acceptance_criteria=[]),c.value.acceptance_criteria.push(_.value.trim()),_.value="")},L=()=>{c.value={role:"",action:"",benefit:"",acceptance_criteria:[],status:"draft"},_.value="",h.value&&h.value.resetValidation()},z=()=>{v.value=!1,L()},Z=async()=>{const{valid:F}=await h.value.validate();F&&(u("submit",c.value),v.value=!1,L())};return pe(v,F=>{F||L()}),(F,O)=>{const Q=ke("IconBtn");return n(),g(je,{modelValue:a(v),"onUpdate:modelValue":O[5]||(O[5]=A=>De(v)?v.value=A:null),"max-width":"700",persistent:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex pt-5 px-5"},{default:t(()=>[o("h5",Mi,l(i.editMode?a(r)("projects.user_stories.title.edit"):a(r)("projects.user_stories.title.create")),1),e(le),e(Q,{onClick:z},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(Y,{class:"px-5 pt-4"},{default:t(()=>[e(Se,{ref_key:"formRef",ref:h,onSubmit:we(Z,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:c.value.role,"onUpdate:modelValue":O[0]||(O[0]=A=>c.value.role=A),label:a(r)("projects.user_stories.fields.role"),rules:j,placeholder:a(r)("projects.user_stories.placeholders.role"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:c.value.action,"onUpdate:modelValue":O[1]||(O[1]=A=>c.value.action=A),label:a(r)("projects.user_stories.fields.action"),rules:U,placeholder:a(r)("projects.user_stories.placeholders.action"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:c.value.benefit,"onUpdate:modelValue":O[2]||(O[2]=A=>c.value.benefit=A),label:a(r)("projects.user_stories.fields.benefit"),rules:C,placeholder:a(r)("projects.user_stories.placeholders.benefit"),required:""},null,8,["modelValue","label","placeholder"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:c.value.status,"onUpdate:modelValue":O[3]||(O[3]=A=>c.value.status=A),label:a(r)("projects.user_stories.fields.status"),items:S,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[o("div",Bi,l(a(r)("projects.user_stories.fields.acceptance_criteria")),1),o("div",Ri,[e(se,{class:"w-100"},{default:t(()=>[e(B,{cols:"10",sm:"8"},{default:t(()=>[e(ne,{modelValue:_.value,"onUpdate:modelValue":O[4]||(O[4]=A=>_.value=A),placeholder:a(r)("projects.user_stories.fields.add_criterion"),density:"compact","hide-details":"",class:"me-2",onKeyup:ht(R,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1}),e(B,{cols:"2",sm:"4"},{default:t(()=>[e(P,{color:"primary",size:"small",disabled:!_.value.trim(),onClick:R},{default:t(()=>[m(l(a(r)("projects.user_stories.actions.add")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),c.value.acceptance_criteria&&c.value.acceptance_criteria.length>0?(n(),g(Ge,{key:0},{default:t(()=>[(n(!0),f(ae,null,ue(c.value.acceptance_criteria,(A,H)=>(n(),g(Xe,{key:H},{prepend:t(()=>[e(q,{icon:"tabler-check",color:"success"})]),append:t(()=>[e(Q,{color:"error",variant:"text",size:"small",onClick:N=>($=>{c.value.acceptance_criteria.splice($,1)})(H)},{default:t(()=>[e(q,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:t(()=>[e(He,null,{default:t(()=>[m(l(A),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),f("div",Li,l(a(r)("projects.user_stories.empty.acceptance_criteria.description")),1))]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ie),e(me,{class:"pa-4"},{default:t(()=>[e(P,{variant:"tonal",color:"secondary",onClick:z},{default:t(()=>[m(l(a(r)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:Z},{default:t(()=>[m(l(i.editMode?a(r)("projects.user_stories.actions.save"):a(r)("projects.user_stories.actions.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Fi={key:0,class:"mb-4"},Oi={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},Ni={key:2,class:"text-center pa-4"},Ei={class:"text-h6 mb-2"},Wi={class:"text-body-1 text-medium-emphasis mb-6"},Ti={class:"d-flex align-center"},Gi={class:"text-body-1 mb-2"},Xi={class:"font-weight-medium text-primary"},Hi={class:"text-body-1 mb-4"},Ji={class:"font-weight-medium text-primary"},Ki={key:0},Zi={class:"text-subtitle-2 font-weight-medium mb-2 text-primary"},Qi={class:"ml-4"},Yi={key:0},en={class:"d-flex align-center justify-space-between mt-3"},tn={class:"d-flex align-center"},an={class:"text-caption"},ln={class:"d-flex align-center"},rn={class:"text-caption"},sn=Ue({__name:"UserStoriesList",props:{projectId:{type:String,required:!0},requirementId:{type:String,required:!1,default:null},userStories:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const i=s,r=ot(),v=Me(),{t:c}=ye(),_=k(""),h=k(["draft","active","completed"]),j=k(null),U=k(!1),C=k(!1),S=k(!1),R=k(!1),L=k({show:!1,text:"",color:"success"}),z=Te(),Z=ee(()=>v.is_admin()),F=k(!1),O=k(!1),Q=k(!1),A=[{title:c("projects.status.draft"),value:"draft"},{title:c("projects.status.active"),value:"active"},{title:c("projects.status.archived"),value:"archived"},{title:c("projects.status.completed"),value:"completed"}],H=ee(()=>i.userStories.filter(b=>{const p=!_.value||b.role.toLowerCase().includes(_.value.toLowerCase())||b.action.toLowerCase().includes(_.value.toLowerCase())||b.benefit.toLowerCase().includes(_.value.toLowerCase()),X=h.value.includes(b.status);return p&&X})),N=ee(()=>i.userStories.some(b=>b.generation_status==="in_progress"||b.generation_status==="pending")),$=()=>{C.value=!0},M=async b=>{R.value=!0;try{const{data:p,error:X}=await r.createUserStory({...b,requirement:i.requirementId});p&&!X?(G("User story created successfully"),u("refresh")):G("Failed to create user story","error")}catch(p){G("Failed to create user story: "+p.message,"error")}finally{R.value=!1}},I=async b=>{R.value=!0;try{const{data:p,error:X}=await r.updateUserStory(j.value.id,b);p&&!X?(G("User story updated successfully"),u("refresh")):G("Failed to update user story","error")}catch(p){G("Failed to update user story: "+p.message,"error")}finally{R.value=!1}},D=async()=>{if(j.value){R.value=!0,S.value=!1;try{const{success:b,error:p}=await r.deleteUserStory(j.value.id);b&&!p?(G("User story deleted successfully"),u("refresh"),U.value=!1):G("Failed to delete user story","error")}catch(b){G("Failed to delete user story: "+b.message,"error")}finally{R.value=!1}}},V=async(b="")=>{if(j.value){R.value=!0;try{const{data:p,error:X}=await r.regenerateUserStory(j.value.id,b);p&&!X?(G("User story regeneration started"),setTimeout(()=>{u("refresh")},3e3)):G("Failed to regenerate user story","error")}catch(p){G("Failed to regenerate user story: "+p.message,"error")}finally{R.value=!1}}},G=(b,p="success")=>{L.value={show:!0,text:b,color:p}},x=async()=>{F.value=await v.hasProjectRoleAtLeast(i.projectId,"MANAGER"),O.value=await v.hasProjectRoleAtLeast(i.projectId,"ADMIN"),Q.value=await v.hasProjectWriteAccess(i.projectId)};return Ce(()=>{x(),!i.requirementId||i.userStories.length||i.loading||r.fetchUserStories(i.requirementId).then(({data:b})=>{b&&u("refresh")}),z.on("project-refresh",()=>{r.fetchUserStories(i.requirementId,{silent:!0}).then(({data:b})=>{b&&u("refresh")})})}),pe(U,b=>{b?z.on("project-refresh",async()=>{if(j.value){const{data:p}=await r.fetchUserStoryById(j.value.id);p&&(j.value=p)}}):z.off("project-refresh")}),pe(()=>i.projectId,()=>{x()}),(b,p)=>{const X=We,T=ke("IconBtn");return n(),g(Y,{class:"pa-6"},{default:t(()=>[a(N)?(n(),f("div",Fi,[e(xe,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(de,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),o("span",null,l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1})])):w("",!0),e(se,null,{default:t(()=>[e(B,{cols:"12",md:"6"},{default:t(()=>[e(ne,{modelValue:_.value,"onUpdate:modelValue":p[0]||(p[0]=d=>_.value=d),density:"compact",placeholder:a(c)("projects.user_stories.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(B,{cols:"12",md:"4"},{default:t(()=>[e(fe,{modelValue:h.value,"onUpdate:modelValue":p[1]||(p[1]=d=>h.value=d),items:A,density:"compact","hide-details":"",label:a(c)("projects.user_stories.fields.status"),variant:"outlined",multiple:"",chips:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[O.value&&s.requirementId?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:$,loading:R.value,block:""},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.add")),1)]),_:1},8,["loading"])):w("",!0)]),_:1})]),_:1}),e(ie,{class:"my-5"}),s.loading?(n(),f("div",Oi,[e(de,{indeterminate:"",color:"primary"})])):a(H).length===0?(n(),f("div",Ni,[e(q,{icon:"tabler-notebook",size:"64",color:"secondary",class:"mb-4"}),o("h4",Ei,l(a(c)("projects.user_stories.empty.title")),1),o("p",Wi,l(_.value||h.value.length>0?a(c)("projects.user_stories.empty.filtered"):a(c)("projects.user_stories.empty.description")),1),O.value&&s.requirementId&&!_.value&&h.value.length===0?(n(),g(P,{key:0,color:"primary",onClick:$,"prepend-icon":"tabler-plus"},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.create")),1)]),_:1})):w("",!0)])):(n(),g(se,{key:3},{default:t(()=>[(n(!0),f(ae,null,ue(a(H),d=>(n(),g(B,{key:d.id,cols:"12",md:"6"},{default:t(()=>[e(te,{class:"user-story-card h-100 d-flex flex-column",onClick:E=>(async y=>{const{data:W}=await r.fetchUserStoryById(y.id);j.value=W||y,U.value=!0})(d),border:"",hover:""},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(ze,{color:"primary",variant:"tonal",size:"42"},{default:t(()=>[e(q,{icon:"tabler-user-check"})]),_:1})]),append:t(()=>[o("div",Ti,[d.generation_status==="in_progress"||d.generation_status==="pending"?(n(),g(de,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):w("",!0),d.generation_status==="pending"?(n(),g(K,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(c)("projects.user_stories.regeneration.title")),1)]),_:1})):w("",!0),e(K,{color:a(be)(d.status),size:"small",label:""},{default:t(()=>[m(l(b.$t(`projects.status.${d.status}`)),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(a(c)("projects.user_stories.fields.role"))+" "+l(d.role),1)]),_:2},1024)]),_:2},1024),e(Y,{class:"d-flex flex-column"},{default:t(()=>{return[o("p",Gi,[o("span",Xi,l(a(c)("projects.user_stories.fields.action"))+":",1),m(" "+l(d.action),1)]),o("p",Hi,[o("span",Ji,l(a(c)("projects.user_stories.fields.benefit"))+":",1),m(" "+l(d.benefit),1)]),d.acceptance_criteria&&d.acceptance_criteria.length>0?(n(),f("div",Ki,[o("div",Zi,l(a(c)("projects.user_stories.fields.acceptance_criteria"))+":",1),o("ul",Qi,[(n(!0),f(ae,null,ue(d.acceptance_criteria.slice(0,2),(y,W)=>(n(),f("li",{key:W},l(y),1))),128)),d.acceptance_criteria.length>2?(n(),f("li",Yi,l(a(c)("projects.user_stories.and_more",{count:d.acceptance_criteria.length-2})),1)):w("",!0)])])):w("",!0),e(le),o("div",en,[o("div",tn,[e(q,{size:"16",icon:"tabler-calendar",class:"me-1"}),o("span",an,l((E=d.updated_at,E?(E=parseInt(E),new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)]),o("div",ln,[e(q,{size:"16",icon:"tabler-history",class:"me-1"}),o("span",rn,"v"+l(d.version_number),1)])])];var E}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),j.value?(n(),g(Pi,{key:4,modelValue:U.value,"onUpdate:modelValue":p[2]||(p[2]=d=>U.value=d),"user-story":j.value,onDelete:p[3]||(p[3]=d=>S.value=!0),onUpdate:I,onRegenerate:V,"is-admin":a(Z),"has-manager-permission":F.value,"has-moderator-permission":O.value},null,8,["modelValue","user-story","is-admin","has-manager-permission","has-moderator-permission"])):w("",!0),e(Ai,{modelValue:C.value,"onUpdate:modelValue":p[4]||(p[4]=d=>C.value=d),onSubmit:M},null,8,["modelValue"]),e(X,{isDialogVisible:S.value,"onUpdate:isDialogVisible":p[5]||(p[5]=d=>S.value=d),confirmationMsg:a(c)("projects.user_stories.delete_confirm.message"),onConfirm:D},null,8,["isDialogVisible","confirmationMsg"]),e(Ve,{modelValue:L.value.show,"onUpdate:modelValue":p[7]||(p[7]=d=>L.value.show=d),color:L.value.color,timeout:5e3},{actions:t(()=>[e(T,{onClick:p[6]||(p[6]=d=>L.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(L.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-a1c18f3d"]]),on={key:0,class:"text-h5"},nn={class:"text-h5"},cn={key:0},un={class:"text-subtitle-1 font-weight-medium mb-2"},dn={class:"bg-grey-lighten-5 rounded pa-3"},mn={class:"text-medium-emphasis text-caption mb-2"},pn={key:1},vn={key:0,class:"pa-5"},fn={class:"d-flex justify-center my-8"},_n={class:"d-flex align-center justify-center text-medium-emphasis"},gn={class:"text-caption me-4"},yn={class:"text-caption"},hn={key:1,class:"diagram-content pa-0"},jn={class:"diagram-metadata d-flex align-center px-6 py-3"},bn={key:0,class:"ms-2"},kn={class:"text-medium-emphasis d-flex align-center"},xn={class:"text-caption me-4"},wn={class:"text-caption"},Vn={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},qn={class:"text-h6 mb-2"},Cn={class:"text-medium-emphasis text-center"},Sn=Ue({__name:"UmlDiagramDetailsDialog",props:{modelValue:{type:Boolean,default:!1},diagram:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(s,{emit:u}){const i=s,r=ee({get:()=>i.modelValue,set:N=>u("update:modelValue",N)}),v=it(),c=k(!1),_=k(!1),h=k({...i.diagram}),j=k(!1),U=k({show:!1,text:"",color:"success"}),{t:C}=ye(),S=[{title:C("projects.status.draft"),value:"draft"},{title:C("projects.status.active"),value:"active"},{title:C("projects.status.archived"),value:"archived"},{title:C("projects.status.completed"),value:"completed"}],R=N=>N?(N=parseInt(N),new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",L=()=>{c.value=!c.value},z=()=>{_.value&&(h.value={...i.diagram}),_.value=!_.value},Z=k(null),F=()=>{r.value&&v.fetchDiagramById(i.diagram.id).then(({data:N})=>{N&&Object.assign(i.diagram,N)})};Ce(()=>{Z.value=setInterval(F,5e3)}),Ne(()=>{Z.value&&clearInterval(Z.value)});const O=async()=>{j.value=!0;try{const{data:N,error:$}=await v.updateDiagram(i.diagram.id,h.value);N&&!$?(H(C("projects.uml_diagrams.notifications.updated")),Object.assign(i.diagram,N),_.value=!1,r.value=!1):H(C("projects.uml_diagrams.notifications.update_failed"),"error")}catch(N){H(C("projects.uml_diagrams.notifications.update_failed")+": "+N.message,"error")}finally{j.value=!1}},Q=()=>{u("delete"),r.value=!1},A=async()=>{j.value=!0;try{const{data:N,error:$}=await v.regenerateDiagram(i.diagram.id);N&&!$?(H(C("projects.uml_diagrams.notifications.regeneration_started")),r.value=!1,setTimeout(()=>{u("regenerate")},3e3)):H(C("projects.uml_diagrams.notifications.regeneration_failed"),"error")}catch(N){H(C("projects.uml_diagrams.notifications.regeneration_failed")+": "+N.message,"error")}finally{j.value=!1}},H=(N,$="success")=>{U.value={show:!0,text:N,color:$}};return pe(()=>i.diagram,N=>{h.value={...N}},{deep:!0}),(N,$)=>{const M=ke("IconBtn");return n(),g(je,{modelValue:a(r),"onUpdate:modelValue":$[7]||($[7]=I=>De(r)?r.value=I:null),fullscreen:c.value,"max-width":c.value?"100%":"900",scrollable:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"d-flex py-3 px-5"},{default:t(()=>[_.value?(n(),f("h5",on,l(a(C)("projects.uml_diagrams.actions.edit")),1)):(n(),f(ae,{key:1},[o("h5",nn,l(s.diagram.name),1),e(K,{class:"ms-2",color:"secondary",size:"small",label:""},{default:t(()=>[m(l(a(C)(`projects.uml_diagrams.types.${s.diagram.diagram_type}`)),1)]),_:1})],64)),e(le),e(P,{icon:"",variant:"text",onClick:L},{default:t(()=>[e(q,{icon:c.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(M,{onClick:$[0]||($[0]=I=>r.value=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),_:1}),e(ie),e(Y,{class:lt({"pa-0":!_.value&&s.diagram.content,"pa-6":_.value||!s.diagram.content}),style:Be({height:c.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:t(()=>[_.value?(n(),f("div",cn,[e(Se,{onSubmit:we(O,["prevent"])},{default:t(()=>[e(se,{class:"mt-3"},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:h.value.name,"onUpdate:modelValue":$[1]||($[1]=I=>h.value.name=I),label:a(C)("projects.uml_diagrams.name"),required:"",rules:[I=>!!I||a(C)("projects.uml_diagrams.validation.name_required")]},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12",md:"6"},{default:t(()=>[e(fe,{modelValue:h.value.status,"onUpdate:modelValue":$[2]||($[2]=I=>h.value.status=I),label:a(C)("projects.uml_diagrams.status.title"),items:S,required:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(qe,{modelValue:h.value.notes,"onUpdate:modelValue":$[3]||($[3]=I=>h.value.notes=I),label:a(C)("projects.uml_diagrams.notes"),rows:"4"},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[o("div",un,l(a(C)("projects.uml_diagrams.content")),1),o("div",dn,[o("div",mn,l(a(C)("projects.uml_diagrams.content_hint")),1),e(qe,{modelValue:h.value.content,"onUpdate:modelValue":$[4]||($[4]=I=>h.value.content=I),rows:"15",monospace:"","hide-details":""},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(n(),f("div",pn,[s.diagram.generation_status==="in_progress"?(n(),f("div",vn,[e(xe,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:t(()=>[e(kt,null,{default:t(()=>[m(l(a(C)("projects.uml_diagrams.status.generating")),1)]),_:1}),o("p",null,l(a(C)("projects.uml_diagrams.status.generating_description")),1)]),_:1}),o("div",fn,[e(de,{indeterminate:"",color:"primary",size:"64"})]),o("div",_n,[e(q,{size:"18",icon:"tabler-calendar",class:"me-1"}),o("span",gn,l(a(C)("projects.details.updated_at"))+": "+l(R(s.diagram.updated_at)),1),e(q,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),o("span",yn,l(a(C)("projects.details.created_at"))+": "+l(R(s.diagram.created_at)),1)])])):s.diagram.content?(n(),f("div",hn,[o("div",jn,[e(K,{color:a(be)(s.diagram.status),size:"small",label:"",class:"me-2"},{default:t(()=>[m(l(a(C)(`projects.status.${s.diagram.status}`)),1)]),_:1},8,["color"]),s.diagram.notes?(n(),f("div",bn,[e(Gt,null,{activator:t(({props:I})=>[e(q,jt({icon:"tabler-info-circle",size:"18",color:"info"},I),null,16)]),default:t(()=>[o("span",null,l(s.diagram.notes),1)]),_:1})])):w("",!0),e(le),o("div",kn,[e(q,{size:"18",icon:"tabler-calendar",class:"me-1"}),o("span",xn,l(a(C)("projects.details.updated_at"))+": "+l(R(s.diagram.updated_at)),1),e(q,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),o("span",wn,l(a(C)("projects.details.created_at"))+": "+l(R(s.diagram.created_at)),1)])]),e(ie),o("div",{class:"diagram-svg-container pa-4 d-flex justify-center align-center",style:Be({height:c.value?"calc(100vh - 180px)":"calc(70vh - 110px)",overflow:"auto"})},[s.diagram.content?(n(),g(Ee,{key:0,src:a(bt)(s.diagram.content),class:"diagram-svg",alt:"Generated Diagram"},null,8,["src"])):w("",!0)],4)])):(n(),f("div",Vn,[e(q,{icon:"tabler-chart-dots-2",size:"64",color:"secondary",class:"mb-4"}),o("h4",qn,l(a(C)("projects.uml_diagrams.status.no_content.title")),1),o("p",Cn,l(a(C)("projects.uml_diagrams.status.no_content.description")),1)]))]))]),_:1},8,["class","style"]),e(ie),e(me,{class:"pa-4"},{default:t(()=>[_.value?(n(),f(ae,{key:0},[e(P,{color:"secondary",variant:"tonal",onClick:z,disabled:j.value},{default:t(()=>[m(l(a(C)("projects.actions.cancel")),1)]),_:1},8,["disabled"]),e(le),e(P,{color:"primary",onClick:O,loading:j.value},{default:t(()=>[m(l(a(C)("projects.actions.save")),1)]),_:1},8,["loading"])],64)):(n(),f(ae,{key:1},[s.isAdmin?(n(),g(P,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:Q},{default:t(()=>[m(l(a(C)("projects.uml_diagrams.actions.delete")),1)]),_:1})):w("",!0),s.hasModeratorPermission?(n(),g(P,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:A,loading:j.value},{default:t(()=>[m(l(a(C)("projects.uml_diagrams.actions.regenerate")),1)]),_:1},8,["loading"])):w("",!0),e(le),s.hasModeratorPermission?(n(),g(P,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:z},{default:t(()=>[m(l(a(C)("projects.uml_diagrams.actions.edit")),1)]),_:1})):w("",!0)],64))]),_:1})]),_:1}),e(Ve,{modelValue:U.value.show,"onUpdate:modelValue":$[6]||($[6]=I=>U.value.show=I),color:U.value.color,timeout:5e3},{actions:t(()=>[e(M,{onClick:$[5]||($[5]=I=>U.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(U.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-036dfd63"]]),Un={key:0,class:"mb-4"},zn={key:1,class:"d-flex justify-center align-center",style:{height:"300px"}},In={key:2,class:"text-center pa-4"},Dn={class:"text-h6 mb-2"},$n={class:"text-body-1 text-medium-emphasis mb-6"},Pn={class:"d-flex align-center"},Mn={class:"mb-3 d-flex align-center"},Bn={class:"diagram-preview mb-3"},Rn={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},Ln={class:"d-flex justify-center align-center h-100"},An={key:0,class:"text-center pa-2"},Fn={class:"text-caption"},On={key:1,class:"diagram-thumbnail pa-2"},Nn={key:2,class:"text-center"},En={class:"text-caption mt-2"},Wn={class:"preview-overlay d-flex justify-center align-center"},Tn={class:"d-flex align-center justify-space-between"},Gn={class:"d-flex align-center"},Xn={class:"text-caption"},Hn={class:"text-body-1 mb-4"},Jn=Ue({__name:"UmlDiagramList",props:{projectId:{type:String,required:!0},diagrams:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const i=s,r=it(),v=Me(),{t:c}=ye(),_=k(""),h=k("all"),j=k(null),U=k(!1),C=k(!1),S=k(!1),R=k(!1),L=k({show:!1,text:"",color:"success"}),z=ee(()=>v.is_admin()),Z=k(!1),F=k(!1),O=async()=>{Z.value=await v.hasProjectRoleAtLeast(i.projectId,"MANAGER"),F.value=await v.hasProjectRoleAtLeast(i.projectId,"ADMIN")},Q=[{title:c("projects.uml_diagrams.types.all"),value:"all"},{title:c("projects.uml_diagrams.types.class"),value:"class"},{title:c("projects.uml_diagrams.types.sequence"),value:"sequence"},{title:c("projects.uml_diagrams.types.activity"),value:"activity"},{title:c("projects.uml_diagrams.types.usecase"),value:"use_case"},{title:c("projects.uml_diagrams.types.state"),value:"state"},{title:c("projects.uml_diagrams.types.component"),value:"component"},{title:c("projects.uml_diagrams.types.deployment"),value:"deployment"},{title:c("projects.uml_diagrams.types.er"),value:"er"}],A=k("class"),H=ee(()=>i.diagrams.filter(b=>{const p=!_.value||b.name.toLowerCase().includes(_.value.toLowerCase())||b.diagram_type.toLowerCase().includes(_.value.toLowerCase()),X=h.value==="all"||b.diagram_type.toLowerCase()===h.value.toLowerCase();return p&&X})),N=ee(()=>i.diagrams.some(b=>b.generation_status==="in_progress"||b.generation_status==="pending")),$=Te(),M=()=>{A.value="class",S.value=!0},I=async()=>{S.value=!1,R.value=!0;try{const{data:b,error:p}=await r.generateDiagrams(i.projectId,A.value);b&&!p?(V(c("projects.uml_diagrams.notifications.generation_started")),setTimeout(()=>{u("refresh")},3e3)):V(c("projects.uml_diagrams.notifications.generation_failed"),"error")}catch(b){V(c("projects.uml_diagrams.notifications.generation_failed")+": "+b.message,"error")}finally{R.value=!1}},D=async()=>{if(j.value){R.value=!0,C.value=!1;try{const{success:b,error:p}=await r.deleteDiagram(j.value.id);b&&!p?(V(c("projects.uml_diagrams.notifications.delete_success")),u("refresh"),U.value=!1):V(c("projects.uml_diagrams.notifications.delete_failed"),"error")}catch(b){V(c("projects.uml_diagrams.notifications.delete_failed")+": "+b.message,"error")}finally{R.value=!1}}},V=(b,p="success")=>{L.value={show:!0,text:b,color:p}},G=b=>{switch(b.toLowerCase()){case"all":default:return"tabler-chart-dots";case"class":return"tabler-box";case"sequence":return"tabler-arrow-right-square";case"activity":return"tabler-activity";case"usecase":return"tabler-user-check";case"state":return"tabler-circle-check";case"component":return"tabler-puzzle";case"deployment":return"tabler-server";case"er":return"tabler-database"}},x=b=>{switch(b.toLowerCase()){case"all":return c("projects.uml_diagrams.types.all");case"class":return c("projects.uml_diagrams.types.class");case"sequence":return c("projects.uml_diagrams.types.sequence");case"activity":return c("projects.uml_diagrams.types.activity");case"usecase":return c("projects.uml_diagrams.types.usecase");case"state":return c("projects.uml_diagrams.types.state");case"component":return c("projects.uml_diagrams.types.component");case"deployment":return c("projects.uml_diagrams.types.deployment");case"er":return c("projects.uml_diagrams.types.er");default:return b.charAt(0).toUpperCase()+b.slice(1)+" "+c("projects.uml_diagrams.types.diagram")}};return Ce(()=>{O(),$.on("project-refresh",()=>{r.fetchDiagrams(i.projectId,{silent:!0}).then(({data:b})=>{b&&u("refresh")})})}),pe(U,b=>{b?$.on("project-refresh",async()=>{if(j.value){const{data:p}=await r.fetchDiagramById(j.value.id);p&&(j.value=p)}}):$.off("project-refresh")}),pe(()=>i.projectId,()=>{O()}),(b,p)=>{const X=We,T=ke("IconBtn");return n(),g(Y,{class:"pa-6"},{default:t(()=>[a(N)?(n(),f("div",Un,[e(xe,{type:"info",variant:"tonal",border:"start",class:"d-flex align-center"},{default:t(()=>[e(de,{indeterminate:"",color:"primary",size:"24",class:"me-3"}),o("span",null,l(a(c)("projects.uml_diagrams.status.generating")),1)]),_:1})])):w("",!0),e(se,null,{default:t(()=>[e(B,{cols:"12",md:"4"},{default:t(()=>[e(ne,{modelValue:_.value,"onUpdate:modelValue":p[0]||(p[0]=d=>_.value=d),density:"compact",placeholder:a(c)("projects.uml_diagrams.actions.search"),"prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(B,{cols:"12",md:"4"},{default:t(()=>[e(fe,{modelValue:h.value,"onUpdate:modelValue":p[1]||(p[1]=d=>h.value=d),items:Q,density:"compact","hide-details":"",label:a(c)("projects.uml_diagrams.type"),variant:"outlined"},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12",md:"4",class:"d-flex align-center"},{default:t(()=>[F.value?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:M,loading:R.value,block:""},{default:t(()=>[m(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1},8,["loading"])):w("",!0)]),_:1})]),_:1}),e(ie,{class:"my-5"}),s.loading?(n(),f("div",zn,[e(de,{indeterminate:"",color:"primary"})])):a(H).length===0?(n(),f("div",In,[e(q,{icon:"tabler-chart-dots",size:"64",color:"secondary",class:"mb-4"}),o("h4",Dn,l(a(c)("projects.uml_diagrams.empty.title")),1),o("p",$n,l(_.value||h.value!=="all"?a(c)("projects.uml_diagrams.empty.filtered"):a(c)("projects.uml_diagrams.empty.description")),1),F.value&&!_.value&&h.value==="all"?(n(),g(P,{key:0,color:"primary",onClick:M,"prepend-icon":"tabler-plus"},{default:t(()=>[m(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1})):w("",!0)])):(n(),g(se,{key:3},{default:t(()=>[(n(!0),f(ae,null,ue(a(H),d=>(n(),g(B,{key:d.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(te,{class:"diagram-card h-100",onClick:E=>(async y=>{const{data:W}=await r.fetchDiagramById(y.id);j.value=W||y,U.value=!0})(d),border:"",hover:""},{default:t(()=>[e(ve,null,{prepend:t(()=>[e(ze,{color:"primary",variant:"tonal",size:"42"},{default:t(()=>[e(q,{icon:G(d.diagram_type)},null,8,["icon"])]),_:2},1024)]),append:t(()=>[o("div",Pn,[d.generation_status==="in_progress"||d.generation_status==="pending"?(n(),g(de,{key:0,indeterminate:"",color:"primary",size:"20",width:"2",class:"me-2"})):w("",!0),d.generation_status==="pending"?(n(),g(K,{key:1,color:"warning",size:"small",label:"","prepend-icon":"tabler-refresh"},{default:t(()=>[m(l(a(c)("projects.uml_diagrams.status.generating")),1)]),_:1})):w("",!0),e(K,{color:a(be)(d.status),size:"small",label:""},{default:t(()=>[m(l(d.status),1)]),_:2},1032,["color"])])]),default:t(()=>[e(re,null,{default:t(()=>[m(l(d.name),1)]),_:2},1024)]),_:2},1024),e(Y,null,{default:t(()=>{return[o("div",Mn,[e(K,{color:"secondary",size:"small",label:"",class:"me-2"},{default:t(()=>[m(l(x(d.diagram_type)),1)]),_:2},1024)]),o("div",Bn,[o("div",Rn,[o("div",Ln,[d.generation_status==="in_progress"?(n(),f("div",An,[e(de,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),o("div",Fn,l(a(c)("projects.uml_diagrams.status.generating")),1)])):d.content?(n(),f("div",On,[d.content?(n(),g(Ee,{key:0,src:a(bt)(d.content),class:"diagram-svg",alt:a(c)("projects.uml_diagrams.title")},null,8,["src","alt"])):w("",!0)])):(n(),f("div",Nn,[e(q,{icon:G(d.diagram_type),size:"48",color:"secondary"},null,8,["icon"]),o("div",En,l(a(c)("projects.uml_diagrams.status.no_content.title")),1)]))]),o("div",Wn,[e(P,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye"},{default:t(()=>[m(l(a(c)("projects.uml_diagrams.actions.view")),1)]),_:1})])])]),o("div",Tn,[o("div",Gn,[e(q,{size:"16",icon:"tabler-calendar",class:"me-1"}),o("span",Xn,l((E=d.created_at,E?(E=parseInt(E),new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)])])];var E}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),j.value?(n(),g(Sn,{key:4,modelValue:U.value,"onUpdate:modelValue":p[2]||(p[2]=d=>U.value=d),diagram:j.value,onDelete:p[3]||(p[3]=d=>C.value=!0),"is-admin":a(z),"has-manager-permission":Z.value,"has-moderator-permission":F.value},null,8,["modelValue","diagram","is-admin","has-manager-permission","has-moderator-permission"])):w("",!0),e(je,{modelValue:S.value,"onUpdate:modelValue":p[6]||(p[6]=d=>S.value=d),"max-width":"600",persistent:""},{default:t(()=>[e(te,null,{default:t(()=>[e(re,{class:"pt-5 pb-2"},{default:t(()=>[m(l(a(c)("projects.uml_diagrams.generation.title")),1)]),_:1}),e(Y,null,{default:t(()=>[o("p",Hn,l(a(c)("projects.uml_diagrams.generation.description")),1),e(fe,{modelValue:A.value,"onUpdate:modelValue":p[4]||(p[4]=d=>A.value=d),items:Q,label:a(c)("projects.uml_diagrams.type")},null,8,["modelValue","label"])]),_:1}),e(me,null,{default:t(()=>[e(P,{color:"secondary",variant:"tonal",onClick:p[5]||(p[5]=d=>S.value=!1)},{default:t(()=>[m(l(a(c)("projects.user_stories.actions.cancel")),1)]),_:1}),e(le),e(P,{color:"primary",onClick:I},{default:t(()=>[m(l(a(c)("projects.uml_diagrams.actions.generate")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{isDialogVisible:C.value,"onUpdate:isDialogVisible":p[7]||(p[7]=d=>C.value=d),confirmationMsg:a(c)("projects.uml_diagrams.delete_confirm.message"),onConfirm:D},null,8,["isDialogVisible","confirmationMsg"]),e(Ve,{modelValue:L.value.show,"onUpdate:modelValue":p[9]||(p[9]=d=>L.value.show=d),color:L.value.color,timeout:5e3},{actions:t(()=>[e(T,{onClick:p[8]||(p[8]=d=>L.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(L.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-61af0646"]]),Kn={key:2,class:"d-flex justify-center align-center",style:{"min-height":"200px"}},Zn={__name:"ProjectExportsList",props:{projectId:{type:String,required:!0},exports:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(s,{emit:u}){const{t:i}=ye(),r=v=>{switch(v){case"active":return"success";case"pending":return"warning";case"failed":return"error";default:return"grey"}};return(v,c)=>(n(),g(te,null,{default:t(()=>[e(Y,null,{default:t(()=>[!s.loading&&s.exports.length>0?(n(),g(Pe,{key:0},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",null,l(a(i)("projects.exports.table.format")),1),o("th",null,l(a(i)("projects.exports.table.status")),1),o("th",null,l(a(i)("projects.exports.table.created_by")),1),o("th",null,l(a(i)("projects.exports.table.created_at")),1),o("th",null,l(a(i)("projects.exports.table.actions")),1)])]),o("tbody",null,[(n(!0),f(ae,null,ue(s.exports,_=>{return n(),f("tr",{key:_.id},[o("td",null,l(_.fmt.toUpperCase()),1),o("td",null,[e(K,{color:r(_.status),size:"small"},{default:t(()=>[m(l(a(i)(`projects.exports.status.${_.status}`)),1)]),_:2},1032,["color"])]),o("td",null,l(_.created_by.username),1),o("td",null,l((h=_.created_at,new Date(parseInt(h)).toLocaleString())),1),o("td",null,[_.url?(n(),g(P,{key:0,icon:"",variant:"text",color:"primary",onClick:j=>(U=>{U.url&&window.open(U.url,"_blank")})(_)},{default:t(()=>[e(q,{icon:"tabler-download"})]),_:2},1032,["onClick"])):w("",!0)])]);var h}),128))])]),_:1})):s.loading||s.exports.length!==0?(n(),f("div",Kn,[e(de,{indeterminate:"",color:"primary",size:"64"})])):(n(),g(xe,{key:1,type:"info",variant:"tonal",class:"mt-4"},{default:t(()=>[m(l(a(i)("projects.exports.empty")),1)]),_:1}))]),_:1})]),_:1}))}},Qn={key:0},Yn={key:0},ec={class:"d-flex gap-2"},tc={__name:"ProjectRoles",props:{projectId:{type:String,required:!0}},emits:["updated"],setup(s,{emit:u}){const i=s,{t:r}=ye(),v=At(),c=Me(),_=ee(()=>v.projectRoles[i.projectId]||[]),h=k(!1),j=k(!1),U=k(!1),C=k(!1),S=k(!1),R=k({user_email:"",role:""}),L=k({id:null,username:"",role:""}),z=k(null),Z=ee(()=>c.userData.username),F=k(!1),O=[{text:r("projects.roles.role_types.owner"),value:"OWNER"},{text:r("projects.roles.role_types.admin"),value:"ADMIN"},{text:r("projects.roles.role_types.manager"),value:"MANAGER"},{text:r("projects.roles.role_types.member"),value:"MEMBER"},{text:r("projects.roles.role_types.viewer"),value:"VIEWER"}],Q=x=>({OWNER:"purple",ADMIN:"red",MANAGER:"orange",MEMBER:"blue",VIEWER:"green"})[x]||"grey",A=()=>{R.value={user_email:"",role:"VIEWER"},U.value=!0},H=k({show:!1,text:"",color:"error"}),N=x=>{let b="An unexpected error occurred";if(typeof x=="string")b=x;else if(x&&x.detail)b=x.detail;else if(x&&x.user_email)b=`Email error: ${x.user_email}`;else if(x&&x.user)b=`User error: ${x.user}`;else if(x&&x.role)b=`Role error: ${x.role}`;else if(x&&x.non_field_errors)b=x.non_field_errors[0];else if(x&&typeof x=="object"){const p=Object.keys(x)[0];p&&x[p]&&(b=`${p}: ${Array.isArray(x[p])?x[p][0]:x[p]}`)}H.value={show:!0,text:b,color:"error"}},$=(x,b="error")=>{H.value={show:!0,text:x,color:b}},M=async()=>{if(R.value.user_email&&R.value.role){j.value=!0;try{const{data:x,error:b}=await v.addProjectRole(i.projectId,R.value);x&&!b?($(r("projects.roles.notifications.role_added"),"success"),setTimeout(()=>{U.value=!1,u("updated"),c.clearProjectRoleCache(i.projectId)},1e3)):b&&N(b)}catch(x){N(x.message||"Failed to add member")}finally{j.value=!1}}},I=async()=>{if(L.value.id&&L.value.role){j.value=!0;try{const{data:x,error:b}=await v.updateProjectRole(i.projectId,L.value.id,{role:L.value.role});x&&!b?($(r("projects.roles.notifications.role_updated"),"success"),setTimeout(()=>{C.value=!1,u("updated"),c.clearProjectRoleCache(i.projectId)},1e3)):b&&N(b)}catch(x){N(x.message||"Failed to update role")}finally{j.value=!1}}},D=async()=>{var x;if((x=z.value)!=null&&x.id){j.value=!0;try{const{success:b,error:p}=await v.deleteProjectRole(i.projectId,z.value.id);b&&!p?(S.value=!1,z.value=null,u("updated"),c.clearProjectRoleCache(i.projectId)):p&&N(p)}catch(b){N(b.message||"Failed to remove member")}finally{j.value=!1}}},V=async()=>{h.value=!0;try{const{data:x,error:b}=await v.fetchProjectRoles(i.projectId);b&&N(b)}catch(x){N(x.message||"Failed to fetch project members")}finally{h.value=!1}},G=async()=>{F.value=await c.hasProjectRoleAtLeast(i.projectId,"MANAGER")};return pe(()=>i.projectId,()=>{i.projectId&&(V(),G())},{immediate:!0}),Ce(async()=>{i.projectId&&(await V(),await G())}),(x,b)=>(n(),g(te,null,{default:t(()=>[e(re,{class:"d-flex justify-space-between align-center"},{default:t(()=>[m(l(x.$t("projects.roles.title"))+" ",1),F.value?(n(),g(P,{key:0,color:"primary",size:"small",onClick:A},{default:t(()=>[e(q,{size:"18",start:"",icon:"tabler-plus"}),m(" "+l(x.$t("projects.roles.add_member")),1)]),_:1})):w("",!0)]),_:1}),e(Y,null,{default:t(()=>[a(_)&&a(_).length>0?(n(),g(Pe,{key:0},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",null,l(x.$t("projects.roles.user")),1),o("th",null,l(x.$t("projects.roles.email")),1),o("th",null,l(x.$t("projects.roles.role")),1),F.value?(n(),f("th",Qn,l(x.$t("projects.roles.actions")),1)):w("",!0)])]),o("tbody",null,[(n(!0),f(ae,null,ue(a(_),p=>(n(),f("tr",{key:p.id},[o("td",null,l(p.first_name)+" "+l(p.last_name),1),o("td",null,l(p.email),1),o("td",null,[F.value&&p.username!==a(Z)?(n(),g(K,{key:0,color:Q(p.role),onClick:X=>(T=>{L.value={id:T.id,username:T.username,role:T.role},C.value=!0})(p),class:"font-weight-medium cursor-pointer"},{default:t(()=>[m(l(x.$t(`projects.roles.role_types.${p.role.toLowerCase()}`)),1)]),_:2},1032,["color","onClick"])):(n(),g(K,{key:1,color:Q(p.role),class:"font-weight-medium"},{default:t(()=>[m(l(x.$t(`projects.roles.role_types.${p.role.toLowerCase()}`)),1)]),_:2},1032,["color"]))]),F.value?(n(),f("td",Yn,[o("div",ec,[p.username!==a(Z)&&p.role!=="OWNER"?(n(),g(P,{key:0,density:"compact",icon:"",variant:"text",disabled:j.value,onClick:X=>(T=>{z.value=T,S.value=!0})(p)},{default:t(()=>[e(q,{icon:"tabler-trash",size:"20",color:"error"})]),_:2},1032,["disabled","onClick"])):w("",!0)])])):w("",!0)]))),128))])]),_:1})):h.value?w("",!0):(n(),g(xe,{key:1,type:"info",variant:"tonal"},{default:t(()=>[m(l(x.$t("projects.roles.no_members")),1)]),_:1})),h.value?(n(),g(Le,{key:2,indeterminate:""})):w("",!0)]),_:1}),e(je,{modelValue:U.value,"onUpdate:modelValue":b[3]||(b[3]=p=>U.value=p),"max-width":"600px"},{default:t(()=>[e(te,null,{default:t(()=>[e(re,null,{default:t(()=>[m(l(x.$t("projects.roles.add_member")),1)]),_:1}),e(Y,null,{default:t(()=>[e(Se,{ref:"addRoleForm",onSubmit:we(M,["prevent"])},{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:R.value.user_email,"onUpdate:modelValue":b[0]||(b[0]=p=>R.value.user_email=p),label:x.$t("projects.roles.email"),rules:[p=>!!p||x.$t("validation.required"),p=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(p)||x.$t("validation.email")],required:""},null,8,["modelValue","label","rules"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(fe,{modelValue:R.value.role,"onUpdate:modelValue":b[1]||(b[1]=p=>R.value.role=p),items:O,"item-title":"text","item-value":"value",label:x.$t("projects.roles.role"),rules:[p=>!!p||x.$t("validation.required")],required:""},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(me,null,{default:t(()=>[e(le),e(P,{color:"error",text:"",onClick:b[2]||(b[2]=p=>U.value=!1)},{default:t(()=>[m(l(x.$t("projects.actions.cancel")),1)]),_:1}),e(P,{color:"primary",loading:j.value,disabled:!R.value.user_email||!R.value.role,onClick:M},{default:t(()=>[m(l(x.$t("projects.actions.add")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(je,{modelValue:C.value,"onUpdate:modelValue":b[7]||(b[7]=p=>C.value=p),"max-width":"600px"},{default:t(()=>[e(te,null,{default:t(()=>[e(re,null,{default:t(()=>[m(l(x.$t("projects.roles.edit_role")),1)]),_:1}),e(Y,null,{default:t(()=>[e(Se,{ref:"editRoleForm",onSubmit:we(I,["prevent"])},{default:t(()=>[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(ne,{modelValue:L.value.username,"onUpdate:modelValue":b[4]||(b[4]=p=>L.value.username=p),label:x.$t("projects.roles.user"),disabled:""},null,8,["modelValue","label"])]),_:1}),e(B,{cols:"12"},{default:t(()=>[e(fe,{modelValue:L.value.role,"onUpdate:modelValue":b[5]||(b[5]=p=>L.value.role=p),items:O,"item-title":"text","item-value":"value",label:x.$t("projects.roles.role"),rules:[p=>!!p||x.$t("validation.required")],required:""},null,8,["modelValue","label","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(me,null,{default:t(()=>[e(le),e(P,{color:"error",text:"",onClick:b[6]||(b[6]=p=>C.value=!1)},{default:t(()=>[m(l(x.$t("projects.actions.cancel")),1)]),_:1}),e(P,{color:"primary",loading:j.value,disabled:!L.value.role,onClick:I},{default:t(()=>[m(l(x.$t("projects.actions.save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(je,{modelValue:S.value,"onUpdate:modelValue":b[9]||(b[9]=p=>S.value=p),"max-width":"400px"},{default:t(()=>[e(te,null,{default:t(()=>[e(re,null,{default:t(()=>[m(l(x.$t("projects.roles.delete_role")),1)]),_:1}),e(Y,null,{default:t(()=>{var p,X;return[m(l(x.$t("projects.roles.delete_confirmation",{user:`${(p=z.value)==null?void 0:p.first_name} ${(X=z.value)==null?void 0:X.last_name}`})),1)]}),_:1}),e(me,null,{default:t(()=>[e(le),e(P,{color:"grey",text:"",onClick:b[8]||(b[8]=p=>S.value=!1)},{default:t(()=>[m(l(x.$t("projects.actions.cancel")),1)]),_:1}),e(P,{color:"error",loading:j.value,onClick:D},{default:t(()=>[m(l(x.$t("projects.actions.delete")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ve,{modelValue:H.value.show,"onUpdate:modelValue":b[11]||(b[11]=p=>H.value.show=p),color:H.value.color,timeout:5e3},{actions:t(()=>[e(P,{icon:"",onClick:b[10]||(b[10]=p=>H.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(H.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}},ac={class:"text-center"},lc={class:"d-flex flex-wrap justify-space-between align-center"},rc={class:"d-flex align-center"},sc={class:"text-h3"},oc={__name:"[id]",setup(s){const u=Ot(),i=Nt(),r=Et();ot(),it();const v=Me(),{t:c}=ye(),_=k(!0),h=k(null),j=k("0"),U=k(!1),C=k(!1),S=k(!1),R=k({show:!1,text:"",color:"success"}),L=ee(()=>u.params.id),z=ee(()=>r.currentProject);ee(()=>v.is_admin());const Z=k(!1),F=k(!1),O=k(!1),Q=k(!1),A=k(null),H=k(!1),N=[{title:"Markdown",value:"md",icon:"tabler-markdown"},{title:"PDF",value:"pdf",icon:"tabler-file-text"},{title:"HTML",value:"html",icon:"tabler-code"}],$=Te(),M=k(null);ee(()=>[{title:c("projects.tabs.info"),icon:"tabler-info-circle",value:"0"},{title:c("projects.tabs.requirements"),icon:"tabler-list-check",value:"1"},{title:c("projects.tabs.user_stories"),icon:"tabler-user-check",value:"2"},{title:c("projects.tabs.mockups"),icon:"tabler-photo",value:"3"},{title:c("projects.tabs.uml_diagrams"),icon:"tabler-chart-dots",value:"4"},{title:c("projects.tabs.development_plan"),icon:"tabler-chart-bar",value:"5"},{title:c("projects.tabs.exports"),icon:"tabler-file-export",value:"6"},{title:c("projects.tabs.roles"),icon:"tabler-users",value:"7"}]);const I=async()=>{z.value||(_.value=!0),h.value=null;try{const{data:E,error:y}=await r.fetchProjectById(L.value);y&&(h.value=y,D("projects.errors.loading_failed"))}catch(E){h.value=E.message||"Failed to load project details",D("projects.errors.loading_failed")}finally{_.value=!1}},D=(E,y="success")=>{R.value={show:!0,text:c(E),color:y}},V=()=>{U.value=!0},G=async(E=!1)=>{if(E){C.value=!1,S.value=!0;try{const{success:y,error:W}=await r.deleteProject(L.value);y&&!W?(D("projects.notifications.deleted"),i.push({name:"projects"})):D("projects.notifications.error")}catch{D("projects.errors.delete_failed","error")}finally{S.value=!1}}},x=async E=>{S.value=!0;try{const{data:y,error:W}=await r.updateProject(L.value,E);D(y&&!W?"projects.notifications.updated":"projects.notifications.error")}catch{D("projects.errors.update_failed","error")}finally{S.value=!1}},b=async()=>{S.value=!0;try{const{data:E,error:y}=await r.generateRequirements(L.value);E&&!y?D("projects.notifications.requirements_generation_started"):D("projects.notifications.requirements_generation_failed","error")}catch{D("projects.notifications.requirements_generation_failed","error")}finally{S.value=!1}},p=async()=>{S.value=!0;try{const{data:E,error:y}=await r.generatePlan(L.value);E&&!y?D("projects.notifications.plan_generation_started"):D("projects.notifications.plan_generation_failed","error")}catch{D("projects.notifications.plan_generation_failed","error")}finally{S.value=!1}},X=async()=>{S.value=!0;try{const{data:E,error:y}=await r.generateMockups(L.value);E&&!y?D("projects.notifications.mockups_generation_started"):D("projects.notifications.mockups_generation_failed","error")}catch{D("projects.notifications.mockups_generation_failed","error")}finally{S.value=!1}},T=E=>{A.value=E,j.value="2"},d=async()=>{Z.value=await v.hasProjectRole(L.value,["OWNER"]),F.value=await v.hasProjectRoleAtLeast(L.value,"MANAGER"),O.value=await v.hasProjectRoleAtLeast(L.value,"ADMIN"),Q.value=await v.hasProjectRoleAtLeast(L.value,"MEMBER")};return Ce(async()=>{await I(),M.value=setInterval(()=>{$.emit("project-refresh"),I()},8e3),await d()}),Ft(()=>{M.value&&(clearInterval(M.value),M.value=null)}),(E,y)=>{const W=We,ce=ke("IconBtn");return n(),g(Tt,{fluid:""},{default:t(()=>[_.value&&!a(z)?(n(),g(se,{key:0},{default:t(()=>[e(B,{cols:"12",class:"d-flex justify-center align-center",style:{"min-height":"400px"}},{default:t(()=>[e(de,{indeterminate:"",color:"primary",size:"64"})]),_:1})]),_:1})):h.value&&!a(z)?(n(),g(se,{key:1},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(xe,{color:"error",variant:"tonal",title:a(c)("projects.errors.loading_failed"),text:a(c)("projects.errors.loading_failed"),class:"mb-4"},null,8,["title","text"]),o("div",ac,[e(P,{color:"primary",onClick:I},{default:t(()=>[m(l(E.$t("projects.actions.retry")),1)]),_:1}),e(P,{color:"secondary",variant:"outlined",class:"ms-2",to:{name:"projects"}},{default:t(()=>[m(l(E.$t("projects.actions.back_to_projects")),1)]),_:1})])]),_:1})]),_:1})):a(z)?(n(),f(ae,{key:2},[e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[o("div",lc,[o("div",rc,[e(P,{icon:"",variant:"text",class:"me-3",to:{name:"projects"}},{default:t(()=>[e(q,{icon:"tabler-arrow-left"})]),_:1}),o("h3",sc,l(a(z).name),1)]),e(le),e(se,{class:"d-flex align-center mt-3 mt-sm-0"},{default:t(()=>[e(B,{cols:"6",sm:"3"},{default:t(()=>[e(P,{color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"w-100 me-2",onClick:I,loading:S.value},{default:t(()=>[m(l(E.$t("projects.actions.refresh")),1)]),_:1},8,["loading"])]),_:1}),Q.value?(n(),g(B,{key:0,cols:"6",sm:"3"},{default:t(()=>[e(Xt,{class:"w-100",modelValue:H.value,"onUpdate:modelValue":y[0]||(y[0]=J=>H.value=J),location:"top",loading:S.value},{activator:t(({props:J})=>[e(P,jt(J,{color:"secondary",variant:"outlined","prepend-icon":"tabler-file-export",class:"me-2 w-100"}),{default:t(()=>[m(l(E.$t("projects.actions.export_srs")),1)]),_:2},1040)]),default:t(()=>[e(Ge,null,{default:t(()=>[(n(),f(ae,null,ue(N,J=>e(Xe,{key:J.value,value:J.value,onClick:he=>{(async(Ie="md")=>{S.value=!0;try{const{data:Re,error:$e}=await r.exportSrs(L.value,Ie);Re&&!$e?(D("projects.notifications.srs_export_started"),j.value="6"):D("projects.notifications.srs_export_failed","error")}catch{D("projects.notifications.srs_export_failed","error")}finally{S.value=!1}})(J.value),H.value=!1}},{prepend:t(()=>[e(q,{icon:J.icon},null,8,["icon"])]),default:t(()=>[e(He,null,{default:t(()=>[m(l(J.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1},8,["modelValue","loading"])]),_:1})):w("",!0),F.value?(n(),g(B,{key:1,cols:"6",sm:"3"},{default:t(()=>[e(P,{color:"primary","prepend-icon":"tabler-edit",class:"me-2 w-100",onClick:V,loading:S.value},{default:t(()=>[m(l(E.$t("projects.actions.edit")),1)]),_:1},8,["loading"])]),_:1})):w("",!0),O.value?(n(),g(B,{key:2,cols:"6",sm:"3"},{default:t(()=>[e(P,{class:"w-100",color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:y[1]||(y[1]=J=>C.value=!0),loading:S.value},{default:t(()=>[m(l(E.$t("projects.actions.delete")),1)]),_:1},8,["loading"])]),_:1})):w("",!0)]),_:1})])]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(te,null,{default:t(()=>[e(rt,{modelValue:j.value,"onUpdate:modelValue":y[2]||(y[2]=J=>j.value=J),"bg-color":"primary",grow:"","slider-color":"white"},{default:t(()=>[e(_e,{value:"0",color:"white"},{default:t(()=>[e(q,{size:"18",icon:"tabler-info-circle",start:""}),m(" "+l(E.$t("projects.tabs.overview")),1)]),_:1}),e(_e,{value:"1",color:"white"},{default:t(()=>{var J;return[e(q,{size:"18",icon:"tabler-list",start:""}),m(" "+l(E.$t("projects.tabs.requirements"))+" ",1),(J=a(z).requirements)!=null&&J.length?(n(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>[m(l(a(z).requirements.length),1)]),_:1})):w("",!0)]}),_:1}),e(_e,{value:"2",color:"white"},{default:t(()=>{var J;return[e(q,{size:"18",icon:"tabler-user-check",start:""}),m(" "+l(E.$t("projects.tabs.user_stories"))+" ",1),(J=a(z).user_stories)!=null&&J.length?(n(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var he;return[m(l(((he=a(z).user_stories)==null?void 0:he.length)||0),1)]}),_:1})):w("",!0)]}),_:1}),e(_e,{value:"3",color:"white"},{default:t(()=>{var J;return[e(q,{size:"18",icon:"tabler-layout-kanban",start:""}),m(" "+l(E.$t("projects.tabs.mockups"))+" ",1),(J=a(z).mockups)!=null&&J.length?(n(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>[m(l(a(z).mockups.length),1)]),_:1})):w("",!0)]}),_:1}),e(_e,{value:"4",color:"white"},{default:t(()=>{var J;return[e(q,{size:"18",icon:"tabler-chart-dots",start:""}),m(" "+l(E.$t("projects.tabs.uml_diagrams"))+" ",1),(J=a(z).uml_diagrams)!=null&&J.length?(n(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var he;return[m(l(((he=a(z).uml_diagrams)==null?void 0:he.length)||0),1)]}),_:1})):w("",!0)]}),_:1}),e(_e,{value:"5",color:"white"},{default:t(()=>[e(q,{size:"18",icon:"tabler-chart-dots",start:""}),m(" "+l(E.$t("projects.tabs.development_plan")),1)]),_:1}),e(_e,{value:"6",color:"white"},{default:t(()=>{var J;return[e(q,{size:"18",icon:"tabler-file-export",start:""}),m(" "+l(E.$t("projects.tabs.exports"))+" ",1),(J=a(z).srs_exports)!=null&&J.length?(n(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:t(()=>{var he;return[m(l(((he=a(z).srs_exports)==null?void 0:he.length)||0),1)]}),_:1})):w("",!0)]}),_:1}),e(_e,{value:"7",color:"white"},{default:t(()=>[e(q,{size:"18",icon:"tabler-users",start:""}),m(" "+l(E.$t("projects.tabs.roles")),1)]),_:1})]),_:1},8,["modelValue"]),e(ie),e(st,{modelValue:j.value,"onUpdate:modelValue":y[6]||(y[6]=J=>j.value=J)},{default:t(()=>[e(ge,{value:"0"},{default:t(()=>[e(Fa,{project:a(z),loading:_.value},null,8,["project","loading"])]),_:1}),e(ge,{value:"1"},{default:t(()=>[e(me,{class:"pt-3 px-6"},{default:t(()=>[e(le),Q.value?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:b,loading:S.value},{default:t(()=>[m(l(a(c)("projects.requirements.actions.generate")),1)]),_:1},8,["loading"])):w("",!0)]),_:1}),e($r,{"project-id":a(z).id,requirements:a(z).requirements||[],"can-manage":Q.value,onSelected:y[3]||(y[3]=J=>A.value=J),onViewUserStories:T},null,8,["project-id","requirements","can-manage"])]),_:1}),e(ge,{value:"2"},{default:t(()=>{var J,he;return[e(me,{class:"pt-3 px-6"},{default:t(()=>[A.value?(n(),g(P,{key:0,color:"secondary",variant:"tonal","prepend-icon":"tabler-arrow-left",onClick:y[4]||(y[4]=Ie=>A.value=null)},{default:t(()=>[m(l(E.$t("projects.actions.back_to_all_user_stories")),1)]),_:1})):w("",!0),e(le),Q.value?(n(),g(P,{key:1,color:"primary","prepend-icon":"tabler-refresh",onClick:y[5]||(y[5]=Ie=>(async(Re=null)=>{S.value=!0;try{let $e;if(Re){const{data:Ye,error:et}=await r.generateUserStories(L.value,Re);$e={data:Ye,error:et}}else{const{data:Ye,error:et}=await r.generateUserStories(L.value);$e={data:Ye,error:et}}$e.data&&!$e.error?D("projects.notifications.user_stories_generation_started"):D("projects.notifications.user_stories_generation_failed","error")}catch{D("projects.notifications.user_stories_generation_failed","error")}finally{S.value=!1}})(A.value?A.value.id:null)),loading:S.value},{default:t(()=>[m(l(E.$t(A.value?"projects.actions.generate_user_stories_for_requirement":"projects.actions.generate_all_user_stories")),1)]),_:1},8,["loading"])):w("",!0)]),_:1}),e(sn,{"project-id":a(z).id,"requirement-id":A.value?A.value.id:null,"user-stories":A.value?((he=(J=a(z).requirements)==null?void 0:J.find(Ie=>Ie.id===A.value.id))==null?void 0:he.user_stories)||[]:a(z).user_stories||[],"can-manage":Q.value},null,8,["project-id","requirement-id","user-stories","can-manage"])]}),_:1}),e(ge,{value:"3"},{default:t(()=>[e(me,{class:"pt-3 px-6"},{default:t(()=>[e(le),Q.value?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:X,loading:S.value},{default:t(()=>[m(l(a(c)("projects.mockups.actions.generate")),1)]),_:1},8,["loading"])):w("",!0)]),_:1}),e(rs,{"project-id":a(z).id,"can-manage":Q.value,mockups:a(z).mockups||[],onRefresh:I},null,8,["project-id","can-manage","mockups"])]),_:1}),e(ge,{value:"4"},{default:t(()=>[e(Jn,{"project-id":a(z).id,diagrams:a(z).uml_diagrams||[],"can-manage":Q.value,onRefresh:I},null,8,["project-id","diagrams","can-manage"])]),_:1}),e(ge,{value:"5"},{default:t(()=>[e(me,{class:"pt-3 px-6"},{default:t(()=>[e(le),Q.value?(n(),g(P,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:p,loading:S.value},{default:t(()=>[m(l(E.$t("projects.development_plan.actions.generate")),1)]),_:1},8,["loading"])):w("",!0)]),_:1}),e(ko,{"project-id":a(z).id,"development-plan":a(z).development_plan,"can-manage":Q.value,onRefresh:I},null,8,["project-id","development-plan","can-manage"])]),_:1}),e(ge,{value:"6"},{default:t(()=>[e(Zn,{"project-id":a(z).id,exports:a(z).srs_exports||[],onRefresh:I},null,8,["project-id","exports"])]),_:1}),e(ge,{value:"7"},{default:t(()=>[e(tc,{"project-id":a(z).id,onUpdated:d,onRefresh:I},null,8,["project-id"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):w("",!0),a(z)?(n(),g(Wt,{key:3,modelValue:U.value,"onUpdate:modelValue":y[7]||(y[7]=J=>U.value=J),"edit-mode":"","project-data":a(z),onSubmit:x},null,8,["modelValue","project-data"])):w("",!0),e(W,{isDialogVisible:C.value,"onUpdate:isDialogVisible":y[8]||(y[8]=J=>C.value=J),confirmationMsg:a(c)("projects.delete_confirm.message"),onConfirm:G},null,8,["isDialogVisible","confirmationMsg"]),e(Ve,{modelValue:R.value.show,"onUpdate:modelValue":y[10]||(y[10]=J=>R.value.show=J),color:R.value.color,timeout:5e3},{actions:t(()=>[e(ce,{onClick:y[9]||(y[9]=J=>R.value.show=!1)},{default:t(()=>[e(q,{icon:"tabler-x"})]),_:1})]),default:t(()=>[m(l(R.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}};typeof ut=="function"&&ut(oc);export{oc as default};
