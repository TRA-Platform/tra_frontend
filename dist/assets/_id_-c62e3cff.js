import{L as Ge,N as Je,b5 as ca,R as ta,S as ma,W as pa,b6 as va,a9 as Ke,p as e,G as Ie,a8 as za,Z as Pe,E as H,ac as ha,Q as fa,b7 as ya,O as ga,b8 as Fa,Y as ua,a1 as Ma,$ as Ia,ap as b,b9 as Pa,ba as Aa,bb as La,k as D,I as De,o,b as g,y as a,aI as W,aY as X,C as I,m as r,A as n,b2 as oe,D as i,aV as Le,bc as Y,aD as _e,aJ as ne,aL as je,q as c,b1 as Re,aK as le,c as p,aj as S,F as Q,a as re,at as Ae,aG as be,aH as xe,r as pe,aZ as ke,aX as ye,ar as ze,w as Me,ah as Se,s as la,bd as _a,H as ra,aa as ba,b4 as xa,b0 as Ra,t as Ba}from"./index-5789d73a.js";import{V as fe}from"./VDialog-27dc4e16.js";import{a as he,u as Ta,_ as Na,V as $a}from"./ProjectCreateDialog-2e212306.js";import{V as te,a as R}from"./VRow-7265fa83.js";import{V as K}from"./VChip-7deee89e.js";import{V as ee}from"./VDivider-82a28f18.js";import{a as aa,g as ve,b as ka}from"./formatters-981de7af.js";import{V as Z}from"./VSpacer-a6336499.js";import{b as sa,c as ce,V as Xe,a as wa}from"./VTabs-c08b9201.js";import{V as oa,a as me}from"./VSlideGroup-d7cb865e.js";import{V as Fe}from"./VForm-73098b32.js";import{b as se}from"./VTextField-196356ff.js";import{V as ie}from"./VSelect-a845b0d4.js";import{V as $e,a as Ee,b as Oe}from"./VList-67fea634.js";import{V as Ea}from"./VTooltip-40d710d2.js";import{b as da}from"./route-block-83d24a4e.js";import{V as Oa}from"./VMenu-0b8d2dd4.js";import"./index-6cdb1ca7.js";import"./VCheckboxBtn-09426770.js";import"./ssrBoot-afa16e16.js";const He=Ge()({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...Je(),...ca(),...ta(),...ma()},setup(t,s){let{slots:l}=s;const{themeClasses:v}=pa(t),{densityClasses:_}=va(t);return Ke(()=>e(t.tag,{class:["v-table",{"v-table--fixed-height":!!t.height,"v-table--fixed-header":t.fixedHeader,"v-table--fixed-footer":t.fixedFooter,"v-table--has-top":!!l.top,"v-table--has-bottom":!!l.bottom,"v-table--hover":t.hover},v.value,_.value,t.class],style:t.style},{default:()=>{var h,m,d;return[(h=l.top)==null?void 0:h.call(l),l.default?e("div",{class:"v-table__wrapper",style:{height:Ie(t.height)}},[e("table",null,[l.default()])]):(m=l.wrapper)==null?void 0:m.call(l),(d=l.bottom)==null?void 0:d.call(l)]}})),{}}}),Va=Ge()({name:"VTimeline",props:{align:{type:String,default:"center",validator:t=>["center","start"].includes(t)},direction:{type:String,default:"vertical",validator:t=>["vertical","horizontal"].includes(t)},justify:{type:String,default:"auto",validator:t=>["auto","center"].includes(t)},side:{type:String,validator:t=>t==null||["start","end"].includes(t)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:t=>["start","end","both"].includes(t)},...Je(),...ca(),...ta(),...ma()},setup(t,s){let{slots:l}=s;const{themeClasses:v}=pa(t),{densityClasses:_}=va(t);za({VTimelineDivider:{lineColor:Pe(t,"lineColor")},VTimelineItem:{density:Pe(t,"density"),lineInset:Pe(t,"lineInset")}});const h=H(()=>{const d=t.side?t.side:t.density!=="default"?"end":null;return d&&`v-timeline--side-${d}`}),m=H(()=>{const d=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(t.truncateLine){case"both":return d;case"start":return d[0];case"end":return d[1];default:return null}});return Ke(()=>e(t.tag,{class:["v-timeline",`v-timeline--${t.direction}`,`v-timeline--align-${t.align}`,`v-timeline--justify-${t.justify}`,m.value,{"v-timeline--inset-line":!!t.lineInset},v.value,_.value,h.value,t.class],style:[{"--v-timeline-line-thickness":Ie(t.lineThickness)},t.style]},l)),{}}}),Ha=Ge()({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:ha,iconColor:String,lineColor:String,...Je(),...fa(),...ya(),...ga()},setup(t,s){let{slots:l}=s;const{sizeClasses:v,sizeStyles:_}=Fa(t,"v-timeline-divider__dot"),{backgroundColorStyles:h,backgroundColorClasses:m}=ua(Pe(t,"dotColor")),{roundedClasses:d}=Ma(t,"v-timeline-divider__dot"),{elevationClasses:V}=Ia(t),{backgroundColorClasses:M,backgroundColorStyles:$}=ua(Pe(t,"lineColor"));return Ke(()=>e("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":t.fillDot},t.class],style:t.style},[e("div",{class:["v-timeline-divider__before",M.value],style:$.value},null),!t.hideDot&&e("div",{key:"dot",class:["v-timeline-divider__dot",V.value,d.value,v.value],style:_.value},[e("div",{class:["v-timeline-divider__inner-dot",m.value,d.value],style:h.value},[l.default?e(Pa,{key:"icon-defaults",disabled:!t.icon,defaults:{VIcon:{color:t.iconColor,icon:t.icon,size:t.size}}},l.default):e(b,{key:"icon",color:t.iconColor,icon:t.icon,size:t.size},null)])]),e("div",{class:["v-timeline-divider__after",M.value],style:$.value},null)])),{}}}),Ca=Ge()({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:ha,iconColor:String,lineInset:[Number,String],...Je(),...Aa(),...ga(),...fa(),...ya(),...ta()},setup(t,s){let{slots:l}=s;const{dimensionStyles:v}=La(t),_=D(0),h=D();return De(h,m=>{var d;m&&(_.value=((d=m.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:d.getBoundingClientRect().width)??0)},{flush:"post"}),Ke(()=>{var m,d;return e("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":t.fillDot},t.class],style:[{"--v-timeline-dot-size":Ie(_.value),"--v-timeline-line-inset":t.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${Ie(t.lineInset)})`:Ie(0)},t.style]},[e("div",{class:"v-timeline-item__body",style:v.value},[(m=l.default)==null?void 0:m.call(l)]),e(Ha,{ref:h,hideDot:t.hideDot,icon:t.icon,iconColor:t.iconColor,size:t.size,elevation:t.elevation,dotColor:t.dotColor,fillDot:t.fillDot,rounded:t.rounded},{default:l.icon}),t.density!=="compact"&&e("div",{class:"v-timeline-item__opposite"},[!t.hideOpposite&&((d=l.opposite)==null?void 0:d.call(l))])])}),{}}}),Ga=r("span",{class:"text-5xl"},"!",-1),Ja={class:"text-lg font-weight-medium"},Be={__name:"ConfirmDialog",props:{confirmationMsg:{type:String,required:!0},isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","confirm"],setup(t,{emit:s}){const l=t,v=m=>{s("update:isDialogVisible",m)},_=()=>{s("confirm",!0),v(!1)},h=()=>{s("confirm",!1),s("update:isDialogVisible",!1)};return(m,d)=>(o(),g(fe,{"max-width":"500","model-value":l.isDialogVisible,"onUpdate:modelValue":v},{default:a(()=>[e(W,{class:"text-center px-10 py-6"},{default:a(()=>[e(X,null,{default:a(()=>[e(I,{icon:"",variant:"outlined",color:"warning",class:"mb-4",style:{width:"88px",height:"88px","pointer-events":"none"}},{default:a(()=>[Ga]),_:1}),r("h6",Ja,n(l.confirmationMsg),1)]),_:1}),e(oe,{class:"align-center justify-center gap-2"},{default:a(()=>[e(I,{variant:"elevated",onClick:_},{default:a(()=>[i(" Confirm ")]),_:1}),e(I,{color:"secondary",variant:"tonal",onClick:h},{default:a(()=>[i(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},ia=Le({id:"UserStoryStore",state:()=>({userStories:[],currentUserStory:null,loading:!1,error:null}),actions:{async fetchUserStories(t=null){this.loading=!0;try{let s="/service/user-stories/";t&&(s+=`?requirement=${t}`);const l=await Y.get(s);return l.status===200?(this.userStories=l.data,{data:l.data,error:null}):{data:[],error:l.data}}catch(s){return this.error=s.message||"Failed to fetch user stories",{data:[],error:this.error}}finally{this.loading=!1}},async fetchUserStoryById(t){this.loading=!0;try{const s=await Y.get(`/service/user-stories/${t}/`);return s.status===200?(this.currentUserStory=s.data,{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to fetch user story",{data:null,error:this.error}}finally{this.loading=!1}},async createUserStory(t){this.loading=!0;try{const s=await Y.post("/service/user-stories/",t);return s.status===201?(this.userStories.length&&this.userStories.push(s.data),{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to create user story",{data:null,error:this.error}}finally{this.loading=!1}},async updateUserStory(t,s){this.loading=!0;try{const l=await Y.put(`/service/user-stories/${t}/`,s);if(l.status===200){if(this.userStories.length){const v=this.userStories.findIndex(_=>_.id===t);v!==-1&&(this.userStories[v]=l.data)}return this.currentUserStory&&this.currentUserStory.id===t&&(this.currentUserStory=l.data),{data:l.data,error:null}}return{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to update user story",{data:null,error:this.error}}finally{this.loading=!1}},async deleteUserStory(t){this.loading=!0;try{const s=await Y.delete(`/service/user-stories/${t}/`);return s.status===204?(this.userStories.length&&(this.userStories=this.userStories.filter(l=>l.id!==t)),this.currentUserStory&&this.currentUserStory.id===t&&(this.currentUserStory=null),{success:!0,error:null}):{success:!1,error:s.data}}catch(s){return this.error=s.message||"Failed to delete user story",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateUserStory(t,s=""){this.loading=!0;try{const l=await Y.post(`/service/user-stories/${t}/regenerate/`,{feedback:s});return l.status===202?{data:l.data,error:null}:{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to regenerate user story",{data:null,error:this.error}}finally{this.loading=!1}},async createComment(t,s){this.loading=!0;try{const l=await Y.post("/service/user-story-comments/",{user_story:t,text:s.text,status:s.status||"active"});return l.status===201?{data:l.data,error:null}:{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(t){this.loading=!0;try{const s=await Y.delete(`/service/user-story-comments/${t}/`);return s.status===204?{success:!0,error:null}:{success:!1,error:s.data}}catch(s){return this.error=s.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),na=Le({id:"UmlDiagramStore",state:()=>({diagrams:[],currentDiagram:null,loading:!1,error:null}),actions:{async fetchDiagrams(t=null,s=null){this.loading=!0;try{let l="/service/uml-diagrams/";const v={};t&&(v.project=t),s&&(v.diagram_type=s);const _=await Y.get(l,{params:v});return _.status===200?(this.diagrams=_.data,{data:_.data,error:null}):{data:[],error:_.data}}catch(l){return this.error=l.message||"Failed to fetch UML diagrams",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDiagramById(t){this.loading=!0;try{const s=await Y.get(`/service/uml-diagrams/${t}/`);return s.status===200?(this.currentDiagram=s.data,{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to fetch UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async createDiagram(t){this.loading=!0;try{const s=await Y.post("/service/uml-diagrams/",t);return s.status===201?(this.diagrams.length&&this.diagrams.push(s.data),{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to create UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async updateDiagram(t,s){this.loading=!0;try{const l=await Y.put(`/service/uml-diagrams/${t}/`,s);if(l.status===200){if(this.diagrams.length){const v=this.diagrams.findIndex(_=>_.id===t);v!==-1&&(this.diagrams[v]=l.data)}return this.currentDiagram&&this.currentDiagram.id===t&&(this.currentDiagram=l.data),{data:l.data,error:null}}return{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to update UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async deleteDiagram(t){this.loading=!0;try{const s=await Y.delete(`/service/uml-diagrams/${t}/`);return s.status===204?(this.diagrams.length&&(this.diagrams=this.diagrams.filter(l=>l.id!==t)),this.currentDiagram&&this.currentDiagram.id===t&&(this.currentDiagram=null),{success:!0,error:null}):{success:!1,error:s.data}}catch(s){return this.error=s.message||"Failed to delete UML diagram",{success:!1,error:this.error}}finally{this.loading=!1}},async regenerateDiagram(t){this.loading=!0;try{const s=await Y.post(`/service/uml-diagrams/${t}/regenerate/`);return s.status===202?{data:s.data,error:null}:{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to regenerate UML diagram",{data:null,error:this.error}}finally{this.loading=!1}},async generateDiagrams(t,s="class"){this.loading=!0;try{const l=await Y.post(`/service/projects/${t}/generate_uml_diagrams/`,{diagram_type:s});return l.status===202?{data:l.data,error:null}:{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to generate UML diagrams",{data:null,error:this.error}}finally{this.loading=!1}}}}),we=t=>(be("data-v-3f565aa3"),t=t(),xe(),t),Ka={class:"d-flex flex-column gap-4"},Xa={class:"d-flex flex-column gap-2"},Ya={class:"d-flex align-center"},Qa=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Created:",-1)),Za={class:"d-flex align-center"},Wa=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Last Updated:",-1)),et={class:"d-flex align-center"},at=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Type:",-1)),tt={class:"d-flex align-center"},lt=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Language:",-1)),rt={key:0,class:"d-flex align-center"},st=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Deadline:",-1)),ot={key:1,class:"d-flex align-center"},it=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Budget:",-1)),nt={key:2,class:"d-flex align-center"},ut=we(()=>r("span",{class:"text-medium-emphasis font-weight-medium me-3",style:{"min-width":"120px"}},"Color Scheme:",-1)),dt={class:"d-flex align-center"},ct={class:"ms-2"},mt={class:"whitespace-pre-wrap"},pt={class:"d-flex flex-column gap-4"},vt={key:0},ht=we(()=>r("h6",{class:"text-subtitle-1 font-weight-bold mb-2"},"Technology Stack",-1)),ft={class:"whitespace-pre-wrap"},yt={key:1},gt=we(()=>r("h6",{class:"text-subtitle-1 font-weight-bold mb-2"},"Operating System",-1)),_t={class:"d-flex flex-column gap-4"},bt={class:"whitespace-pre-wrap mb-4"},xt={key:0,class:"whitespace-pre-wrap"},kt=we(()=>r("h6",{class:"text-subtitle-1 font-weight-bold mb-2"},"Detailed Description",-1)),wt={class:"whitespace-pre-wrap"},Vt={class:"whitespace-pre-wrap"},Ct={class:"whitespace-pre-wrap"},St={__name:"ProjectDetailsInfo",props:{project:{type:Object,required:!0},loading:{type:Boolean,default:!1}},setup(t){const s=t,l=m=>m?new Date(parseInt(m)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",v=H(()=>{switch(s.project.status){case"draft":return"warning";case"active":return"success";case"archived":return"secondary";case"completed":return"info";default:return"primary"}}),_=H(()=>{switch(s.project.type_of_application){case"website":return"tabler-world-www";case"mobile":return"tabler-device-mobile";case"desktop":return"tabler-device-desktop";case"api":return"tabler-api";default:return"tabler-code"}}),h={en:"English",ru:"Russian",de:"German"};return(m,d)=>(o(),g(X,{class:"pa-6"},{default:a(()=>[e(te,null,{default:a(()=>[e(R,{cols:"12",md:"6"},{default:a(()=>[r("div",Ka,[e(W,{border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(je,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:a(()=>[e(b,{icon:c(_)},null,8,["icon"])]),_:1})]),append:a(()=>[e(K,{size:"small",color:c(v),label:""},{default:a(()=>[i(n(Re(t.project.status)),1)]),_:1},8,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i("Project Overview")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",Xa,[r("div",Ya,[Qa,r("span",null,n(l(t.project.created_at)),1)]),r("div",Za,[Wa,r("span",null,n(l(t.project.updated_at)),1)]),r("div",et,[at,e(K,{size:"small"},{default:a(()=>[i(n(t.project.type_of_application),1)]),_:1})]),r("div",tt,[lt,e(K,{size:"small"},{default:a(()=>{return[i(n((V=t.project.language,h[V]||V)),1)];var V}),_:1})]),t.project.deadline?(o(),p("div",rt,[st,r("span",null,n(l(t.project.deadline)),1)])):S("",!0),t.project.preliminary_budget?(o(),p("div",ot,[it,r("span",null,"$"+n(t.project.preliminary_budget),1)])):S("",!0),t.project.color_scheme?(o(),p("div",nt,[ut,r("div",dt,[(o(!0),p(Q,null,re(t.project.color_scheme.split(","),(V,M)=>(o(),p("div",{key:M,class:"color-swatch rounded me-1",style:Ae({backgroundColor:V.trim()}),title:"color"},null,4))),128)),r("span",ct,n(t.project.color_scheme),1)])])):S("",!0)])]),_:1})]),_:1}),t.project.additional_requirements?(o(),g(W,{key:0,border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(b,{color:"primary",icon:"tabler-list-details"})]),default:a(()=>[e(le,null,{default:a(()=>[i("Additional Requirements")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",mt,n(t.project.additional_requirements),1)]),_:1})]),_:1})):S("",!0),t.project.technology_stack||t.project.operating_system?(o(),g(W,{key:1,border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(b,{color:"primary",icon:"tabler-device-laptop-code"})]),default:a(()=>[e(le,null,{default:a(()=>[i("Technical Details")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",pt,[t.project.technology_stack?(o(),p("div",vt,[ht,r("div",ft,n(t.project.technology_stack),1)])):S("",!0),t.project.operating_system?(o(),p("div",yt,[gt,r("div",null,n(t.project.operating_system),1)])):S("",!0)])]),_:1})]),_:1})):S("",!0)])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[r("div",_t,[e(W,{border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(b,{color:"primary",icon:"tabler-file-description"})]),default:a(()=>[e(le,null,{default:a(()=>[i("Description")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",bt,n(t.project.short_description),1),t.project.application_description?(o(),p("div",xt,[kt,r("div",null,n(t.project.application_description),1)])):S("",!0)]),_:1})]),_:1}),t.project.target_users?(o(),g(W,{key:0,border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(b,{color:"primary",icon:"tabler-users"})]),default:a(()=>[e(le,null,{default:a(()=>[i("Target Users")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",wt,n(t.project.target_users),1)]),_:1})]),_:1})):S("",!0),t.project.non_functional_requirements?(o(),g(W,{key:1,border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(b,{color:"primary",icon:"tabler-chart-bubble"})]),default:a(()=>[e(le,null,{default:a(()=>[i("Non-Functional Requirements")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",Vt,n(t.project.non_functional_requirements),1)]),_:1})]),_:1})):S("",!0),t.project.priority_modules?(o(),g(W,{key:2,border:"",class:"project-info-card"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(b,{color:"primary",icon:"tabler-star"})]),default:a(()=>[e(le,null,{default:a(()=>[i("Priority Modules/Features")]),_:1})]),_:1}),e(ee),e(X,null,{default:a(()=>[r("div",Ct,n(t.project.priority_modules),1)]),_:1})]),_:1})):S("",!0)])]),_:1})]),_:1})]),_:1}))}},Dt=_e(St,[["__scopeId","data-v-3f565aa3"]]),Sa=Le({id:"RequirementStore",state:()=>({requirements:[],currentRequirement:null,loading:!1,error:null}),actions:{async fetchRequirements(t=null){this.loading=!0;try{let s="/service/requirements/";t&&(s+=`?project=${t}`);const l=await Y.get(s);return l.status===200?(this.requirements=l.data,{data:l.data,error:null}):{data:[],error:l.data}}catch(s){return this.error=s.message||"Failed to fetch requirements",{data:[],error:this.error}}finally{this.loading=!1}},async fetchRequirementById(t){this.loading=!0;try{const s=await Y.get(`/service/requirements/${t}/`);return s.status===200?(this.currentRequirement=s.data,{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to fetch requirement",{data:null,error:this.error}}finally{this.loading=!1}},async createRequirement(t){this.loading=!0;try{const s=await Y.post("/service/requirements/",t);return s.status===201?(this.requirements.length&&this.requirements.push(s.data),{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to create requirement",{data:null,error:this.error}}finally{this.loading=!1}},async updateRequirement(t,s){this.loading=!0;try{const l=await Y.put(`/service/requirements/${t}/`,s);if(l.status===200){if(this.requirements.length){const v=this.requirements.findIndex(_=>_.id===t);v!==-1&&(this.requirements[v]=l.data)}return this.currentRequirement&&this.currentRequirement.id===t&&(this.currentRequirement=l.data),{data:l.data,error:null}}return{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to update requirement",{data:null,error:this.error}}finally{this.loading=!1}},async deleteRequirement(t){this.loading=!0;try{const s=await Y.delete(`/service/requirements/${t}/`);return s.status===204?(this.requirements.length&&(this.requirements=this.requirements.filter(l=>l.id!==t)),this.currentRequirement&&this.currentRequirement.id===t&&(this.currentRequirement=null),{success:!0,error:null}):{success:!1,error:s.data}}catch(s){return this.error=s.message||"Failed to delete requirement",{success:!1,error:this.error}}finally{this.loading=!1}},async createComment(t,s){this.loading=!0;try{const l=await Y.post("/service/requirement-comments/",{requirement:t,text:s.text,status:s.status||"active",responsible_user:s.responsibleUser||null});return l.status===201?{data:l.data,error:null}:{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to create comment",{data:null,error:this.error}}finally{this.loading=!1}},async deleteComment(t){this.loading=!0;try{const s=await Y.delete(`/service/requirement-comments/${t}/`);return s.status===204?{success:!0,error:null}:{success:!1,error:s.data}}catch(s){return this.error=s.message||"Failed to delete comment",{success:!1,error:this.error}}finally{this.loading=!1}}}}),Ve=t=>(be("data-v-352863e5"),t=t(),xe(),t),Ut={key:0,class:"text-h5"},qt={key:1,class:"text-h5"},jt={key:0},zt={key:1},Ft={class:"d-flex align-center mb-5"},Mt={class:"text-medium-emphasis d-flex align-center"},It={class:"text-caption me-4"},Pt={class:"text-caption"},At={class:"text-h4 mb-4"},Lt={class:"text-body-1 whitespace-pre-wrap"},Rt={key:0,class:"text-center pa-6"},Bt=Ve(()=>r("h4",{class:"text-h6 mb-2"},"No User Stories Available",-1)),Tt=Ve(()=>r("p",{class:"text-medium-emphasis mb-4"}," This requirement doesn't have any user stories yet. ",-1)),Nt={key:1},$t={class:"d-flex justify-space-between align-center mb-4"},Et=Ve(()=>r("h5",{class:"text-h5"},"User Stories",-1)),Ot={class:"mb-2"},Ht=Ve(()=>r("strong",null,"I want to:",-1)),Gt=Ve(()=>r("strong",null,"So that:",-1)),Jt={key:0,class:"mt-3"},Kt=Ve(()=>r("div",{class:"text-subtitle-2"},"Acceptance Criteria:",-1)),Xt={class:"pl-4"},Yt={key:0},Qt={key:0,class:"text-center mt-4"},Zt={key:0,class:"text-center pa-6"},Wt=Ve(()=>r("h4",{class:"text-h6 mb-2"},"No History Available",-1)),el=Ve(()=>r("p",{class:"text-medium-emphasis"}," This requirement hasn't been modified since its creation. ",-1)),al={key:1},tl={class:"text-caption"},ll={class:"text-caption text-medium-emphasis"},rl={class:"d-flex align-center mb-2"},sl={class:"text-caption"},ol={class:"text-body-2 whitespace-pre-wrap"},il={class:"d-flex justify-end mt-2"},nl={key:1,class:"text-center pa-6"},ul=Ve(()=>r("h4",{class:"text-h6 mb-2"},"No Comments Yet",-1)),dl=Ve(()=>r("p",{class:"text-medium-emphasis"}," Be the first to comment on this requirement. ",-1)),cl={key:2},ml={class:"d-flex align-center"},pl={class:"d-flex align-center"},vl={class:"text-caption text-medium-emphasis ml-2"},hl={class:"comment-text mt-2 whitespace-pre-wrap"},fl={__name:"RequirementDetailsDialog",props:{modelValue:{type:Boolean,default:!1},requirement:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","view-user-stories"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:B=>s("update:modelValue",B)}),_=Sa(),h=D(0),m=D(!1),d=D({...l.requirement}),V=D(""),M=D(!1),$=D({show:!1,text:"",color:"success"}),C=[{title:"Functional",value:"functional"},{title:"Non-Functional",value:"nonfunctional"},{title:"UI/UX",value:"uiux"},{title:"Other",value:"other"}],z=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],P=[{title:"Feature",value:"feature"},{title:"Constraint",value:"constraint"},{title:"Quality",value:"quality"},{title:"Interface",value:"interface"},{title:"Security",value:"security"},{title:"Performance",value:"performance"},{title:"Other",value:"other"}],U=H(()=>l.requirement.history||[]),j=H(()=>l.requirement.comments||[]),x=H(()=>l.requirement.user_stories||[]),F=B=>B?(B=parseInt(B),new Date(B).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",k=()=>{m.value&&(d.value={...l.requirement}),m.value=!m.value},A=()=>{s("update",d.value),m.value=!1},G=()=>{s("delete")},O=()=>{s("view-user-stories",l.requirement),v.value=!1},T=async()=>{if(V.value.trim()){M.value=!0;try{const{data:B,error:f}=await _.createComment(l.requirement.id,{text:V.value,status:"active"});if(B&&!f){E("Comment added successfully"),V.value="";const{data:w}=await _.fetchRequirementById(l.requirement.id);w&&Object.assign(l.requirement,w)}else E("Failed to add comment","error")}catch(B){E("Failed to add comment: "+B.message,"error")}finally{M.value=!1}}},E=(B,f="success")=>{$.value={show:!0,text:B,color:f}};return De(()=>l.requirement,B=>{d.value={...B}},{deep:!0}),(B,f)=>{const w=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":f[11]||(f[11]=u=>ze(v)?v.value=u:null),"max-width":"900",scrollable:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex pt-5 px-5"},{default:a(()=>[m.value?(o(),p("h5",Ut,"Edit Requirement")):(o(),p("h5",qt,"Requirement Details")),e(Z),e(w,{onClick:f[0]||(f[0]=u=>v.value=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(X,{class:"pb-0"},{default:a(()=>[e(sa,{modelValue:h.value,"onUpdate:modelValue":f[1]||(f[1]=u=>h.value=u),"slider-color":"primary","align-tabs":"start"},{default:a(()=>[e(ce,{value:"0"},{default:a(()=>[e(b,{size:"18",icon:"tabler-info-circle",start:""}),i(" Details ")]),_:1}),e(ce,{value:"1"},{default:a(()=>[e(b,{size:"18",icon:"tabler-user-check",start:""}),i(" User Stories "),c(x).length?(o(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:a(()=>[i(n(c(x).length),1)]),_:1})):S("",!0)]),_:1}),e(ce,{value:"2"},{default:a(()=>[e(b,{size:"18",icon:"tabler-history",start:""}),i(" History "),c(U).length?(o(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:a(()=>[i(n(c(U).length),1)]),_:1})):S("",!0)]),_:1}),e(ce,{value:"3"},{default:a(()=>[e(b,{size:"18",icon:"tabler-messages",start:""}),i(" Comments "),c(j).length?(o(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:a(()=>[i(n(c(j).length),1)]),_:1})):S("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(X,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:a(()=>[e(oa,{modelValue:h.value,"onUpdate:modelValue":f[8]||(f[8]=u=>h.value=u),class:"mt-5"},{default:a(()=>[e(me,{value:"0"},{default:a(()=>[m.value?(o(),p("div",jt,[e(Fe,{onSubmit:ke(A,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:d.value.title,"onUpdate:modelValue":f[2]||(f[2]=u=>d.value.title=u),label:"Title",required:"",rules:[u=>!!u||"Title is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12",md:"4"},{default:a(()=>[e(ie,{modelValue:d.value.category,"onUpdate:modelValue":f[3]||(f[3]=u=>d.value.category=u),label:"Category",items:C,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"4"},{default:a(()=>[e(ie,{modelValue:d.value.requirement_type,"onUpdate:modelValue":f[4]||(f[4]=u=>d.value.requirement_type=u),label:"Requirement Type",items:P,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"4"},{default:a(()=>[e(ie,{modelValue:d.value.status,"onUpdate:modelValue":f[5]||(f[5]=u=>d.value.status=u),label:"Status",items:z,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:d.value.description,"onUpdate:modelValue":f[6]||(f[6]=u=>d.value.description=u),label:"Description",required:"",rows:"8",rules:[u=>!!u||"Description is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(o(),p("div",zt,[r("div",Ft,[e(K,{color:c(aa)(t.requirement.category),size:"small",label:"",class:"me-2"},{default:a(()=>[i(n(t.requirement.category),1)]),_:1},8,["color"]),e(K,{color:c(ve)(t.requirement.status),size:"small",label:""},{default:a(()=>{return[i(n((u=t.requirement.status,u?u.charAt(0).toUpperCase()+u.slice(1):"")),1)];var u}),_:1},8,["color"]),e(K,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:a(()=>[i(" v"+n(t.requirement.version_number),1)]),_:1}),t.requirement.requirement_type?(o(),g(K,{key:0,color:"info",size:"small",label:"",class:"ms-2"},{default:a(()=>[i(n(t.requirement.requirement_type),1)]),_:1})):S("",!0),e(Z),r("div",Mt,[e(b,{size:"18",icon:"tabler-calendar",class:"me-1"}),r("span",It,"Updated: "+n(F(t.requirement.updated_at)),1),e(b,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),r("span",Pt,"Created: "+n(F(t.requirement.created_at)),1)])]),r("h4",At,n(t.requirement.title),1),r("div",Lt,n(t.requirement.description),1)]))]),_:1}),e(me,{value:"1"},{default:a(()=>[c(x).length===0?(o(),p("div",Rt,[e(b,{icon:"tabler-user-check",size:"64",color:"secondary",class:"mb-3"}),Bt,Tt,e(I,{color:"primary",onClick:O},{default:a(()=>[i(" Generate User Stories ")]),_:1})])):(o(),p("div",Nt,[r("div",$t,[Et,e(I,{color:"primary",variant:"tonal",onClick:O},{default:a(()=>[i(" View All User Stories ")]),_:1})]),(o(!0),p(Q,null,re(c(x).slice(0,3),(u,q)=>(o(),g(W,{key:u.id,class:"mb-4",border:""},{default:a(()=>[e(ne,null,{append:a(()=>[e(K,{color:c(ve)(u.status),size:"small",label:""},{default:a(()=>[i(n(u.status),1)]),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i("As a "+n(u.role),1)]),_:2},1024)]),_:2},1024),e(X,null,{default:a(()=>[r("p",Ot,[Ht,i(" "+n(u.action),1)]),r("p",null,[Gt,i(" "+n(u.benefit),1)]),u.acceptance_criteria&&u.acceptance_criteria.length>0?(o(),p("div",Jt,[Kt,r("ul",Xt,[(o(!0),p(Q,null,re(u.acceptance_criteria.slice(0,2),(y,ae)=>(o(),p("li",{key:ae},n(y),1))),128)),u.acceptance_criteria.length>2?(o(),p("li",Yt," ...and "+n(u.acceptance_criteria.length-2)+" more ",1)):S("",!0)])])):S("",!0)]),_:2},1024)]),_:2},1024))),128)),c(x).length>3?(o(),p("div",Qt,[e(I,{color:"primary",variant:"tonal",onClick:O},{default:a(()=>[i(" View All "+n(c(x).length)+" User Stories ",1)]),_:1})])):S("",!0)]))]),_:1}),e(me,{value:"2"},{default:a(()=>[c(U).length===0?(o(),p("div",Zt,[e(b,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),Wt,el])):(o(),p("div",al,[e(Va,{density:"compact",align:"start"},{default:a(()=>[(o(!0),p(Q,null,re(c(U),(u,q)=>(o(),g(Ca,{key:q,"dot-color":"primary",size:"small"},{opposite:a(()=>[r("div",tl,n(F(u.changed_at)),1),r("div",ll,"v"+n(u.version_number),1)]),default:a(()=>[e(W,{border:""},{default:a(()=>[e(ne,null,{append:a(()=>[e(K,{color:c(ve)(u.status),size:"small",label:"",class:"ms-2"},{default:a(()=>[i(n(u.status),1)]),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i(n(u.title),1)]),_:2},1024)]),_:2},1024),e(X,null,{default:a(()=>[r("div",rl,[e(K,{color:c(aa)(u.category),size:"small",label:"",class:"me-2"},{default:a(()=>[i(n(u.category),1)]),_:2},1032,["color"]),r("span",sl," Changed by: "+n(u.changed_by?u.changed_by.username:"Unknown"),1)]),r("div",ol,n(u.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(me,{value:"3"},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:V.value,"onUpdate:modelValue":f[7]||(f[7]=u=>V.value=u),label:"Add a comment",rows:"3",counter:"",disabled:M.value},null,8,["modelValue","disabled"]),r("div",il,[e(I,{color:"primary",size:"small",loading:M.value,disabled:!V.value.trim(),onClick:T},{default:a(()=>[i(" Add Comment ")]),_:1},8,["loading","disabled"])])]),_:1}),e(R,{cols:"12"},{default:a(()=>[c(j).length?(o(),g(ee,{key:0,class:"mb-4"})):S("",!0),c(j).length===0?(o(),p("div",nl,[e(b,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),ul,dl])):(o(),p("div",cl,[(o(!0),p(Q,null,re(c(j),u=>(o(),p("div",{key:u.id,class:"comment-item mb-4"},[e(W,{border:""},{default:a(()=>[e(X,{class:"py-2"},{default:a(()=>[r("div",ml,[e(je,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:a(()=>[e(b,{icon:"tabler-user"})]),_:1}),r("div",null,[r("div",pl,[r("strong",null,n(u.user?u.user.username:"Unknown User"),1),r("div",vl,n(F(u.created_at)),1)])]),e(Z),t.isAdmin||t.hasManagerPermission?(o(),g(w,{key:0,size:"small",color:"error",variant:"text",onClick:q=>(async y=>{M.value=!0;try{const{success:ae,error:L}=await _.deleteComment(y);if(ae&&!L){E("Comment deleted successfully");const{data:N}=await _.fetchRequirementById(l.requirement.id);N&&Object.assign(l.requirement,N)}else E("Failed to delete comment","error")}catch(ae){E("Failed to delete comment: "+ae.message,"error")}finally{M.value=!1}})(u.id),disabled:M.value},{default:a(()=>[e(b,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):S("",!0)]),r("div",hl,n(u.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[m.value?(o(),p(Q,{key:0},[e(I,{color:"secondary",variant:"tonal",onClick:k},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:A},{default:a(()=>[i(" Save Changes ")]),_:1})],64)):(o(),p(Q,{key:1},[t.isAdmin?(o(),g(I,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:G},{default:a(()=>[i(" Delete ")]),_:1})):S("",!0),t.hasModeratorPermission&&c(x).length===0?(o(),g(I,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-user-check",class:"ms-2",onClick:O},{default:a(()=>[i(" Generate User Stories ")]),_:1})):S("",!0),e(Z),t.hasModeratorPermission?(o(),g(I,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:k},{default:a(()=>[i(" Edit ")]),_:1})):S("",!0)],64))]),_:1})]),_:1}),e(ye,{modelValue:$.value.show,"onUpdate:modelValue":f[10]||(f[10]=u=>$.value.show=u),color:$.value.color,timeout:5e3},{actions:a(()=>[e(w,{onClick:f[9]||(f[9]=u=>$.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n($.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},yl=_e(fl,[["__scopeId","data-v-352863e5"]]),gl={class:"text-h5"},_l={__name:"RequirementCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},requirementData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:P=>s("update:modelValue",P)}),_=D({title:l.editMode&&l.requirementData?l.requirementData.title:"",description:l.editMode&&l.requirementData?l.requirementData.description:"",category:l.editMode&&l.requirementData?l.requirementData.category:"functional",status:l.editMode&&l.requirementData?l.requirementData.status:"draft"}),h=[P=>!!P||"Title is required",P=>P.length<=255||"Title must be less than 255 characters"],m=[P=>!!P||"Description is required"],d=[{title:"Functional",value:"functional"},{title:"Non-Functional",value:"nonfunctional"},{title:"UI/UX",value:"uiux"},{title:"Other",value:"other"}],V=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],M=D(null),$=()=>{_.value={title:"",description:"",category:"functional",status:"draft"},M.value&&M.value.resetValidation()},C=()=>{v.value=!1,$()},z=async()=>{const{valid:P}=await M.value.validate();P&&(s("submit",_.value),v.value=!1,$())};return De(v,P=>{P||$()}),(P,U)=>{const j=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":U[4]||(U[4]=x=>ze(v)?v.value=x:null),"max-width":"700",persistent:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex pt-5 px-5"},{default:a(()=>[r("h5",gl,n(l.editMode?"Edit Requirement":"Create New Requirement"),1),e(Z),e(j,{onClick:C},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(X,{class:"px-5 pt-4"},{default:a(()=>[e(Fe,{ref_key:"formRef",ref:M,onSubmit:ke(z,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:_.value.title,"onUpdate:modelValue":U[0]||(U[0]=x=>_.value.title=x),label:"Requirement Title",rules:h,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:_.value.category,"onUpdate:modelValue":U[1]||(U[1]=x=>_.value.category=x),label:"Category",items:d,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:_.value.status,"onUpdate:modelValue":U[2]||(U[2]=x=>_.value.status=x),label:"Status",items:V,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:_.value.description,"onUpdate:modelValue":U[3]||(U[3]=x=>_.value.description=x),label:"Description",rules:m,required:"",rows:"6"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[e(I,{variant:"tonal",color:"secondary",onClick:C},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:z},{default:a(()=>[i(n(l.editMode?"Update":"Create")+" Requirement ",1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},bl=t=>(be("data-v-13a73dd1"),t=t(),xe(),t),xl={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},kl={key:1,class:"text-center pa-4"},wl=bl(()=>r("h4",{class:"text-h6 mb-2"},"No Requirements Found",-1)),Vl={class:"text-body-1 text-medium-emphasis mb-6"},Cl={class:"text-body-2 mb-3"},Sl={class:"d-flex align-center justify-space-between mb-2"},Dl={class:"d-flex align-center"},Ul={class:"text-caption text-capitalize"},ql={class:"d-flex align-center"},jl={class:"text-caption"},zl={class:"d-flex align-center"},Fl={class:"text-caption"},Ml={key:0,class:"mt-3"},Il={__name:"ProjectRequirementsList",props:{projectId:{type:String,required:!0},requirements:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh","view-user-stories"],setup(t,{emit:s}){const l=t,v=Sa(),_=Me(),h=D(""),m=D([]),d=D(["draft","active","completed"]),V=D(null),M=D(!1),$=D(!1),C=D(!1),z=D(!1),P=D({show:!1,text:"",color:"success"}),U=H(()=>_.is_admin()),j=H(()=>_.userData.role>=2),x=H(()=>_.userData.role>=3),F=[{title:"Functional",value:"functional"},{title:"Non-Functional",value:"nonfunctional"},{title:"UI/UX",value:"uiux"},{title:"Other",value:"other"}],k=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],A=H(()=>l.requirements.filter(u=>{const q=!h.value||u.title.toLowerCase().includes(h.value.toLowerCase())||u.description.toLowerCase().includes(h.value.toLowerCase()),y=m.value.length===0||m.value.includes(u.category),ae=d.value.includes(u.status);return q&&y&&ae})),G=()=>{$.value=!0},O=async u=>{z.value=!0;try{const{data:q,error:y}=await v.createRequirement({...u,project:l.projectId});q&&!y?(f("Requirement created successfully"),s("refresh")):f("Failed to create requirement","error")}catch(q){f("Failed to create requirement: "+q.message,"error")}finally{z.value=!1}},T=async u=>{z.value=!0;try{const{data:q,error:y}=await v.updateRequirement(V.value.id,u);q&&!y?(f("Requirement updated successfully"),s("refresh")):f("Failed to update requirement","error")}catch(q){f("Failed to update requirement: "+q.message,"error")}finally{z.value=!1}},E=async()=>{if(V.value){z.value=!0,C.value=!1;try{const{success:u,error:q}=await v.deleteRequirement(V.value.id);u&&!q?(f("Requirement deleted successfully"),s("refresh"),M.value=!1):f("Failed to delete requirement","error")}catch(u){f("Failed to delete requirement: "+u.message,"error")}finally{z.value=!1}}},B=u=>{s("view-user-stories",u)},f=(u,q="success")=>{P.value={show:!0,text:u,color:q}},w=(u,q=120)=>!u||u.length<=q?u:u.substring(0,q)+"...";return(u,q)=>{const y=Be,ae=pe("IconBtn");return o(),g(X,{class:"pa-6"},{default:a(()=>[e(te,null,{default:a(()=>[e(R,{cols:"12",md:"4"},{default:a(()=>[e(se,{modelValue:h.value,"onUpdate:modelValue":q[0]||(q[0]=L=>h.value=L),density:"compact",placeholder:"Search requirements...","prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"3"},{default:a(()=>[e(ie,{modelValue:m.value,"onUpdate:modelValue":q[1]||(q[1]=L=>m.value=L),items:F,density:"compact","hide-details":"",label:"Category",variant:"outlined",multiple:"",chips:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"3"},{default:a(()=>[e(ie,{modelValue:d.value,"onUpdate:modelValue":q[2]||(q[2]=L=>d.value=L),items:k,density:"compact","hide-details":"",label:"Status",variant:"outlined",multiple:"",chips:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"2",class:"d-flex align-center"},{default:a(()=>[c(x)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:G,loading:z.value,block:""},{default:a(()=>[i(" Add ")]),_:1},8,["loading"])):S("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),t.loading?(o(),p("div",xl,[e(Se,{indeterminate:"",color:"primary"})])):c(A).length===0?(o(),p("div",kl,[e(b,{icon:"tabler-file-search",size:"64",color:"secondary",class:"mb-4"}),wl,r("p",Vl,n(h.value||m.value.length>0||d.value.length>0?"Try adjusting your filters to see more results.":"This project does not have any requirements yet."),1),c(x)&&!h.value&&m.value.length===0&&d.value.length===0?(o(),g(I,{key:0,color:"primary",onClick:G,"prepend-icon":"tabler-plus"},{default:a(()=>[i(" Add Requirement ")]),_:1})):S("",!0)])):(o(),g(te,{key:2},{default:a(()=>[(o(!0),p(Q,null,re(c(A),L=>(o(),g(R,{key:L.id,cols:"12"},{default:a(()=>[e(W,{class:"requirement-card",onClick:N=>(ge=>{V.value=ge,M.value=!0})(L),border:"",hover:""},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(je,{color:c(aa)(L.category),variant:"tonal",size:"42"},{default:a(()=>[L.category==="functional"?(o(),g(b,{key:0,icon:"tabler-function"})):L.category==="nonfunctional"?(o(),g(b,{key:1,icon:"tabler-chart-bar"})):L.category==="uiux"?(o(),g(b,{key:2,icon:"tabler-palette"})):(o(),g(b,{key:3,icon:"tabler-file-description"}))]),_:2},1032,["color"])]),append:a(()=>[e(K,{color:c(ve)(L.status),size:"small",label:""},{default:a(()=>{return[i(n((N=L.status,N?N.charAt(0).toUpperCase()+N.slice(1):"")),1)];var N}),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i(n(L.handle)+" "+n(L.title),1)]),_:2},1024)]),_:2},1024),e(X,null,{default:a(()=>{return[r("p",Cl,n(w(L.description)),1),r("div",Sl,[r("div",Dl,[e(b,{size:"16",icon:"tabler-tag",class:"me-1"}),r("span",Ul,n(L.category),1)]),r("div",ql,[e(b,{size:"16",icon:"tabler-calendar",class:"me-1"}),r("span",jl,n((N=L.updated_at,N?(N=parseInt(N),new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"")),1)]),r("div",zl,[e(b,{size:"16",icon:"tabler-history",class:"me-1"}),r("span",Fl,"v"+n(L.version_number),1)])]),L.user_stories&&L.user_stories.length>0?(o(),p("div",Ml,[e(I,{size:"small",variant:"tonal",color:"primary","prepend-icon":"tabler-user-check",onClick:ke(ge=>B(L),["stop"])},{default:a(()=>[i(n(L.user_stories.length)+" User "+n(L.user_stories.length===1?"Story":"Stories"),1)]),_:2},1032,["onClick"])])):S("",!0)];var N}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),V.value?(o(),g(yl,{key:3,modelValue:M.value,"onUpdate:modelValue":q[3]||(q[3]=L=>M.value=L),requirement:V.value,onDelete:q[4]||(q[4]=L=>C.value=!0),onUpdate:T,onViewUserStories:B,"is-admin":c(U),"has-manager-permission":c(j),"has-moderator-permission":c(x)},null,8,["modelValue","requirement","is-admin","has-manager-permission","has-moderator-permission"])):S("",!0),e(_l,{modelValue:$.value,"onUpdate:modelValue":q[5]||(q[5]=L=>$.value=L),onSubmit:O},null,8,["modelValue"]),e(y,{isDialogVisible:C.value,"onUpdate:isDialogVisible":q[6]||(q[6]=L=>C.value=L),confirmationMsg:"Are you sure you want to delete this requirement? This action cannot be undone.",onConfirm:E},null,8,["isDialogVisible"]),e(ye,{modelValue:P.value.show,"onUpdate:modelValue":q[8]||(q[8]=L=>P.value.show=L),color:P.value.color,timeout:5e3},{actions:a(()=>[e(ae,{onClick:q[7]||(q[7]=L=>P.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(P.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},Pl=_e(Il,[["__scopeId","data-v-13a73dd1"]]),Da=Le({id:"MockupStore",state:()=>({mockups:[],currentMockup:null,loading:!1,error:null}),actions:{async fetchMockups(t=null){this.loading=!0;try{let s="/service/mockups/";t&&(s+=`?project=${t}`);const l=await Y.get(s);return l.status===200?(this.mockups=l.data,{data:l.data,error:null}):{data:[],error:l.data}}catch(s){return this.error=s.message||"Failed to fetch mockups",{data:[],error:this.error}}finally{this.loading=!1}},async fetchMockupById(t){this.loading=!0;try{const s=await Y.get(`/service/mockups/${t}/`);return s.status===200?(this.currentMockup=s.data,{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to fetch mockup",{data:null,error:this.error}}finally{this.loading=!1}},async createMockup(t){this.loading=!0;try{const s=await Y.post("/service/mockups/",t);return s.status===201?(this.mockups.length&&this.mockups.push(s.data),{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to create mockup",{data:null,error:this.error}}finally{this.loading=!1}},async updateMockup(t,s){this.loading=!0;try{const l=await Y.put(`/service/mockups/${t}/`,s);if(l.status===200){if(this.mockups.length){const v=this.mockups.findIndex(_=>_.id===t);v!==-1&&(this.mockups[v]=l.data)}return this.currentMockup&&this.currentMockup.id===t&&(this.currentMockup=l.data),{data:l.data,error:null}}return{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to update mockup",{data:null,error:this.error}}finally{this.loading=!1}},async deleteMockup(t){this.loading=!0;try{const s=await Y.delete(`/service/mockups/${t}/`);return s.status===204?(this.mockups.length&&(this.mockups=this.mockups.filter(l=>l.id!==t)),this.currentMockup&&this.currentMockup.id===t&&(this.currentMockup=null),{success:!0,error:null}):{success:!1,error:s.data}}catch(s){return this.error=s.message||"Failed to delete mockup",{success:!1,error:this.error}}finally{this.loading=!1}}}}),Ua=t=>(be("data-v-b1d59641"),t=t(),xe(),t),Al={key:0,class:"text-h5"},Ll={class:"text-h5"},Rl={key:0},Bl={key:1},Tl={class:"mockup-metadata d-flex align-center px-6 py-3"},Nl={class:"d-flex align-center"},$l={class:"text-caption"},El={class:"d-flex align-center ms-4"},Ol={class:"text-caption"},Hl={key:0,class:"d-flex align-center ms-4"},Gl={class:"text-caption"},Jl={class:"mockup-content pa-0"},Kl=["srcdoc"],Xl={key:1,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},Yl=Ua(()=>r("h4",{class:"text-h6 mb-2"},"No HTML Content",-1)),Ql=Ua(()=>r("p",{class:"text-medium-emphasis text-center"}," This mockup doesn't have any HTML content to display. ",-1)),Zl={__name:"MockupPreviewDialog",props:{modelValue:{type:Boolean,default:!1},mockup:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:x=>s("update:modelValue",x)}),_=Da(),h=D(!1),m=D(!1),d=D({...l.mockup}),V=D(!1),M=D({show:!1,text:"",color:"success"}),$=x=>x?new Date(parseInt(x)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",C=()=>{h.value=!h.value},z=()=>{m.value&&(d.value={...l.mockup}),m.value=!m.value},P=async()=>{V.value=!0;try{const{data:x,error:F}=await _.updateMockup(l.mockup.id,d.value);x&&!F?(j("Mockup updated successfully"),Object.assign(l.mockup,x),m.value=!1):j("Failed to update mockup","error")}catch(x){j("Failed to update mockup: "+x.message,"error")}finally{V.value=!1}},U=()=>{s("delete")},j=(x,F="success")=>{M.value={show:!0,text:x,color:F}};return De(()=>l.mockup,x=>{d.value={...x}},{deep:!0}),(x,F)=>{const k=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":F[6]||(F[6]=A=>ze(v)?v.value=A:null),fullscreen:h.value,"max-width":h.value?"100%":"900",scrollable:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex py-3 px-5"},{default:a(()=>[m.value?(o(),p("h5",Al,"Edit Mockup")):(o(),p(Q,{key:1},[r("h5",Ll,n(t.mockup.name),1),e(K,{color:c(ve)(t.mockup.status),size:"small",label:""},{default:a(()=>[i(n(Re(t.mockup.status)),1)]),_:1},8,["color"])],64)),e(Z),e(I,{icon:"",variant:"text",onClick:C},{default:a(()=>[e(b,{icon:h.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(k,{onClick:F[0]||(F[0]=A=>v.value=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(ee),e(X,{class:la({"pa-0":!m.value,"pa-6":m.value}),style:Ae({height:h.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:a(()=>[m.value?(o(),p("div",Rl,[e(Fe,{onSubmit:ke(P,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:d.value.name,"onUpdate:modelValue":F[1]||(F[1]=A=>d.value.name=A),label:"Mockup Name",required:"",rules:[A=>!!A||"Name is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:d.value.status,"onUpdate:modelValue":F[2]||(F[2]=A=>d.value.status=A),label:"Status",items:[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:d.value.html_content,"onUpdate:modelValue":F[3]||(F[3]=A=>d.value.html_content=A),label:"HTML Content",rows:"15",rules:[A=>!!A||"HTML content is required"],monospace:""},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(o(),p("div",Bl,[r("div",Tl,[r("div",Nl,[e(b,{icon:"tabler-calendar",class:"me-2",size:"18"}),r("span",$l,"Created: "+n($(t.mockup.created_at)),1)]),r("div",El,[e(b,{icon:"tabler-calendar-event",class:"me-2",size:"18"}),r("span",Ol,"Updated: "+n($(t.mockup.updated_at)),1)]),t.mockup.requirement?(o(),p("div",Hl,[e(b,{icon:"tabler-file-check",class:"me-2",size:"18"}),r("span",Gl,"Requirement: "+n(t.mockup.requirement),1)])):S("",!0)]),e(ee),r("div",Jl,[t.mockup.html_content?(o(),p("iframe",{key:0,srcdoc:t.mockup.html_content,class:"mockup-iframe",style:Ae([{width:"100%",border:"none"},{height:h.value?"calc(100vh - 180px)":"calc(70vh - 110px)"}]),sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",title:"Mockup Preview"},null,12,Kl)):(o(),p("div",Xl,[e(b,{icon:"tabler-code-off",size:"64",color:"secondary",class:"mb-4"}),Yl,Ql]))])]))]),_:1},8,["class","style"]),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[m.value?(o(),p(Q,{key:0},[e(I,{color:"secondary",variant:"tonal",onClick:z,disabled:V.value},{default:a(()=>[i(" Cancel ")]),_:1},8,["disabled"]),e(Z),e(I,{color:"primary",onClick:P,loading:V.value},{default:a(()=>[i(" Save Changes ")]),_:1},8,["loading"])],64)):(o(),p(Q,{key:1},[t.isAdmin?(o(),g(I,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:U},{default:a(()=>[i(" Delete ")]),_:1})):S("",!0),e(Z),t.hasManagerPermission?(o(),g(I,{key:1,color:"primary","prepend-icon":"tabler-edit",onClick:z},{default:a(()=>[i(" Edit ")]),_:1})):S("",!0),t.hasManagerPermission?(o(),g(I,{key:2,class:"ms-2",color:"primary",variant:"tonal","prepend-icon":"tabler-code",onClick:z},{default:a(()=>[i(" View HTML ")]),_:1})):S("",!0)],64))]),_:1})]),_:1}),e(ye,{modelValue:M.value.show,"onUpdate:modelValue":F[5]||(F[5]=A=>M.value.show=A),color:M.value.color,timeout:5e3},{actions:a(()=>[e(k,{onClick:F[4]||(F[4]=A=>M.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(M.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},Wl=_e(Zl,[["__scopeId","data-v-b1d59641"]]),qa=t=>(be("data-v-fcfe1101"),t=t(),xe(),t),er={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},ar={key:1,class:"text-center pa-4"},tr=qa(()=>r("h4",{class:"text-h6 mb-2"},"No Mockups Found",-1)),lr={class:"text-body-1 text-medium-emphasis mb-6"},rr={class:"mockup-preview mb-3"},sr={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},or={key:0,class:"html-preview"},ir=["innerHTML"],nr={key:1,class:"d-flex justify-center align-center h-100"},ur={class:"preview-overlay d-flex justify-center align-center"},dr={key:0,class:"mb-2"},cr=qa(()=>r("span",{class:"text-caption font-weight-medium"},"Requirement: ",-1)),mr={class:"d-flex align-center justify-space-between"},pr={class:"d-flex align-center"},vr={class:"text-caption"},hr=_e({__name:"ProjectMockupsList",props:{projectId:{type:String,required:!0},mockups:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(t,{emit:s}){const l=t,v=Da(),_=Me(),h=D(""),m=D(null),d=D(!1),V=D(!1),M=D(!1),$=D({show:!1,text:"",color:"success"}),C=H(()=>_.is_admin()),z=H(()=>_.userData.role>=2);H(()=>_.userData.role>=3);const P=H(()=>l.mockups.filter(F=>!h.value||F.name.toLowerCase().includes(h.value.toLowerCase())||F.requirement&&F.requirement.title.toLowerCase().includes(h.value.toLowerCase()))),U=async()=>{if(m.value){M.value=!0,V.value=!1;try{const{success:F,error:k}=await v.deleteMockup(m.value.id);F&&!k?(j("Mockup deleted successfully"),s("refresh"),d.value=!1):j("Failed to delete mockup","error")}catch(F){j("Failed to delete mockup: "+F.message,"error")}finally{M.value=!1}}},j=(F,k="success")=>{$.value={show:!0,text:F,color:k}},x=(F,k=150)=>{if(!F||F.length<=k)return F;const A=F.replace(/<[^>]*>/g,"");return A.length<=k?F:A.substring(0,k)+"..."};return(F,k)=>{const A=Be,G=pe("IconBtn");return o(),g(X,{class:"pa-6"},{default:a(()=>[e(te,null,{default:a(()=>[e(R,{cols:"12",md:"6"},{default:a(()=>[e(se,{modelValue:h.value,"onUpdate:modelValue":k[0]||(k[0]=O=>h.value=O),density:"compact",placeholder:"Search mockups...","prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(ee,{class:"my-5"}),t.loading?(o(),p("div",er,[e(Se,{indeterminate:"",color:"primary"})])):c(P).length===0?(o(),p("div",ar,[e(b,{icon:"tabler-photo-off",size:"64",color:"secondary",class:"mb-4"}),tr,r("p",lr,n(h.value?"Try adjusting your search to see more results.":"This project does not have any mockups yet."),1)])):(o(),g(te,{key:2},{default:a(()=>[(o(!0),p(Q,null,re(c(P),O=>(o(),g(R,{key:O.id,cols:"12",md:"6",lg:"4"},{default:a(()=>[e(W,{class:"mockup-card h-100",onClick:T=>(E=>{m.value=E,d.value=!0})(O),border:"",hover:""},{default:a(()=>[e(ne,null,{append:a(()=>[e(K,{color:c(ve)(O.status),size:"small",label:""},{default:a(()=>[i(n(Re(O.status)),1)]),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i(n(O.name),1)]),_:2},1024)]),_:2},1024),e(ee),e(X,null,{default:a(()=>{return[r("div",rr,[r("div",sr,[O.html_content?(o(),p("div",or,[r("div",{innerHTML:x(O.html_content)},null,8,ir)])):(o(),p("div",nr,[e(b,{icon:"tabler-file-code",size:"48",color:"secondary"})])),r("div",ur,[e(I,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye"},{default:a(()=>[i(" Preview ")]),_:1})])])]),O.requirement?(o(),p("div",dr,[cr,e(K,{size:"x-small",color:"primary",class:"ms-1"},{default:a(()=>[i(n(O.requirement),1)]),_:2},1024)])):S("",!0),r("div",mr,[r("div",pr,[e(b,{size:"16",icon:"tabler-calendar",class:"me-1"}),r("span",vr,n((T=O.created_at,T?new Date(parseInt(T)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1)])])];var T}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),m.value?(o(),g(Wl,{key:3,modelValue:d.value,"onUpdate:modelValue":k[1]||(k[1]=O=>d.value=O),mockup:m.value,onDelete:k[2]||(k[2]=O=>V.value=!0),"is-admin":c(C),"has-manager-permission":c(z)},null,8,["modelValue","mockup","is-admin","has-manager-permission"])):S("",!0),e(A,{isDialogVisible:V.value,"onUpdate:isDialogVisible":k[3]||(k[3]=O=>V.value=O),confirmationMsg:"Are you sure you want to delete this mockup? This action cannot be undone.",onConfirm:U},null,8,["isDialogVisible"]),e(ye,{modelValue:$.value.show,"onUpdate:modelValue":k[5]||(k[5]=O=>$.value.show=O),color:$.value.color,timeout:5e3},{actions:a(()=>[e(G,{onClick:k[4]||(k[4]=O=>$.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n($.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-fcfe1101"]]),ja=Le({id:"DevelopmentPlanStore",state:()=>({plans:[],currentPlan:null,loading:!1,error:null}),actions:{async fetchDevelopmentPlans(t=null){this.loading=!0;try{let s="/service/development-plans/";t&&(s+=`?project=${t}`);const l=await Y.get(s);return l.status===200?(this.plans=l.data,{data:l.data,error:null}):{data:[],error:l.data}}catch(s){return this.error=s.message||"Failed to fetch development plans",{data:[],error:this.error}}finally{this.loading=!1}},async fetchDevelopmentPlanById(t){this.loading=!0;try{const s=await Y.get(`/service/development-plans/${t}/`);return s.status===200?(this.currentPlan=s.data,{data:s.data,error:null}):{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to fetch development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createDevelopmentPlan(t){this.loading=!0;try{const s=await Y.post("/service/development-plans/",{project:t,status:"draft"});return s.status===201?{data:s.data,error:null}:{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to create development plan",{data:null,error:this.error}}finally{this.loading=!1}},async updateDevelopmentPlan(t,s){this.loading=!0;try{const l=await Y.put(`/service/development-plans/${t}/`,s);return l.status===200?(this.currentPlan&&this.currentPlan.id===t&&(this.currentPlan=l.data),{data:l.data,error:null}):{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to update development plan",{data:null,error:this.error}}finally{this.loading=!1}},async createPlanVersion(t,s){this.loading=!0;try{const l=await Y.post(`/service/development-plans/${t}/new_version/`,s);return l.status===201?{data:l.data,error:null}:{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to create plan version",{data:null,error:this.error}}finally{this.loading=!1}},async fetchPlanVersionById(t){this.loading=!0;try{const s=await Y.get(`/service/development-plan-versions/${t}/`);return s.status===200?{data:s.data,error:null}:{data:null,error:s.data}}catch(s){return this.error=s.message||"Failed to fetch plan version",{data:null,error:this.error}}finally{this.loading=!1}},async updatePlanVersion(t,s){this.loading=!0;try{const l=await Y.put(`/service/development-plan-versions/${t}/`,s);return l.status===200?{data:l.data,error:null}:{data:null,error:l.data}}catch(l){return this.error=l.message||"Failed to update plan version",{data:null,error:this.error}}finally{this.loading=!1}},async setCurrentPlanVersion(t,s){this.loading=!0;try{const l=await this.fetchDevelopmentPlanById(t);if(!l.data)return{data:null,error:"Plan not found"};const v=await this.fetchPlanVersionById(s);return v.data?await this.updateDevelopmentPlan(t,{current_version_number:v.data.version_number,status:l.data.status}):{data:null,error:"Version not found"}}catch(l){return this.error=l.message||"Failed to set current plan version",{data:null,error:this.error}}finally{this.loading=!1}}}}),Ye=t=>(be("data-v-c45d3933"),t=t(),xe(),t),fr={key:0,class:"text-h5"},yr={key:1,class:"text-h5"},gr={key:0},_r=Ye(()=>r("p",{class:"text-subtitle-1 font-weight-bold mb-2"},"Roles & Hours",-1)),br={key:1},xr={class:"d-flex flex-wrap justify-space-between mb-4"},kr={class:"d-flex align-center"},wr={class:"d-flex align-center"},Vr={class:"text-caption"},Cr={key:0,class:"text-caption ms-3"},Sr={class:"text-h4 font-weight-bold"},Dr=Ye(()=>r("div",{class:"text-caption text-medium-emphasis text-right"}," Estimated total cost ",-1)),Ur=Ye(()=>r("thead",null,[r("tr",null,[r("th",null,"Role"),r("th",{class:"text-right"},"Hours"),r("th",{class:"text-right"},"Cost")])],-1)),qr={class:"text-right"},jr={class:"text-right"},zr={key:0},Fr=[Ye(()=>r("td",{colspan:"3",class:"text-center"},"No roles and hours defined",-1))],Mr={class:"text-body-1 whitespace-pre-wrap"},Ir=_e({__name:"PlanVersionDialog",props:{modelValue:{type:Boolean,default:!1},version:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},planId:{type:String,default:null}},emits:["update:modelValue","refresh"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:j=>s("update:modelValue",j)}),_=ja(),h=D(!1),m=D({...l.version}),d=D(!1),V=D({show:!1,text:"",color:"success"}),M=j=>j||j===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(j):"-",$=()=>{h.value&&(m.value={...l.version}),h.value=!h.value},C=async()=>{d.value=!0;try{const{data:j,error:x}=await _.updatePlanVersion(l.version.id,m.value);j&&!x?(U("Plan version updated successfully"),Object.assign(l.version,j),h.value=!1,s("refresh")):U("Failed to update plan version","error")}catch(j){U("Failed to update plan version: "+j.message,"error")}finally{d.value=!1}},z=async()=>{if(l.planId){d.value=!0;try{const{data:j,error:x}=await _.setCurrentPlanVersion(l.planId,l.version.id);j&&!x?(U("Set as current version successfully"),s("refresh")):U("Failed to set as current version","error")}catch(j){U("Failed to set as current version: "+j.message,"error")}finally{d.value=!1}}},P=j=>{if(!j)return[];try{return typeof j=="string"?JSON.parse(j):j}catch(x){return console.error("Error parsing roles and hours:",x),[]}},U=(j,x="success")=>{V.value={show:!0,text:j,color:x}};return De(()=>l.version,j=>{m.value={...j}},{deep:!0}),(j,x)=>{const F=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":x[7]||(x[7]=k=>ze(v)?v.value=k:null),"max-width":"900",scrollable:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex py-3 px-5"},{default:a(()=>[h.value?(o(),p("h5",fr,"Edit Plan Version")):(o(),p("h5",yr,[i(" Development Plan v"+n(t.version.version_number)+" ",1),t.isCurrent?(o(),g(K,{key:0,color:"primary",size:"small",label:"",class:"ms-2"},{default:a(()=>[i(" Current ")]),_:1})):S("",!0)])),e(Z),e(F,{onClick:x[0]||(x[0]=k=>v.value=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(ee),e(X,{class:"pa-6"},{default:a(()=>[h.value?(o(),p("div",gr,[e(Fe,{onSubmit:ke(C,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12",md:"4"},{default:a(()=>[e(se,{modelValue:m.value.estimated_cost,"onUpdate:modelValue":x[1]||(x[1]=k=>m.value.estimated_cost=k),modelModifiers:{number:!0},label:"Estimated Cost ($)",type:"number",required:"",rules:[k=>!!k||"Estimated cost is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12",md:"4"},{default:a(()=>[e(ie,{modelValue:m.value.status,"onUpdate:modelValue":x[2]||(x[2]=k=>m.value.status=k),label:"Status",items:[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:m.value.notes,"onUpdate:modelValue":x[3]||(x[3]=k=>m.value.notes=k),label:"Notes",rows:"4"},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[_r,e(he,{modelValue:m.value.roles_and_hours,"onUpdate:modelValue":x[4]||(x[4]=k=>m.value.roles_and_hours=k),label:"Roles & Hours (JSON format)",rows:"8",monospace:"",hint:"Format: [{ 'role': 'Developer', 'hours': 40, 'cost': 4000 }]","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(o(),p("div",br,[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>{return[r("div",xr,[r("div",kr,[e(K,{color:c(ve)(t.version.status),size:"small",label:""},{default:a(()=>[i(n(Re(t.version.status)),1)]),_:1},8,["color"])]),r("div",wr,[r("span",Vr," Created: "+n((k=t.version.created_at,k?new Date(parseInt(k)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"")),1),t.version.created_by?(o(),p("span",Cr," Created by: "+n(t.version.created_by.username),1)):S("",!0)]),r("div",null,[r("h4",Sr,n(M(t.version.estimated_cost)),1),Dr])])];var k}),_:1}),e(R,{cols:"12"},{default:a(()=>[e(W,{variant:"outlined",class:"mb-4"},{default:a(()=>[e(le,null,{default:a(()=>[i("Roles & Hours Breakdown")]),_:1}),e(X,null,{default:a(()=>[e(He,null,{default:a(()=>[Ur,r("tbody",null,[(o(!0),p(Q,null,re(P(t.version.roles_and_hours),(k,A)=>(o(),p("tr",{key:A},[r("td",null,n(k.role),1),r("td",qr,n(k.hours),1),r("td",jr,n(M(k.cost)),1)]))),128)),P(t.version.roles_and_hours).length===0?(o(),p("tr",zr,Fr)):S("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),t.version.notes?(o(),g(R,{key:0,cols:"12"},{default:a(()=>[e(W,{variant:"outlined"},{default:a(()=>[e(le,null,{default:a(()=>[i("Notes")]),_:1}),e(X,null,{default:a(()=>[r("div",Mr,n(t.version.notes),1)]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1})]))]),_:1}),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[h.value?(o(),p(Q,{key:0},[e(I,{color:"secondary",variant:"tonal",onClick:$,disabled:d.value},{default:a(()=>[i(" Cancel ")]),_:1},8,["disabled"]),e(Z),e(I,{color:"primary",onClick:C,loading:d.value},{default:a(()=>[i(" Save Changes ")]),_:1},8,["loading"])],64)):(o(),p(Q,{key:1},[!t.isCurrent&&t.hasManagerPermission?(o(),g(I,{key:0,color:"primary",variant:"tonal",onClick:z,loading:d.value,"prepend-icon":"tabler-check"},{default:a(()=>[i(" Set as Current ")]),_:1},8,["loading"])):S("",!0),e(Z),t.hasManagerPermission?(o(),g(I,{key:1,color:"primary","prepend-icon":"tabler-edit",onClick:$},{default:a(()=>[i(" Edit ")]),_:1})):S("",!0)],64))]),_:1})]),_:1}),e(ye,{modelValue:V.value.show,"onUpdate:modelValue":x[6]||(x[6]=k=>V.value.show=k),color:V.value.color,timeout:5e3},{actions:a(()=>[e(F,{onClick:x[5]||(x[5]=k=>V.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(V.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-c45d3933"]]),Pr=r("h5",{class:"text-h5"},"Create New Plan Version",-1),Ar={class:"text-subtitle-1 mb-4"},Lr={__name:"PlanVersionCreateDialog",props:{modelValue:{type:Boolean,default:!1},planId:{type:String,required:!0},currentVersionNumber:{type:Number,default:0}},emits:["update:modelValue","submit"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:C=>s("update:modelValue",C)}),_=D({roles_and_hours:'[{"role": "Project Manager", "hours": 20, "cost": 2000}, {"role": "Developer", "hours": 80, "cost": 8000}]',estimated_cost:1e4,notes:"",status:"draft"}),h=[C=>!!C||"Estimated cost is required",C=>!isNaN(parseFloat(C))||"Estimated cost must be a number"],m=[C=>{try{return JSON.parse(C),!0}catch{return"Roles and hours must be valid JSON"}}],d=D(null),V=()=>{_.value={roles_and_hours:'[{"role": "Project Manager", "hours": 20, "cost": 2000}, {"role": "Developer", "hours": 80, "cost": 8000}]',estimated_cost:1e4,notes:"",status:"draft"},d.value&&d.value.resetValidation()},M=()=>{v.value=!1,V()},$=async()=>{const{valid:C}=await d.value.validate();if(C){const z={..._.value};z.estimated_cost=parseFloat(z.estimated_cost),s("submit",z),v.value=!1,V()}};return De(v,C=>{C||V()}),(C,z)=>{const P=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":z[4]||(z[4]=U=>ze(v)?v.value=U:null),"max-width":"700",persistent:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex pt-5 px-5"},{default:a(()=>[Pr,e(Z),e(P,{onClick:M},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(X,{class:"px-5 pt-4"},{default:a(()=>[r("p",Ar," Creating version "+n(t.currentVersionNumber+1)+" for this development plan. ",1),e(Fe,{ref_key:"formRef",ref:d,onSubmit:ke($,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12",md:"6"},{default:a(()=>[e(se,{modelValue:_.value.estimated_cost,"onUpdate:modelValue":z[0]||(z[0]=U=>_.value.estimated_cost=U),modelModifiers:{number:!0},label:"Estimated Cost ($)",type:"number",rules:h,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:_.value.status,"onUpdate:modelValue":z[1]||(z[1]=U=>_.value.status=U),label:"Status",items:[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:_.value.roles_and_hours,"onUpdate:modelValue":z[2]||(z[2]=U=>_.value.roles_and_hours=U),label:"Roles & Hours (JSON format)",rules:m,rows:"6",monospace:"",hint:"Format: [{ 'role': 'Developer', 'hours': 40, 'cost': 4000 }]","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:_.value.notes,"onUpdate:modelValue":z[3]||(z[3]=U=>_.value.notes=U),label:"Notes",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[e(I,{variant:"tonal",color:"secondary",onClick:M},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:$},{default:a(()=>[i(" Create Version ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Rr={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},Br={key:1,class:"text-center pa-6"},Tr=r("h4",{class:"text-h6 mb-2"},"No Development Plan",-1),Nr=r("p",{class:"text-body-1 text-medium-emphasis mb-6"}," This project does not have a development plan yet. ",-1),$r={key:2},Er={class:"d-flex flex-column"},Or=r("div",{class:"text-h6 mb-2"},"Estimated Cost",-1),Hr={class:"text-h4 font-weight-bold"},Gr={class:"text-caption text-medium-emphasis"},Jr=r("div",{class:"text-h6 mb-3"},"Roles & Hours Breakdown",-1),Kr=r("thead",null,[r("tr",null,[r("th",null,"Role"),r("th",{class:"text-right"},"Hours"),r("th",{class:"text-right"},"Cost")])],-1),Xr={class:"text-right"},Yr={class:"text-right"},Qr={class:"d-flex align-center justify-space-between mb-4"},Zr=r("h5",{class:"text-h5"},"Version History",-1),Wr=r("thead",null,[r("tr",null,[r("th",null,"Version"),r("th",null,"Created"),r("th",null,"Status"),r("th",{class:"text-right"},"Estimated Cost"),r("th",{class:"text-right"},"Actions")])],-1),es=["onClick"],as={class:"d-flex align-center"},ts={class:"font-weight-medium"},ls={class:"text-right"},rs={class:"text-right"},ss={key:1,class:"text-center pa-4"},os=[r("p",{class:"text-medium-emphasis"}," Only one version available. Create more versions to see the history. ",-1)],is={key:2,class:"text-center pa-4"},ns=[r("p",{class:"text-medium-emphasis"}," No versions available yet. ",-1)],us={__name:"ProjectDevelopmentPlan",props:{projectId:{type:String,required:!0},developmentPlan:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(t,{emit:s}){const l=t,v=ja(),_=Me(),h=D(null),m=D(!1),d=D(!1),V=D(!1),M=D({show:!1,text:"",color:"success"}),$=H(()=>_.is_admin()),C=H(()=>_.userData.role>=2),z=H(()=>l.developmentPlan&&l.developmentPlan.id),P=H(()=>z.value&&l.developmentPlan.versions?[...l.developmentPlan.versions].sort((E,B)=>B.version_number-E.version_number):[]),U=H(()=>z.value?P.value.find(E=>E.version_number===l.developmentPlan.current_version_number):null),j=E=>E?new Date(parseInt(E)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",x=E=>E||E===0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(E):"-",F=E=>{h.value=E,m.value=!0},k=()=>{d.value=!0},A=async E=>{V.value=!0;try{const{data:B,error:f}=await v.createPlanVersion(l.developmentPlan.id,E);B&&!f?(O("Plan version created successfully"),s("refresh")):O("Failed to create plan version","error")}catch(B){O("Failed to create plan version: "+B.message,"error")}finally{V.value=!1,d.value=!1}},G=async()=>{V.value=!0;try{const{data:E,error:B}=await v.createDevelopmentPlan(l.projectId);E&&!B?(O("Development plan created successfully"),s("refresh")):O("Failed to create development plan","error")}catch(E){O("Failed to create development plan: "+E.message,"error")}finally{V.value=!1}},O=(E,B="success")=>{M.value={show:!0,text:E,color:B}},T=E=>{if(!E)return[];try{return typeof E=="string"?JSON.parse(E):E}catch(B){return console.error("Error parsing roles and hours:",B),[]}};return(E,B)=>{const f=pe("IconBtn");return o(),g(X,{class:"pa-6"},{default:a(()=>[t.loading?(o(),p("div",Rr,[e(Se,{indeterminate:"",color:"primary"})])):c(z)?(o(),p("div",$r,[e(te,null,{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(W,{border:"",class:"mb-4"},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(je,{color:"primary",variant:"tonal",rounded:"",size:"42"},{default:a(()=>[e(b,{icon:"tabler-calendar-stats"})]),_:1})]),append:a(()=>[e(K,{color:"primary",size:"small",label:"",class:"me-2"},{default:a(()=>[i(" v"+n(t.developmentPlan.current_version_number),1)]),_:1}),e(K,{color:t.developmentPlan.status==="active"?"success":"warning",size:"small",label:""},{default:a(()=>[i(n(t.developmentPlan.status),1)]),_:1},8,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i("Current Development Plan")]),_:1})]),_:1}),e(ee),c(U)?(o(),g(X,{key:0},{default:a(()=>[e(te,null,{default:a(()=>[e(R,{cols:"12",md:"4"},{default:a(()=>[r("div",Er,[Or,r("div",Hr,n(x(c(U).estimated_cost)),1),r("div",Gr," Last updated: "+n(j(c(U).created_at)),1)])]),_:1}),e(R,{cols:"12",md:"8"},{default:a(()=>[Jr,e(He,{density:"compact"},{default:a(()=>[Kr,r("tbody",null,[(o(!0),p(Q,null,re(T(c(U).roles_and_hours),(w,u)=>(o(),p("tr",{key:u},[r("td",null,n(w.role),1),r("td",Xr,n(w.hours),1),r("td",Yr,n(x(w.cost)),1)]))),128))])]),_:1}),e(I,{color:"primary",variant:"tonal",class:"mt-4",size:"small",onClick:B[0]||(B[0]=w=>F(c(U)))},{default:a(()=>[i(" View Full Details ")]),_:1})]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),e(R,{cols:"12"},{default:a(()=>[r("div",Qr,[Zr,c(C)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:k,disabled:V.value},{default:a(()=>[i(" New Version ")]),_:1},8,["disabled"])):S("",!0)]),c(P).length>1?(o(),g(He,{key:0},{default:a(()=>[Wr,r("tbody",null,[(o(!0),p(Q,null,re(c(P),w=>(o(),p("tr",{key:w.id,class:la({"bg-primary-lighten-5":w.version_number===t.developmentPlan.current_version_number}),style:{cursor:"pointer"},onClick:u=>F(w)},[r("td",null,[r("div",as,[r("span",ts,"v"+n(w.version_number),1),w.version_number===t.developmentPlan.current_version_number?(o(),g(K,{key:0,color:"primary",size:"x-small",label:"",class:"ms-2"},{default:a(()=>[i(" Current ")]),_:1})):S("",!0)])]),r("td",null,n(j(w.created_at)),1),r("td",null,[e(K,{color:w.status==="active"?"success":"warning",size:"small",label:""},{default:a(()=>[i(n(w.status),1)]),_:2},1032,["color"])]),r("td",ls,n(x(w.estimated_cost)),1),r("td",rs,[e(I,{icon:"",variant:"text",size:"small",color:"primary",onClick:ke(u=>F(w),["stop"])},{default:a(()=>[e(b,{icon:"tabler-eye"})]),_:2},1032,["onClick"])])],10,es))),128))])]),_:1})):c(P).length===1?(o(),p("div",ss,os)):(o(),p("div",is,ns))]),_:1})]),_:1})])):(o(),p("div",Br,[e(b,{icon:"tabler-calendar-time",size:"64",color:"secondary",class:"mb-4"}),Tr,Nr,c(C)?(o(),g(I,{key:0,color:"primary",onClick:G,loading:V.value},{default:a(()=>[i(" Create Development Plan ")]),_:1},8,["loading"])):S("",!0)])),h.value?(o(),g(Ir,{key:3,modelValue:m.value,"onUpdate:modelValue":B[1]||(B[1]=w=>m.value=w),version:h.value,"is-current":h.value&&t.developmentPlan&&h.value.version_number===t.developmentPlan.current_version_number,"is-admin":c($),"has-manager-permission":c(C),"plan-id":t.developmentPlan?t.developmentPlan.id:null,onRefresh:B[2]||(B[2]=w=>s("refresh"))},null,8,["modelValue","version","is-current","is-admin","has-manager-permission","plan-id"])):S("",!0),e(Lr,{modelValue:d.value,"onUpdate:modelValue":B[3]||(B[3]=w=>d.value=w),"plan-id":t.developmentPlan?t.developmentPlan.id:null,"current-version-number":t.developmentPlan?t.developmentPlan.current_version_number:0,onSubmit:A},null,8,["modelValue","plan-id","current-version-number"]),e(ye,{modelValue:M.value.show,"onUpdate:modelValue":B[5]||(B[5]=w=>M.value.show=w),color:M.value.color,timeout:5e3},{actions:a(()=>[e(f,{onClick:B[4]||(B[4]=w=>M.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(M.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},ue=t=>(be("data-v-5ae692aa"),t=t(),xe(),t),ds={key:0,class:"text-h5"},cs={key:1,class:"text-h5"},ms={key:0},ps={class:"align-center justify-space-between mb-3"},vs=ue(()=>r("div",{class:"text-subtitle-1 font-weight-medium"},"Acceptance Criteria",-1)),hs={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},fs={key:1},ys={class:"d-flex align-center mb-5"},gs={class:"text-medium-emphasis d-flex align-center"},_s={class:"text-caption me-4"},bs={class:"text-caption"},xs={class:"user-story-format mb-6"},ks={class:"text-h5 mb-4"},ws=ue(()=>r("span",{class:"text-primary"},"As a",-1)),Vs={class:"text-h5 mb-4"},Cs=ue(()=>r("span",{class:"text-primary"},"I want to",-1)),Ss={class:"text-h5 mb-4"},Ds=ue(()=>r("span",{class:"text-primary"},"so that",-1)),Us={key:0},qs=ue(()=>r("div",{class:"text-h6 mb-3"},"Acceptance Criteria",-1)),js={key:1,class:"text-medium-emphasis text-center pa-4"},zs={key:2,class:"mt-6"},Fs=ue(()=>r("p",null,"This user story is currently being regenerated. Please check back shortly.",-1)),Ms={key:0,class:"text-center pa-6"},Is=ue(()=>r("h4",{class:"text-h6 mb-2"},"No History Available",-1)),Ps=ue(()=>r("p",{class:"text-medium-emphasis"}," This user story hasn't been modified since its creation. ",-1)),As={key:1},Ls={class:"text-caption"},Rs={class:"text-caption text-medium-emphasis"},Bs=ue(()=>r("span",{class:"text-primary"},"As a",-1)),Ts={class:"mb-2"},Ns=ue(()=>r("span",{class:"text-primary"},"I want to",-1)),$s={class:"mb-4"},Es=ue(()=>r("span",{class:"text-primary"},"so that",-1)),Os={key:0},Hs=ue(()=>r("div",{class:"text-subtitle-2 font-weight-medium mb-2"},"Acceptance Criteria:",-1)),Gs={class:"ms-3"},Js={class:"text-caption mt-3"},Ks={class:"d-flex justify-end mt-2"},Xs={key:1,class:"text-center pa-6"},Ys=ue(()=>r("h4",{class:"text-h6 mb-2"},"No Comments Yet",-1)),Qs=ue(()=>r("p",{class:"text-medium-emphasis"}," Be the first to comment on this user story. ",-1)),Zs={key:2},Ws={class:"d-flex align-center"},eo={class:"d-flex align-center"},ao={class:"text-caption text-medium-emphasis ml-2"},to={class:"comment-text mt-2 whitespace-pre-wrap"},lo=ue(()=>r("p",{class:"text-body-1 mb-3"}," This will use AI to regenerate this user story based on your feedback and the associated requirement. ",-1)),ro=_e({__name:"UserStoryDetailsDialog",props:{modelValue:{type:Boolean,default:!1},userStory:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","update","delete","regenerate"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:w=>s("update:modelValue",w)}),_=ia(),h=D(0),m=D(!1),d=D({...l.userStory}),V=D(""),M=D(""),$=D(""),C=D(!1),z=D(!1),P=D({show:!1,text:"",color:"success"}),U=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],j=H(()=>l.userStory.history||[]),x=H(()=>l.userStory.comments||[]),F=w=>w?(w=parseInt(w),new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",k=()=>{m.value&&(d.value={...l.userStory},V.value=""),m.value=!m.value},A=()=>{V.value.trim()&&(d.value.acceptance_criteria||(d.value.acceptance_criteria=[]),d.value.acceptance_criteria.push(V.value.trim()),V.value="")},G=()=>{s("update",d.value),m.value=!1},O=()=>{s("delete")},T=()=>{$.value="",C.value=!0},E=()=>{s("regenerate",$.value),C.value=!1},B=async()=>{if(M.value.trim()){z.value=!0;try{const{data:w,error:u}=await _.createComment(l.userStory.id,{text:M.value,status:"active"});if(w&&!u){f("Comment added successfully"),M.value="";const{data:q}=await _.fetchUserStoryById(l.userStory.id);q&&Object.assign(l.userStory,q)}else f("Failed to add comment","error")}catch(w){f("Failed to add comment: "+w.message,"error")}finally{z.value=!1}}},f=(w,u="success")=>{P.value={show:!0,text:w,color:u}};return De(()=>l.userStory,w=>{d.value={...w}},{deep:!0}),(w,u)=>{const q=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":u[14]||(u[14]=y=>ze(v)?v.value=y:null),"max-width":"900",scrollable:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex pt-5 px-5"},{default:a(()=>[m.value?(o(),p("h5",ds,"Edit User Story")):(o(),p("h5",cs,"User Story Details")),e(Z),e(q,{onClick:u[0]||(u[0]=y=>v.value=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(X,{class:"pb-0"},{default:a(()=>[e(sa,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=y=>h.value=y),"slider-color":"primary","align-tabs":"start"},{default:a(()=>[e(ce,{value:"0"},{default:a(()=>[e(b,{size:"18",icon:"tabler-user-check",start:""}),i(" Details ")]),_:1}),e(ce,{value:"1"},{default:a(()=>[e(b,{size:"18",icon:"tabler-history",start:""}),i(" History "),c(j).length?(o(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:a(()=>[i(n(c(j).length),1)]),_:1})):S("",!0)]),_:1}),e(ce,{value:"2"},{default:a(()=>[e(b,{size:"18",icon:"tabler-messages",start:""}),i(" Comments "),c(x).length?(o(),g(K,{key:0,size:"x-small",color:"primary",class:"ms-2"},{default:a(()=>[i(n(c(x).length),1)]),_:1})):S("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(X,{class:"pa-6",style:{"min-height":"400px","max-height":"70vh"}},{default:a(()=>[e(oa,{modelValue:h.value,"onUpdate:modelValue":u[8]||(u[8]=y=>h.value=y),class:"mt-5"},{default:a(()=>[e(me,{value:"0"},{default:a(()=>[m.value?(o(),p("div",ms,[e(Fe,{onSubmit:ke(G,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:d.value.role,"onUpdate:modelValue":u[2]||(u[2]=y=>d.value.role=y),label:"Role (As a...)",required:"",rules:[y=>!!y||"Role is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:d.value.action,"onUpdate:modelValue":u[3]||(u[3]=y=>d.value.action=y),label:"Action (I want to...)",required:"",rules:[y=>!!y||"Action is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:d.value.benefit,"onUpdate:modelValue":u[4]||(u[4]=y=>d.value.benefit=y),label:"Benefit (So that...)",required:"",rules:[y=>!!y||"Benefit is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:d.value.status,"onUpdate:modelValue":u[5]||(u[5]=y=>d.value.status=y),label:"Status",items:U,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[r("div",ps,[vs,e(te,{class:"w-100"},{default:a(()=>[e(R,{cols:"10",sm:"8"},{default:a(()=>[e(se,{modelValue:V.value,"onUpdate:modelValue":u[6]||(u[6]=y=>V.value=y),placeholder:"Add new criterion",density:"compact","hide-details":"",class:"me-2",onKeyup:_a(A,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(R,{cols:"2",sm:"4"},{default:a(()=>[e(I,{color:"primary",size:"small",disabled:!V.value.trim(),onClick:A},{default:a(()=>[i(" Add ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),d.value.acceptance_criteria&&d.value.acceptance_criteria.length>0?(o(),g($e,{key:0},{default:a(()=>[(o(!0),p(Q,null,re(d.value.acceptance_criteria,(y,ae)=>(o(),g(Ee,{key:ae},{prepend:a(()=>[e(b,{icon:"tabler-check",color:"success"})]),append:a(()=>[e(q,{color:"error",variant:"text",size:"small",onClick:L=>(N=>{d.value.acceptance_criteria.splice(N,1)})(ae)},{default:a(()=>[e(b,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:a(()=>[e(Oe,null,{default:a(()=>[i(n(y),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(o(),p("div",hs," No acceptance criteria added yet "))]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(o(),p("div",fs,[r("div",ys,[e(K,{color:c(ve)(t.userStory.status),size:"small",label:"",class:"me-2"},{default:a(()=>[i(n(Re(t.userStory.status)),1)]),_:1},8,["color"]),e(K,{color:"secondary",size:"small",label:"",class:"ms-2"},{default:a(()=>[i(" v"+n(t.userStory.version_number),1)]),_:1}),e(Z),r("div",gs,[e(b,{size:"18",icon:"tabler-calendar",class:"me-1"}),r("span",_s,"Updated: "+n(F(t.userStory.updated_at)),1),e(b,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),r("span",bs,"Created: "+n(F(t.userStory.created_at)),1)])]),r("div",xs,[r("div",ks,[ws,i(" "+n(t.userStory.role)+", ",1)]),r("div",Vs,[Cs,i(" "+n(t.userStory.action)+", ",1)]),r("div",Ss,[Ds,i(" "+n(t.userStory.benefit)+". ",1)])]),e(ee,{class:"mb-4"}),t.userStory.acceptance_criteria&&t.userStory.acceptance_criteria.length>0?(o(),p("div",Us,[qs,e($e,null,{default:a(()=>[(o(!0),p(Q,null,re(t.userStory.acceptance_criteria,(y,ae)=>(o(),g(Ee,{key:ae,class:"px-0"},{prepend:a(()=>[e(b,{icon:"tabler-check",color:"success",class:"me-2"})]),default:a(()=>[e(Oe,null,{default:a(()=>[i(n(y),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(o(),p("div",js," No acceptance criteria defined for this user story. ")),t.userStory.generation_status==="in_progress"?(o(),p("div",zs,[e(Xe,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:a(()=>[e(wa,null,{default:a(()=>[i("Regenerating User Story")]),_:1}),Fs]),_:1})])):S("",!0)]))]),_:1}),e(me,{value:"1"},{default:a(()=>[c(j).length===0?(o(),p("div",Ms,[e(b,{icon:"tabler-history",size:"64",color:"secondary",class:"mb-3"}),Is,Ps])):(o(),p("div",As,[e(Va,{density:"compact",align:"start"},{default:a(()=>[(o(!0),p(Q,null,re(c(j),(y,ae)=>(o(),g(Ca,{key:ae,"dot-color":"primary",size:"small"},{opposite:a(()=>[r("div",Ls,n(F(y.changed_at)),1),r("div",Rs,"v"+n(y.version_number),1)]),default:a(()=>[e(W,{border:""},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(je,{color:"primary",variant:"tonal",size:"36"},{default:a(()=>[e(b,{icon:"tabler-user-check"})]),_:1})]),append:a(()=>[e(K,{color:c(ve)(y.status),size:"small",label:"",class:"ms-2"},{default:a(()=>[i(n(y.status),1)]),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[Bs,i(" "+n(y.role),1)]),_:2},1024)]),_:2},1024),e(X,null,{default:a(()=>[r("p",Ts,[Ns,i(" "+n(y.action),1)]),r("p",$s,[Es,i(" "+n(y.benefit),1)]),y.acceptance_criteria&&y.acceptance_criteria.length>0?(o(),p("div",Os,[Hs,r("ul",Gs,[(o(!0),p(Q,null,re(y.acceptance_criteria,(L,N)=>(o(),p("li",{key:N},n(L),1))),128))])])):S("",!0),r("div",Js," Changed by: "+n(y.changed_by?y.changed_by.username:"System"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(me,{value:"2"},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:M.value,"onUpdate:modelValue":u[7]||(u[7]=y=>M.value=y),label:"Add a comment",rows:"3",counter:"",disabled:z.value},null,8,["modelValue","disabled"]),r("div",Ks,[e(I,{color:"primary",size:"small",loading:z.value,disabled:!M.value.trim(),onClick:B},{default:a(()=>[i(" Add Comment ")]),_:1},8,["loading","disabled"])])]),_:1}),e(R,{cols:"12"},{default:a(()=>[c(x).length?(o(),g(ee,{key:0,class:"mb-4"})):S("",!0),c(x).length===0?(o(),p("div",Xs,[e(b,{icon:"tabler-messages",size:"64",color:"secondary",class:"mb-3"}),Ys,Qs])):(o(),p("div",Zs,[(o(!0),p(Q,null,re(c(x),y=>(o(),p("div",{key:y.id,class:"comment-item mb-4"},[e(W,{border:""},{default:a(()=>[e(X,{class:"py-2"},{default:a(()=>[r("div",Ws,[e(je,{color:"primary",variant:"tonal",size:"36",class:"me-3"},{default:a(()=>[e(b,{icon:"tabler-user"})]),_:1}),r("div",null,[r("div",eo,[r("strong",null,n(y.user?y.user.username:"Unknown User"),1),r("div",ao,n(F(y.created_at)),1)])]),e(Z),t.isAdmin||t.hasManagerPermission?(o(),g(q,{key:0,size:"small",color:"error",variant:"text",onClick:ae=>(async L=>{z.value=!0;try{const{success:N,error:ge}=await _.deleteComment(L);if(N&&!ge){f("Comment deleted successfully");const{data:Ne}=await _.fetchUserStoryById(l.userStory.id);Ne&&Object.assign(l.userStory,Ne)}else f("Failed to delete comment","error")}catch(N){f("Failed to delete comment: "+N.message,"error")}finally{z.value=!1}})(y.id),disabled:z.value},{default:a(()=>[e(b,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick","disabled"])):S("",!0)]),r("div",to,n(y.text),1)]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[m.value?(o(),p(Q,{key:0},[e(I,{color:"secondary",variant:"tonal",onClick:k},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:G},{default:a(()=>[i(" Save Changes ")]),_:1})],64)):(o(),p(Q,{key:1},[t.isAdmin?(o(),g(I,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:O},{default:a(()=>[i(" Delete ")]),_:1})):S("",!0),t.hasModeratorPermission?(o(),g(I,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:T},{default:a(()=>[i(" Regenerate ")]),_:1})):S("",!0),e(Z),t.hasModeratorPermission?(o(),g(I,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:k},{default:a(()=>[i(" Edit ")]),_:1})):S("",!0)],64))]),_:1})]),_:1}),e(fe,{modelValue:C.value,"onUpdate:modelValue":u[11]||(u[11]=y=>C.value=y),"max-width":"600",persistent:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"pt-3 pb-0"},{default:a(()=>[i(" Regenerate User Story ")]),_:1}),e(X,null,{default:a(()=>[lo,e(he,{modelValue:$.value,"onUpdate:modelValue":u[9]||(u[9]=y=>$.value=y),label:"Feedback for Regeneration",placeholder:"Explain what you want to improve about this user story...",rows:"4",counter:""},null,8,["modelValue"])]),_:1}),e(oe,null,{default:a(()=>[e(I,{color:"secondary",variant:"tonal",onClick:u[10]||(u[10]=y=>C.value=!1)},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:E},{default:a(()=>[i(" Regenerate ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ye,{modelValue:P.value.show,"onUpdate:modelValue":u[13]||(u[13]=y=>P.value.show=y),color:P.value.color,timeout:5e3},{actions:a(()=>[e(q,{onClick:u[12]||(u[12]=y=>P.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(P.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-5ae692aa"]]),so={class:"text-h5"},oo=r("div",{class:"text-subtitle-1 font-weight-medium"},"Acceptance Criteria",-1),io={class:"d-flex align-center justify-space-between mb-3"},no={key:1,class:"text-medium-emphasis text-center pa-4 rounded bg-grey-lighten-5"},uo={__name:"UserStoryCreateDialog",props:{modelValue:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},userStoryData:{type:Object,default:()=>({})}},emits:["update:modelValue","submit"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:j=>s("update:modelValue",j)}),_=D({role:l.editMode&&l.userStoryData?l.userStoryData.role:"",action:l.editMode&&l.userStoryData?l.userStoryData.action:"",benefit:l.editMode&&l.userStoryData?l.userStoryData.benefit:"",acceptance_criteria:l.editMode&&l.userStoryData?[...l.userStoryData.acceptance_criteria]:[],status:l.editMode&&l.userStoryData?l.userStoryData.status:"draft"}),h=D(""),m=D(null),d=[j=>!!j||"Role is required"],V=[j=>!!j||"Action is required"],M=[j=>!!j||"Benefit is required"],$=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],C=()=>{h.value.trim()&&(_.value.acceptance_criteria||(_.value.acceptance_criteria=[]),_.value.acceptance_criteria.push(h.value.trim()),h.value="")},z=()=>{_.value={role:"",action:"",benefit:"",acceptance_criteria:[],status:"draft"},h.value="",m.value&&m.value.resetValidation()},P=()=>{v.value=!1,z()},U=async()=>{const{valid:j}=await m.value.validate();j&&(s("submit",_.value),v.value=!1,z())};return De(v,j=>{j||z()}),(j,x)=>{const F=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":x[5]||(x[5]=k=>ze(v)?v.value=k:null),"max-width":"700",persistent:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex pt-5 px-5"},{default:a(()=>[r("h5",so,n(l.editMode?"Edit User Story":"Create New User Story"),1),e(Z),e(F,{onClick:P},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(X,{class:"px-5 pt-4"},{default:a(()=>[e(Fe,{ref_key:"formRef",ref:m,onSubmit:ke(U,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:_.value.role,"onUpdate:modelValue":x[0]||(x[0]=k=>_.value.role=k),label:"Role (As a...)",rules:d,placeholder:"e.g. registered user, system administrator, customer",required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:_.value.action,"onUpdate:modelValue":x[1]||(x[1]=k=>_.value.action=k),label:"Action (I want to...)",rules:V,placeholder:"e.g. search for products, export reports, reset my password",required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:_.value.benefit,"onUpdate:modelValue":x[2]||(x[2]=k=>_.value.benefit=k),label:"Benefit (So that...)",rules:M,placeholder:"e.g. I can find what I need quickly, I can analyze the data offline",required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:_.value.status,"onUpdate:modelValue":x[3]||(x[3]=k=>_.value.status=k),label:"Status",items:$,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[oo,r("div",io,[e(te,{class:"w-100"},{default:a(()=>[e(R,{cols:"10",sm:"8"},{default:a(()=>[e(se,{modelValue:h.value,"onUpdate:modelValue":x[4]||(x[4]=k=>h.value=k),placeholder:"Add new criterion",density:"compact","hide-details":"",class:"me-2",onKeyup:_a(C,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(R,{cols:"2",sm:"4"},{default:a(()=>[e(I,{color:"primary",size:"small",disabled:!h.value.trim(),onClick:C},{default:a(()=>[i(" Add ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_.value.acceptance_criteria&&_.value.acceptance_criteria.length>0?(o(),g($e,{key:0},{default:a(()=>[(o(!0),p(Q,null,re(_.value.acceptance_criteria,(k,A)=>(o(),g(Ee,{key:A},{prepend:a(()=>[e(b,{icon:"tabler-check",color:"success"})]),append:a(()=>[e(F,{color:"error",variant:"text",size:"small",onClick:G=>(O=>{_.value.acceptance_criteria.splice(O,1)})(A)},{default:a(()=>[e(b,{icon:"tabler-trash",size:"18"})]),_:2},1032,["onClick"])]),default:a(()=>[e(Oe,null,{default:a(()=>[i(n(k),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(o(),p("div",no," No acceptance criteria added yet. Add at least one criterion to help clarify when this user story is considered done. "))]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[e(I,{variant:"tonal",color:"secondary",onClick:P},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:U},{default:a(()=>[i(n(l.editMode?"Update":"Create")+" User Story ",1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Qe=t=>(be("data-v-50fff0f2"),t=t(),xe(),t),co={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},mo={key:1,class:"text-center pa-4"},po=Qe(()=>r("h4",{class:"text-h6 mb-2"},"No User Stories Found",-1)),vo={class:"text-body-1 text-medium-emphasis mb-6"},ho={class:"text-body-1 mb-2"},fo=Qe(()=>r("span",{class:"font-weight-medium text-primary"},"I want to:",-1)),yo={class:"text-body-1 mb-4"},go=Qe(()=>r("span",{class:"font-weight-medium text-primary"},"So that:",-1)),_o={key:0},bo=Qe(()=>r("div",{class:"text-subtitle-2 font-weight-medium mb-2 text-primary"},"Acceptance Criteria:",-1)),xo={class:"ml-4"},ko={key:0},wo={class:"d-flex align-center justify-space-between mt-3"},Vo={class:"d-flex align-center"},Co={class:"text-caption"},So={class:"d-flex align-center"},Do={class:"text-caption"},Uo=_e({__name:"UserStoriesList",props:{projectId:{type:String,required:!0},requirementId:{type:String,required:!1,default:null},userStories:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(t,{emit:s}){const l=t,v=ia(),_=Me(),h=D(""),m=D(["draft","active","completed"]),d=D(null),V=D(!1),M=D(!1),$=D(!1),C=D(!1),z=D({show:!1,text:"",color:"success"}),P=H(()=>_.is_admin()),U=H(()=>_.userData.role>=2),j=H(()=>_.userData.role>=3),x=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],F=H(()=>l.userStories.filter(B=>{const f=!h.value||B.role.toLowerCase().includes(h.value.toLowerCase())||B.action.toLowerCase().includes(h.value.toLowerCase())||B.benefit.toLowerCase().includes(h.value.toLowerCase()),w=m.value.includes(B.status);return f&&w})),k=()=>{M.value=!0},A=async B=>{C.value=!0;try{const{data:f,error:w}=await v.createUserStory({...B,requirement:l.requirementId});f&&!w?(E("User story created successfully"),s("refresh")):E("Failed to create user story","error")}catch(f){E("Failed to create user story: "+f.message,"error")}finally{C.value=!1}},G=async B=>{C.value=!0;try{const{data:f,error:w}=await v.updateUserStory(d.value.id,B);f&&!w?(E("User story updated successfully"),s("refresh")):E("Failed to update user story","error")}catch(f){E("Failed to update user story: "+f.message,"error")}finally{C.value=!1}},O=async()=>{if(d.value){C.value=!0,$.value=!1;try{const{success:B,error:f}=await v.deleteUserStory(d.value.id);B&&!f?(E("User story deleted successfully"),s("refresh"),V.value=!1):E("Failed to delete user story","error")}catch(B){E("Failed to delete user story: "+B.message,"error")}finally{C.value=!1}}},T=async(B="")=>{if(d.value){C.value=!0;try{const{data:f,error:w}=await v.regenerateUserStory(d.value.id,B);f&&!w?(E("User story regeneration started"),setTimeout(()=>{s("refresh")},3e3)):E("Failed to regenerate user story","error")}catch(f){E("Failed to regenerate user story: "+f.message,"error")}finally{C.value=!1}}},E=(B,f="success")=>{z.value={show:!0,text:B,color:f}};return ra(()=>{!l.requirementId||l.userStories.length||l.loading||v.fetchUserStories(l.requirementId).then(({data:B})=>{B&&s("refresh")})}),(B,f)=>{const w=Be,u=pe("IconBtn");return o(),g(X,{class:"pa-6"},{default:a(()=>[e(te,null,{default:a(()=>[e(R,{cols:"12",md:"6"},{default:a(()=>[e(se,{modelValue:h.value,"onUpdate:modelValue":f[0]||(f[0]=q=>h.value=q),density:"compact",placeholder:"Search user stories...","prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"4"},{default:a(()=>[e(ie,{modelValue:m.value,"onUpdate:modelValue":f[1]||(f[1]=q=>m.value=q),items:x,density:"compact","hide-details":"",label:"Status",variant:"outlined",multiple:"",chips:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"2",class:"d-flex align-center"},{default:a(()=>[c(j)&&t.requirementId?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:k,loading:C.value,block:""},{default:a(()=>[i(" Add ")]),_:1},8,["loading"])):S("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),t.loading?(o(),p("div",co,[e(Se,{indeterminate:"",color:"primary"})])):c(F).length===0?(o(),p("div",mo,[e(b,{icon:"tabler-notebook",size:"64",color:"secondary",class:"mb-4"}),po,r("p",vo,n(h.value||m.value.length>0?"Try adjusting your filters to see more results.":"This requirement does not have any user stories yet."),1),c(j)&&t.requirementId&&!h.value&&m.value.length===0?(o(),g(I,{key:0,color:"primary",onClick:k,"prepend-icon":"tabler-plus"},{default:a(()=>[i(" Add User Story ")]),_:1})):S("",!0)])):(o(),g(te,{key:2},{default:a(()=>[(o(!0),p(Q,null,re(c(F),q=>(o(),g(R,{key:q.id,cols:"12",md:"6"},{default:a(()=>[e(W,{class:"user-story-card h-100 d-flex flex-column",onClick:y=>(ae=>{d.value=ae,V.value=!0})(q),border:"",hover:""},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(je,{color:"primary",variant:"tonal",size:"42"},{default:a(()=>[e(b,{icon:"tabler-user-check"})]),_:1})]),append:a(()=>[e(K,{color:c(ve)(q.status),size:"small",label:""},{default:a(()=>[i(n(q.status),1)]),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i("As a "+n(q.role),1)]),_:2},1024)]),_:2},1024),e(X,{class:"d-flex flex-column"},{default:a(()=>{return[r("p",ho,[fo,i(" "+n(q.action),1)]),r("p",yo,[go,i(" "+n(q.benefit),1)]),q.acceptance_criteria&&q.acceptance_criteria.length>0?(o(),p("div",_o,[bo,r("ul",xo,[(o(!0),p(Q,null,re(q.acceptance_criteria.slice(0,2),(ae,L)=>(o(),p("li",{key:L},n(ae),1))),128)),q.acceptance_criteria.length>2?(o(),p("li",ko," ...and "+n(q.acceptance_criteria.length-2)+" more ",1)):S("",!0)])])):S("",!0),e(Z),r("div",wo,[r("div",Vo,[e(b,{size:"16",icon:"tabler-calendar",class:"me-1"}),r("span",Co,n((y=q.updated_at,y?(y=parseInt(y),new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)]),r("div",So,[e(b,{size:"16",icon:"tabler-history",class:"me-1"}),r("span",Do,"v"+n(q.version_number),1)])])];var y}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),d.value?(o(),g(ro,{key:3,modelValue:V.value,"onUpdate:modelValue":f[2]||(f[2]=q=>V.value=q),"user-story":d.value,onDelete:f[3]||(f[3]=q=>$.value=!0),onUpdate:G,onRegenerate:T,"is-admin":c(P),"has-manager-permission":c(U),"has-moderator-permission":c(j)},null,8,["modelValue","user-story","is-admin","has-manager-permission","has-moderator-permission"])):S("",!0),e(uo,{modelValue:M.value,"onUpdate:modelValue":f[4]||(f[4]=q=>M.value=q),onSubmit:A},null,8,["modelValue"]),e(w,{isDialogVisible:$.value,"onUpdate:isDialogVisible":f[5]||(f[5]=q=>$.value=q),confirmationMsg:"Are you sure you want to delete this user story? This action cannot be undone.",onConfirm:O},null,8,["isDialogVisible"]),e(ye,{modelValue:z.value.show,"onUpdate:modelValue":f[7]||(f[7]=q=>z.value.show=q),color:z.value.color,timeout:5e3},{actions:a(()=>[e(u,{onClick:f[6]||(f[6]=q=>z.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(z.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-50fff0f2"]]),Te=t=>(be("data-v-9ece2766"),t=t(),xe(),t),qo={key:0,class:"text-h5"},jo={class:"text-h5"},zo={key:0},Fo=Te(()=>r("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Diagram Content (SVG)",-1)),Mo={class:"bg-grey-lighten-5 rounded pa-3"},Io=Te(()=>r("div",{class:"text-medium-emphasis text-caption mb-2"}," Note: Direct editing of diagram content is not recommended. Use the Regenerate button to create a new version instead. ",-1)),Po={key:1},Ao={key:0,class:"pa-5"},Lo=Te(()=>r("p",null,"This diagram is currently being generated. Please check back shortly.",-1)),Ro={class:"d-flex justify-center my-8"},Bo={class:"d-flex align-center justify-center text-medium-emphasis"},To={class:"text-caption me-4"},No={class:"text-caption"},$o={key:1,class:"diagram-content pa-0"},Eo={class:"diagram-metadata d-flex align-center px-6 py-3"},Oo={key:0,class:"ms-2"},Ho={class:"text-medium-emphasis d-flex align-center"},Go={class:"text-caption me-4"},Jo={class:"text-caption"},Ko={key:2,class:"d-flex flex-column justify-center align-center pa-6",style:{height:"400px"}},Xo=Te(()=>r("h4",{class:"text-h6 mb-2"},"No Diagram Content",-1)),Yo=Te(()=>r("p",{class:"text-medium-emphasis text-center"}," This diagram doesn't have any content to display. Try regenerating it. ",-1)),Qo=_e({__name:"UmlDiagramDetailsDialog",props:{modelValue:{type:Boolean,default:!1},diagram:{type:Object,required:!0},isAdmin:{type:Boolean,default:!1},hasManagerPermission:{type:Boolean,default:!1},hasModeratorPermission:{type:Boolean,default:!1}},emits:["update:modelValue","delete","regenerate"],setup(t,{emit:s}){const l=t,v=H({get:()=>l.modelValue,set:A=>s("update:modelValue",A)}),_=na(),h=D(!1),m=D(!1),d=D({...l.diagram}),V=D(!1),M=D({show:!1,text:"",color:"success"}),$=[{title:"Draft",value:"draft"},{title:"Active",value:"active"},{title:"Archived",value:"archived"},{title:"Completed",value:"completed"}],C=A=>A?(A=parseInt(A),new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})):"",z=A=>{switch(A.toLowerCase()){case"class":return"Class Diagram";case"sequence":return"Sequence Diagram";case"activity":return"Activity Diagram";case"usecase":return"Use Case Diagram";case"state":return"State Diagram";case"component":return"Component Diagram";case"deployment":return"Deployment Diagram";case"er":return"ER Diagram";default:return A.charAt(0).toUpperCase()+A.slice(1)+" Diagram"}},P=()=>{h.value=!h.value},U=()=>{m.value&&(d.value={...l.diagram}),m.value=!m.value},j=async()=>{V.value=!0;try{const{data:A,error:G}=await _.updateDiagram(l.diagram.id,d.value);A&&!G?(k("UML diagram updated successfully"),Object.assign(l.diagram,A),m.value=!1):k("Failed to update UML diagram","error")}catch(A){k("Failed to update UML diagram: "+A.message,"error")}finally{V.value=!1}},x=()=>{s("delete")},F=async()=>{V.value=!0;try{const{data:A,error:G}=await _.regenerateDiagram(l.diagram.id);A&&!G?(k("UML diagram regeneration started"),setTimeout(()=>{s("regenerate")},3e3)):k("Failed to regenerate UML diagram","error")}catch(A){k("Failed to regenerate UML diagram: "+A.message,"error")}finally{V.value=!1}},k=(A,G="success")=>{M.value={show:!0,text:A,color:G}};return De(()=>l.diagram,A=>{d.value={...A}},{deep:!0}),(A,G)=>{const O=pe("IconBtn");return o(),g(fe,{modelValue:c(v),"onUpdate:modelValue":G[7]||(G[7]=T=>ze(v)?v.value=T:null),fullscreen:h.value,"max-width":h.value?"100%":"900",scrollable:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"d-flex py-3 px-5"},{default:a(()=>[m.value?(o(),p("h5",qo,"Edit UML Diagram")):(o(),p(Q,{key:1},[r("h5",jo,n(t.diagram.name),1),e(K,{class:"ms-2",color:"secondary",size:"small",label:""},{default:a(()=>[i(n(z(t.diagram.diagram_type)),1)]),_:1})],64)),e(Z),e(I,{icon:"",variant:"text",onClick:P},{default:a(()=>[e(b,{icon:h.value?"tabler-minimize":"tabler-maximize"},null,8,["icon"])]),_:1}),e(O,{onClick:G[0]||(G[0]=T=>v.value=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),_:1}),e(ee),e(X,{class:la({"pa-0":!m.value&&t.diagram.content,"pa-6":m.value||!t.diagram.content}),style:Ae({height:h.value?"calc(100vh - 120px)":"70vh",maxHeight:"800px"})},{default:a(()=>[m.value?(o(),p("div",zo,[e(Fe,{onSubmit:ke(j,["prevent"])},{default:a(()=>[e(te,{class:"mt-3"},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(se,{modelValue:d.value.name,"onUpdate:modelValue":G[1]||(G[1]=T=>d.value.name=T),label:"Diagram Name",required:"",rules:[T=>!!T||"Name is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:a(()=>[e(ie,{modelValue:d.value.status,"onUpdate:modelValue":G[2]||(G[2]=T=>d.value.status=T),label:"Status",items:$,required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[e(he,{modelValue:d.value.notes,"onUpdate:modelValue":G[3]||(G[3]=T=>d.value.notes=T),label:"Notes",rows:"4"},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:a(()=>[Fo,r("div",Mo,[Io,e(he,{modelValue:d.value.content,"onUpdate:modelValue":G[4]||(G[4]=T=>d.value.content=T),rows:"15",monospace:"","hide-details":""},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])):(o(),p("div",Po,[t.diagram.generation_status==="in_progress"?(o(),p("div",Ao,[e(Xe,{color:"info",variant:"tonal",icon:"tabler-refresh"},{default:a(()=>[e(wa,null,{default:a(()=>[i("Generating Diagram")]),_:1}),Lo]),_:1}),r("div",Ro,[e(Se,{indeterminate:"",color:"primary",size:"64"})]),r("div",Bo,[e(b,{size:"18",icon:"tabler-calendar",class:"me-1"}),r("span",To,"Updated: "+n(C(t.diagram.updated_at)),1),e(b,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),r("span",No,"Created: "+n(C(t.diagram.created_at)),1)])])):t.diagram.content?(o(),p("div",$o,[r("div",Eo,[e(K,{color:c(ve)(t.diagram.status),size:"small",label:"",class:"me-2"},{default:a(()=>[i(n(t.diagram.status),1)]),_:1},8,["color"]),t.diagram.notes?(o(),p("div",Oo,[e(Ea,null,{activator:a(({props:T})=>[e(b,ba({icon:"tabler-info-circle",size:"18",color:"info"},T),null,16)]),default:a(()=>[r("span",null,n(t.diagram.notes),1)]),_:1})])):S("",!0),e(Z),r("div",Ho,[e(b,{size:"18",icon:"tabler-calendar",class:"me-1"}),r("span",Go,"Updated: "+n(C(t.diagram.updated_at)),1),e(b,{size:"18",icon:"tabler-calendar-plus",class:"me-1"}),r("span",Jo,"Created: "+n(C(t.diagram.created_at)),1)])]),e(ee),r("div",{class:"diagram-svg-container pa-4 d-flex justify-center align-center",style:Ae({height:h.value?"calc(100vh - 180px)":"calc(70vh - 110px)",overflow:"auto"})},[t.diagram.content?(o(),g(xa,{key:0,src:c(ka)(t.diagram.content),class:"diagram-svg",alt:"Generated Diagram"},null,8,["src"])):S("",!0)],4)])):(o(),p("div",Ko,[e(b,{icon:"tabler-chart-dots-2",size:"64",color:"secondary",class:"mb-4"}),Xo,Yo]))]))]),_:1},8,["class","style"]),e(ee),e(oe,{class:"pa-4"},{default:a(()=>[m.value?(o(),p(Q,{key:0},[e(I,{color:"secondary",variant:"tonal",onClick:U,disabled:V.value},{default:a(()=>[i(" Cancel ")]),_:1},8,["disabled"]),e(Z),e(I,{color:"primary",onClick:j,loading:V.value},{default:a(()=>[i(" Save Changes ")]),_:1},8,["loading"])],64)):(o(),p(Q,{key:1},[t.isAdmin?(o(),g(I,{key:0,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:x},{default:a(()=>[i(" Delete ")]),_:1})):S("",!0),t.hasModeratorPermission?(o(),g(I,{key:1,color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"ms-2",onClick:F,loading:V.value},{default:a(()=>[i(" Regenerate ")]),_:1},8,["loading"])):S("",!0),e(Z),t.hasModeratorPermission?(o(),g(I,{key:2,color:"primary","prepend-icon":"tabler-edit",onClick:U},{default:a(()=>[i(" Edit ")]),_:1})):S("",!0)],64))]),_:1})]),_:1}),e(ye,{modelValue:M.value.show,"onUpdate:modelValue":G[6]||(G[6]=T=>M.value.show=T),color:M.value.color,timeout:5e3},{actions:a(()=>[e(O,{onClick:G[5]||(G[5]=T=>M.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(M.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["modelValue","fullscreen","max-width"])}}},[["__scopeId","data-v-9ece2766"]]),Ze=t=>(be("data-v-f1e2d8ab"),t=t(),xe(),t),Zo={key:0,class:"d-flex justify-center align-center",style:{height:"300px"}},Wo={key:1,class:"text-center pa-4"},ei=Ze(()=>r("h4",{class:"text-h6 mb-2"},"No UML Diagrams Found",-1)),ai={class:"text-body-1 text-medium-emphasis mb-6"},ti={class:"mb-3 d-flex align-center"},li={class:"diagram-preview mb-3"},ri={class:"overflow-hidden position-relative rounded bg-grey-lighten-4",style:{height:"150px"}},si={class:"d-flex justify-center align-center h-100"},oi={key:0,class:"text-center pa-2"},ii=Ze(()=>r("div",{class:"text-caption"},"Generating diagram...",-1)),ni={key:1,class:"diagram-thumbnail pa-2"},ui={key:2,class:"text-center"},di=Ze(()=>r("div",{class:"text-caption mt-2"},"Preview not available",-1)),ci={class:"preview-overlay d-flex justify-center align-center"},mi={class:"d-flex align-center justify-space-between"},pi={class:"d-flex align-center"},vi={class:"text-caption"},hi=Ze(()=>r("p",{class:"text-body-1 mb-4"}," Select the type of UML diagram you want to generate for this project. The system will analyze the requirements and create an appropriate diagram. ",-1)),fi=_e({__name:"UmlDiagramList",props:{projectId:{type:String,required:!0},diagrams:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(t,{emit:s}){const l=t,v=na(),_=Me(),h=D(""),m=D("all"),d=D(null),V=D(!1),M=D(!1),$=D(!1),C=D(!1),z=D({show:!1,text:"",color:"success"}),P=H(()=>_.is_admin()),U=H(()=>_.userData.role>=2),j=H(()=>_.userData.role>=3),x=[{title:"All Diagram Types",value:"all"},{title:"Class Diagram",value:"class"},{title:"Sequence Diagram",value:"sequence"},{title:"Activity Diagram",value:"activity"},{title:"Use Case Diagram",value:"usecase"},{title:"State Diagram",value:"state"},{title:"Component Diagram",value:"component"},{title:"Deployment Diagram",value:"deployment"},{title:"ER Diagram",value:"er"}],F=D("class"),k=H(()=>l.diagrams.filter(f=>{const w=!h.value||f.name.toLowerCase().includes(h.value.toLowerCase())||f.diagram_type.toLowerCase().includes(h.value.toLowerCase()),u=m.value==="all"||f.diagram_type.toLowerCase()===m.value.toLowerCase();return w&&u})),A=()=>{F.value="class",$.value=!0},G=async()=>{$.value=!1,C.value=!0;try{const{data:f,error:w}=await v.generateDiagrams(l.projectId,F.value);f&&!w?(T(`${F.value.charAt(0).toUpperCase()+F.value.slice(1)} diagram generation started`),setTimeout(()=>{s("refresh")},3e3)):T("Failed to generate UML diagrams","error")}catch(f){T("Failed to generate UML diagrams: "+f.message,"error")}finally{C.value=!1}},O=async()=>{if(d.value){C.value=!0,M.value=!1;try{const{success:f,error:w}=await v.deleteDiagram(d.value.id);f&&!w?(T("UML diagram deleted successfully"),s("refresh"),V.value=!1):T("Failed to delete UML diagram","error")}catch(f){T("Failed to delete UML diagram: "+f.message,"error")}finally{C.value=!1}}},T=(f,w="success")=>{z.value={show:!0,text:f,color:w}},E=f=>{switch(f.toLowerCase()){case"class":return"tabler-box";case"sequence":return"tabler-arrow-right-square";case"activity":return"tabler-activity";case"usecase":return"tabler-user-check";case"state":return"tabler-circle-check";case"component":return"tabler-puzzle";case"deployment":return"tabler-server";case"er":return"tabler-database";default:return"tabler-chart-dots"}},B=f=>{switch(f.toLowerCase()){case"class":return"Class Diagram";case"sequence":return"Sequence Diagram";case"activity":return"Activity Diagram";case"usecase":return"Use Case Diagram";case"state":return"State Diagram";case"component":return"Component Diagram";case"deployment":return"Deployment Diagram";case"er":return"ER Diagram";default:return f.charAt(0).toUpperCase()+f.slice(1)+" Diagram"}};return ra(()=>{!l.projectId||l.diagrams.length||l.loading||v.fetchDiagrams(l.projectId).then(({data:f})=>{f&&s("refresh")})}),(f,w)=>{const u=Be,q=pe("IconBtn");return o(),g(X,{class:"pa-6"},{default:a(()=>[e(te,null,{default:a(()=>[e(R,{cols:"12",md:"4"},{default:a(()=>[e(se,{modelValue:h.value,"onUpdate:modelValue":w[0]||(w[0]=y=>h.value=y),density:"compact",placeholder:"Search diagrams...","prepend-inner-icon":"tabler-search","hide-details":"",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"4"},{default:a(()=>[e(ie,{modelValue:m.value,"onUpdate:modelValue":w[1]||(w[1]=y=>m.value=y),items:x,density:"compact","hide-details":"",label:"Diagram Type",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"4",class:"d-flex align-center"},{default:a(()=>[c(j)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:A,loading:C.value,block:""},{default:a(()=>[i(" Generate Diagram ")]),_:1},8,["loading"])):S("",!0)]),_:1})]),_:1}),e(ee,{class:"my-5"}),t.loading?(o(),p("div",Zo,[e(Se,{indeterminate:"",color:"primary"})])):c(k).length===0?(o(),p("div",Wo,[e(b,{icon:"tabler-chart-dots",size:"64",color:"secondary",class:"mb-4"}),ei,r("p",ai,n(h.value||m.value!=="all"?"Try adjusting your filters to see more results.":"This project does not have any UML diagrams yet."),1),c(j)&&!h.value&&m.value==="all"?(o(),g(I,{key:0,color:"primary",onClick:A,"prepend-icon":"tabler-plus"},{default:a(()=>[i(" Generate UML Diagram ")]),_:1})):S("",!0)])):(o(),g(te,{key:2},{default:a(()=>[(o(!0),p(Q,null,re(c(k),y=>(o(),g(R,{key:y.id,cols:"12",md:"6",lg:"4"},{default:a(()=>[e(W,{class:"diagram-card h-100",onClick:ae=>(L=>{d.value=L,V.value=!0})(y),border:"",hover:""},{default:a(()=>[e(ne,null,{prepend:a(()=>[e(je,{color:"primary",variant:"tonal",size:"42"},{default:a(()=>[e(b,{icon:E(y.diagram_type)},null,8,["icon"])]),_:2},1024)]),append:a(()=>[e(K,{color:c(ve)(y.status),size:"small",label:""},{default:a(()=>[i(n(y.status),1)]),_:2},1032,["color"])]),default:a(()=>[e(le,null,{default:a(()=>[i(n(y.name),1)]),_:2},1024)]),_:2},1024),e(X,null,{default:a(()=>{return[r("div",ti,[e(K,{color:"secondary",size:"small",label:"",class:"me-2"},{default:a(()=>[i(n(B(y.diagram_type)),1)]),_:2},1024)]),r("div",li,[r("div",ri,[r("div",si,[y.generation_status==="in_progress"?(o(),p("div",oi,[e(Se,{indeterminate:"",color:"primary",size:"40",class:"mb-2"}),ii])):y.content?(o(),p("div",ni,[y.content?(o(),g(xa,{key:0,src:c(ka)(y.content),class:"diagram-svg",alt:"Generated Diagram"},null,8,["src"])):S("",!0)])):(o(),p("div",ui,[e(b,{icon:E(y.diagram_type),size:"48",color:"secondary"},null,8,["icon"]),di]))]),r("div",ci,[e(I,{color:"primary",variant:"elevated",size:"small","prepend-icon":"tabler-eye"},{default:a(()=>[i(" View Diagram ")]),_:1})])])]),r("div",mi,[r("div",pi,[e(b,{size:"16",icon:"tabler-calendar",class:"me-1"}),r("span",vi,n((ae=y.created_at,ae?(ae=parseInt(ae),new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})):"")),1)])])];var ae}),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),d.value?(o(),g(Qo,{key:3,modelValue:V.value,"onUpdate:modelValue":w[2]||(w[2]=y=>V.value=y),diagram:d.value,onDelete:w[3]||(w[3]=y=>M.value=!0),"is-admin":c(P),"has-manager-permission":c(U),"has-moderator-permission":c(j)},null,8,["modelValue","diagram","is-admin","has-manager-permission","has-moderator-permission"])):S("",!0),e(fe,{modelValue:$.value,"onUpdate:modelValue":w[6]||(w[6]=y=>$.value=y),"max-width":"600",persistent:""},{default:a(()=>[e(W,null,{default:a(()=>[e(le,{class:"pt-5 pb-2"},{default:a(()=>[i(" Generate UML Diagram ")]),_:1}),e(X,null,{default:a(()=>[hi,e(ie,{modelValue:F.value,"onUpdate:modelValue":w[4]||(w[4]=y=>F.value=y),items:[{title:"Class Diagram",value:"class"},{title:"Sequence Diagram",value:"sequence"},{title:"Activity Diagram",value:"activity"},{title:"Use Case Diagram",value:"usecase"},{title:"State Diagram",value:"state"},{title:"Component Diagram",value:"component"}],label:"Diagram Type"},null,8,["modelValue"])]),_:1}),e(oe,null,{default:a(()=>[e(I,{color:"secondary",variant:"tonal",onClick:w[5]||(w[5]=y=>$.value=!1)},{default:a(()=>[i(" Cancel ")]),_:1}),e(Z),e(I,{color:"primary",onClick:G},{default:a(()=>[i(" Generate ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(u,{isDialogVisible:M.value,"onUpdate:isDialogVisible":w[7]||(w[7]=y=>M.value=y),confirmationMsg:"Are you sure you want to delete this UML diagram? This action cannot be undone.",onConfirm:O},null,8,["isDialogVisible"]),e(ye,{modelValue:z.value.show,"onUpdate:modelValue":w[9]||(w[9]=y=>z.value.show=y),color:z.value.color,timeout:5e3},{actions:a(()=>[e(q,{onClick:w[8]||(w[8]=y=>z.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(z.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}},[["__scopeId","data-v-f1e2d8ab"]]),yi=r("thead",null,[r("tr",null,[r("th",null,"Template"),r("th",null,"Format"),r("th",null,"Status"),r("th",null,"Created By"),r("th",null,"Created At"),r("th",null,"Actions")])],-1),gi={key:2,class:"d-flex justify-center align-center",style:{"min-height":"200px"}},_i={__name:"ProjectExportsList",props:{projectId:{type:String,required:!0},exports:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(t,{emit:s}){const l=v=>{switch(v){case"active":return"success";case"pending":return"warning";case"failed":return"error";default:return"grey"}};return(v,_)=>(o(),g(W,null,{default:a(()=>[e(X,null,{default:a(()=>[!t.loading&&t.exports.length>0?(o(),g(He,{key:0},{default:a(()=>[yi,r("tbody",null,[(o(!0),p(Q,null,re(t.exports,h=>{return o(),p("tr",{key:h.id},[r("td",null,n(h.template.name),1),r("td",null,n(h.fmt.toUpperCase()),1),r("td",null,[e(K,{color:l(h.status),size:"small"},{default:a(()=>[i(n(h.status),1)]),_:2},1032,["color"])]),r("td",null,n(h.created_by.username),1),r("td",null,n((m=h.created_at,new Date(parseInt(m)).toLocaleString())),1),r("td",null,[h.url?(o(),g(I,{key:0,icon:"",variant:"text",color:"primary",onClick:d=>(V=>{V.url&&window.open(V.url,"_blank")})(h)},{default:a(()=>[e(b,{icon:"tabler-download"})]),_:2},1032,["onClick"])):S("",!0)])]);var m}),128))])]),_:1})):t.loading||t.exports.length!==0?(o(),p("div",gi,[e(Se,{indeterminate:"",color:"primary",size:"64"})])):(o(),g(Xe,{key:1,type:"info",variant:"tonal",class:"mt-4"},{default:a(()=>[i(" No exports found ")]),_:1}))]),_:1})]),_:1}))}},bi={class:"text-center"},xi={class:"d-flex flex-wrap justify-space-between align-center"},ki={class:"d-flex align-center"},wi={class:"text-h3"},Vi={class:"d-flex align-center mt-3 mt-sm-0"},Ci={__name:"[id]",setup(t){const s=Ra(),l=Ba(),v=Ta();ia();const _=na(),h=Me(),m=D(!0),d=D(null),V=D("0"),M=D(!1),$=D(!1),C=D(!1),z=D({show:!1,text:"",color:"success"}),P=H(()=>s.params.id),U=H(()=>v.currentProject),j=H(()=>h.is_admin()),x=H(()=>h.userData.role>=2),F=H(()=>h.userData.role>=3),k=D(null),A=D(!1),G=[{title:"Markdown",value:"md",icon:"tabler-markdown"},{title:"PDF",value:"pdf",icon:"tabler-file-text"},{title:"HTML",value:"html",icon:"tabler-code"}],O=async()=>{m.value=!0,d.value=null;try{const{data:L,error:N}=await v.fetchProjectById(P.value);N&&(d.value=N,T("Failed to load project details","error"))}catch(L){d.value=L.message||"Failed to load project details",T("Failed to load project details","error")}finally{m.value=!1}},T=(L,N="success")=>{z.value={show:!0,text:L,color:N}},E=()=>{M.value=!0},B=async(L=!1)=>{if(L){$.value=!1,C.value=!0;try{const{success:N,error:ge}=await v.deleteProject(P.value);N&&!ge?(T("Project deleted successfully"),l.push({name:"projects"})):T("Failed to delete project","error")}catch(N){T("Failed to delete project: "+N.message,"error")}finally{C.value=!1}}},f=async L=>{C.value=!0;try{const{data:N,error:ge}=await v.updateProject(P.value,L);N&&!ge?T("Project updated successfully"):T("Failed to update project","error")}catch(N){T("Failed to update project: "+N.message,"error")}finally{C.value=!1}},w=async()=>{setTimeout(()=>{O()},9e3)},u=async()=>{C.value=!0;try{const{data:L,error:N}=await v.generateRequirements(P.value);L&&!N?(T("Requirements generation started successfully"),w()):T("Failed to start requirements generation","error")}catch(L){T("Failed to start requirements generation: "+L.message,"error")}finally{C.value=!1}},q=async()=>{C.value=!0;try{const{data:L,error:N}=await v.generatePlan(P.value);L&&!N?(T("Development plan generation started successfully"),w()):T("Failed to start development plan generation","error")}catch(L){T("Failed to start development plan generation: "+L.message,"error")}finally{C.value=!1}},y=async()=>{C.value=!0;try{const{data:L,error:N}=await v.generateMockups(P.value);L&&!N?(T("Mockups generation started successfully"),w()):T("Failed to start mockups generation","error")}catch(L){T("Failed to start mockups generation: "+L.message,"error")}finally{C.value=!1}},ae=L=>{k.value=L,V.value="2"};return ra(()=>{O()}),(L,N)=>{const ge=Be,Ne=pe("IconBtn");return o(),g($a,{fluid:""},{default:a(()=>[m.value&&!c(U)?(o(),g(te,{key:0},{default:a(()=>[e(R,{cols:"12",class:"d-flex justify-center align-center",style:{"min-height":"400px"}},{default:a(()=>[e(Se,{indeterminate:"",color:"primary",size:"64"})]),_:1})]),_:1})):d.value&&!c(U)?(o(),g(te,{key:1},{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(Xe,{color:"error",variant:"tonal",title:"Error Loading Project",text:"There was an error loading the project details",class:"mb-4"}),r("div",bi,[e(I,{color:"primary",onClick:O},{default:a(()=>[i(" Retry ")]),_:1}),e(I,{color:"secondary",variant:"outlined",class:"ms-2",to:{name:"projects"}},{default:a(()=>[i(" Back to Projects ")]),_:1})])]),_:1})]),_:1})):c(U)?(o(),p(Q,{key:2},[e(te,null,{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[r("div",xi,[r("div",ki,[e(I,{icon:"",variant:"text",class:"me-3",to:{name:"projects"}},{default:a(()=>[e(b,{icon:"tabler-arrow-left"})]),_:1}),r("h3",wi,n(c(U).name),1)]),r("div",Vi,[e(I,{color:"info",variant:"tonal","prepend-icon":"tabler-refresh",class:"me-2",onClick:O,loading:C.value},{default:a(()=>[i(" Refresh ")]),_:1},8,["loading"]),c(F)?(o(),g(Oa,{key:0,modelValue:A.value,"onUpdate:modelValue":N[0]||(N[0]=J=>A.value=J),location:"top",loading:C.value},{activator:a(({props:J})=>[e(I,ba(J,{color:"secondary",variant:"outlined","prepend-icon":"tabler-file-export",class:"me-2"}),{default:a(()=>[i(" Export SRS ")]),_:2},1040)]),default:a(()=>[e($e,null,{default:a(()=>[(o(),p(Q,null,re(G,J=>e(Ee,{key:J.value,value:J.value,onClick:de=>{(async(Ce="md")=>{C.value=!0;try{const{data:Ue,error:qe}=await v.exportSrs(P.value,Ce);Ue&&!qe?(T("SRS export started successfully"),V.value="6",w()):T("Failed to start SRS export","error")}catch(Ue){T("Failed to start SRS export: "+Ue.message,"error")}finally{C.value=!1}})(J.value),A.value=!1}},{prepend:a(()=>[e(b,{icon:J.icon},null,8,["icon"])]),default:a(()=>[e(Oe,null,{default:a(()=>[i(n(J.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1},8,["modelValue","loading"])):S("",!0),c(x)?(o(),g(I,{key:1,color:"primary","prepend-icon":"tabler-edit",class:"me-2",onClick:E,loading:C.value},{default:a(()=>[i(" Edit ")]),_:1},8,["loading"])):S("",!0),c(j)?(o(),g(I,{key:2,color:"error",variant:"tonal","prepend-icon":"tabler-trash",onClick:N[1]||(N[1]=J=>$.value=!0),loading:C.value},{default:a(()=>[i(" Delete ")]),_:1},8,["loading"])):S("",!0)])])]),_:1})]),_:1}),e(te,null,{default:a(()=>[e(R,{cols:"12"},{default:a(()=>[e(W,null,{default:a(()=>[e(sa,{modelValue:V.value,"onUpdate:modelValue":N[2]||(N[2]=J=>V.value=J),"bg-color":"primary",grow:"","slider-color":"white"},{default:a(()=>[e(ce,{value:"0",color:"white"},{default:a(()=>[e(b,{size:"18",icon:"tabler-info-circle",start:""}),i(" Overview ")]),_:1}),e(ce,{value:"1",color:"white"},{default:a(()=>{var J;return[e(b,{size:"18",icon:"tabler-list",start:""}),i(" Requirements "),(J=c(U).requirements)!=null&&J.length?(o(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:a(()=>[i(n(c(U).requirements.length),1)]),_:1})):S("",!0)]}),_:1}),e(ce,{value:"2",color:"white"},{default:a(()=>{var J;return[e(b,{size:"18",icon:"tabler-user-check",start:""}),i(" User Stories "),(J=c(U).user_stories)!=null&&J.length?(o(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:a(()=>{var de;return[i(n(((de=c(U).user_stories)==null?void 0:de.length)||0),1)]}),_:1})):S("",!0)]}),_:1}),e(ce,{value:"3",color:"white"},{default:a(()=>{var J;return[e(b,{size:"18",icon:"tabler-layout-kanban",start:""}),i(" Mockups "),(J=c(U).mockups)!=null&&J.length?(o(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:a(()=>[i(n(c(U).mockups.length),1)]),_:1})):S("",!0)]}),_:1}),e(ce,{value:"4",color:"white"},{default:a(()=>{var J;return[e(b,{size:"18",icon:"tabler-chart-dots",start:""}),i(" UML Diagrams "),(J=c(U).uml_diagrams)!=null&&J.length?(o(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:a(()=>{var de;return[i(n(((de=c(U).uml_diagrams)==null?void 0:de.length)||0),1)]}),_:1})):S("",!0)]}),_:1}),e(ce,{value:"5",color:"white"},{default:a(()=>[e(b,{size:"18",icon:"tabler-chart-dots",start:""}),i(" Development Plan ")]),_:1}),e(ce,{value:"6",color:"white"},{default:a(()=>{var J;return[e(b,{size:"18",icon:"tabler-file-export",start:""}),i(" Exports "),(J=c(U).srs_exports)!=null&&J.length?(o(),g(K,{key:0,size:"x-small",color:"white",class:"ms-2"},{default:a(()=>{var de;return[i(n(((de=c(U).srs_exports)==null?void 0:de.length)||0),1)]}),_:1})):S("",!0)]}),_:1})]),_:1},8,["modelValue"]),e(ee),e(oa,{modelValue:V.value,"onUpdate:modelValue":N[6]||(N[6]=J=>V.value=J)},{default:a(()=>[e(me,{value:"0"},{default:a(()=>[e(Dt,{project:c(U),loading:m.value},null,8,["project","loading"])]),_:1}),e(me,{value:"1"},{default:a(()=>[e(oe,{class:"pt-3 px-6"},{default:a(()=>[e(Z),c(F)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:u,loading:C.value},{default:a(()=>[i(" Generate Requirements ")]),_:1},8,["loading"])):S("",!0)]),_:1}),e(Pl,{"project-id":c(P),requirements:c(U).requirements||[],loading:m.value,onRefresh:O,onViewUserStories:ae},null,8,["project-id","requirements","loading"])]),_:1}),e(me,{value:"2"},{default:a(()=>{var J,de;return[e(oe,{class:"pt-3 px-6"},{default:a(()=>[k.value?(o(),g(I,{key:0,color:"secondary",variant:"tonal","prepend-icon":"tabler-arrow-left",onClick:N[3]||(N[3]=Ce=>k.value=null)},{default:a(()=>[i(" Back to All User Stories ")]),_:1})):S("",!0),e(Z),c(F)?(o(),g(I,{key:1,color:"primary","prepend-icon":"tabler-refresh",onClick:N[4]||(N[4]=Ce=>(async(Ue=null)=>{C.value=!0;try{let qe;if(Ue){const{data:We,error:ea}=await v.generateUserStories(P.value,Ue);qe={data:We,error:ea}}else{const{data:We,error:ea}=await v.generateUserStories(P.value);qe={data:We,error:ea}}qe.data&&!qe.error?(T("User stories generation started successfully"),w()):T("Failed to start user stories generation","error")}catch(qe){T("Failed to start user stories generation: "+qe.message,"error")}finally{C.value=!1}})(k.value?k.value.id:null)),loading:C.value},{default:a(()=>[i(n(k.value?"Generate User Stories for this Requirement":"Generate All User Stories"),1)]),_:1},8,["loading"])):S("",!0)]),_:1}),e(Uo,{"project-id":c(P),"requirement-id":k.value?k.value.id:null,"user-stories":k.value?((de=(J=c(U).requirements)==null?void 0:J.find(Ce=>Ce.id===k.value.id))==null?void 0:de.user_stories)||[]:c(U).user_stories||[],loading:m.value,onRefresh:O},null,8,["project-id","requirement-id","user-stories","loading"])]}),_:1}),e(me,{value:"3"},{default:a(()=>[e(oe,{class:"pt-3 px-6"},{default:a(()=>[e(Z),c(F)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:y,loading:C.value},{default:a(()=>[i(" Generate Mockups ")]),_:1},8,["loading"])):S("",!0)]),_:1}),e(hr,{"project-id":c(P),mockups:c(U).mockups||[],loading:m.value,onRefresh:O},null,8,["project-id","mockups","loading"])]),_:1}),e(me,{value:"4"},{default:a(()=>[e(oe,{class:"pt-3 px-6"},{default:a(()=>[e(Z),c(F)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:N[5]||(N[5]=J=>(async(de=null)=>{C.value=!0;try{const{data:Ce,error:Ue}=await _.generateDiagrams(P.value,de);Ce&&!Ue?(T("UML diagram generation started successfully"),w()):T("Failed to start UML diagram generation","error")}catch(Ce){T("Failed to start UML diagram generation: "+Ce.message,"error")}finally{C.value=!1}})(null)),loading:C.value},{default:a(()=>[i(" Generate UML Diagrams ")]),_:1},8,["loading"])):S("",!0)]),_:1}),e(fi,{"project-id":c(P),diagrams:c(U).uml_diagrams||[],loading:m.value,onRefresh:O},null,8,["project-id","diagrams","loading"])]),_:1}),e(me,{value:"5"},{default:a(()=>[e(oe,{class:"pt-3 px-6"},{default:a(()=>[e(Z),c(x)?(o(),g(I,{key:0,color:"primary","prepend-icon":"tabler-refresh",onClick:q,loading:C.value},{default:a(()=>[i(" Generate Development Plan ")]),_:1},8,["loading"])):S("",!0)]),_:1}),e(us,{"project-id":c(P),"development-plan":c(U).development_plan,loading:m.value,onRefresh:O},null,8,["project-id","development-plan","loading"])]),_:1}),e(me,{value:"6"},{default:a(()=>[e(_i,{"project-id":c(P),exports:c(U).srs_exports||[],loading:m.value,onRefresh:O},null,8,["project-id","exports","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):S("",!0),c(U)?(o(),g(Na,{key:3,modelValue:M.value,"onUpdate:modelValue":N[7]||(N[7]=J=>M.value=J),"edit-mode":"","project-data":c(U),onSubmit:f},null,8,["modelValue","project-data"])):S("",!0),e(ge,{isDialogVisible:$.value,"onUpdate:isDialogVisible":N[8]||(N[8]=J=>$.value=J),confirmationMsg:"Are you sure you want to delete this project? This action cannot be undone.",onConfirm:B},null,8,["isDialogVisible"]),e(ye,{modelValue:z.value.show,"onUpdate:modelValue":N[10]||(N[10]=J=>z.value.show=J),color:z.value.color,timeout:5e3},{actions:a(()=>[e(Ne,{onClick:N[9]||(N[9]=J=>z.value.show=!1)},{default:a(()=>[e(b,{icon:"tabler-x"})]),_:1})]),default:a(()=>[i(n(z.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})}}};typeof da=="function"&&da(Ci);export{Ci as default};
