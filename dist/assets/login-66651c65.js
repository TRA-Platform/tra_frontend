import{L as S,ab as z,ad as E,E as J,a9 as K,ae as L,p as a,aa as w,b2 as R,aB as T,k as f,w as X,o as Y,c as Z,y as o,D as h,A as b,q as e,aX as G,m as v,aJ as H,V as M,z as V,aK as N,aY as x,aZ as O,C as Q,aI as W,t as ee}from"./index-e8b63828.js";import{b as k}from"./route-block-83d24a4e.js";import{V as ae}from"./VForm-0819d548.js";import{V as se,a as _}from"./VRow-1119710b.js";import{m as le,u as te,V as D,b as q}from"./VTextField-348ad488.js";import{c as re,d as A}from"./VCheckboxBtn-6658bce8.js";import"./index-ecf02037.js";const oe=S()({name:"VCheckbox",inheritAttrs:!1,props:{...le(),...z(re(),["inline"])},emits:{"update:focused":t=>!0},setup(t,l){let{attrs:r,slots:i}=l;const{isFocused:n,focus:c,blur:g}=te(t),m=E(),p=J(()=>t.id||`checkbox-${m}`);return K(()=>{const[y,d]=L(r),[s,u]=D.filterProps(t),[U,fe]=A.filterProps(t);return a(D,w({class:["v-checkbox",t.class]},y,s,{id:p.value,focused:n.value,style:t.style}),{...i,default:j=>{let{id:F,messagesId:P,isDisabled:$,isReadonly:B}=j;return a(A,w(U,{id:F.value,"aria-describedby":P.value,disabled:$.value,readonly:B.value},d,{onFocus:c,onBlur:g}),i)}})}),{}}}),{t:C}=R.global,I=t=>{return(r=>r==null)(t)||(l=t,Array.isArray(l)&&l.length===0)||t===!1?C("validation.required"):!!String(t).trim().length||C("validation.required");var l},de={class:"auth-wrapper d-flex justify-center align-center pa-md-4"},ue={class:"position-relative"},ie={class:"d-flex"},ne={class:"text-h5 font-weight-semibold mb-1"},me={class:"mb-0"},ce={class:"d-flex align-center justify-space-between flex-wrap mt-2 mb-4"},pe={__name:"login",setup(t){const{t:l}=T(),r=f({enabled:!1,type:"error",message:l("auth.login.messages.error")}),i=f({username:"",password:"",stay_signed:!1,code:""}),n=f(!1),c=f(!1),g=ee(),m=X(),p=f(),y=async()=>{var s;let d;if((await((s=p==null?void 0:p.value)==null?void 0:s.validate())).valid){n.value=!0;try{if(d=await m.login(i.value),!d.data.access)return r.value={enabled:!0,type:"error",message:d.data},void(n.value=!1)}catch(u){return r.value={enabled:!0,type:"error",message:u.data},void(n.value=!1)}if(m.authData={...m.authData,access:`${d.data.access}`,refresh:`${d.data.refresh}`},d=await m.me({}),d.data.error)return r.value={enabled:!0,type:"error",message:d.data.error},void(n.value=!1);m.userData=d.data,r.value={enabled:!0,type:"success",message:l("auth.login.messages.success")},n.value=!1,setTimeout(()=>{g.push({name:m.authData.nextUrl,params:m.authData.nextParams})},1e3)}else r.value={enabled:!0,type:"error",message:l("validation.required")}};return(d,s)=>(Y(),Z("div",de,[a(G,{modelValue:e(r).enabled,"onUpdate:modelValue":s[0]||(s[0]=u=>e(r).enabled=u),location:"bottom end",variant:"flat",transition:"scroll-y-reverse-transition",color:e(r).type},{default:o(()=>[h(b(e(r).message),1)]),_:1},8,["modelValue","color"]),v("div",ue,[a(W,{class:"auth-card pa-4","min-width":"448","max-width":"448"},{default:o(()=>[a(H,{class:"justify-center"},{prepend:o(()=>[v("div",ie,[a(e(M),{nodes:e(V).app.logo},null,8,["nodes"])])]),default:o(()=>[a(N,{class:"font-weight-bold text-h5 py-1"},{default:o(()=>[h(b(e(V).app.title),1)]),_:1})]),_:1}),a(x,{class:"pt-1"},{default:o(()=>[v("h5",ne,b(e(l)("auth.login.welcome")),1),v("p",me,b(e(l)("auth.login.slogan")),1)]),_:1}),a(x,null,{default:o(()=>[a(ae,{ref_key:"refForm",ref:p,onSubmit:s[5]||(s[5]=O(()=>{},["prevent"]))},{default:o(()=>[a(se,null,{default:o(()=>[a(_,{cols:"12"},{default:o(()=>[a(q,{modelValue:e(i).username,"onUpdate:modelValue":s[1]||(s[1]=u=>e(i).username=u),label:e(l)("auth.login.username"),type:"text",rules:[e(I)]},null,8,["modelValue","label","rules"])]),_:1}),a(_,{cols:"12"},{default:o(()=>[a(q,{modelValue:e(i).password,"onUpdate:modelValue":s[2]||(s[2]=u=>e(i).password=u),label:e(l)("auth.login.password"),type:e(c)?"text":"password",rules:[e(I)],autocomplete:"on","append-inner-icon":e(c)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[3]||(s[3]=u=>c.value=!e(c))},null,8,["modelValue","label","type","rules","append-inner-icon"])]),_:1}),a(_,{cols:"12"},{default:o(()=>[v("div",ce,[a(oe,{modelValue:e(i).stay_signed,"onUpdate:modelValue":s[4]||(s[4]=u=>e(i).stay_signed=u),label:e(l)("auth.login.remember_me")},null,8,["modelValue","label"])]),a(Q,{loading:e(n),disabled:e(n),block:"",type:"submit",onClick:y},{default:o(()=>[h(b(e(l)("auth.login.login_btn")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])]))}};typeof k=="function"&&k(pe);export{pe as default};
